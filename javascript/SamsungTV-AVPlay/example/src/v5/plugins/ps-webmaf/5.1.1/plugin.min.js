/**
 * @license
 * Plugin 5.1.1-ps-webmaf <http://youbora.com/>
 * Copyright NicePopleAtWork <http://nicepeopleatwork.com/>
 */
"undefined"!=typeof $YB&&($YB.plainConsole=!0,$YB.plugins.PsWebmaf=function(e){try{this.duration=0,this.playhead=0,this.pluginName="ps-webmaf",this.pluginVersion="5.1.1-ps-webmaf",this.init("playstation",e),this.registerListeners(),window.external.user('{"command":"appversion"}')}catch(t){$YB.error(t)}},$YB.plugins.PsWebmaf.prototype=new $YB.plugins.Generic,$YB.plugins.PsWebmaf.prototype.getPlayhead=function(){return this.playhead},$YB.plugins.PsWebmaf.prototype.getMediaDuration=function(){return this.duration},$YB.plugins.PsWebmaf.prototype.getBitrate=function(){return this.bitrate},$YB.plugins.PsWebmaf.prototype.getThroughput=function(){return this.throughput},$YB.plugins.PsWebmaf.prototype.getPlayerVersion=function(){return this.playerVersion},$YB.plugins.PsWebmaf.prototype.accessfunctionHandler=function(e){try{if(e){try{var t=JSON.parse(e)}catch(i){return void $YB.warn('Accessfunction response is not correct: "'+e+'".')}switch("getPlaybackTime"!=t.command&&$YB.debug(e),t.command){case"playerStreamingError":case"playerError":this.videoApi.sendError({errorCode:t.error_code,msg:t.error}),this.videoApi.sendStop(),this.stopTimers();break;case"AppWebBrowser":this.videoApi.sendError({errorCode:t.errorCode,msg:"Web Browser Error"}),this.videoApi.sendStop(),this.stopTimers();break;case"playerStatusChange":switch(t.playerState){case"endOfStream":case"stopped":case"notReady":this.videoApi.sendStop(),this.stopTimers();break;case"paused":this.videoApi.sendPause();break;case"buffering":this.isJoinSent&&this.videoApi.sendBufferStart();break;case"opening":this.duration=t.totalLength,this.isStartSent||this.videoApi.sendStart(),this.startTimers();break;case"playing":this.isJoinSent?this.isPaused?this.videoApi.sendResume():this.isSeeking?this.videoApi.sendSeekEnd():this.isBuffering&&this.videoApi.sendBufferEnd():this.videoApi.sendJoin()}break;case"getPlaybackTime":this.playhead=t.elapsedTime;break;case"setPlayTime":this.videoApi.sendSeekStart();break;case"getBitrate":this.bitrate=t.bitrate,this.throughput=t.bandwidth;break;case"playerMessage":switch(t.msg_code){case-2140536828:this.videoApi.sendError({errorCode:t.msg_code,msg:t.msg_info}),this.videoApi.sendStop(),this.stopTimers()}break;case"contentAvailable":this.duration=t.totalLength;break;case"appversion":this.playerVersion=t.version}}}catch(i){$YB.error(i)}},$YB.plugins.PsWebmaf.prototype.startTimers=function(){this.timers=this.timers||{},this.timers.playhead=setInterval(function(){window.external.user('{"command":"getPlaybackTime"}')},500),this.timers.bitrate=setInterval(function(){window.external.user('{"command":"getBitrate"}')},5e3)},$YB.plugins.PsWebmaf.prototype.stopTimers=function(){for(var e in this.timers)clearInterval(this.timers[e])});