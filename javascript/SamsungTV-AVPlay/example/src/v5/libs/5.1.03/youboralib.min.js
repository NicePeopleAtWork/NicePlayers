/**
 * @license
 * youboralib 5.1.03 <http://youbora.com/>
 * Copyright NicePopleAtWork <http://nicepeopleatwork.com/>
 */
var $YB=$YB||{version:"5.1.03",plugins:{},adnalyzers:{},utils:{},api:{},comm:{},data:{},services:{}};$YB.api.Ads=function(e){this.adnalyzer=e,this.buffer=new $YB.utils.Buffer(this),this.chrono={total:new $YB.utils.Chrono,joinTime:new $YB.utils.Chrono,pause:new $YB.utils.Chrono,buffer:this.buffer.chrono},this.counter={pre:0,mid:0,post:0,unknown:0},this.totalPrerollTime=0,this.position=""},$YB.api.Ads.prototype.sendAdStart=function(e,t){try{this.adnalyzer.isAdStartSent&&this.sendAdStop(),this.buffer.autostart&&this.buffer.start(),this.adnalyzer.plugin.videoApi.sendSeekEnd(),this.adnalyzer.plugin.isShowingAds=!0,this.adnalyzer.isAdStartSent=!0,this.chrono.total.start(),this.chrono.joinTime.start(),e=e||{},e.resource=$YB.utils.getFirstDefined(e.resource,this.getAdResource()),e.position=$YB.utils.getFirstDefined(e.position,this.getAdPosition()),e.number=$YB.utils.getFirstDefined(e.number,this.getNumber(e.position,!0)),e.campaign=$YB.utils.getFirstDefined(e.campaign,this.adnalyzer.plugin.data.ads.campaign),e.title=$YB.utils.getFirstDefined(e.title,this.getAdTitle()),e.adDuration=$YB.utils.getFirstDefined(e.adDuration,this.getAdDuration()),e.playhead=$YB.utils.getFirstDefined(e.playhead,this.getMediaPlayhead()),e.adnalyzerVersion=$YB.utils.getFirstDefined(e.adnalyzerVersion,this.adnalyzer.adnalyzerVersion),e.adPlayerVersion=$YB.utils.getFirstDefined(e.adPlayerVersion,this.getAdPlayerVersion()),"undefined"!=typeof e.durationJointime&&(this.adnalyzer.isAdJoinSent=!0),this.position=e.position,this.adnalyzer.plugin.comm.sendRequest("/adStart",e,t),$YB.notice("Request: NQS /adStart "+e.position+e.number,"darkgreen")}catch(i){$YB.error(i)}},$YB.api.Ads.prototype.sendAdJoin=function(e,t){try{this.adnalyzer.isAdStartSent&&!this.adnalyzer.isAdJoinSent&&(this.adnalyzer.isAdJoinSent=!0,this.buffer.autostart&&this.buffer.start(),e=e||{},e.adPlayhead=$YB.utils.getFirstDefined(e.adPlayhead,this.getAdPlayhead()),e.duration=$YB.utils.getFirstDefined(e.duration,this.chrono.joinTime.getDeltaTime()),e.position=$YB.utils.getFirstDefined(e.position,this.position),e.number=$YB.utils.getFirstDefined(e.number,this.getNumber(e.position)),this.adnalyzer.plugin.comm.sendRequest("/adJoinTime",e,t),$YB.notice("Request: NQS /adJoinTime "+e.duration+"ms","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Ads.prototype.sendAdStop=function(e,t){try{this.adnalyzer.isAdStartSent&&(this.adnalyzer.isAdStartSent=!1,this.adnalyzer.isAdJoinSent=!1,this.adnalyzer.isAdBuffering=!1,this.adnalyzer.plugin.isShowingAds=!1,this.buffer.stop(),e=e||{},e.totalDuration=$YB.utils.getFirstDefined(e.totalDuration,this.chrono.total.getDeltaTime()),e.adPlayhead=$YB.utils.getFirstDefined(e.adPlayhead,this.getAdPlayhead()),e.adBitrate=$YB.utils.getFirstDefined(e.adBitrate,this.getAdBitrate()),e.position=$YB.utils.getFirstDefined(e.position,this.position),e.number=$YB.utils.getFirstDefined(e.number,this.getNumber(e.position)),e.adPlayhead||delete e.adPlayhead,"pre"!=this.position||this.adnalyzer.plugin.isJoinSent||(this.totalPrerollTime+=e.totalDuration),this.adnalyzer.plugin.comm.sendRequest("/adStop",e,t),$YB.notice("Request: NQS /adStop "+e.totalDuration+"ms","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Ads.prototype.sendAdPause=function(e,t){try{this.adnalyzer.isAdJoinSent&&!this.adnalyzer.isAdPaused&&(this.adnalyzer.isAdPaused=!0,this.chrono.pause.start(),e=e||{},e.position=$YB.utils.getFirstDefined(e.position,this.position),e.number=$YB.utils.getFirstDefined(e.number,this.getNumber(e.position)),this.adnalyzer.plugin.comm.sendRequest("/adPause",e,t),$YB.notice("Request: NQS /adPause","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Ads.prototype.sendAdResume=function(e,t){try{this.adnalyzer.isAdJoinSent&&this.adnalyzer.isAdPaused&&(this.adnalyzer.isAdPaused=!1,this.chrono.pause.getDeltaTime(),e=e||{},e.position=$YB.utils.getFirstDefined(e.position,this.position),e.number=$YB.utils.getFirstDefined(e.number,this.getNumber(e.position)),this.adnalyzer.plugin.comm.sendRequest("/adResume",e,t),$YB.notice("Request: NQS /adResume","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Ads.prototype.sendAdBufferStart=function(){try{this.adnalyzer.isAdJoinSent&&!this.adnalyzer.isAdBuffering&&(this.adnalyzer.isAdBuffering=!0,this.chrono.buffer.start(),$YB.notice("Method: /adBufferStart","darkgreen"))}catch(e){$YB.error(e)}},$YB.api.Ads.prototype.sendAdBufferEnd=function(e,t){try{this.adnalyzer.isAdJoinSent&&this.adnalyzer.isAdBuffering&&(this.adnalyzer.isAdBuffering=!1,e=e||{},e.adPlayhead=$YB.utils.getFirstDefined(e.adPlayhead,this.getAdPlayhead()),e.duration=$YB.utils.getFirstDefined(e.duration,this.chrono.buffer.getDeltaTime()),e.position=$YB.utils.getFirstDefined(e.position,this.position),e.number=$YB.utils.getFirstDefined(e.number,this.getNumber(e.position)),this.adnalyzer.plugin.comm.sendRequest("/adBufferUnderrun",e,t),$YB.notice("Request: NQS /adBufferUnderrun "+e.duration+"ms","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Ads.prototype.getNumber=function(e,t){switch(e){case"pre":return t?++this.counter.pre:this.counter.pre;case"mid":return t?++this.counter.mid:this.counter.mid;case"post":return t?++this.counter.post:this.counter.post;default:return t?++this.counter.unknown:this.counter.unknown}},$YB.api.Ads.prototype.resetNumbers=function(){this.counter={pre:0,mid:0,post:0,unknown:0}},$YB.api.Ads.prototype.getAdResource=function(){try{var e="";return"undefined"!=typeof this.adnalyzer.plugin.data.ads.resource?e=this.adnalyzer.plugin.data.ads.resource:"function"==typeof this.adnalyzer.getAdResource&&(e=this.adnalyzer.getAdResource()),e}catch(t){return $YB.warn(t),""}},$YB.api.Ads.prototype.getMediaPlayhead=function(){try{var e=0;return"function"==typeof this.adnalyzer.getMediaPlayhead&&null!==this.adnalyzer.getMediaPlayhead()?e=this.adnalyzer.getMediaPlayhead():"function"==typeof this.adnalyzer.plugin.getPlayhead&&null!==this.adnalyzer.plugin.getPlayhead()&&(e=this.adnalyzer.plugin.getPlayhead()),$YB.utils.parseNumber(e,0)}catch(t){return $YB.warn(t),0}},$YB.api.Ads.prototype.getAdPlayhead=function(){try{var e=0;return"function"==typeof this.adnalyzer.getAdPlayhead&&(e=this.adnalyzer.getAdPlayhead()),$YB.utils.parseNumber(e,0)}catch(t){return $YB.warn(t),0}},$YB.api.Ads.prototype.getAdPosition=function(){try{var e="unknown";return"undefined"!=typeof this.adnalyzer.plugin.data.ads.position?e=this.adnalyzer.plugin.data.ads.position:"function"==typeof this.adnalyzer.getAdPosition&&(e=this.adnalyzer.getAdPosition()),e}catch(t){return $YB.warn(t),"unknown"}},$YB.api.Ads.prototype.getAdTitle=function(){try{var e="";return"undefined"!=typeof this.adnalyzer.plugin.data.ads.title?e=this.adnalyzer.plugin.data.ads.title:"function"==typeof this.adnalyzer.getAdTitle&&(e=this.adnalyzer.getAdTitle()),e}catch(t){return $YB.warn(t),""}},$YB.api.Ads.prototype.getAdDuration=function(){try{return res=0,"undefined"!=typeof this.adnalyzer.plugin.data.ads.duration?res=this.adnalyzer.plugin.data.ads.duration:"function"==typeof this.adnalyzer.getAdDuration&&(res=Math.round(this.adnalyzer.getAdDuration())),$YB.utils.parseNumber(res,0)}catch(e){return $YB.warn(e),0}},$YB.api.Ads.prototype.getAdBitrate=function(){try{var e=-1;return"undefined"!=typeof this.adnalyzer.plugin.data.ads.bitrate?e=this.adnalyzer.plugin.data.ads.bitrate:"function"==typeof this.adnalyzer.getAdBitrate&&(e=Math.round(this.adnalyzer.getAdBitrate())),$YB.utils.parseNumber(e,-1)}catch(t){return $YB.warn(t),-1}},$YB.api.Ads.prototype.getAdThroughput=function(){try{var e=-1;return"undefined"!=typeof this.adnalyzer.plugin.data.ads.throughput?e=this.adnalyzer.plugin.data.ads.throughput:"function"==typeof this.adnalyzer.getAdThroughput&&(e=Math.round(this.adnalyzer.getAdThroughput())),$YB.utils.parseNumber(e,-1)}catch(t){return $YB.warn(t),-1}},$YB.api.Ads.prototype.getAdPlayerVersion=function(){try{var e="";return"function"==typeof this.adnalyzer.getAdPlayerVersion&&(e=this.adnalyzer.getAdPlayerVersion()),e}catch(t){return $YB.warn(t),""}},$YB.api.Ping=function(e){try{this.plugin=e,this.interval=5e3,this.isRunning=!1,this.timer=null,this.chrono=new $YB.utils.Chrono,this.changedEntities=[],this.lastRendition=""}catch(t){$YB.error(t)}},$YB.api.Ping.prototype.start=function(){try{this.isRunning=!0,this._setPing(),$YB.notice("Sending pings every "+this.interval+"ms.","darkgreen")}catch(e){$YB.error(e)}},$YB.api.Ping.prototype.stop=function(){try{this.isRunning=!1,clearTimeout(this.timer)}catch(e){$YB.error(e)}},$YB.api.Ping.prototype._setPing=function(){try{if(this.isRunning){this.chrono.start();var e=this;this.timer=setTimeout(function(){e.sendPing({diffTime:e.chrono.stop()}),e._setPing()},this.interval)}}catch(t){$YB.error(t)}},$YB.api.Ping.prototype.sendPing=function(e,t){try{e=e||{};var i=this.plugin.videoApi.getRendition();if(this.lastRendition!=i&&(this.sendChangeEntity("rendition",i),this.lastRendition=i),2==this.changedEntities.length)e.entityType=$YB.utils.getFirstDefined(e.entityType,this.changedEntities.shift()),e.entityValue=$YB.utils.getFirstDefined(e.entityValue,this.changedEntities.shift());else if(this.changedEntities.length>2){for(var r={};this.changedEntities.length>0;)r[this.changedEntities.shift()]=this.changedEntities.shift();e.entityValue=$YB.utils.getFirstDefined(e.entityValue,JSON.stringify(r))}this.plugin.adnalyzer&&this.plugin.isShowingAds?(e.time=$YB.utils.getFirstDefined(e.time,this.plugin.adnalyzer.adsApi.getMediaPlayhead()),e.adPlayhead=$YB.utils.getFirstDefined(e.adPlayhead,this.plugin.adnalyzer.adsApi.getAdPlayhead()),e.adBitrate=$YB.utils.getFirstDefined(e.adBitrate,this.plugin.adnalyzer.adsApi.getAdBitrate())):e.time=$YB.utils.getFirstDefined(e.time,this.plugin.videoApi.getPlayhead()),this.plugin.videoApi.lastPlayhead=e.time,e.bitrate=$YB.utils.getFirstDefined(e.bitrate,this.plugin.videoApi.getBitrate()),e.throughput=$YB.utils.getFirstDefined(e.throughput,this.plugin.videoApi.getThroughput()),e.totalBytes=$YB.utils.getFirstDefined(e.totalBytes,this.plugin.videoApi.getTotalBytes()),e.pingTime=$YB.utils.getFirstDefined(e.pingTime,this.plugin.comm.pingTime),this.plugin.comm.sendRequest("/ping",e,t)}catch(s){$YB.error(s)}},$YB.api.Ping.prototype.sendChangeEntity=function(e,t){try{this.changedEntities.push(e),this.changedEntities.push(t)}catch(i){$YB.error(i)}},$YB.api.Video=function(e){this.plugin=e,this.buffer=new $YB.utils.Buffer(this),this.chrono={seek:new $YB.utils.Chrono,pause:new $YB.utils.Chrono,joinTime:new $YB.utils.Chrono,genericAd:new $YB.utils.Chrono,buffer:this.buffer.chrono},this.lastBitrate=0,this.lastDuration=0,this.lastPlayhead=0},$YB.api.Video.prototype.sendStart=function(e,t){try{this.plugin.isStartSent&&this.sendStop(),(this.plugin.data.parseCDNNodeHost||this.plugin.data.parseHLS)&&this.plugin.resourceParser.init(),this.plugin.isStartSent=!0,this.chrono.joinTime.start(),this.plugin.pingApi.start(),this._consolidateTitle(),e=e||{},e.system=$YB.utils.getFirstDefined(e.system,this.plugin.data.accountCode),e.player=$YB.utils.getFirstDefined(e.player,this.plugin.pluginName),e.pluginVersion=$YB.utils.getFirstDefined(e.pluginVersion,this.plugin.pluginVersion),e.playerVersion=$YB.utils.getFirstDefined(e.playerVersion,this.getPlayerVersion()),e.resource=$YB.utils.getFirstDefined(e.resource,this.getResource()),e.duration=$YB.utils.getFirstDefined(e.duration,this.getMediaDuration()),e.live=$YB.utils.getFirstDefined(e.live,this.getIsLive()),e.rendition=$YB.utils.getFirstDefined(e.rendition,this.getRendition()),e.user=$YB.utils.getFirstDefined(e.user,this.plugin.data.username),e.transcode=$YB.utils.getFirstDefined(e.transcode,this.plugin.data.transactionCode),e.title=$YB.utils.getFirstDefined(e.title,this.getTitle()),e.properties=$YB.utils.getFirstDefined(e.properties,this.plugin.data.properties),e.hashTitle=$YB.utils.getFirstDefined(e.hashTitle,this.plugin.data.hashTitle),e.cdn=$YB.utils.getFirstDefined(e.cdn,this.plugin.data.media.cdn),e.isp=$YB.utils.getFirstDefined(e.isp,this.plugin.data.network.isp),e.ip=$YB.utils.getFirstDefined(e.ip,this.plugin.data.network.ip),e.param1=$YB.utils.getFirstDefined(e.param1,this.plugin.data.extraParams.param1),e.param2=$YB.utils.getFirstDefined(e.param2,this.plugin.data.extraParams.param2),e.param3=$YB.utils.getFirstDefined(e.param3,this.plugin.data.extraParams.param3),e.param4=$YB.utils.getFirstDefined(e.param4,this.plugin.data.extraParams.param4),e.param5=$YB.utils.getFirstDefined(e.param5,this.plugin.data.extraParams.param5),e.param6=$YB.utils.getFirstDefined(e.param6,this.plugin.data.extraParams.param6),e.param7=$YB.utils.getFirstDefined(e.param7,this.plugin.data.extraParams.param7),e.param8=$YB.utils.getFirstDefined(e.param8,this.plugin.data.extraParams.param8),e.param9=$YB.utils.getFirstDefined(e.param9,this.plugin.data.extraParams.param9),e.param10=$YB.utils.getFirstDefined(e.param10,this.plugin.data.extraParams.param10),e.totalBytes=$YB.utils.getFirstDefined(e.totalBytes,this.getTotalBytes()),e.pingTime=$YB.utils.getFirstDefined(e.pingTime,this.plugin.comm.pingTime),e.referer=$YB.utils.getFirstDefined(e.referer,"undefined"!=typeof window?window.location.href:""),e.properties=$YB.utils.getFirstDefined(e.properties,{}),e.deviceId=$YB.utils.getFirstDefined(e.deviceid,this.plugin.data.device.id),e.adsExpected=$YB.utils.getFirstDefined(e.adsExpected,this.plugin.data.ads.expected),this.plugin.data.parseCDNNodeHost&&(e.nodeHost=$YB.utils.getFirstDefined(e.nodeHost,this.plugin.resourceParser.cdnHost),e.nodeType=$YB.utils.getFirstDefined(e.nodeType,this.plugin.resourceParser.cdnType)),this.plugin.resumeService&&this.plugin.data.resumeConfig.enabled&&(this.plugin.resumeService.start(),e.isResumed=this.plugin.resumeService.isResumed),1==this.plugin.data.isBalanced&&(e.isBalanced=1),this.plugin.comm.nextView(e.live),this.plugin.comm.sendRequest("/start",e,t),$YB.notice("Request: NQS /start "+e.resource,"darkgreen"),this.lastDuration=e.duration}catch(i){$YB.error(i)}},$YB.api.Video.prototype._consolidateTitle=function(){try{this.plugin.data.properties.content_metadata?this.plugin.data.properties.content_metadata.title=this.getTitle():this.plugin.data.properties.content_metadata={title:this.getTitle()}}catch(e){$YB.error(e)}},$YB.api.Video.prototype.sendJoin=function(e,t){try{!this.plugin.isStartSent||this.plugin.isJoinSent||this.plugin.adnalyzer&&this.plugin.adnalyzer.isStartSent||(this.plugin.isJoinSent=!0,this.buffer.autostart&&this.buffer.start(),e=e||{},e.time=$YB.utils.getFirstDefined(e.time,this.chrono.joinTime.getDeltaTime()),e.eventTime=$YB.utils.getFirstDefined(e.eventTime,this.getPlayhead()),e.mediaDuration=$YB.utils.getFirstDefined(e.mediaDuration,this.getMediaDuration()),e.mediaDuration===this.lastDuration&&delete e.mediaDuration,this.plugin.adnalyzer&&this.plugin.adnalyzer.adsApi.totalPrerollTime>0&&(e.time=e.time-this.plugin.adnalyzer.adsApi.totalPrerollTime,e.time<0&&(e.time=1),this.plugin.adnalyzer.adsApi.totalPrerollTime=0),this.lastPlayhead=e.eventTime,this.plugin.comm.sendRequest("/joinTime",e,t),$YB.notice("Request: NQS /joinTime "+e.time+"ms","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendStop=function(e,t){try{this.plugin.isStartSent&&(this.plugin.isStartSent=!1,this.plugin.isPaused=!1,this.plugin.isJoinSent=!1,this.plugin.isSeeking=!1,this.plugin.isBuffering=!1,this.plugin.resourceParser.clear(),this.plugin.pingApi.stop(),this.buffer.stop(),this.plugin.adnalyzer&&this.plugin.adnalyzer.adsApi.resetNumbers(),e=e||{},e.diffTime=$YB.utils.getFirstDefined(e.diffTime,this.plugin.pingApi.chrono.getDeltaTime()),this.plugin.comm.sendRequest("/stop",e,t),$YB.notice("Request: NQS /stop","darkgreen"),$YB.services.Resume&&this.plugin.data.resumeConfig.enabled&&this.plugin.resumeService.sendPlayTime())}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendPause=function(e,t){try{this.plugin.isJoinSent&&!this.plugin.isPaused&&(this.plugin.isPaused=!0,this.chrono.pause.start(),this.plugin.comm.sendRequest("/pause",e,t),$YB.notice("Request: NQS /pause","darkgreen"),$YB.services.Resume&&this.plugin.data.resumeConfig.enabled&&this.plugin.resumeService.sendPlayTime())}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendResume=function(e,t){try{this.plugin.isJoinSent&&this.plugin.isPaused&&(this.plugin.isPaused=!1,this.chrono.pause.getDeltaTime(),this.plugin.comm.sendRequest("/resume",e,t),$YB.notice("Request: NQS /resume","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendBufferStart=function(){try{this.plugin.isJoinSent&&!this.plugin.isBuffering&&(this.plugin.isBuffering=!0,this.chrono.buffer.start(),$YB.notice("Method: /bufferStart","darkgreen"))}catch(e){$YB.error(e)}},$YB.api.Video.prototype.sendBufferEnd=function(e,t){try{this.plugin.isJoinSent&&this.plugin.isBuffering&&(this.plugin.isBuffering=!1,e=e||{},e.duration=$YB.utils.getFirstDefined(e.duration,this.chrono.buffer.getDeltaTime()),e.time=$YB.utils.getFirstDefined(e.time,this.getPlayhead()),this.getIsLive()&&0===e.time&&(e.time=1),this.lastPlayhead=e.time,this.plugin.comm.sendRequest("/bufferUnderrun",e,t),$YB.notice("Request: NQS /bufferUnderrun "+e.duration+"ms","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendError=function(e,t){try{this._consolidateTitle(),this.plugin.pingApi.stop(),this.buffer.stop(),e=e||{},e.system=$YB.utils.getFirstDefined(e.system,this.plugin.data.accountCode),e.player=$YB.utils.getFirstDefined(e.player,this.plugin.pluginName),e.pluginVersion=$YB.utils.getFirstDefined(e.pluginVersion,this.plugin.pluginVersion),e.playerVersion=$YB.utils.getFirstDefined(e.playerVersion,this.getPlayerVersion()),e.resource=$YB.utils.getFirstDefined(e.resource,this.getResource()),e.duration=$YB.utils.getFirstDefined(e.duration,this.getMediaDuration()),e.live=$YB.utils.getFirstDefined(e.live,this.getIsLive()),e.user=$YB.utils.getFirstDefined(e.user,this.plugin.data.username),e.transcode=$YB.utils.getFirstDefined(e.transcode,this.plugin.data.transactionCode),e.title=$YB.utils.getFirstDefined(e.title,this.getTitle()),e.properties=$YB.utils.getFirstDefined(e.properties,this.plugin.data.properties),e.hashTitle=$YB.utils.getFirstDefined(e.hashTitle,this.plugin.data.hashTitle),e.cdn=$YB.utils.getFirstDefined(e.cdn,this.plugin.data.media.cdn),e.isp=$YB.utils.getFirstDefined(e.isp,this.plugin.data.network.isp),e.ip=$YB.utils.getFirstDefined(e.ip,this.plugin.data.network.ip),e.param1=$YB.utils.getFirstDefined(e.param1,this.plugin.data.extraParams.param1),e.param2=$YB.utils.getFirstDefined(e.param2,this.plugin.data.extraParams.param2),e.param3=$YB.utils.getFirstDefined(e.param3,this.plugin.data.extraParams.param3),e.param4=$YB.utils.getFirstDefined(e.param4,this.plugin.data.extraParams.param4),e.param5=$YB.utils.getFirstDefined(e.param5,this.plugin.data.extraParams.param5),e.param6=$YB.utils.getFirstDefined(e.param6,this.plugin.data.extraParams.param6),e.param7=$YB.utils.getFirstDefined(e.param7,this.plugin.data.extraParams.param7),e.param8=$YB.utils.getFirstDefined(e.param8,this.plugin.data.extraParams.param8),e.param9=$YB.utils.getFirstDefined(e.param9,this.plugin.data.extraParams.param9),e.param10=$YB.utils.getFirstDefined(e.param10,this.plugin.data.extraParams.param10),e.msg=$YB.utils.getFirstDefined(e.msg,"Unknown Error"),e.referer=$YB.utils.getFirstDefined(e.referer,"undefined"!=typeof window?window.location.href:""),("undefined"==typeof e.errorCode||parseInt(e.errorCode)<0)&&(e.errorCode=9e3),this.plugin.data.parseCDNNodeHost&&(e.nodeHost=$YB.utils.getFirstDefined(e.nodeHost,this.plugin.resourceParser.cdnHost),e.nodeType=$YB.utils.getFirstDefined(e.nodeType,this.plugin.resourceParser.cdnType)),$YB.services.Resume&&this.plugin.data.resumeConfig.enabled&&(this.plugin.resumeService.start(),e.isResumed=this.plugin.resumeService.isResumed),1==this.plugin.data.isBalanced&&(e.isBalanced=1),this.plugin.comm.sendRequest("/error",e,t),$YB.notice("Request: NQS /error "+e.msg,"darkgreen")}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendSeekStart=function(){try{this.plugin.isJoinSent&&!this.plugin.isSeeking&&(this.plugin.isSeeking=!0,this.chrono.seek.start(),$YB.notice("Method: /seekStart","darkgreen"))}catch(e){$YB.error(e)}},$YB.api.Video.prototype.sendSeekEnd=function(e,t){try{this.plugin.isJoinSent&&this.plugin.isSeeking&&(this.plugin.isSeeking=!1,e=e||{},e.duration=$YB.utils.getFirstDefined(e.duration,this.chrono.seek.getDeltaTime()),e.time=$YB.utils.getFirstDefined(e.time,this.getPlayhead()),this.lastPlayhead=e.time,this.plugin.comm.sendRequest("/seek",e,t),$YB.notice("Request: NQS /seek "+e.duration+"ms","darkgreen"))}catch(i){$YB.error(i)}},$YB.api.Video.prototype.sendGenericAdStart=function(){try{this.plugin.adnalyzer?$YB.warn("Generic Ads are disabled if an adnalyzer module is loaded."):this.plugin.isStartSent&&!this.plugin.isShowingAds&&(this.plugin.isShowingAds=!0,this.chrono.genericAd.start(),$YB.notice("Method: /genericAdStart","darkgreen"))}catch(e){$YB.error(e)}},$YB.api.Video.prototype.sendGenericAdEnd=function(){try{this.plugin.adnalyzer?$YB.warn("Generic Ads are disabled if an adnalyzer module is loaded."):this.plugin.isStartSent&&this.plugin.isShowingAds&&(this.plugin.isShowingAds=!1,this.chrono.genericAd.stop(),this.plugin.isJoinSent||(this.chrono.joinTime.startTime+=this.chrono.genericAd.getDeltaTime(),this.chrono.joinTime.startTime=Math.min(this.chrono.joinTime.startTime,(new Date).getTime())),$YB.notice("Method: /genericAdEnd "+this.chrono.genericAd.getDeltaTime()+"ms","darkgreen"))}catch(e){$YB.error(e)}},$YB.api.Video.prototype.getResource=function(){try{return this.plugin.resourceParser&&this.plugin.resourceParser.realResource?this.plugin.resourceParser.realResource:"undefined"!=typeof this.plugin.data.media.resource?this.plugin.data.media.resource:"function"==typeof this.plugin.getResource&&this.plugin.getResource()?this.plugin.getResource():"unknown"}catch(e){return $YB.warn(e),"unknown"}},$YB.api.Video.prototype.getPlayhead=function(){try{var e=0;return"function"==typeof this.plugin.getPlayhead&&(e=this.plugin.getPlayhead()),$YB.utils.parseNumber(e,0)}catch(t){return $YB.warn(t),0}},$YB.api.Video.prototype.getMediaDuration=function(){try{var e=0;return"undefined"!=typeof this.plugin.data.media.duration?e=this.plugin.data.media.duration:"function"==typeof this.plugin.getMediaDuration&&(e=this.plugin.getMediaDuration()),Math.round($YB.utils.parseNumber(e,0))}catch(t){return $YB.warn(t),0}},$YB.api.Video.prototype.getIsLive=function(){try{return"undefined"!=typeof this.plugin.data.media.isLive?this.plugin.data.media.isLive:"function"==typeof this.plugin.getIsLive&&"boolean"==typeof this.plugin.getIsLive()?this.plugin.getIsLive():!1}catch(e){return $YB.warn(e),!1}},$YB.api.Video.prototype.getRendition=function(){try{return"undefined"!=typeof this.plugin.data.media.rendition?this.plugin.data.media.rendition:"function"==typeof this.plugin.getRendition?this.plugin.getRendition():""}catch(e){return $YB.warn(e),""}},$YB.api.Video.prototype.getBitrate=function(){try{var e=-1;if("undefined"!=typeof this.plugin.data.media.bitrate)e=this.plugin.data.media.bitrate;else if("function"==typeof this.plugin.getBitrate&&$YB.utils.parseNumber(this.plugin.getBitrate(),!1)!==!1)e=Math.round(this.plugin.getBitrate());else if(this.plugin.tag&&"undefined"!=typeof this.plugin.tag.webkitVideoDecodedByteCount){var t=this.plugin.tag.webkitVideoDecodedByteCount;this.lastBitrate&&(t=Math.round((this.plugin.tag.webkitVideoDecodedByteCount-this.lastBitrate)/5*8)),this.lastBitrate=this.plugin.tag.webkitVideoDecodedByteCount,e=t}return $YB.utils.parseNumber(e,-1)}catch(i){return $YB.warn(i),-1}},$YB.api.Video.prototype.getThroughput=function(){try{var e=-1;return"undefined"!=typeof this.plugin.data.media.throughput?e=this.plugin.data.media.throughput:"function"==typeof this.plugin.getThroughput&&$YB.utils.parseNumber(this.plugin.getThroughput(),!1)!==!1&&(e=Math.round(this.plugin.getThroughput())),$YB.utils.parseNumber(e,-1)}catch(t){return $YB.warn(t),-1}},$YB.api.Video.prototype.getPlayerVersion=function(){try{var e="";return"function"==typeof this.plugin.getPlayerVersion&&this.plugin.getPlayerVersion()&&(e=this.plugin.getPlayerVersion()),e}catch(t){return $YB.warn(t),""}},$YB.api.Video.prototype.getTotalBytes=function(){try{var e=void 0;return"function"==typeof this.plugin.getTotalBytes&&(e=this.plugin.getTotalBytes()),$YB.utils.parseNumber(e,void 0)}catch(t){return void $YB.warn(t)}},$YB.api.Video.prototype.getTitle=function(){try{var e="";return"undefined"!=typeof this.plugin.data.media.title?this.plugin.data.media.title:("function"==typeof this.plugin.getTitle&&(e=this.plugin.getTitle()),e)}catch(t){return $YB.warn(t),""}},$YB.comm.AjaxRequest=function(e,t,i,r){try{this.xhr=this.createXHR(),this.host=e,this.service=t||"",this.params=i,this.options=r||{},this.options.method=this.options.method||$YB.comm.AjaxRequest.options.method,this.options.maxRetries=this.options.maxRetries||$YB.comm.AjaxRequest.options.maxRetries,"undefined"==typeof this.options.retryAfter&&(this.options.retryAfter=$YB.comm.AjaxRequest.options.retryAfter),this.hasError=!1,this.retries=0}catch(s){$YB.error(s)}},$YB.comm.AjaxRequest.options={method:"GET",requestHeaders:{},maxRetries:3,retryAfter:5e3},$YB.comm.AjaxRequest.prototype.getUrl=function(){try{return this.host+this.service+this.getParams()}catch(e){$YB.error(e)}},$YB.comm.AjaxRequest.prototype.getParams=function(){try{switch(typeof this.params){case"object":return"?"+this._parseParams(this.params);case"string":return this.params?"?"+this.params:"";default:return""}}catch(e){$YB.error(e)}},$YB.comm.AjaxRequest.prototype.setParam=function(e,t){try{switch(typeof this.params){case"string":this.params.length>0&&(this.params+="&"),this.params+=e+"="+t;break;case"object":default:this.params[e]=t}return this}catch(i){return $YB.error(i),this}},$YB.comm.AjaxRequest.prototype.on=function(e,t){try{"error"==e&&(this.hasError=!0),"function"==typeof t?this.xhr.addEventListener(e,t,!1):"undefined"!=typeof t&&$YB.warn("Warning: Request '"+this.getUrl()+"' has a callback that is not a function.")}catch(i){$YB.error(i)}finally{return this}},$YB.comm.AjaxRequest.prototype.load=function(e){return this.on("load",e)},$YB.comm.AjaxRequest.prototype.error=function(e){return this.on("error",e)},$YB.comm.AjaxRequest.prototype.send=function(){try{if(this.xhr.open(this.options.method,this.getUrl(),!0),this.options.requestHeaders)for(var e in this.options.requestHeaders)this.options.requestHeaders.hasOwnProperty(e)&&this.xhr.setRequestHeader(e,this.options.requestHeaders[e]);if(!this.hasError&&this.options.retryAfter>0&&this.options.maxRetries>0){var t=this;this.error(function r(){t.retries++,t.retries>t.options.maxRetries?$YB.error("Error: Aborting failed request. Max retries reached."):($YB.error("Error: Request failed. Retry "+t.retries+" of "+t.options.maxRetries+" in "+t.options.retryAfter+"ms."),setTimeout(function(){t.xhr.removeEventListener("error",r),t.send()},t.options.retryAfter))})}$YB.report("XHR Req: "+this.getUrl(),5,"navy"),this.xhr.send()}catch(i){$YB.error(i)}},$YB.comm.AjaxRequest.prototype.createXHR=function(){try{return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return $YB.error(e),{}}},$YB.comm.AjaxRequest.prototype.getXHR=function(){return this.xhr},$YB.comm.AjaxRequest.prototype._parseParams=function(e){try{if("string"==typeof e)return e;if(null!==e&&"object"==typeof e){var t="";for(var i in e)null!==e[i]&&"object"==typeof e[i]?t+=encodeURIComponent(i)+"="+encodeURIComponent(JSON.stringify(e[i]))+"&":null!==e[i]&&"undefined"!=typeof e[i]&&""!==e[i]&&(t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&");return t.slice(0,-1)}return""}catch(r){return $YB.error(r),""}},$YB.comm.Communication=function(e){try{this.plugin=e,this.host=e.data.service,this.pingTime=5,this.prefix="U",this.code="",this.view=-1,this.preloaders=[],this._requests={},this.addPreloader("FastData")}catch(t){$YB.error(t)}},$YB.comm.Communication.prototype.getViewCode=function(){return this.code?this.prefix+this.code+"_"+this.view:"nocode"},$YB.comm.Communication.prototype.nextView=function(e){return this.view++,e===!0?this.prefix="L":e===!1?this.prefix="V":this.prefix="U",this.getViewCode()},$YB.comm.Communication.prototype.requestData=function(e,t){try{e=e||{},e.outputformat=$YB.utils.getFirstDefined(e.outputformat,"jsonp"),delete e.code;var i=this,r=new $YB.comm.AjaxRequest(this._parseServiceHost(this.host),"/data",e);r.load(function(){i.receiveData(r)}),r.load(t),r.send(),$YB.notice("Request: NQS /data "+e.system,"darkgreen")}catch(s){$YB.error(s)}},$YB.comm.Communication.prototype.receiveData=function(e){try{var t=e.getXHR().response,i=JSON.parse(t.slice(t.indexOf("(")+1,t.lastIndexOf(")"))),r=i.q.h,s=i.q.c,n=i.q.pt,a=i.q.b;r.length>0&&s.length>0&&n.length>0&&a.length>0?(this.prefix=s.slice(0,1),this.code=s.slice(1),this.host=r,this.pingTime=n,this.plugin.pingApi.interval=1e3*this.pingTime,this.balancerEnabled=a,$YB.notice("FastData '"+s+"' is ready.","darkgreen"),this._requests.nocode&&this._requests.nocode.length>0&&(this._requests[this.getViewCode()]=this._requests.nocode,delete this._requests.nocode),this.removePreloader("FastData")):$YB.warn("Warning: FastData response is wrong.")}catch(o){$YB.error(o)}},$YB.comm.Communication.prototype.sendRequest=function(e,t,i){try{if(this.isAllowed(e)){t=t||{},delete t.code;var r=new $YB.comm.AjaxRequest("",e,t);r.load(i),this._registerRequest(r)}}catch(s){$YB.error(s)}},$YB.comm.Communication.prototype.sendService=function(e,t,i){try{var r=new $YB.comm.AjaxRequest(this._parseServiceHost(e),"",t);r.load(i),this._registerRequest(r)}catch(s){$YB.error(s)}},$YB.comm.Communication.prototype.isAllowed=function(e){return this.plugin.data.enableAnalytics&&!(e in this.plugin.data.disabledRequests)},$YB.comm.Communication.prototype.addPreloader=function(e){try{this.preloaders.push(e)}catch(t){$YB.error(t)}},$YB.comm.Communication.prototype.removePreloader=function(e){try{var t=this.preloaders.indexOf(e);if(-1!==t){if(this.preloaders.splice(t,1),0===this.preloaders.length){var i;for(var r in this._requests)for(;i=this._requests[r].shift();)i.setParam("code",r),i.host||(i.host=this._parseServiceHost(this.host)),"undefined"!=typeof i.params.resource&&this.plugin.resourceParser.realResource&&(i.params.resource=this.plugin.resourceParser.realResource),"undefined"!=typeof i.params.nodeHost&&this.plugin.resourceParser.nodeHost&&(i.params.nodeHost=this.plugin.resourceParser.nodeHost,i.params.nodeType=this.plugin.resourceParser.nodeType),i.send()}}else $YB.warn("Warning: trying to remove unexisting preloader '"+e+"'.")}catch(s){$YB.error(s)}},$YB.comm.Communication.prototype._registerRequest=function(e){try{return"undefined"==typeof this._requests[this.getViewCode()]&&(this._requests[this.getViewCode()]=[]),e.setParam("timemark",(new Date).getTime()),this._requests[this.getViewCode()].push(e),this._sendRequests(),e}catch(t){$YB.error(t)}},$YB.comm.Communication.prototype._sendRequests=function(){try{if(0===this.preloaders.length){var e;for(var t in this._requests)for(;e=this._requests[t].shift();)e.setParam("code",t),e.host||(e.host=this._parseServiceHost(this.host)),e.send()}}catch(i){$YB.error(i)}},$YB.comm.Communication.prototype._parseServiceHost=function(e){try{return 0===e.indexOf("//")?e=e.slice(2):0===e.indexOf("http://")?e=e.slice(7):0===e.indexOf("https://")&&(e=e.slice(8)),e=this.plugin.data.httpSecure===!0?"https://"+e:this.plugin.data.httpSecure===!1?"http://"+e:"//"+e}catch(t){return $YB.error(t),"http://localhost"}},$YB.data.Map=function(){this._map={}},$YB.data.Map.prototype.getLength=function(){return this._map.length},$YB.data.Map.prototype.add=function(e,t){return this._map[e]=t},$YB.data.Map.prototype.get=function(e){return e=e||"default",this._map.hasOwnProperty(e)===!1&&this.add(e,new $YB.data.Options),this._map[e]},$YB.datamap=new $YB.data.Map,$YB.data.Options=function(e){try{this.setOptions(e)}catch(t){$YB.error(t)}},$YB.data.Options.prototype={enableAnalytics:!0,disabledRequests:[],parseHLS:!1,parseCDNNodeHost:!1,hashTitle:!0,httpSecure:void 0,enableNiceBuffer:!0,
accountCode:"nicetest",service:"nqs.nice264.com",username:void 0,transactionCode:void 0,isBalanced:0,network:{ip:void 0,isp:void 0},device:{id:void 0},media:{isLive:void 0,resource:void 0,title:void 0,duration:void 0,cdn:void 0},ads:{expected:!1,resource:void 0,campaign:void 0,title:void 0,position:void 0,duration:void 0},properties:{contentId:void 0,type:void 0,transaction_type:void 0,genre:void 0,language:void 0,year:void 0,cast:void 0,director:void 0,owner:void 0,parental:void 0,price:void 0,rating:void 0,audioType:void 0,audioChannels:void 0,device:void 0,quality:void 0},extraParams:{param1:void 0,param2:void 0,param3:void 0,param4:void 0,param5:void 0,param6:void 0,param7:void 0,param8:void 0,param9:void 0,param10:void 0},concurrencyConfig:{enabled:!1,contentId:"",maxConcurrents:1,service:"pc.youbora.com/cping",redirect:"http://www.google.com",ipMode:!1},resumeConfig:{enabled:!1,contentId:"",service:"pc.youbora.com/resume",playTimeService:"pc.youbora.com/playTime",callback:function(e){console.log("ResumeService Callback: Seek to second "+e)}},smartswitchConfig:{enabled:!1,type:"balance",service:"smartswitch.youbora.com",zoneCode:"",originCode:"",niceNVA:"",niceNVB:"",token:""},setOptions:function(e,t){try{if(t=t||this,"undefined"!=typeof e)for(var i in e)"object"==typeof t[i]&&null!==t[i]?this.setOptions(e[i],t[i]):t[i]=e[i]}catch(r){$YB.error(r)}}},$YB.adnalyzers.Generic=function(){},$YB.adnalyzers.Generic.prototype={adnalyzerVersion:"1.0.0-GENERIC",ads:void 0,plugin:void 0,adsApi:void 0,isAdStartSent:!1,isAdJoinSent:!1,isAdPaused:!1,isAdBuffering:!1},$YB.adnalyzers.Generic.prototype.init=function(e,t){try{return $YB.notice("Adnalyzer "+this.adnalyzerVersion+" is ready."),this.plugin=e,this.ads=t,this.adsApi=new $YB.api.Ads(this),this.ads}catch(i){return $YB.error(i),null}},$YB.adnalyzers.Generic.prototype.startAutobuffer=function(){this.plugin.data.enableNiceBuffer&&(this.adsApi.buffer.autostart=!0)},$YB.adnalyzers.Generic.prototype.playAdHandler=function(e){try{this.isAdStartSent||(this.plugin.setOptions(e),this.adsApi.sendAdStart())}catch(t){$YB.error(t)}},$YB.adnalyzers.Generic.prototype.startJoinAdHandler=function(e){try{this.isAdStartSent||(this.plugin.setOptions(e),this.adsApi.sendAdStart(),this.plugin.isBuffering&&(this.adsApi.chrono.joinTime.startTime=this.plugin.videoApi.chrono.buffer.startTime,this.plugin.isBuffering=!1),this.adsApi.sendAdJoin())}catch(t){$YB.error(t)}},$YB.adnalyzers.Generic.prototype.joinAdHandler=function(){try{this.adsApi.sendAdJoin()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.pauseAdHandler=function(){try{this.adsApi.sendAdPause()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.pauseToggleAdHandler=function(){try{this.isAdPaused?this.adsApi.sendAdResume():this.adsApi.sendAdPause()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.resumeAdHandler=function(){try{this.adsApi.sendAdResume()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.endedAdHandler=function(){try{this.adsApi.sendAdStop()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.skipAdHandler=function(){try{this.adsApi.sendAdStop({skipped:!0})}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.bufferingAdHandler=function(){try{this.adsApi.sendAdBufferStart()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.bufferedAdHandler=function(){try{this.isAdStartSent&&(this.isAdJoinSent?this.isAdBuffering&&this.adsApi.sendAdBufferEnd():this.adsApi.sendAdJoin())}catch(e){$YB.error(e)}},$YB.plugins.Generic=function(){},$YB.plugins.Generic.prototype={pluginName:"GENERIC",pluginVersion:"5.1.0-GENERIC",playerId:"generic",player:void 0,tag:void 0,isStartSent:!1,isJoinSent:!1,isPaused:!1,isSeeking:!1,isBuffering:!1,isShowingAds:!1,data:void 0,videoApi:void 0,pingApi:void 0,comm:void 0,adnalyzer:void 0,resourceParser:void 0,concurrencyService:void 0,resumeService:void 0,smartswitchService:void 0},$YB.plugins.Generic.prototype.init=function(e,t){try{return $YB.notice("Plugin "+this.pluginVersion+" (with YouboraJS "+$YB.version+") is ready."),"string"==typeof e?(this.playerId=e,this.player=document.getElementById(e)):(this.player=e,e&&e.id&&(this.playerId=e.id)),this.tag=this.player,this.data=$YB.datamap.get(this.playerId),this.data.setOptions(t),this.videoApi=new $YB.api.Video(this),this.pingApi=new $YB.api.Ping(this),this.comm=new $YB.comm.Communication(this),this.resourceParser=new $YB.services.ResourceParser(this),this.data.concurrencyConfig.enabled&&($YB.services.Concurrency?this.concurrency=new $YB.services.Concurrency(this):$YB.warning("Concurrecy Service is enabled but library was not found. Try to include 'services.js'.")),this.data.resumeConfig.enabled&&($YB.services.Resume?this.resume=new $YB.services.Resume(this):$YB.warning("Resume Service is enabled but library was not found. Try to include 'services.js'.")),this.data.smartswitchConfig.enabled&&($YB.services.Smartswitch?this.smartswitch=new $YB.services.Smartswitch(this):$YB.warning("Smartswitch Service is enabled but library was not found. Try to include 'services.js'.")),this.comm.requestData({system:this.data.accountCode,pluginVersion:this.pluginVersion,targetDevice:this.pluginName,live:this.data.media.isLive}),this.player}catch(i){return $YB.error(i),null}},$YB.plugins.Generic.prototype.startAutobuffer=function(){this.data.enableNiceBuffer&&(this.videoApi.buffer.autostart=!0)},$YB.plugins.Generic.prototype.playHandler=function(e){try{this.isStartSent||(this.setOptions(e),this.videoApi.sendStart())}catch(t){$YB.error(t)}},$YB.plugins.Generic.prototype.videoChangeHandler=function(e){try{this.setOptions(e),this.videoApi.sendStart()}catch(t){$YB.error(t)}},$YB.plugins.Generic.prototype.joinHandler=function(){try{this.videoApi.sendJoin()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.playingHandler=function(){try{this.isStartSent&&(this.isJoinSent?this.isSeeking&&this.isPaused?(this.videoApi.sendSeekEnd(),this.videoApi.sendResume()):this.isSeeking?this.videoApi.sendSeekEnd():this.isBuffering?this.videoApi.sendBufferEnd():this.isPaused&&this.videoApi.sendResume():this.videoApi.sendJoin())}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.pauseHandler=function(){try{this.videoApi.sendPause()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.pauseToggleHandler=function(){try{this.isPaused?this.videoApi.sendResume():this.videoApi.sendPause()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.resumeHandler=function(){try{this.videoApi.sendResume()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.endedHandler=function(){try{this.videoApi.sendStop()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.stopHandler=function(){try{this.videoApi.sendStop()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.errorHandler=function(e,t){try{"undefined"==typeof e&&(e=0),t=t||e||"Unknown error",this.videoApi.sendError({errorCode:e,msg:t})}catch(i){$YB.error(i)}},$YB.plugins.Generic.prototype.seekingHandler=function(){try{this.videoApi.sendSeekStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.seekedHandler=function(){try{this.videoApi.sendSeekEnd()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.bufferingHandler=function(){try{this.isSeeking||this.videoApi.sendBufferStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.bufferedHandler=function(){try{this.isStartSent&&(this.isJoinSent?this.isSeeking?this.videoApi.sendSeekEnd():this.isBuffering&&this.videoApi.sendBufferEnd():this.videoApi.sendJoin())}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.genericAdStartHandler=function(){try{this.videoApi.sendGenericAdStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.genericAdEndHandler=function(){try{this.videoApi.sendGenericAdEnd()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.setOptions=function(e){try{this.data.setOptions(e)}catch(t){$YB.error(t)}},$YB.plugins.Generic.prototype.getOptions=function(){try{return this.data}catch(e){$YB.error(e)}},$YB.services.ResourceParser=function(e){try{this.plugin=e,this.parseTimeout=null,this.realResource="",this.nodeHost=void 0,this.nodeType=void 0,this.cdnRequests={},this.cdns=$YB.services.ResourceParser.cdnsEnabled.slice()}catch(t){$YB.error(t)}},$YB.services.ResourceParser.prototype.init=function(){try{this.realResource&&this.clear(),this.plugin.comm.addPreloader("services.ResourceParser");var e=this;this.parseTimeout=setTimeout(function(){"services.ResourceParser"in e.plugin.comm.preloaders&&(e.realResource=e.plugin.videoApi.getResource(),e.plugin.comm.removePreloader("services.ResourceParser"),$YB.warn("ResourceParser has exceded the maximum execution time (3s) and will be aborted."))},3e3),this.realResource=this.plugin.videoApi.getResource(),this.plugin.data.parseHLS?this._parseRealResourceAsync(this.plugin.videoApi.getResource()):this._parseCDNAsync()}catch(t){$YB.error(t)}},$YB.services.ResourceParser.prototype.clear=function(){this.realResource="",this.nodeHost=void 0,this.nodeType=void 0,this.cdnRequests={},this.cdns=$YB.services.ResourceParser.cdnsEnabled.slice()},$YB.services.ResourceParser.prototype._parseRealResourceAsync=function(e,t){try{var i=/(\S*?(\.m3u8|\.m3u|\.ts|\.mp4)(\?\S*|\n|\r|$))/i.exec(e);if(null!==i){var r=i[1].trim();if(0!==r.indexOf("http")&&(r=t.slice(0,t.lastIndexOf("/"))+"/"+r),".m3u8"==i[2]||".m3u"==i[2]){var s=this;new $YB.comm.AjaxRequest(r).load(function(){s._parseRealResourceAsync(this.responseText,r)}).error(function(){s._parseCDNAsync()}).send()}else this.realResource=r,this._parseCDNAsync()}else this._parseCDNAsync()}catch(n){$YB.error(n),this._parseCDNAsync()}},$YB.services.ResourceParser.cdnsEnabled=["Level3","Akamai","Highwinds","Fastly"],$YB.services.ResourceParser.cdnsAvailable={Level3:{parsers:[{type:"host+type",name:"X-WR-DIAG",regex:/Host:(.+)\sType:(.+)/}],headers:{"X-WR-DIAG":"host"}},Akamai:{parsers:[{type:"host+type",name:"X-Cache",regex:/(.+)\sfrom\s.+\(.+\/(.+)\).+/}]},Highwinds:{parsers:[{type:"host+type",name:"X-HW",regex:/.+,[0-9]+\.(.+)\.(.+)/}]},Fastly:{parsers:[{type:"host",name:"X-Served-By",regex:/([^,\s]+)$/},{type:"type",name:"X-Cache",regex:/([^,\s]+)$/}]}},$YB.services.ResourceParser.prototype._parseCDNAsync=function(){try{if(this.plugin.data.parseCDNNodeHost)if(this.cdns.length>0&&!this.nodeHost){var e=this.cdns.shift();if("undefined"!=typeof $YB.services.ResourceParser.cdnsAvailable[e]){var t=$YB.services.ResourceParser.cdnsAvailable[e],i=JSON.stringify(t.headers);if(this.cdnRequests.hasOwnProperty(i))this._parseNode(t.parsers,this.cdnRequests[i]);else{var r=this,s=new $YB.comm.AjaxRequest(this.realResource,"","",{method:"HEAD",maxRetries:0,requestHeaders:t.headers});s.load(function(){r.cdnRequests[i]=s.getXHR(),r._parseNode(t.parsers,s.getXHR())}),s.error(function(){r._parseCDNAsync()}),s.send()}}else this._parseCDNAsync()}else this.plugin.comm.removePreloader("services.ResourceParser");else this.plugin.comm.removePreloader("services.ResourceParser")}catch(n){$YB.error(n)}},$YB.services.ResourceParser.prototype._parseNode=function(e,t){try{for(var i in e){var r=t.getResponseHeader(e[i].name);if(null===r)return void this._parseCDNAsync();var s=e[i].regex.exec(r);if(null===s)return void this._parseCDNAsync();switch(e[i].type){case"host":this.nodeHost=s[1];break;case"type":this.nodeType=this._parseNodeType(s[1]);break;case"host+type":this.nodeHost=s[1],this.nodeType=this._parseNodeType(s[2]);break;case"type+host":this.nodeType=this._parseNodeType(s[1]),this.nodeHost=s[2]}}this._parseCDNAsync()}catch(n){$YB.error(n),this._parseCDNAsync()}},$YB.services.ResourceParser.prototype._parseNodeType=function(e){try{switch(e){case"TCP_HIT":case"HIT":case"c":return 1;case"TCP_MISS":case"MISS":case"p":return 2;case"TCP_MEM_HIT":return 3;case"TCP_IMS_HIT":return 4;default:return 0}}catch(t){return $YB.error(t),0}},$YB.utils.Buffer=function(e,t){try{this.api=e,this.chrono=new $YB.utils.Chrono,this.options=t||{},this.options.interval=this.options.interval||800,this.options.threshold=this.options.threshold||400,this.options.skipMiniBuffer=this.options.skipMiniBuffer||!0,this.timer=null,this.lastPlayhead=0,this.autostart=!1}catch(i){$YB.error(i)}},$YB.utils.Buffer.prototype.start=function(){try{if(null===this.timer)if("function"==typeof this.api.getPlayhead||"function"==typeof this.api.getAdPlayhead){var e=this;this.lastPlayhead=0,this.chrono.start(),this.timer=setInterval(function(){try{e.api.getPlayhead?e._checkBuffer():e.api.getAdPlayhead&&e._checkAdBuffer()}catch(t){$YB.error(t)}},this.options.interval)}else $YB.warn("Warning: Can't start autobuffer because parent api does not implement getPlayhead() or getAdPlayhead().")}catch(t){$YB.error(t)}},$YB.utils.Buffer.prototype._checkBuffer=function(){try{if(this.api.plugin.isJoinSent&&!this.api.plugin.isPaused&&!this.api.plugin.isSeeking&&!this.api.plugin.isShowingAds){var e=this.api.getPlayhead();Math.abs(1e3*this.lastPlayhead-1e3*e)>this.options.threshold?(this.lastPlayhead=e,(!this.options.skipMiniBuffer||this.chrono.stop()>1.1*this.options.interval)&&this.api.sendBufferEnd()):this.lastPlayhead&&!this.api.plugin.isBuffering&&Math.abs(1e3*this.lastPlayhead-1e3*e)<this.options.threshold&&this.api.sendBufferStart()}}catch(t){$YB.error(t)}},$YB.utils.Buffer.prototype._checkAdBuffer=function(){try{if(this.api.adnalyzer.isAdJoinSent&&!this.api.adnalyzer.isAdPaused){var e=this.api.getAdPlayhead();Math.abs(1e3*this.lastPlayhead-1e3*e)>this.options.threshold?(this.lastPlayhead=e,(!this.options.skipMiniBuffer||this.chrono.stop()>1.1*this.options.interval)&&this.api.sendAdBufferEnd()):this.lastPlayhead&&Math.abs(1e3*this.lastPlayhead-1e3*e)<this.options.threshold&&this.api.sendAdBufferStart()}}catch(t){$YB.error(t)}},$YB.utils.Buffer.prototype.stop=function(){try{return clearInterval(this.timer),this.timer=null,this.chrono.stop()}catch(e){$YB.error(e)}},$YB.utils.Chrono=function(){try{this.startTime=0,this.lastTime=0}catch(e){$YB.error(e)}},$YB.utils.Chrono.prototype.getDeltaTime=function(e){try{return this.startTime?0===this.lastTime?e!==!1?this.stop():(new Date).getTime()-this.startTime:this.lastTime-this.startTime:-1}catch(t){$YB.error(t)}},$YB.utils.Chrono.prototype.start=function(){try{this.startTime=(new Date).getTime(),this.lastTime=0}catch(e){$YB.error(e)}},$YB.utils.Chrono.prototype.stop=function(){try{return this.lastTime=(new Date).getTime(),this.getDeltaTime()}catch(e){$YB.error(e)}},$YB.utils.getFirstDefined=function(e){if(arguments.length>1)return $YB.utils.getFirstDefined(arguments);if("undefined"==typeof e||"[object Array]"!==Object.prototype.toString.call(e)&&"[object Arguments]"!==Object.prototype.toString.call(e))return e;for(var t=0;t<e.length;t++){if("function"==typeof e[t]&&"undefined"!=typeof e[t]()&&null!==e[t]())return $YB.utils.getFirstDefined(e[t]());if("undefined"!=typeof e[t]&&null!==e[t])return $YB.utils.getFirstDefined(e[t])}return null},$YB.utils.parseNumber=function(e,t){return!isNaN(e)&&e>=0&&e!=1/0&&null!==e&&"undefined"!=typeof e?e:t},$YB.utils.listenAllEvents=function(e,t,i){try{if($YB.debugLevel>=4){i=i||function(e){var t="";"undefined"!=typeof e.target&&"undefined"!=typeof e.target.id&&(t=e.target.id),$YB.debug("Event: "+t+" > "+e.type)};var r=["canplay","buffering","waiting","ended","play","playing","pause","resume","error","abort","seek","seeking","seeked","stalled","dispose","loadeddata","loadstart"];t&&(null===t[0]?(t.shift(),r=t):r=r.concat(t));for(var s=0;s<r.length;s++)"function"==typeof e?e.call(window,r[s],i):e.on?e.on(r[s],i):e.addEventListener&&e.addEventListener(r[s],i)}}catch(n){$YB.error(n)}},$YB.utils.serialize=$YB.utils.listenAllEvents||function(){},$YB.debugLevel=1,$YB.plainConsole=!1,$YB.report=function(e,t,i){if(console&&console.log&&(t=t||4,i=i||"darkcyan",$YB.debugLevel>=t)){if($YB.plainConsole||document.documentMode)console.log("[Youbora:"+t+"] "+e),console.log(e);else{var r=console.log;1==t&&console.error?r=console.error:2==t&&console.warn?r=console.warn:t>=4&&console.debug&&(r=console.debug),null!==e&&"object"==typeof e?r.call(console,"%c[Youbora] %o","color: "+i,e):r.call(console,"%c[Youbora] %c%s","color: "+i,"color: black",e)}"undefined"!=typeof $YB.remoteLog&&$YB.remoteLog.forced===!0&&$YB.remoteLog("[Youbora:"+t+"] "+e)}},$YB.error=function(e,t){$YB.report(e,1,t||"darkred")},$YB.warn=function(e,t){$YB.report(e,2,t||"darkorange")},$YB.notice=function(e,t){$YB.report(e,3,t||"darkcyan")},$YB.debug=function(e,t){$YB.report(e,4,t||"indigo")},function(){function e(e){switch(e){case"plain":$YB.plainConsole=!0;break;case"remote":$YB.remoteLog.forced=!0;break;case"plain+remote":case"remote+plain":$YB.remoteLog.forced=!0,$YB.plainConsole=!0}}try{if("undefined"!=typeof window){var t=document.getElementsByTagName("script");for(var i in t)if(t[i].getAttribute){var r=t[i].getAttribute("youbora-debug");r&&($YB.debugLevel=r),r=t[i].getAttribute("youbora-console"),r&&e(r)}var s=/\?.*\&*youbora-debug=(.+)/i.exec(window.location.search);null!==s&&($YB.debugLevel=s[1]),s=/\?.*\&*youbora-console=(.+)/i.exec(window.location.search),null!==s&&e(s[1])}}catch(n){$YB.error(n)}}();