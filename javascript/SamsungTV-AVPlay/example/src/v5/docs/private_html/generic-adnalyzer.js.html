
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: generic-adnalyzer.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles.css">
</head>

<body>

    <div id="main">

        <h1 class="page-title">Source: generic-adnalyzer.js</h1>

        



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @license
 * Youbora API
 * Copyright NicePopleAtWork &lt;http://nicepeopleatwork.com/>
 */

/**
 * This class is the generic adnalyzers from which specifics adnalyzers will extend.
 * Internally, it coordinates AdsApi and its flags.
 *
 * @class Generic
 * @since  5.1.02
 * @memberof $YB.adnalyzers
 */
$YB.adnalyzers.Generic = function() {};

$YB.adnalyzers.Generic.prototype = {
    /** Version of the plugin. ie: 1.0.0-name */
    adnalyzerVersion: '1.0.0-GENERIC',

    /** Reference to the ads player. */
    ads: undefined,
    /** Reference to the main plugin */
    plugin: undefined,

    /** An instance of {@link $YB.api.Ads}. */
    adsApi: undefined,


    /** Flag when Ads Start has been sent */
    isAdStartSent: false,
    /** Flag when Join has been sent */
    isAdJoinSent: false,
    /** Flag when Ad is paused. */
    isAdPaused: false,
    /** Flag when Ad is buffering */
    isAdBuffering: false,
};

/**
 * Instantiates the adnalyzer libraries.
 *
 * @param {(object)} plugin The main youbora plugin from where it is instantiated.
 * @param {(object)} [ads] The object sending ads. ie: this.plugin.player.ima.
 * @return {Object} Returns the ads player object.
 */
$YB.adnalyzers.Generic.prototype.init = function(plugin, ads) {
    try {
        $YB.notice("Adnalyzer " + this.adnalyzerVersion + " is ready.");

        // Save the main plugin.
        this.plugin = plugin;

        // Save the ads plugin
        this.ads = ads;

        // Instantiate Objects
        this.adsApi = new $YB.api.Ads(this);

        return this.ads;
    } catch (err) {
        $YB.error(err);
        return null;
    }
}


/**
 * Starts Nicebuffer in ads API.
 */
$YB.adnalyzers.Generic.prototype.startAutobuffer = function() {
    if (this.plugin.data.enableNiceBuffer) {
        this.adsApi.buffer.autostart = true;
    }
};

/**
 * This function must be called when a new ad starts loading.
 * @see $YB.api.Ads#sendAdStart
 */
$YB.adnalyzers.Generic.prototype.playAdHandler = function(options) {
    try {
        if (!this.isAdStartSent) {
            this.plugin.setOptions(options);
            this.adsApi.sendAdStart();
        }
    } catch (err) {
        $YB.error(err);
    }
};


/**
 * This function must be called when a new ad starts. It will /adStart + /adJoinTime. If there was a bufferUnderrun running before this call, its time will be used as joinTime.
 * @see $YB.api.Ads#sendAdStart
 * @see $YB.api.Ads#sendAdJoin
 */
$YB.adnalyzers.Generic.prototype.startJoinAdHandler = function(options) {
    try {
        if (!this.isAdStartSent) {
            this.plugin.setOptions(options);
            this.adsApi.sendAdStart();

            // Use buffer clock to calculate joinTime in midrolls
            if (this.plugin.isBuffering) {
                this.adsApi.chrono.joinTime.startTime = this.plugin.videoApi.chrono.buffer.startTime;
                this.plugin.isBuffering = false;
            }

            this.adsApi.sendAdJoin();
        }
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video starts playing for the first time. If playingAdHandler is used, this function is not needed.
 * @see $YB.adsApi#sendAdJoin
 */
$YB.adnalyzers.Generic.prototype.joinAdHandler = function() {
    try {
        this.adsApi.sendAdJoin();
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video is paused.
 * @see $YB.api.Ads#sendAdPause
 */
$YB.adnalyzers.Generic.prototype.pauseAdHandler = function() {
    try {
        this.adsApi.sendAdPause();
    } catch (err) {
        $YB.error(err);
    }
};


/**
 * This function must be called when a button of pause/resume is pressed.
 * @see $YB.api.Ads#sendAdPause
 * @see $YB.api.Ads#sendAdResume
 */
$YB.adnalyzers.Generic.prototype.pauseToggleAdHandler = function() {
    try {
        if (this.isAdPaused) {
            this.adsApi.sendAdResume();
        } else {
            this.adsApi.sendAdPause();
        }
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video is resumed from a pause. If playingAdHandler is used, this function is not needed.
 * @see $YB.api.Ads#sendAdResume
 */
$YB.adnalyzers.Generic.prototype.resumeAdHandler = function() {
    try {
        this.adsApi.sendAdResume();
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video has ended.
 * @see $YB.adsApi#sendAdStop
 */
$YB.adnalyzers.Generic.prototype.endedAdHandler = function() {
    try {
        this.adsApi.sendAdStop();
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video has been stoped.
 * @see $YB.adsApi#sendAdStop
 */
$YB.adnalyzers.Generic.prototype.skipAdHandler = function() {
    try {
        this.adsApi.sendAdStop({ skipped: true });
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video starts a buffer underrun.
 * @see $YB.adsApi#sendAdBufferStart
 */
$YB.adnalyzers.Generic.prototype.bufferingAdHandler = function() {
    try {
        this.adsApi.sendAdBufferStart();
    } catch (err) {
        $YB.error(err);
    }
};

/**
 * This function must be called when the video ends buffering. If playingAdHandler is used, this function is not needed.
 * @see $YB.adsApi#sendAdBufferEnd
 */
$YB.adnalyzers.Generic.prototype.bufferedAdHandler = function() {
    try {
        if (this.isAdStartSent) {
            if (!this.isAdJoinSent) {
                this.adsApi.sendAdJoin();
            } else if (this.isAdBuffering) {
                this.adsApi.sendAdBufferEnd();
            }
        }
    } catch (err) {
        $YB.error(err);
    }
};



/**
 * Override this function to return ad resource.
 * @return {string} ""
 */
$YB.adnalyzers.Generic.prototype.getAdResource = function() {
    return "unknown";
};


/**
 * Override this function to return ad playhead of the media. If null is returned, this class will be ignored.
 * @return {number} null
 */
$YB.adnalyzers.Generic.prototype.getMediaPlayhead = function() {
    return null;
};

/**
 * Override this function to return ad playhead.
 * @return {number} 0
 */
$YB.adnalyzers.Generic.prototype.getAdPlayhead = function() {
    return 0;
};


/**
 * Override this function to return ad position pre/mid/post/unknown.
 * @return {string} "unknown"
 */
$YB.adnalyzers.Generic.prototype.getAdPosition = function() {
    return 'unknown';
};

/**
 * Override this function to return ad title.
 * @return {string} ""
 */
$YB.adnalyzers.Generic.prototype.getAdTitle = function() {
    return null;
};

/**
 * Override this function to return ad duration.
 * @return {number} ""
 */
$YB.adnalyzers.Generic.prototype.getAdDuration = function() {
    return 0;
};

/**
 * Override this function to return ad bitrate.
 * @return {number} -1
 */
$YB.adnalyzers.Generic.prototype.getAdBitrate = function() {
    return -1;
};

/**
 * Override this function to return ad player version.
 * @return {string} ""
 */
$YB.adnalyzers.Generic.prototype.getAdPlayerVersion = function() {
    return null;
};
</code></pre>
        </article>
    </section>




    </div>

    <nav>
        <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="$YB.adnalyzers.Generic.html">$YB.adnalyzers.Generic</a></li><li><a href="$YB.api.Ads.html">$YB.api.Ads</a></li><li><a href="$YB.api.Info.html">$YB.api.Info</a></li><li><a href="$YB.api.Ping.html">$YB.api.Ping</a></li><li><a href="$YB.api.Video.html">$YB.api.Video</a></li><li><a href="$YB.comm.AjaxRequest.html">$YB.comm.AjaxRequest</a></li><li><a href="$YB.comm.Communication.html">$YB.comm.Communication</a></li><li><a href="$YB.data.Options.html">$YB.data.Options</a></li><li><a href="$YB.plugins.Generic.html">$YB.plugins.Generic</a></li><li><a href="$YB.services.ResourceParser.html">$YB.services.ResourceParser</a></li><li><a href="$YB.utils.Buffer.html">$YB.utils.Buffer</a></li><li><a href="$YB.utils.Chrono.html">$YB.utils.Chrono</a></li></ul><h3>Namespaces</h3><ul><li><a href="$YB.html">$YB</a></li><li><a href="$YB.adnalyzers.html">$YB.adnalyzers</a></li><li><a href="$YB.api.html">$YB.api</a></li><li><a href="$YB.comm.html">$YB.comm</a></li><li><a href="$YB.data.html">$YB.data</a></li><li><a href="$YB.plugins.html">$YB.plugins</a></li><li><a href="$YB.services.html">$YB.services</a></li><li><a href="$YB.utils.html">$YB.utils</a></li></ul>
    </nav>

    <div class="clear"></div>
    <footer>
        Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Apr 22 2016 09:34:52 GMT+0200 (CEST)
    </footer>

    <script> prettyPrint(); </script>
    <script src="scripts/linenumber.js"> </script>
</body>
</html>