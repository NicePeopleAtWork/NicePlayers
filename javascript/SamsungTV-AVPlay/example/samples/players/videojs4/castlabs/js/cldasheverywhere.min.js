/*! cldasheverywhere 3.3.1, 22-01-2016 */
function X2JS(a){"use strict";function b(){void 0===a.escapeMode&&(a.escapeMode=!0),a.attributePrefix=a.attributePrefix||"_",a.arrayAccessForm=a.arrayAccessForm||"none",a.emptyNodeForm=a.emptyNodeForm||"text",void 0===a.enableToStringFunc&&(a.enableToStringFunc=!0),a.arrayAccessFormPaths=a.arrayAccessFormPaths||[],void 0===a.skipEmptyTextNodesForObj&&(a.skipEmptyTextNodesForObj=!0),void 0===a.stripWhitespaces&&(a.stripWhitespaces=!0),a.datetimeAccessFormPaths=a.datetimeAccessFormPaths||[]}function c(){function a(a){var b=String(a);return 1===b.length&&(b="0"+b),b}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}function d(a){var b=a.localName;return null==b&&(b=a.baseName),(null==b||""==b)&&(b=a.nodeName),b}function e(a){return a.prefix}function f(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):a}function g(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function h(b,c,d){switch(a.arrayAccessForm){case"property":b[c+"_asArray"]=b[c]instanceof Array?b[c]:[b[c]]}if(!(b[c]instanceof Array)&&a.arrayAccessFormPaths.length>0){for(var e=0;e<a.arrayAccessFormPaths.length;e++){var f=a.arrayAccessFormPaths[e];if("string"==typeof f){if(f==d)break}else if(f instanceof RegExp){if(f.test(d))break}else if("function"==typeof f&&f(b,c,d))break}e!=a.arrayAccessFormPaths.length&&(b[c]=[b[c]])}}function i(a){var b=a.split(/[-T:+Z]/g),c=new Date(b[0],b[1]-1,b[2]),d=b[5].split(".");if(c.setHours(b[3],b[4],d[0]),d.length>1&&c.setMilliseconds(d[1]),b[6]&&b[7]){var e=60*b[6]+Number(b[7]),f=/\d\d-\d\d:\d\d$/.test(a)?"-":"+";e=0+("-"==f?-1*e:e),c.setMinutes(c.getMinutes()-e-c.getTimezoneOffset())}else-1!==a.indexOf("Z",a.length-1)&&(c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())));return c}function j(b,c,d){if(a.datetimeAccessFormPaths.length>0){for(var e=d.split(".#")[0],f=0;f<a.datetimeAccessFormPaths.length;f++){var g=a.datetimeAccessFormPaths[f];if("string"==typeof g){if(g==e)break}else if(g instanceof RegExp){if(g.test(e))break}else if("function"==typeof g&&g(obj,c,e))break}return f!=a.datetimeAccessFormPaths.length?i(b):b}return b}function k(b,c){if(b.nodeType==w.DOCUMENT_NODE){for(var f=new Object,i=b.childNodes,l=0;l<i.length;l++){var m=i.item(l);if(m.nodeType==w.ELEMENT_NODE){var n=d(m);f[n]=k(m,n)}}return f}if(b.nodeType==w.ELEMENT_NODE){var f=new Object;f.__cnt=0;for(var i=b.childNodes,l=0;l<i.length;l++){var m=i.item(l),n=d(m);m.nodeType!=w.COMMENT_NODE&&(f.__cnt++,null==f[n]?(f[n]=k(m,c+"."+n),h(f,n,c+"."+n)):(null!=f[n]&&(f[n]instanceof Array||(f[n]=[f[n]],h(f,n,c+"."+n))),f[n][f[n].length]=k(m,c+"."+n)))}for(var o=31536e3,p=2592e3,q=86400,r=3600,s=60,t=60,u=1e3,v=/^([\-\+])?P(?:([0-9]+)Y)?(?:([0-9]+)M)?(?:([0-9]+)D)?(?:T(?:([0-9]+)H)?(?:([0-9]+)M)?(?:([0-9]+(?:\.[0-9]+)?)?S)?)$/,x=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,y=/^[-+]?[0-9]+[.]?[0-9]*$/,z=[{type:"duration",test:function(a){return v.test(a)},converter:function(a){var b=v.exec(a);return parseFloat(b[2]||0)*o+parseFloat(b[3]||0)*p+parseFloat(b[4]||0)*q+parseFloat(b[5]||0)*r+parseFloat(b[6]||0)*s+parseFloat(b[7]||0)}},{type:"datetime",test:function(a){return x.test(a)},converter:function(a){var b,c=x.exec(a);if(b=Date.UTC(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),c[6]&&parseInt(c[6],10)||0,c[7]&&parseFloat(c[7])*u||0),c[9]&&c[10]){var d=parseInt(c[9],10)*t+parseInt(c[10],10);b+=("+"===c[8]?-1:1)*d*s*u}return new Date(b)}},{type:"numeric",test:function(a){return y.test(a)},converter:function(a){var b=parseFloat(a);return b>=9007199254740992&&(CL.configs.useBigInt=!0,0===CL.configs.bigIntOffset&&(CL.configs.bigIntOffset=bigInt(a)),b=bigInt(a).minus(CL.configs.bigIntOffset).valueOf()),b}}],A=0;A<b.attributes.length;A++){var B=b.attributes.item(A);f.__cnt++,B.formattedValue=B.value;for(var C=0;C<z.length;C++)z[C].test(B.value)&&(B.formattedValue=z[C].converter(B.value));f[a.attributePrefix+B.name]=B.formattedValue}var D=e(b);return null!=D&&""!=D&&(f.__cnt++,f.__prefix=D),null!=f["#text"]&&(f.__text=f["#text"],f.__text instanceof Array&&(f.__text=f.__text.join("\n")),a.escapeMode&&(f.__text=g(f.__text)),a.stripWhitespaces&&(f.__text=f.__text.trim()),delete f["#text"],"property"==a.arrayAccessForm&&delete f["#text_asArray"],f.__text=j(f.__text,n,c+"."+n)),null!=f["#cdata-section"]&&(f.__cdata=f["#cdata-section"],delete f["#cdata-section"],"property"==a.arrayAccessForm&&delete f["#cdata-section_asArray"]),1==f.__cnt&&null!=f.__text?f=f.__text:0==f.__cnt&&"text"==a.emptyNodeForm?f="":f.__cnt>1&&null!=f.__text&&a.skipEmptyTextNodesForObj&&(a.stripWhitespaces&&""==f.__text||""==f.__text.trim())&&delete f.__text,delete f.__cnt,!a.enableToStringFunc||null==f.__text&&null==f.__cdata||(f.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),f}return b.nodeType==w.TEXT_NODE||b.nodeType==w.CDATA_SECTION_NODE?b.nodeValue:void 0}function l(b,c,d,e){var g="<"+(null!=b&&null!=b.__prefix?b.__prefix+":":"")+c;if(null!=d)for(var h=0;h<d.length;h++){var i=d[h],j=b[i];a.escapeMode&&(j=f(j)),g+=" "+i.substr(a.attributePrefix.length)+"='"+j+"'"}return g+=e?"/>":">"}function m(a,b){return"</"+(null!=a.__prefix?a.__prefix+":":"")+b+">"}function n(a,b){return-1!==a.indexOf(b,a.length-b.length)}function o(b,c){return"property"==a.arrayAccessForm&&n(c.toString(),"_asArray")||0==c.toString().indexOf(a.attributePrefix)||0==c.toString().indexOf("__")||b[c]instanceof Function?!0:!1}function p(a){var b=0;if(a instanceof Object)for(var c in a)o(a,c)||b++;return b}function q(b){var c=[];if(b instanceof Object)for(var d in b)-1==d.toString().indexOf("__")&&0==d.toString().indexOf(a.attributePrefix)&&c.push(d);return c}function r(b){var c="";return null!=b.__cdata&&(c+="<![CDATA["+b.__cdata+"]]>"),null!=b.__text&&(c+=a.escapeMode?f(b.__text):b.__text),c}function s(b){var c="";return b instanceof Object?c+=r(b):null!=b&&(c+=a.escapeMode?f(b):b),c}function t(a,b,c){var d="";if(0==a.length)d+=l(a,b,c,!0);else for(var e=0;e<a.length;e++)d+=l(a[e],b,q(a[e]),!1),d+=u(a[e]),d+=m(a[e],b);return d}function u(a){var b="",c=p(a);if(c>0)for(var d in a)if(!o(a,d)){var e=a[d],f=q(e);if(null==e||void 0==e)b+=l(e,d,f,!0);else if(e instanceof Object)if(e instanceof Array)b+=t(e,d,f);else if(e instanceof Date)b+=l(e,d,f,!1),b+=e.toISOString(),b+=m(e,d);else{var g=p(e);g>0||null!=e.__text||null!=e.__cdata?(b+=l(e,d,f,!1),b+=u(e),b+=m(e,d)):b+=l(e,d,f,!0)}else b+=l(e,d,f,!1),b+=s(e),b+=m(e,d)}return b+=s(a)}var v="1.1.5";a=a||{},b(),c();var w={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(a){var b=window.ActiveXObject||"ActiveXObject"in window||CL.configs.isIE11===!0;if(void 0===a)return null;var c;if(window.DOMParser){var d=new window.DOMParser,e=null;if(!b)try{e=d.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(f){e=null}try{c=d.parseFromString(a,"text/xml"),null!=e&&c.getElementsByTagNameNS(e,"parsererror").length>0&&(c=null)}catch(f){c=null}}else 0==a.indexOf("<?")&&(a=a.substr(a.indexOf("?>")+2)),c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a);return c},this.asArray=function(a){return a instanceof Array?a:[a]},this.toXmlDateTime=function(a){return a instanceof Date?a.toISOString():"number"==typeof a?new Date(a).toISOString():null},this.asDateTime=function(a){return"string"==typeof a?i(a):a},this.xml2json=function(a){return k(a)},this.xml_str2json=function(a){var b=this.parseXmlString(a);return null!=b?this.xml2json(b):null},this.json2xml_str=function(a){return u(a)},this.json2xml=function(a){var b=this.json2xml_str(a);return this.parseXmlString(b)},this.getVersion=function(){return v}}function ObjectIron(a){var b;for(b=[],i=0,len=a.length;len>i;i+=1)b.push(a[i].isRoot?"root":a[i].name);var c=function(a,b){var c;if(null!==a&&null!==b)for(c in a)a.hasOwnProperty(c)&&(b.hasOwnProperty(c)||(b[c]=a[c]))},d=function(a,b,d){var e,f,g,h,i;if(null!==a&&0!==a.length)for(e=0,f=a.length;f>e;e+=1)g=a[e],b.hasOwnProperty(g.name)&&(d.hasOwnProperty(g.name)?g.merge&&(h=b[g.name],i=d[g.name],"object"==typeof h&&"object"==typeof i?c(h,i):d[g.name]=null!=g.mergeFunction?g.mergeFunction(h,i):h+i):d[g.name]=b[g.name])},e=function(a,b){var c,f,g,h,i,j,k,l=a;if(null!==l.children&&0!==l.children.length)for(c=0,f=l.children.length;f>c;c+=1)if(j=l.children[c],b.hasOwnProperty(j.name))if(j.isArray)for(i=b[j.name+"_asArray"],g=0,h=i.length;h>g;g+=1)k=i[g],d(l.properties,b,k),e(j,k);else k=b[j.name],d(l.properties,b,k),e(j,k)},f=function(c){var d,g,h,i,j,k,l;if(null===c)return c;if("object"!=typeof c)return c;for(d=0,g=b.length;g>d;d+=1)"root"===b[d]&&(j=a[d],k=c,e(j,k));for(i in c)if(c.hasOwnProperty(i)){if(h=b.indexOf(i),-1!==h)if(j=a[h],j.isArray)for(l=c[i+"_asArray"],d=0,g=l.length;g>d;d+=1)k=l[d],e(j,k);else k=c[i],e(j,k);f(c[i])}return c};return{run:f}}function intTobitArray(a,b){for(var c=[],d=0;b>d;d++)c.push((a&Math.pow(2,d))>0);return c}if(function(a){var b,c=0,d=a.MediaSource||a.WebKitMediaSource||{},e=a.URL||{},f=/video\/flv(;\s*codecs=["']vp6,aac["'])?$/,g="blob:vjs-media-source/";b=function(){},b.prototype.init=function(){this.listeners=[]},b.prototype.addEventListener=function(a,b){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].unshift(b)},b.prototype.removeEventListener=function(a,b){for(var c=this.listeners[a],d=c.length;d--;)if(c[d]===b)return c.splice(d,1)},b.prototype.trigger=function(a){for(var b=this.listeners[a.type]||[],c=b.length;c--;)b[c](a)},videojs.MediaSource=function(){var a=this;videojs.MediaSource.prototype.init.call(this),this.sourceBuffers=[],this.readyState="closed",this.listeners={sourceopen:[function(b){a.swfObj=document.getElementById(b.swfId),a.readyState="open",a.swfObj&&a.swfObj.vjs_load()}],webkitsourceopen:[function(){a.trigger({type:"sourceopen"})}]}},videojs.MediaSource.prototype=new b,videojs.MediaSource.BYTES_PER_SECOND_GOAL=4194304,videojs.MediaSource.TICKS_PER_SECOND=60,videojs.MediaSource.prototype.addSourceBuffer=function(a){var b;if(f.test(a))b=new videojs.SourceBuffer(this);else{if(!this.nativeSource)throw new Error("NotSupportedError (Video.js)");b=this.nativeSource.addSourceBuffer.apply(this.nativeSource,arguments)}return this.sourceBuffers.push(b),b},videojs.MediaSource.prototype.endOfStream=function(){this.readyState="ended"},videojs.mediaSources={},videojs.MediaSource.open=function(a,b){var c=videojs.mediaSources[a];if(!c)throw new Error("Media Source not found (Video.js)");c.trigger({type:"sourceopen",swfId:b})},videojs.SourceBuffer=function(b){var c=this,d=[],e=0,f=function(b){a.setTimeout(b,Math.ceil(1e3/videojs.MediaSource.TICKS_PER_SECOND))},g=function(){var b,h,i,j,k,l="";if(d.length){for(k=document.hidden?videojs.MediaSource.BYTES_PER_SECOND_GOAL:Math.ceil(videojs.MediaSource.BYTES_PER_SECOND_GOAL/videojs.MediaSource.TICKS_PER_SECOND),j=new Uint8Array(Math.min(k,e)),h=j.byteLength;h;)b=d[0].subarray(0,h),j.set(b,j.byteLength-h),b.byteLength<d[0].byteLength?d[0]=d[0].subarray(h):d.shift(),h-=b.byteLength;for(e-=j.byteLength,h=0,i=j.byteLength;i>h;h++)l+=String.fromCharCode(j[h]);b64str=a.btoa(l),c.source.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+b64str+"</string></arguments></invoke>"),0!==e?f(g):"ended"===c.source.readyState&&c.source.swfObj.vjs_endOfStream()}};videojs.SourceBuffer.prototype.init.call(this),this.source=b,this.appendBuffer=function(a){0===d.length&&f(g),this.source.readyState="open",this.trigger({type:"update"}),d.push(a),e+=a.byteLength},this.abort=function(){d=[],e=0,this.source.swfObj.vjs_abort()}},videojs.SourceBuffer.prototype=new b,videojs.URL={createObjectURL:function(a){var b=g+c;return c++,videojs.mediaSources[b]=a,b}},videojs.plugin("mediaSource",function(){var a=this;a.on("loadstart",function(){var b,c=a.currentSrc(),f=function(a){b.trigger(a)};"Html5"===a.techName&&0===c.indexOf(g)&&(b=videojs.mediaSources[c],b.nativeUrl||(b.nativeSource=new d,b.nativeSource.addEventListener("sourceopen",f,!1),b.nativeSource.addEventListener("webkitsourceopen",f,!1),b.nativeUrl=e.createObjectURL(b.nativeSource)),a.src(b.nativeUrl))})})}(this),function(a,b,c,d){"use strict";var e,f,g,h=1.1,i=500;f=function(a){return a.retries&&a.retries>=2},b.Hls=b.Flash.extend({init:function(a,c,d){var e=c.source,f=a.options();a.hls=this,delete c.source,c.swf=f.flash.swf,b.Flash.call(this,a,c,d),c.source=e,this.bytesReceived=0,this.currentTime=b.Hls.prototype.currentTime,this.setCurrentTime=b.Hls.prototype.setCurrentTime,this.segmentBuffer_=[],this.startCheckingBuffer_(),b.Hls.prototype.src.call(this,c.source&&c.source.src)}}),b.options.techOrder.unshift("hls"),b.Hls.GOAL_BUFFER_LENGTH=30,b.Hls.prototype.src=function(c){var f,g,h,i=this,j=this.player(),k=j.options().hls||{};c&&(this.src_&&this.resetSrc_(),this.src_=c,f=new b.MediaSource,h={src:b.URL.createObjectURL(f),type:"video/flv"},this.mediaSource=f,this.segmentBuffer_=[],this.segmentParser_=new b.Hls.SegmentParser,function(){var c,d=i.segmentParser_.metadataStream;i.player().addTextTrack&&d.on("data",function(e){var f,g,h,j;if(!c)for(c=i.player().addTextTrack("metadata","Timed Metadata"),c.inBandMetadataTrackDispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16).toUpperCase(),f=0;f<d.descriptor.length;f++)j=("00"+d.descriptor[f].toString(16).toUpperCase()).slice(-2),c.inBandMetadataTrackDispatchType+=j;for(f=0;f<e.frames.length;f++)g=e.frames[f],h=e.pts/1e3,c.addCue(new a.VTTCue(h,h,g.value||g.url))})}(),this.mediaSource.addEventListener("sourceopen",b.bind(this,this.handleSourceOpen)),this.playlists&&this.playlists.dispose(),this.mediaIndex=0,this.playlists=new b.Hls.PlaylistLoader(this.src_,k.withCredentials),this.playlists.on("loadedmetadata",b.bind(this,function(){var a,c,e,f,h,i,k,l;k=function(){this.fillBuffer(),j.trigger("loadedmetadata")},g=this.playlists.media(),this.bandwidth===d&&this.setBandwidth({bandwidth:5*this.playlists.bandwidth}),1/0===this.duration()&&0===this.mediaIndex&&(this.mediaIndex=b.Hls.getMediaIndexForLive_(g)),a=this.selectPlaylist(),e=g.attributes&&g.attributes.BANDWIDTH||0,f=a.attributes&&a.attributes.BANDWIDTH||0,h=g.segments&&g.segments[this.mediaIndex].duration||g.targetDuration,i=h*f/this.bandwidth,i||(i=1/0),l=10,f>e&&l>=i?(this.playlists.media(a),c=b.bind(this,function(){k.call(this),this.playlists.off("loadedplaylist",c)}),this.playlists.on("loadedplaylist",c)):k.call(this)})),this.playlists.on("error",b.bind(this,function(){j.error(this.playlists.error)})),this.playlists.on("loadedplaylist",b.bind(this,function(){var a=this.playlists.media();a&&(this.updateDuration(this.playlists.media()),this.mediaIndex=b.Hls.translateMediaIndex(this.mediaIndex,g,a),g=a,this.fetchKeys_())})),this.playlists.on("mediachange",b.bind(this,function(){e&&this.cancelKeyXhr(),j.trigger("mediachange")})),this.player().ready(function(){i.el()&&i.el().vjs_src(h.src)}))},b.Hls.getMediaIndexForLive_=function(a){if(!a.segments)return 0;for(var b=a.segments.length,c=0,d=3*(a.targetDuration||10);d>c&&b>0;)c+=a.segments[b-1].duration,b--;return b},b.Hls.prototype.handleSourceOpen=function(){var a=this.player(),b=this.mediaSource.addSourceBuffer('video/flv; codecs="vp6,aac"');this.sourceBuffer=b,b.appendBuffer(this.segmentParser_.getFlvHeader()),a.options().autoplay&&a.play()},b.Hls.prototype.play=function(){return this.ended()&&(this.mediaIndex=0),1/0===this.duration()&&this.playlists.media()&&null!=this.playbackRate()&&(this.mediaIndex=b.Hls.getMediaIndexForLive_(this.playlists.media()),this.setCurrentTime(this.getCurrentTimeByMediaIndex_(this.playlists.media(),this.mediaIndex))),b.Flash.prototype.play.apply(this,arguments)},b.Hls.prototype.currentTime=function(){return this.lastSeekedTime_?this.lastSeekedTime_:this.el()&&this.el().vjs_getProperty?this.el().vjs_getProperty("currentTime"):0},b.Hls.prototype.setCurrentTime=function(a){return this.playlists&&this.playlists.media()?(this.lastSeekedTime_=a,this.mediaIndex=b.Hls.getMediaIndexByTime(this.playlists.media(),a),this.sourceBuffer.abort(),this.cancelSegmentXhr(),e&&(e.aborted=!0,this.cancelKeyXhr()),this.segmentBuffer_=[],void this.fillBuffer(1e3*a)):0},b.Hls.prototype.duration=function(){var a=this.playlists;return a?b.Hls.getPlaylistTotalDuration(a.media()):0},b.Hls.prototype.updateDuration=function(a){var c=this.player(),d=c.duration(),e=b.Hls.getPlaylistTotalDuration(a);d!==e&&c.trigger("durationchange")},b.Hls.prototype.resetSrc_=function(){if(this.cancelSegmentXhr(),this.cancelKeyXhr(),this.sourceBuffer&&this.sourceBuffer.abort(),this.mediaSource){var a,b,c,d,e=this.mediaSource.listeners;for(a in e){b=e[a];for(d in b)c=b[d],this.mediaSource.removeEventListener(a,c)}}},b.Hls.prototype.cancelKeyXhr=function(){e&&(e.onreadystatechange=null,e.abort(),e=null)},b.Hls.prototype.cancelSegmentXhr=function(){this.segmentXhr_&&(this.segmentXhr_.onreadystatechange=null,this.segmentXhr_.abort(),this.segmentXhr_=null)},b.Hls.prototype.dispose=function(){this.stopCheckingBuffer_(),this.playlists&&this.playlists.dispose(),this.resetSrc_(),b.Flash.prototype.dispose.call(this)},b.Hls.prototype.selectPlaylist=function(){var a,c,d,e,f,g,i=this.player(),j=this.playlists.master.playlists.slice(),k=[],l=j.length;for(j.sort(b.Hls.comparePlaylistBandwidth);l--;)c=j[l],c.attributes&&c.attributes.BANDWIDTH&&(a=c.attributes.BANDWIDTH*h,a<i.hls.bandwidth&&(k.push(c),e||(e=c)));for(l=k.length,k.sort(b.Hls.comparePlaylistResolution),c=null;l--;)if(d=c,c=k[l],c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&c.attributes.RESOLUTION.height){if(c.attributes.RESOLUTION.width===i.width()&&c.attributes.RESOLUTION.height===i.height()){f=null,g=c;break}if(c.attributes.RESOLUTION.width<i.width()&&c.attributes.RESOLUTION.height<i.height()){d&&d.attributes&&d.attributes.RESOLUTION&&d.attributes.RESOLUTION.width&&d.attributes.RESOLUTION.height&&(f=d),g=c;break}}return f||g||e||j[0]},b.Hls.prototype.checkBuffer_=function(){this.checkBufferTimeout_&&(a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null),this.fillBuffer(),this.drainBuffer(),this.checkBufferTimeout_=a.setTimeout(b.bind(this,this.checkBuffer_),i)},b.Hls.prototype.startCheckingBuffer_=function(){this.player().on("waiting",b.bind(this,this.drainBuffer)),this.checkBuffer_()},b.Hls.prototype.stopCheckingBuffer_=function(){a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null,this.player().off("waiting",this.drainBuffer)},b.Hls.prototype.fillBuffer=function(a){var c,d,e=this.player(),f=e.buffered(),g=0;e.currentSrc()&&this.playlists&&(this.segmentXhr_||"HAVE_NOTHING"!==this.playlists.state&&this.playlists.media()&&this.playlists.media().segments&&(c=this.playlists.media().segments[this.mediaIndex],c&&(f&&(g=e.buffered().end(0)-e.currentTime()),"number"!=typeof a&&g>=b.Hls.GOAL_BUFFER_LENGTH||(d=this.playlistUriToUrl(c.uri),this.loadSegment(d,a)))))},b.Hls.prototype.playlistUriToUrl=function(a){var b;return b=this.playlists.media().uri===this.src_?g(this.src_,a):g(g(this.src_,this.playlists.media().uri||""),a)},b.Hls.prototype.setBandwidth=function(a){var b=this;b.segmentXhrTime=a.roundTripTime,b.bandwidth=a.bandwidth,b.bytesReceived+=a.bytesReceived||0,b.trigger("bandwidthupdate")},b.Hls.prototype.loadSegment=function(a,c){var d=this,e=this.player(),f=e.options().hls||{};this.segmentXhr_=b.Hls.xhr({url:a,responseType:"arraybuffer",withCredentials:f.withCredentials},function(a,b){var f;return d.segmentXhr_=null,a?"timeout"===a?(d.bandwidth=1,d.playlists.media(d.selectPlaylist())):(d.error={status:this.status,message:"HLS segment request error at URL: "+b,code:this.status>=500?4:2},void d.mediaIndex++):void(this.response&&(d.setBandwidth(this),f={mediaIndex:d.mediaIndex,playlist:d.playlists.media(),offset:c,bytes:null,encryptedBytes:null,decrypter:null},f.playlist.segments[f.mediaIndex].key?f.encryptedBytes=new Uint8Array(this.response):f.bytes=new Uint8Array(this.response),d.segmentBuffer_.push(f),e.trigger("progress"),d.drainBuffer(),d.mediaIndex++,d.playlists.media(d.selectPlaylist())))})},b.Hls.prototype.drainBuffer=function(a){var c,d,e,g,h,i,j,k,l,m,n,o=0,p=this.segmentBuffer_;if(p.length&&this.sourceBuffer){if(c=p[0],d=c.mediaIndex,e=c.playlist,g=c.offset,i=c.bytes,j=e.segments[d],j.key&&!i)return f(j.key)?p.shift():j.key.bytes?c.decrypter?void 0:(l=j.key.iv||new Uint32Array([0,0,0,d+e.mediaSequence]),k=new b.Hls.Decrypter(c.encryptedBytes,j.key.bytes,l,function(a,b){c.bytes=b}),void(c.decrypter=k)):this.fetchKeys_();for(a=a||{},n=1e3*b.Hls.getPlaylistDuration(e,0,d),this.segmentParser_.parseSegmentBinaryData(i),this.segmentParser_.flushTags(),h=[];this.segmentParser_.tagsAvailable();)h.push(this.segmentParser_.getNextTag());if("number"==typeof g){for(m=g-n+h[0].pts;h[o].pts<m;)o++;this.el().vjs_setProperty("currentTime",.001*(h[o].pts-h[0].pts+n)),h=h.slice(o),this.lastSeekedTime_=null}for(j.discontinuity&&h.length&&this.el().vjs_discontinuity(),o=0;o<h.length;o++)this.sourceBuffer.appendBuffer(h[o].bytes,this.player());p.shift(),1/0!==this.duration()&&d+1===e.segments.length&&this.mediaSource.endOfStream()}},b.Hls.prototype.fetchKeys_=function(){var a,c,d,g,h,i,j,k;if(!e&&this.segmentBuffer_.length)for(d=this,g=this.player(),h=g.options().hls||{},k=function(a){return function(b){return e=null,b||!this.response||16!==this.response.byteLength?(a.retries=a.retries||0,a.retries++,void(this.aborted||d.fetchKeys_())):(j=new DataView(this.response),a.bytes=new Uint32Array([j.getUint32(0),j.getUint32(4),j.getUint32(8),j.getUint32(12)]),void d.checkBuffer_())}},a=0;a<d.segmentBuffer_.length;a++)if(i=d.segmentBuffer_[a].playlist.segments[d.segmentBuffer_[a].mediaIndex],c=i.key,c&&!c.bytes&&!f(c)){e=b.Hls.xhr({url:this.playlistUriToUrl(c.uri),responseType:"arraybuffer",withCredentials:h.withCredentials},k(c));break}},b.Hls.supportsNativeHls=function(){var a,d,e=c.createElement("video");return b.Html5.isSupported()?(a=e.canPlayType("application/x-mpegURL"),d=e.canPlayType("application/vnd.apple.mpegURL"),/probably|maybe/.test(a)||/probably|maybe/.test(d)):!1}(),b.Hls.isSupported=function(){return(!b.Hls.supportsNativeHls||1)&&b.Flash.isSupported()&&b.MediaSource&&a.Uint8Array},b.Hls.canPlaySource=function(a){var b=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return b.test(a.type)},b.Hls.getPlaylistDuration=function(a,b,c){var e,f,g=0;for(b=b||0,c=c!==d?c:(a.segments||[]).length,f=c-1;f>=b;f--)e=a.segments[f],g+=(e.duration!==d?e.duration:a.targetDuration)||0;return g},b.Hls.getPlaylistTotalDuration=function(c){return c?c.totalDuration?c.totalDuration:c.endList?b.Hls.getPlaylistDuration(c):a.Infinity:0},b.Hls.translateMediaIndex=function(a,c,d){var e;return 0===a?0:d&&d.segments?(e=a+(c.mediaSequence-d.mediaSequence),e>=d.segments.length||0>e?b.Hls.getMediaIndexForLive_(d)+1:e):0},b.Hls.getMediaIndexByTime=function(a,b){var c,d,e,f;for(e=[],c=0;c<a.segments.length;c++)f={},f.start=0===c?0:e[c-1].end,f.end=f.start+a.segments[c].duration,e.push(f);for(d=0;d<e.length;d++)if(b>=e[d].start&&b<e[d].end)return d;return-1},b.Hls.prototype.getCurrentTimeByMediaIndex_=function(a,b){var c,d=0;if(!a.segments||0===b)return 0;for(c=0;b>c;c++)d+=a.segments[c].duration;return d},b.Hls.comparePlaylistBandwidth=function(b,c){var d,e;return b.attributes&&b.attributes.BANDWIDTH&&(d=b.attributes.BANDWIDTH),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.BANDWIDTH&&(e=c.attributes.BANDWIDTH),e=e||a.Number.MAX_VALUE,d-e},b.Hls.comparePlaylistResolution=function(b,c){var d,e;return b.attributes&&b.attributes.RESOLUTION&&b.attributes.RESOLUTION.width&&(d=b.attributes.RESOLUTION.width),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&(e=c.attributes.RESOLUTION.width),e=e||a.Number.MAX_VALUE,d===e&&b.attributes.BANDWIDTH&&c.attributes.BANDWIDTH?b.attributes.BANDWIDTH-c.attributes.BANDWIDTH:d-e},g=b.Hls.resolveUrl=function(a,b){var d,e,f=c.querySelector("base"),g=c.querySelector("head"),h=c.createElement("a"),i=f;return f?d=f.href:i=g.appendChild(c.createElement("base")),i.href=a,h.href=b,e=h.href,f?f.href=d:g.removeChild(i),e}}(window,window.videojs,document),function(a){a.Hls.xhr=function(b,c){var d,e,f={method:"GET",timeout:45e3};return"function"!=typeof c&&(c=function(){}),"object"==typeof b&&(f=a.util.mergeOptions(f,b),b=f.url),d=new window.XMLHttpRequest,d.open(f.method,b),d.url=b,d.requestTime=(new Date).getTime(),f.responseType&&(d.responseType=f.responseType),f.withCredentials&&(d.withCredentials=!0),f.timeout&&(e=window.setTimeout(function(){4!==d.readyState&&(d.timedout=!0,d.abort())},f.timeout)),d.onreadystatechange=function(){return 4===this.readyState?(window.clearTimeout(e),d.timedout?c.call(this,"timeout",b):this.status>=400||0===this.status?c.call(this,!0,b):(this.response&&(this.responseTime=(new Date).getTime(),this.roundTripTime=this.responseTime-this.requestTime,this.bytesReceived=this.response.byteLength||this.response.length,this.bandwidth=Math.floor(this.bytesReceived/this.roundTripTime*8*1e3)),c.call(this,!1,b))):void 0},d.send(null),d}}(window.videojs),function(a){a.videojs=a.videojs||{},a.videojs.Hls=a.videojs.Hls||{};var b=a.videojs.Hls;b.FlvTag=function(a,c){var d,e=0,f=function(a,b){var c,d=a.position+b;d<a.bytes.byteLength||(c=new Uint8Array(2*d),c.set(a.bytes.subarray(0,a.position),0),a.bytes=c,a.view=new DataView(a.bytes.buffer))},g=b.FlvTag.widthBytes||new Uint8Array("width".length),h=b.FlvTag.heightBytes||new Uint8Array("height".length),i=b.FlvTag.videocodecidBytes||new Uint8Array("videocodecid".length);if(!b.FlvTag.widthBytes){for(d=0;d<"width".length;d++)g[d]="width".charCodeAt(d);for(d=0;d<"height".length;d++)h[d]="height".charCodeAt(d);for(d=0;d<"videocodecid".length;d++)i[d]="videocodecid".charCodeAt(d);b.FlvTag.widthBytes=g,b.FlvTag.heightBytes=h,b.FlvTag.videocodecidBytes=i}switch(this.keyFrame=!1,a){case b.FlvTag.VIDEO_TAG:this.length=16;break;case b.FlvTag.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case b.FlvTag.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(16384),this.view=new DataView(this.bytes.buffer),this.bytes[0]=a,this.position=this.length,this.keyFrame=c,this.pts=0,this.dts=0,this.writeBytes=function(a,b,c){var d,e=b||0;c=c||a.byteLength,d=e+c,f(this,c),this.bytes.set(a.subarray(e,d),this.position),this.position+=c,this.length=Math.max(this.length,this.position)},this.writeByte=function(a){f(this,1),this.bytes[this.position]=a,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(a){f(this,2),this.view.setUint16(this.position,a),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(a){return this.bytes[this.length-a]},this.nalUnitSize=function(){return 0===e?0:this.length-(e+4)},this.startNalUnit=function(){if(e>0)throw new Error("Attempted to create new NAL wihout closing the old one");e=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(a){var b,c;this.length===e+4?this.length-=4:e>0&&(b=e+4,c=this.length-b,this.position=e,this.view.setUint32(this.position,c),this.position=this.length,a&&a.push(this.bytes.subarray(b,b+c))),e=0},this.writeMetaDataDouble=function(a,b){var c;if(f(this,2+a.length+9),this.view.setUint16(this.position,a.length),this.position+=2,"width"===a)this.bytes.set(g,this.position),this.position+=5;else if("height"===a)this.bytes.set(h,this.position),this.position+=6;else if("videocodecid"===a)this.bytes.set(i,this.position),this.position+=12;else for(c=0;c<a.length;c++)this.bytes[this.position]=a.charCodeAt(c),this.position++;this.position++,this.view.setFloat64(this.position,b),this.position+=8,this.length=Math.max(this.length,this.position),++e},this.writeMetaDataBoolean=function(a,b){var c;for(f(this,2),this.view.setUint16(this.position,a.length),this.position+=2,c=0;c<a.length;c++)console.assert(a.charCodeAt(c)<255),f(this,1),this.bytes[this.position]=a.charCodeAt(c),this.position++;f(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,b?1:0),this.position++,this.length=Math.max(this.length,this.position),++e},this.finalize=function(){var a,d;switch(this.bytes[0]){case b.FlvTag.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||c?16:32),this.bytes[12]=c?0:1,a=this.pts-this.dts,this.bytes[13]=(16711680&a)>>>16,this.bytes[14]=(65280&a)>>>8,this.bytes[15]=(255&a)>>>0;break;case b.FlvTag.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=c?0:1;break;case b.FlvTag.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,e),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return d=this.length-11,this.bytes[1]=(16711680&d)>>>16,this.bytes[2]=(65280&d)>>>8,this.bytes[3]=(255&d)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,f(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=b.FlvTag.frameTime(this.bytes),console.assert(this.bytes.byteLength===this.length),this}},b.FlvTag.AUDIO_TAG=8,b.FlvTag.VIDEO_TAG=9,b.FlvTag.METADATA_TAG=18,b.FlvTag.isAudioFrame=function(a){return b.FlvTag.AUDIO_TAG===a[0]},b.FlvTag.isVideoFrame=function(a){return b.FlvTag.VIDEO_TAG===a[0]},b.FlvTag.isMetaData=function(a){return b.FlvTag.METADATA_TAG===a[0]},b.FlvTag.isKeyFrame=function(a){return b.FlvTag.isVideoFrame(a)?23===a[11]:b.FlvTag.isAudioFrame(a)?!0:b.FlvTag.isMetaData(a)?!0:!1},b.FlvTag.frameTime=function(a){var b=a[4]<<16;return b|=a[5]<<8,b|=a[6]<<0,b|=a[7]<<24}}(this),function(a){var b=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return a[b]?(d=a[b].indexOf(c),a[b].splice(d,1),d>-1):!1},this.trigger=function(b){var c,d,e,f;if(c=a[b])for(f=Array.prototype.slice.call(arguments,1),e=c.length,d=0;e>d;++d)c[d].apply(this,f)},this.dispose=function(){a={}}}};b.prototype.pipe=function(a){this.on("data",function(b){a.push(b)})},a.Hls.Stream=b}(window.videojs),function(a){a.videojs.Hls.ExpGolomb=function(a){var b=a.byteLength,c=0,d=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+d},this.loadWord=function(){var e=a.byteLength-b,f=new Uint8Array(4),g=Math.min(4,b);if(0===g)throw new Error("no bytes available");f.set(a.subarray(e,e+g)),c=new DataView(f.buffer).getUint32(0),d=8*g,b-=g},this.skipBits=function(a){var e;d>a?(c<<=a,d-=a):(a-=d,e=a/8,a-=8*e,b-=e,this.loadWord(),c<<=a,d-=a)},this.readBits=function(a){var e=Math.min(d,a),f=c>>>32-e;return console.assert(32>a,"Cannot read more than 32 bits at a time"),d-=e,d>0?c<<=e:b>0&&this.loadWord(),e=a-e,e>0?f<<e|this.readBits(e):f},this.skipLeadingZeros=function(){var a;for(a=0;d>a;++a)if(0!==(c&2147483648>>>a))return c<<=a,d-=a,a;return this.loadWord(),a+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())
},this.readUnsignedExpGolomb=function(){var a=this.skipLeadingZeros();return this.readBits(a+1)-1},this.readExpGolomb=function(){var a=this.readUnsignedExpGolomb();return 1&a?1+a>>>1:-1*(a>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}}(this),function(a){var b,c=a.videojs.Hls.ExpGolomb,d=a.videojs.Hls.FlvTag,e=function(){this.sps=[],this.pps=[],this.extraDataExists=function(){return this.sps.length>0},this.scaling_list=function(a,b){var c,d,e=8,f=8;for(c=0;a>c;++c)0!==f&&(d=b.readExpGolomb(),f=(e+d+256)%256),e=0===f?e:f},this.getSps0Rbsp=function(){for(var a=this.sps[0],b=1,c=1,d=0,e=a.byteLength-2,f=new Uint8Array(a.byteLength);e>b;)0===a[b]&&0===a[b+1]&&3===a[b+2]&&(f.set(a.subarray(c,b+1),d),d+=b+1-c,c=b+3),b++;return f.set(a.subarray(c),d),f.subarray(0,d+(a.byteLength-c))},this.metaDataTag=function(a){var b,e,f,g,h,i,j,k,l,m,n,o,p,q=new d(d.METADATA_TAG),r=0,s=0,t=0,u=0;if(q.dts=a,q.pts=a,b=new c(this.getSps0Rbsp()),e=b.readUnsignedByte(),b.skipBits(16),b.skipUnsignedExpGolomb(),(100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e)&&(f=b.readUnsignedExpGolomb(),3===f&&b.skipBits(1),b.skipUnsignedExpGolomb(),b.skipUnsignedExpGolomb(),b.skipBits(1),b.readBoolean()))for(g=3!==f?8:12,h=0;g>h;++h)b.readBoolean()&&(6>h?this.scaling_list(16,b):this.scaling_list(64,b));if(b.skipUnsignedExpGolomb(),i=b.readUnsignedExpGolomb(),0===i)b.readUnsignedExpGolomb();else if(1===i)for(b.skipBits(1),b.skipExpGolomb(),b.skipExpGolomb(),j=b.readUnsignedExpGolomb(),h=0;j>h;++h)b.skipExpGolomb();return b.skipUnsignedExpGolomb(),b.skipBits(1),k=b.readUnsignedExpGolomb(),l=b.readUnsignedExpGolomb(),m=b.readBits(1),0===m&&b.skipBits(1),b.skipBits(1),n=b.readBoolean(),n&&(r=b.readUnsignedExpGolomb(),s=b.readUnsignedExpGolomb(),t=b.readUnsignedExpGolomb(),u=b.readUnsignedExpGolomb()),o=16*(k+1)-2*r-2*s,p=(2-m)*(l+1)*16-2*t-2*u,q.writeMetaDataDouble("videocodecid",7),q.writeMetaDataDouble("width",o),q.writeMetaDataDouble("height",p),q},this.extraDataTag=function(a){var b,c=new d(d.VIDEO_TAG,!0);for(c.dts=a,c.pts=a,c.writeByte(1),c.writeByte(this.sps[0][1]),c.writeByte(this.sps[0][2]),c.writeByte(this.sps[0][3]),c.writeByte(255),c.writeByte(225),c.writeShort(this.sps[0].length),c.writeBytes(this.sps[0]),c.writeByte(this.pps.length),b=0;b<this.pps.length;++b)c.writeShort(this.pps[b].length),c.writeBytes(this.pps[b]);return c}};a.videojs.Hls.NALUnitType=b={unspecified:0,slice_layer_without_partitioning_rbsp_non_idr:1,slice_data_partition_a_layer_rbsp:2,slice_data_partition_b_layer_rbsp:3,slice_data_partition_c_layer_rbsp:4,slice_layer_without_partitioning_rbsp_idr:5,sei_rbsp:6,seq_parameter_set_rbsp:7,pic_parameter_set_rbsp:8,access_unit_delimiter_rbsp:9,end_of_seq_rbsp:10,end_of_stream_rbsp:11},a.videojs.Hls.H264Stream=function(){var a,c,f,g,h,i=new e,j=new e,k=-1;this.tags=[],this.setTimeStampOffset=function(a){f=a},this.setNextTimeStamp=function(b,d,e){a=b-f,c=d-f,e&&this.finishFrame()},this.finishFrame=function(){g&&(j.extraDataExists()&&(i=j,j=new e),g.keyFrame&&(this.tags.push(i.metaDataTag(g.pts)),this.tags.push(i.extraDataTag(g.pts))),g.endNalUnit(),this.tags.push(g)),g=null,k=-1,h=0},this.writeBytes=function(e,f,i){var l,m,n,o;if(f=f||0,i=i||0,!(0>=i))switch(h){default:case 0:h=1;case 1:if(e[f]<=1&&(l=g?g.nalUnitSize():0,l>=1&&0===g.negIndex(1))){if(1===e[f]&&l>=2&&0===g.negIndex(2))return g.length-=l>=3&&0===g.negIndex(3)?3:2,h=3,this.writeBytes(e,f+1,i-1);if(i>1&&0===e[f]&&1===e[f+1])return g.length-=l>=2&&0===g.negIndex(2)?2:1,h=3,this.writeBytes(e,f+2,i-2);if(i>2&&0===e[f]&&0===e[f+1]&&1===e[f+2])return h=3,this.writeBytes(e,f+3,i-3)}h=2;case 2:for(m=f,n=m+i,o=n-3;o>f;)if(e[f+2]>1)f+=3;else if(0!==e[f+1])f+=2;else if(0!==e[f])f+=1;else{if(1===e[f+2])return f>m&&g.writeBytes(e,m,f-m),h=3,f+=3,this.writeBytes(e,f,n-f);if(n-f>=4&&0===e[f+2]&&1===e[f+3])return f>m&&g.writeBytes(e,m,f-m),h=3,f+=4,this.writeBytes(e,f,n-f);f+=3}return h=1,void(g&&g.writeBytes(e,m,i));case 3:if(g)switch(k){case b.seq_parameter_set_rbsp:g.endNalUnit(j.sps);break;case b.pic_parameter_set_rbsp:g.endNalUnit(j.pps);break;case b.slice_layer_without_partitioning_rbsp_idr:g.endNalUnit();break;default:g.endNalUnit()}return k=31&e[f],g&&(k===b.access_unit_delimiter_rbsp?this.finishFrame():k===b.slice_layer_without_partitioning_rbsp_idr&&(g.keyFrame=!0)),g||(g=new d(d.VIDEO_TAG),g.pts=a,g.dts=c),g.startNalUnit(),h=2,this.writeBytes(e,f,i)}}}}(this),function(a){var b=a.videojs.Hls.FlvTag,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3];a.videojs.Hls.AacStream=function(){var a,d,e,f,g,h,i,j,k,l,m,n,o,p;this.tags=[],this.setTimeStampOffset=function(a){d=a,g=a-1e3},this.setNextTimeStamp=function(b,c,g){a=b-d,f=c,g&&(e=0)},this.writeBytes=function(d,q,r){var s,t,u;for(q=q||0,r=r||0,r=r>f?f:r,f-=r,s=q+r;s>q;)switch(e){default:e=0;break;case 0:if(q>=s)return;if(255!==d[q])return console.assert(!1,"Error no ATDS header found"),q+=1,void(e=0);q+=1,e=1;break;case 1:if(q>=s)return;if(240!==(240&d[q]))return console.assert(!1,"Error no ATDS header found"),q+=1,void(e=0);h=!!(1&d[q]),q+=1,e=2;break;case 2:if(q>=s)return;i=((192&d[q])>>>6)+1,j=(60&d[q])>>>2,k=(1&d[q])<<2,q+=1,e=3;break;case 3:if(q>=s)return;k|=(192&d[q])>>>6,l=(3&d[q])<<11,q+=1,e=4;break;case 4:if(q>=s)return;l|=d[q]<<3,q+=1,e=5;break;case 5:if(q>=s)return;l|=(224&d[q])>>>5,l-=h?7:9,q+=1,e=6;break;case 6:if(q>=s)return;m=1024*((3&d[q])+1),n=1e3*m/c[j],t=i<<11|j<<7|k<<3,(t!==p||a-g>=1e3)&&(o=new b(b.METADATA_TAG),o.pts=a,o.dts=a,o.writeMetaDataDouble("audiocodecid",10),o.writeMetaDataBoolean("stereo",2===k),o.writeMetaDataDouble("audiosamplerate",c[j]),o.writeMetaDataDouble("audiosamplesize",16),this.tags.push(o),p=t,o=new b(b.AUDIO_TAG,!0),o.pts=a,o.dts=o.pts,o.view.setUint16(o.position,t),o.position+=2,o.length=Math.max(o.length,o.position),this.tags.push(o),g=a),q+=1,e=7;break;case 7:if(!h){if(2>s-q)return;q+=2}o=new b(b.AUDIO_TAG),o.pts=a,o.dts=a,e=8;break;case 8:for(;l;){if(q>=s)return;u=l>s-q?s-q:l,o.writeBytes(d,q,u),q+=u,l-=u}this.tags.push(o),e=0,a+=n}}}}(this),function(a,b){"use strict";var c,d=function(b,c,d){var e,f="";for(e=c;d>e;e++)f+="%"+("00"+b[e].toString(16)).slice(-2);return a.decodeURIComponent(f)},e={TXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=d(a.data,1,b),a.value=d(a.data,b+1,a.data.length);break}},WXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=d(a.data,1,b),a.url=d(a.data,b+1,a.data.length);break}}};c=function(a){var d,f={debug:!(!a||!a.debug),descriptor:a&&a.descriptor};if(c.prototype.init.call(this),this.dispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16),f.descriptor)for(d=0;d<f.descriptor.length;d++)this.dispatchType+=("00"+f.descriptor[d].toString(16)).slice(-2);this.push=function(a){var c,d,g,h;if(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0))return void(f.debug&&b.log("Skipping unrecognized metadata stream"));c=a.data.byteLength,d=10,64&a.data[5]&&(d+=4,d+=a.data[10]<<24|a.data[11]<<16|a.data[12]<<8|a.data[13],c-=a.data[16]<<24|a.data[17]<<16|a.data[18]<<8|a.data[19]),this.timestampOffset&&(a.pts-=this.timestampOffset,a.dts-=this.timestampOffset),a.frames=[];do{if(g=a.data[d+4]<<24|a.data[d+5]<<16|a.data[d+6]<<8|a.data[d+7],1>g)return b.log("Malformed ID3 frame encountered. Skipping metadata parsing.");h={id:String.fromCharCode(a.data[d])+String.fromCharCode(a.data[d+1])+String.fromCharCode(a.data[d+2])+String.fromCharCode(a.data[d+3]),data:a.data.subarray(d+10,d+g+10)},e[h.id]&&e[h.id](h),a.frames.push(h),d+=10,d+=g}while(c>d);this.trigger("data",a)}},c.prototype=new b.Hls.Stream,b.Hls.MetadataStream=c}(window,window.videojs),function(a){var b,c,d=a.videojs,e=d.Hls.FlvTag,f=d.Hls.H264Stream,g=d.Hls.AacStream,h=d.Hls.MetadataStream;d.Hls.SegmentParser=function(){var a,i,j=this,k=new Uint8Array(b),l=0,m=new f,n=new g,o=!1,p=!1;j.stream={programMapTable:{}},j.metadataStream=new h,j.getFlvHeader=function(a,b,c){var d,f,g=new Uint8Array(9),h=new DataView(g.buffer);return a=a||0,b=void 0===b?!0:b,c=void 0===c?!0:c,h.setUint8(0,70),h.setUint8(1,76),h.setUint8(2,86),h.setUint8(3,1),h.setUint8(4,(b?4:0)|(c?1:0)),h.setUint32(5,g.byteLength),0>=a?(f=new Uint8Array(g.byteLength+4),f.set(g),f.set([0,0,0,0],g.byteLength),f):(d=new e(e.METADATA_TAG),d.pts=d.dts=0,d.writeMetaDataDouble("duration",a),f=new Uint8Array(g.byteLength+d.byteLength),f.set(h),f.set(h.bytesLength,d.finalize()),f)},j.flushTags=function(){m.finishFrame()},j.tagsAvailable=function(){return m.tags.length+n.tags.length},j.getNextTag=function(){var a;return a=m.tags.length?n.tags.length&&n.tags[0].dts<m.tags[0].dts?n.tags.shift():m.tags.shift():n.tags.shift(),a.finalize()},j.parseSegmentBinaryData=function(c){var e,f=0;if(l>0){if(c.byteLength+l<b)return d.log("data.length + streamBuffer.length < MP2T_PACKET_LENGTH ??"),void k.readBytes(c,c.length,k.length);e=c.subarray(0,b-l),k.set(e,l),a(k),k=new Uint8Array(b),l=0}for(;;){for(;f<c.byteLength&&71!==c[f];)f++;if(c.byteLength-f<b)return void(c.byteLength-f>0&&(k.set(c.subarray(f),l),l+=c.byteLength-f));a(c.subarray(f,f+b))?f+=b:(d.log("error parsing m2ts packet, attempting to re-align"),f++)}},a=function(a){var e,f,g,h,k,l,q,r,s,t,u,v,w,x,y,z=0,A=z+b,B=!!(64&a[z+1]),C=(31&a[z+1])<<8|a[z+2],D=(48&a[z+3])>>>4;if(z+=4,D>1&&(z+=a[z]+1),0===C){if(B&&(z+=1+a[z]),e=a[z],0!==e&&d.log("the table_id of the PAT should be 0x00 but was"+e.toString(16)),f=!!(1&a[z+5])){if(g=(15&a[z+1])<<8|a[z+2],z+=8,(g-5-4)/4!==1)throw new Error("TS has more that 1 program");j.stream.pmtPid=(31&a[z+2])<<8|a[z+3]}}else if(C===j.stream.programMapTable[c.h264]||C===j.stream.programMapTable[c.adts]||C===j.stream.programMapTable[c.metadata]){if(B){if(0!==a[z+0]||0!==a[z+1]||1!==a[z+2])throw new Error("PES did not begin with start code");h=a[z+4]<<8|a[z+5],k=0!==(4&a[z+6]),l=a[z+7],q=a[z+8],z+=9,192&l&&(r=(14&a[z+0])<<28|(255&a[z+1])<<21|(254&a[z+2])<<13|(255&a[z+3])<<6|(254&a[z+4])>>>2,r/=45,s=r,64&l&&(s=(14&a[z+5])<<28|(255&a[z+6])<<21|(254&a[z+7])<<13|(255&a[z+8])<<6|(254&a[z+9])>>>2,s/=45)),z+=q,j.metadataStream.timestampOffset||(j.metadataStream.timestampOffset=r),C===j.stream.programMapTable[c.h264]?(o||(o=!0,void 0===i&&(i=r),m.setTimeStampOffset(i)),m.setNextTimeStamp(r,s,k)):C===j.stream.programMapTable[c.adts]?(p||(p=!0,void 0===i&&(i=r),n.setTimeStampOffset(i)),n.setNextTimeStamp(r,h,k)):j.metadataStream.push({pts:r,dts:s,data:a.subarray(z)})}C===j.stream.programMapTable[c.adts]?n.writeBytes(a,z,A-z):C===j.stream.programMapTable[c.h264]&&m.writeBytes(a,z,A-z)}else if(j.stream.pmtPid===C){if(B&&(z+=1+a[z]),2!==a[z]&&d.log("The table_id of a PMT should be 0x02 but was "+a[z].toString(16)),t=!!(1&a[z+5]))for(j.stream.programMapTable={},v=(15&a[z+1])<<8|a[z+2],u=(15&a[z+10])<<8|a[z+11],v-=u,v-=13,z+=12+u;v>0;){if(w=a[z+0],x=(31&a[z+1])<<8|a[z+2],w===c.h264&&j.stream.programMapTable[w]&&j.stream.programMapTable[w]!==x)throw new Error("Program has more than 1 video stream");if(w===c.adts&&j.stream.programMapTable[w]&&j.stream.programMapTable[w]!==x)throw new Error("Program has more than 1 audio Stream");j.stream.programMapTable[w]=x,y=(15&a[z+3])<<8|a[z+4],w===c.metadata&&(j.metadataStream.descriptor=new Uint8Array(a.subarray(z+5,z+5+y))),z+=5+y,v-=5+y}}else 17===C||8191===C||d.log("Unknown PID parsing TS packet: "+C);return!0},j.getTags=function(){return m.tags},j.stats={h264Tags:function(){return m.tags.length},aacTags:function(){return n.tags.length}}},d.Hls.SegmentParser.MP2T_PACKET_LENGTH=b=188,d.Hls.SegmentParser.STREAM_TYPES=c={h264:27,adts:15,metadata:21}}(window),function(a,b,c,d,e){var f,g,h,i=function(){},j=function(){var a="[^=]*",b='"[^"]*"|[^,]*',c="(?:"+a+")=(?:"+b+")";return new RegExp("(?:^|,)("+c+")")}(),k=function(a){for(var b,c=a.split(j),d=c.length,e={};d--;)""!==c[d]&&(b=/([^=]*)=(.*)/.exec(c[d]).slice(1),b[0]=b[0].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^['"](.*)['"]$/g,"$1"),e[b[0]]=b[1]);return e},l=a.Hls.Stream;f=function(){var a="";f.prototype.init.call(this),this.push=function(b){var c;for(a+=b,c=a.indexOf("\n");c>-1;c=a.indexOf("\n"))this.trigger("data",a.substring(0,c)),a=a.substring(c+1)}},f.prototype=new l,g=function(){g.prototype.init.call(this)},g.prototype=new l,g.prototype.push=function(a){var c,d;if(0!==a.length)return"#"!==a[0]?void this.trigger("data",{type:"uri",uri:a}):0!==a.indexOf("#EXT")?void this.trigger("data",{type:"comment",text:a.slice(1)}):(a=a.replace("\r",""),(c=/^#EXTM3U/.exec(a))?void this.trigger("data",{type:"tag",tagType:"m3u"}):(c=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(a))?(d={type:"tag",tagType:"inf"},c[1]&&(d.duration=parseFloat(c[1])),c[2]&&(d.title=c[2]),void this.trigger("data",d)):(c=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"targetduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"totalduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"version"},c[1]&&(d.version=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"media-sequence"},c[1]&&(d.number=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(a))?(d={type:"tag",tagType:"playlist-type"},c[1]&&(d.playlistType=c[1]),void this.trigger("data",d)):(c=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"byterange"},c[1]&&(d.length=b(c[1],10)),c[2]&&(d.offset=b(c[2],10)),void this.trigger("data",d)):(c=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(a))?(d={type:"tag",tagType:"allow-cache"},c[1]&&(d.allowed=!/NO/.test(c[1])),void this.trigger("data",d)):(c=/^#EXT-X-STREAM-INF:?(.*)$/.exec(a))?(d={type:"tag",tagType:"stream-inf"},c[1]&&(d.attributes=k(c[1]),d.attributes.RESOLUTION&&!function(){var a=d.attributes.RESOLUTION.split("x"),c={};a[0]&&(c.width=b(a[0],10)),a[1]&&(c.height=b(a[1],10)),d.attributes.RESOLUTION=c}(),d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=b(d.attributes.BANDWIDTH,10)),d.attributes["PROGRAM-ID"]&&(d.attributes["PROGRAM-ID"]=b(d.attributes["PROGRAM-ID"],10))),void this.trigger("data",d)):(c=/^#EXT-X-ENDLIST/.exec(a))?void this.trigger("data",{type:"tag",tagType:"endlist"}):(c=/^#EXT-X-DISCONTINUITY/.exec(a))?void this.trigger("data",{type:"tag",tagType:"discontinuity"}):(c=/^#EXT-X-KEY:?(.*)$/.exec(a))?(d={type:"tag",tagType:"key"},c[1]&&(d.attributes=k(c[1]),d.attributes.IV&&("0x"===d.attributes.IV.substring(0,2)&&(d.attributes.IV=d.attributes.IV.substring(2)),d.attributes.IV=d.attributes.IV.match(/.{8}/g),d.attributes.IV[0]=b(d.attributes.IV[0],16),d.attributes.IV[1]=b(d.attributes.IV[1],16),d.attributes.IV[2]=b(d.attributes.IV[2],16),d.attributes.IV[3]=b(d.attributes.IV[3],16),d.attributes.IV=new Uint32Array(d.attributes.IV))),void this.trigger("data",d)):void this.trigger("data",{type:"tag",data:a.slice(4,a.length)}))},h=function(){var a,b=this,j=[],k={};h.prototype.init.call(this),this.lineStream=new f,this.parseStream=new g,this.lineStream.pipe(this.parseStream),this.manifest={allowCache:!0},this.parseStream.on("data",function(f){({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=f.allowed,"allowed"in f||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var a={};"length"in f&&(k.byterange=a,a.length=f.length,"offset"in f||(this.trigger("info",{message:"defaulting offset to zero"}),f.offset=0)),"offset"in f&&(k.byterange=a,a.offset=f.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),f.duration>=0&&(k.duration=f.duration),this.manifest.segments=j},key:function(){return f.attributes?"NONE"===f.attributes.METHOD?void(a=null):f.attributes.URI?(f.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:f.attributes.METHOD||"AES-128",uri:f.attributes.URI},void(f.attributes.IV!==e&&(a.iv=f.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){return c(f.number)?void(this.manifest.mediaSequence=f.number):void this.trigger("warn",{message:"ignoring invalid media sequence: "+f.number})},"playlist-type":function(){return/VOD|EVENT/.test(f.playlistType)?void(this.manifest.playlistType=f.playlistType):void this.trigger("warn",{message:"ignoring unknown playlist type: "+f.playlist})},"stream-inf":function(){return this.manifest.playlists=j,f.attributes?(k.attributes||(k.attributes={}),void(k.attributes=d(k.attributes,f.attributes))):void this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){k.discontinuity=!0},targetduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid target duration: "+f.duration}):void(this.manifest.targetDuration=f.duration)},totalduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid total duration: "+f.duration}):void(this.manifest.totalDuration=f.duration)}})[f.tagType]||i).call(b)},uri:function(){k.uri=f.uri,j.push(k),!this.manifest.targetDuration||"duration"in k||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),k.duration=this.manifest.targetDuration),a&&(k.key=a),k={}},comment:function(){}})[f.type].call(b)})},h.prototype=new l,h.prototype.push=function(a){this.lineStream.push(a)},h.prototype.end=function(){this.lineStream.push("\n")},window.videojs.m3u8={LineStream:f,ParseStream:g,Parser:h}}(window.videojs,window.parseInt,window.isFinite,window.videojs.util.mergeOptions),function(a,b){"use strict";var c=b.Hls.resolveUrl,d=b.Hls.xhr,e=function(a,c){var d,e,f=!1,g=b.util.mergeOptions(a,{});for(d=a.playlists.length;d--;)if(e=g.playlists[d],e.uri===c.uri){if(e.segments&&c.segments&&e.segments.length===c.segments.length&&e.mediaSequence===c.mediaSequence)continue;g.playlists[d]=b.util.mergeOptions(e,c),g.playlists[c.uri]=g.playlists[d],f=!0}return f?g:null},f=function(g,h){var i,j,k,l,m=this,n=function(c,d,f){var g,h,i;return m.setBandwidth(l||d),l=null,c?(m.error={status:d.status,message:"HLS playlist request error at URL: "+f,responseText:d.responseText,code:d.status>=500?4:2},m.trigger("error")):(m.state="HAVE_METADATA",g=new b.m3u8.Parser,g.push(d.responseText),g.end(),g.manifest.uri=f,i=e(m.master,g.manifest),h=1e3*(g.manifest.targetDuration||10),i?(m.master=i,j=m.master.playlists[f]):h/=2,m.media().endList||(k=a.setTimeout(function(){m.trigger("mediaupdatetimeout")},h)),void m.trigger("loadedplaylist"))};if(f.prototype.init.call(this),!g)throw new Error("A non-empty playlist URL is required");m.state="HAVE_NOTHING",i=this.dispose,m.dispose=function(){l&&(l.onreadystatechange=null,l.abort(),l=null),a.clearTimeout(k),i.call(this)},m.media=function(a){var b=!1;if(!a)return j;if("HAVE_NOTHING"===m.state||"HAVE_MASTER"===m.state)throw new Error("Cannot switch media playlist from "+m.state);if("string"==typeof a){if(!m.master.playlists[a])throw new Error("Unknown playlist URI: "+a);a=m.master.playlists[a]}if(b=a.uri!==j.uri,m.master.playlists[a.uri].endList)return l&&(l.onreadystatechange=null,l.abort(),l=null),m.state="HAVE_METADATA",j=a,void(b&&m.trigger("mediachange"));if(b){if(m.state="SWITCHING_MEDIA",l){if(c(m.master.uri,a.uri)===l.url)return;l.onreadystatechange=null,l.abort(),l=null}l=d({url:c(m.master.uri,a.uri),withCredentials:h},function(b){n(b,this,a.uri),m.trigger("mediachange")})}},m.setBandwidth=function(a){m.bandwidth=a.bandwidth},m.on("mediaupdatetimeout",function(){"HAVE_METADATA"===m.state&&(m.state="HAVE_CURRENT_METADATA",l=d({url:c(m.master.uri,m.media().uri),withCredentials:h},function(a){n(a,this,m.media().uri)}))}),d({url:g,withCredentials:h},function(e){var f,i;if(e)return m.error={status:this.status,message:"HLS playlist request error at URL: "+g,responseText:this.responseText,code:2},m.trigger("error");if(f=new b.m3u8.Parser,f.push(this.responseText),f.end(),m.state="HAVE_MASTER",f.manifest.uri=g,f.manifest.playlists){for(m.master=f.manifest,i=m.master.playlists.length;i--;)m.master.playlists[m.master.playlists[i].uri]=m.master.playlists[i];return l=d({url:c(g,f.manifest.playlists[0].uri),withCredentials:h},function(a){n(a,this,f.manifest.playlists[0].uri),a||m.trigger("loadedmetadata")}),m.trigger("loadedplaylist")}return m.master={uri:a.location.href,playlists:[{uri:g}]},m.master.playlists[g]=m.master.playlists[0],n(null,this,g),m.trigger("loadedmetadata")})};f.prototype=new b.Hls.Stream,b.Hls.PlaylistLoader=f}(window,window.videojs),function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){(function(b){b.window.pkcs7={unpad:a("./unpad")}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./unpad":2}],2:[function(a,b){"use strict";b.exports=function(a){return a.subarray(0,a.byteLength-a[a.byteLength-1])}},{}]},{},[1]),function(a,b,c){"use strict";var d,e,f,g,h;h=function(a){return a<<24|(65280&a)<<8|(16711680&a)>>8|a>>>24},d=function(a){this._precompute();var b,c,d,e,f,g=this._tables[0][4],h=this._tables[1],i=a.length,j=1;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size");for(e=a.slice(0),f=[],this._key=[e,f],b=i;4*i+28>b;b++)d=e[b-1],(b%i===0||8===i&&b%i===4)&&(d=g[d>>>24]<<24^g[d>>16&255]<<16^g[d>>8&255]<<8^g[255&d],b%i===0&&(d=d<<8^d>>>24^j<<24,j=j<<1^283*(j>>7))),e[b]=e[b-i]^d;for(c=0;b;c++,b--)d=e[3&c?b:b-4],f[c]=4>=b||4>c?d:h[0][g[d>>>24]]^h[1][g[d>>16&255]]^h[2][g[d>>8&255]]^h[3][g[255&d]]},d.prototype={_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;256>a;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;4>a;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;5>a;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},decrypt:function(a,b,c,d,e,f){var g,h,i,j,k=this._key[1],l=a^k[0],m=d^k[1],n=c^k[2],o=b^k[3],p=k.length/4-2,q=4,r=this._tables[1],s=r[0],t=r[1],u=r[2],v=r[3],w=r[4];for(j=0;p>j;j++)g=s[l>>>24]^t[m>>16&255]^u[n>>8&255]^v[255&o]^k[q],h=s[m>>>24]^t[n>>16&255]^u[o>>8&255]^v[255&l]^k[q+1],i=s[n>>>24]^t[o>>16&255]^u[l>>8&255]^v[255&m]^k[q+2],o=s[o>>>24]^t[l>>16&255]^u[m>>8&255]^v[255&n]^k[q+3],q+=4,l=g,m=h,n=i;for(j=0;4>j;j++)e[(3&-j)+f]=w[l>>>24]<<24^w[m>>16&255]<<16^w[n>>8&255]<<8^w[255&o]^k[q++],g=l,l=m,m=n,n=o,o=g}},g=function(a,b,c){var e,f,g,i,j,k,l,m,n,o=new Int32Array(a.buffer,a.byteOffset,a.byteLength>>2),p=new d(Array.prototype.slice.call(b)),q=new Uint8Array(a.byteLength),r=new Int32Array(q.buffer);for(e=c[0],f=c[1],g=c[2],i=c[3],n=0;n<o.length;n+=4)j=h(o[n]),k=h(o[n+1]),l=h(o[n+2]),m=h(o[n+3]),p.decrypt(j,k,l,m,r,n),r[n]=h(r[n]^e),r[n+1]=h(r[n+1]^f),r[n+2]=h(r[n+2]^g),r[n+3]=h(r[n+3]^i),e=j,f=k,g=l,i=m;return q},e=function(){this.jobs=[],this.delay=1,this.timeout_=null},e.prototype=new b.Hls.Stream,e.prototype.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(b.bind(this,this.processJob_),this.delay):null},e.prototype.push=function(a){this.jobs.push(a),this.timeout_||(this.timeout_=setTimeout(b.bind(this,this.processJob_),this.delay))},f=function(a,b,d,g){var i=f.STEP,j=new Int32Array(a.buffer),k=new Uint8Array(a.byteLength),l=0;for(this.asyncStream_=new e,this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k,l)),l=i;l<j.length;l+=i)d=new Uint32Array([h(j[l-4]),h(j[l-3]),h(j[l-2]),h(j[l-1])]),this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k));this.asyncStream_.push(function(){g(null,c(k))})},f.prototype=new b.Hls.Stream,f.prototype.decryptChunk_=function(a,b,c,d){return function(){var e=g(a,b,c);d.set(e,a.byteOffset)}},f.STEP=32e3,b.Hls.decrypt=g,b.Hls.Decrypter=f,b.Hls.AsyncStream=e}(window,window.videojs,window.pkcs7.unpad),function(a){var b={hexDump:function(a){for(var b,c,d=Array.prototype.slice.call(a),e=16,f=function(a,b){var c=a.toString(16);return"00".substring(0,2-c.length)+c+(b%2?" ":"")},g=function(a){return a>=32&&126>a?String.fromCharCode(a):"."},h="",i=0;i<d.length/e;i++)b=d.slice(i*e,i*e+e).map(f).join(""),c=d.slice(i*e,i*e+e).map(g).join(""),h+=b+" "+c+"\n";return h},tagDump:function(a){return b.hexDump(a.bytes)}};a.videojs.Hls.utils=b}(this),videojs.plugin("audiotracks",function(a){var b=this,c=videojs.MenuItem.extend({init:function(a,b){videojs.MenuItem.call(this,a,b),this.lang=b.label,this.on("tap",this.onClick),this.on("click",this.onClick)}});c.prototype.onClick=function(){this.trigger({type:"selected",lang:this.lang,trackId:this.options().trackId})};var d=videojs.MenuButton.extend({init:function(a,b,c){this.tracks=void 0!==a.audioTracks?a.audioTracks():[],videojs.MenuButton.call(this,a,b,c),this.tracks.length<=1&&this.hide(),this.el().setAttribute("aria-label","Audio Menu")}});d.prototype.buttonText="Audio",d.prototype.className="vjs-audiotracks-button",d.prototype.createItems=function(){var a;for(this.items=[],a=0;a<this.tracks.length;a++)this.items.push(this.createItem(a,this.tracks[a]));return this.items},d.prototype.createItem=function(a,b){var d,e=new castLabs.utils.Internationalization;return d=new c(this.player(),{label:e.translateLanguageCode(b,"en"),trackId:a}),d.on("selected",videojs.bind(this,this.selectItem)),d.on("selected",videojs.bind(this,this.setAudioTrack)),d},d.prototype.selectItem=function(a){var b;for(b=0;b<this.items.length;b++)this.items[b].selected(this.items[b].options().trackId===a.trackId?!0:!1)},d.prototype.setAudioTrack=function(a){b.setAudioTrack(a.trackId),this.player().trigger({type:"trackchanged",trackType:"audio",trackId:a.trackId,trackEnabled:!0})};var e=null;b.on("loadedmetadata",function(){null!==e&&e.dispose&&e.el()&&e.dispose(),e=new d(b,a),b.controlBar.addChild(e)})}),function(a){"use strict";var b={VERSION:"0.5.3"};b.System=function(){this._mappings={},this._outlets={},this._handlers={},this.strictInjections=!0,this.autoMapOutlets=!1,this.postInjectionHook="setup"},b.System.prototype={_createAndSetupInstance:function(a,b){var c=new b;return this.injectInto(c,a),c},_retrieveFromCacheOrCreate:function(a,b){"undefined"==typeof b&&(b=!1);var c;if(!this._mappings.hasOwnProperty(a))throw new Error(1e3);var d=this._mappings[a];return!b&&d.isSingleton?(null==d.object&&(d.object=this._createAndSetupInstance(a,d.clazz)),c=d.object):c=d.clazz?this._createAndSetupInstance(a,d.clazz):d.object,c},mapOutlet:function(a,b,c){if("undefined"==typeof a)throw new Error(1010);return b=b||"global",c=c||a,this._outlets.hasOwnProperty(b)||(this._outlets[b]={}),this._outlets[b][c]=a,this},getObject:function(a){if("undefined"==typeof a)throw new Error(1020);return this._retrieveFromCacheOrCreate(a)},mapValue:function(a,b){if("undefined"==typeof a)throw new Error(1030);return this._mappings[a]={clazz:null,object:b,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(a),this.hasMapping(a)&&this.injectInto(b,a),this},hasMapping:function(a){if("undefined"==typeof a)throw new Error(1040);return this._mappings.hasOwnProperty(a)},mapClass:function(a,b){if("undefined"==typeof a)throw new Error(1050);if("undefined"==typeof b)throw new Error(1051);return this._mappings[a]={clazz:b,object:null,isSingleton:!1},this.autoMapOutlets&&this.mapOutlet(a),this},mapSingleton:function(a,b){if("undefined"==typeof a)throw new Error(1060);if("undefined"==typeof b)throw new Error(1061);return this._mappings[a]={clazz:b,object:null,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(a),this},instantiate:function(a){if("undefined"==typeof a)throw new Error(1070);return this._retrieveFromCacheOrCreate(a,!0)},injectInto:function(a,b){if("undefined"==typeof a)throw new Error(1080);if("object"==typeof a){var c=[];this._outlets.hasOwnProperty("global")&&c.push(this._outlets.global),"undefined"!=typeof b&&this._outlets.hasOwnProperty(b)&&c.push(this._outlets[b]);for(var d in c){var e=c[d];for(var f in e){var g=e[f];(!this.strictInjections||f in a)&&(a[f]=this.getObject(g))}}"setup"in a&&a.setup.call(a)}return this},unmap:function(a){if("undefined"==typeof a)throw new Error(1090);return delete this._mappings[a],this},unmapOutlet:function(a,b){if("undefined"==typeof a)throw new Error(1100);if("undefined"==typeof b)throw new Error(1101);return delete this._outlets[a][b],this},mapHandler:function(a,b,c,d,e){if("undefined"==typeof a)throw new Error(1110);return b=b||"global",c=c||a,"undefined"==typeof d&&(d=!1),"undefined"==typeof e&&(e=!1),this._handlers.hasOwnProperty(a)||(this._handlers[a]={}),this._handlers[a].hasOwnProperty(b)||(this._handlers[a][b]=[]),this._handlers[a][b].push({handler:c,oneShot:d,passEvent:e}),this},unmapHandler:function(a,b,c){if("undefined"==typeof a)throw new Error(1120);if(b=b||"global",c=c||a,this._handlers.hasOwnProperty(a)&&this._handlers[a].hasOwnProperty(b)){var d=this._handlers[a][b];for(var e in d){var f=d[e];if(f.handler===c){d.splice(e,1);break}}}return this},notify:function(a){if("undefined"==typeof a)throw new Error(1130);var b=Array.prototype.slice.call(arguments),c=b.slice(1);if(this._handlers.hasOwnProperty(a)){var d=this._handlers[a];for(var e in d){var f,g=d[e];"global"!==e&&(f=this.getObject(e));var h,i,j=[];for(h=0,i=g.length;i>h;h++){var k,l=g[h];k=f&&"string"==typeof l.handler?f[l.handler]:l.handler,l.oneShot&&j.unshift(h),l.passEvent?k.apply(f,b):k.apply(f,c)}for(h=0,i=j.length;i>h;h++)g.splice(j[h],1)}}return this}},a.dijon=b}(this),"undefined"==typeof utils)var utils={};"undefined"==typeof utils.Math&&(utils.Math={}),utils.Math.to64BitNumber=function(a,b){var c,d,e;return c=new goog.math.Long(0,b),d=new goog.math.Long(a,0),e=c.add(d),e.toNumber()},goog={},goog.math={},goog.math.Long=function(a,b){this.low_=0|a,this.high_=0|b},goog.math.Long.IntCache_={},goog.math.Long.fromInt=function(a){if(a>=-128&&128>a){var b=goog.math.Long.IntCache_[a];if(b)return b}var c=new goog.math.Long(0|a,0>a?-1:0);return a>=-128&&128>a&&(goog.math.Long.IntCache_[a]=c),c},goog.math.Long.fromNumber=function(a){return isNaN(a)||!isFinite(a)?goog.math.Long.ZERO:a<=-goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MIN_VALUE:a+1>=goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MAX_VALUE:0>a?goog.math.Long.fromNumber(-a).negate():new goog.math.Long(a%goog.math.Long.TWO_PWR_32_DBL_|0,a/goog.math.Long.TWO_PWR_32_DBL_|0)},goog.math.Long.fromBits=function(a,b){return new goog.math.Long(a,b)},goog.math.Long.fromString=function(a,b){if(0==a.length)throw Error("number format error: empty string");var c=b||10;if(2>c||c>36)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return goog.math.Long.fromString(a.substring(1),c).negate();if(a.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+a);for(var d=goog.math.Long.fromNumber(Math.pow(c,8)),e=goog.math.Long.ZERO,f=0;f<a.length;f+=8){var g=Math.min(8,a.length-f),h=parseInt(a.substring(f,f+g),c);if(8>g){var i=goog.math.Long.fromNumber(Math.pow(c,g));e=e.multiply(i).add(goog.math.Long.fromNumber(h))}else e=e.multiply(d),e=e.add(goog.math.Long.fromNumber(h))}return e},goog.math.Long.TWO_PWR_16_DBL_=65536,goog.math.Long.TWO_PWR_24_DBL_=1<<24,goog.math.Long.TWO_PWR_32_DBL_=goog.math.Long.TWO_PWR_16_DBL_*goog.math.Long.TWO_PWR_16_DBL_,goog.math.Long.TWO_PWR_31_DBL_=goog.math.Long.TWO_PWR_32_DBL_/2,goog.math.Long.TWO_PWR_48_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_16_DBL_,goog.math.Long.TWO_PWR_64_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_32_DBL_,goog.math.Long.TWO_PWR_63_DBL_=goog.math.Long.TWO_PWR_64_DBL_/2,goog.math.Long.ZERO=goog.math.Long.fromInt(0),goog.math.Long.ONE=goog.math.Long.fromInt(1),goog.math.Long.NEG_ONE=goog.math.Long.fromInt(-1),goog.math.Long.MAX_VALUE=goog.math.Long.fromBits(-1,2147483647),goog.math.Long.MIN_VALUE=goog.math.Long.fromBits(0,-2147483648),goog.math.Long.TWO_PWR_24_=goog.math.Long.fromInt(1<<24),goog.math.Long.prototype.toInt=function(){return this.low_
},goog.math.Long.prototype.toNumber=function(){return this.high_*goog.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},goog.math.Long.prototype.toString=function(a){var b=a||10;if(2>b||b>36)throw Error("radix out of range: "+b);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(goog.math.Long.MIN_VALUE)){var c=goog.math.Long.fromNumber(b),d=this.div(c),e=d.multiply(c).subtract(this);return d.toString(b)+e.toInt().toString(b)}return"-"+this.negate().toString(b)}for(var f=goog.math.Long.fromNumber(Math.pow(b,6)),e=this,g="";;){var h=e.div(f),i=e.subtract(h.multiply(f)).toInt(),j=i.toString(b);if(e=h,e.isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},goog.math.Long.prototype.getHighBits=function(){return this.high_},goog.math.Long.prototype.getLowBits=function(){return this.low_},goog.math.Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:goog.math.Long.TWO_PWR_32_DBL_+this.low_},goog.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(goog.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high_?this.high_:this.low_,b=31;b>0&&0==(a&1<<b);b--);return 0!=this.high_?b+33:b+1},goog.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_},goog.math.Long.prototype.isNegative=function(){return this.high_<0},goog.math.Long.prototype.isOdd=function(){return 1==(1&this.low_)},goog.math.Long.prototype.equals=function(a){return this.high_==a.high_&&this.low_==a.low_},goog.math.Long.prototype.notEquals=function(a){return this.high_!=a.high_||this.low_!=a.low_},goog.math.Long.prototype.lessThan=function(a){return this.compare(a)<0},goog.math.Long.prototype.lessThanOrEqual=function(a){return this.compare(a)<=0},goog.math.Long.prototype.greaterThan=function(a){return this.compare(a)>0},goog.math.Long.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0},goog.math.Long.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.subtract(a).isNegative()?-1:1},goog.math.Long.prototype.negate=function(){return this.equals(goog.math.Long.MIN_VALUE)?goog.math.Long.MIN_VALUE:this.not().add(goog.math.Long.ONE)},goog.math.Long.prototype.add=function(a){var b=this.high_>>>16,c=65535&this.high_,d=this.low_>>>16,e=65535&this.low_,f=a.high_>>>16,g=65535&a.high_,h=a.low_>>>16,i=65535&a.low_,j=0,k=0,l=0,m=0;return m+=e+i,l+=m>>>16,m&=65535,l+=d+h,k+=l>>>16,l&=65535,k+=c+g,j+=k>>>16,k&=65535,j+=b+f,j&=65535,goog.math.Long.fromBits(l<<16|m,j<<16|k)},goog.math.Long.prototype.subtract=function(a){return this.add(a.negate())},goog.math.Long.prototype.multiply=function(a){if(this.isZero())return goog.math.Long.ZERO;if(a.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE))return a.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(a.equals(goog.math.Long.MIN_VALUE))return this.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(goog.math.Long.TWO_PWR_24_)&&a.lessThan(goog.math.Long.TWO_PWR_24_))return goog.math.Long.fromNumber(this.toNumber()*a.toNumber());var b=this.high_>>>16,c=65535&this.high_,d=this.low_>>>16,e=65535&this.low_,f=a.high_>>>16,g=65535&a.high_,h=a.low_>>>16,i=65535&a.low_,j=0,k=0,l=0,m=0;return m+=e*i,l+=m>>>16,m&=65535,l+=d*i,k+=l>>>16,l&=65535,l+=e*h,k+=l>>>16,l&=65535,k+=c*i,j+=k>>>16,k&=65535,k+=d*h,j+=k>>>16,k&=65535,k+=e*g,j+=k>>>16,k&=65535,j+=b*i+c*h+d*g+e*f,j&=65535,goog.math.Long.fromBits(l<<16|m,j<<16|k)},goog.math.Long.prototype.div=function(a){if(a.isZero())throw Error("division by zero");if(this.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE)){if(a.equals(goog.math.Long.ONE)||a.equals(goog.math.Long.NEG_ONE))return goog.math.Long.MIN_VALUE;if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ONE;var b=this.shiftRight(1),c=b.div(a).shiftLeft(1);if(c.equals(goog.math.Long.ZERO))return a.isNegative()?goog.math.Long.ONE:goog.math.Long.NEG_ONE;var d=this.subtract(a.multiply(c)),e=c.add(d.div(a));return e}if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(var f=goog.math.Long.ZERO,d=this;d.greaterThanOrEqual(a);){for(var c=Math.max(1,Math.floor(d.toNumber()/a.toNumber())),g=Math.ceil(Math.log(c)/Math.LN2),h=48>=g?1:Math.pow(2,g-48),i=goog.math.Long.fromNumber(c),j=i.multiply(a);j.isNegative()||j.greaterThan(d);)c-=h,i=goog.math.Long.fromNumber(c),j=i.multiply(a);i.isZero()&&(i=goog.math.Long.ONE),f=f.add(i),d=d.subtract(j)}return f},goog.math.Long.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))},goog.math.Long.prototype.not=function(){return goog.math.Long.fromBits(~this.low_,~this.high_)},goog.math.Long.prototype.and=function(a){return goog.math.Long.fromBits(this.low_&a.low_,this.high_&a.high_)},goog.math.Long.prototype.or=function(a){return goog.math.Long.fromBits(this.low_|a.low_,this.high_|a.high_)},goog.math.Long.prototype.xor=function(a){return goog.math.Long.fromBits(this.low_^a.low_,this.high_^a.high_)},goog.math.Long.prototype.shiftLeft=function(a){if(a&=63,0==a)return this;var b=this.low_;if(32>a){var c=this.high_;return goog.math.Long.fromBits(b<<a,c<<a|b>>>32-a)}return goog.math.Long.fromBits(0,b<<a-32)},goog.math.Long.prototype.shiftRight=function(a){if(a&=63,0==a)return this;var b=this.high_;if(32>a){var c=this.low_;return goog.math.Long.fromBits(c>>>a|b<<32-a,b>>a)}return goog.math.Long.fromBits(b>>a-32,b>=0?0:-1)},goog.math.Long.prototype.shiftRightUnsigned=function(a){if(a&=63,0==a)return this;var b=this.high_;if(32>a){var c=this.low_;return goog.math.Long.fromBits(c>>>a|b<<32-a,b>>>a)}return 32==a?goog.math.Long.fromBits(b,0):goog.math.Long.fromBits(b>>>a-32,0)};var UTF8={};UTF8.encode=function(a){for(var b=[],c=0;c<a.length;++c){var d=a.charCodeAt(c);128>d?b.push(d):2048>d?(b.push(192|d>>6),b.push(128|63&d)):65536>d?(b.push(224|d>>12),b.push(128|63&d>>6),b.push(128|63&d)):(b.push(240|d>>18),b.push(128|63&d>>12),b.push(128|63&d>>6),b.push(128|63&d))}return b},UTF8.decode=function(a){for(var b=[],c=0;c<a.length;){var d=a[c++];128>d||(224>d?(d=(31&d)<<6,d|=63&a[c++]):240>d?(d=(15&d)<<12,d|=(63&a[c++])<<6,d|=63&a[c++]):(d=(7&d)<<18,d|=(63&a[c++])<<12,d|=(63&a[c++])<<6,d|=63&a[c++])),b.push(String.fromCharCode(d))}return b.join("")};var BASE64={};!function(b){var c=function(a){for(var c=0,d=[],e=0|a.length/3;0<e--;){var f=(a[c]<<16)+(a[c+1]<<8)+a[c+2];c+=3,d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push(b.charAt(63&f))}if(2==a.length-c){var f=(a[c]<<16)+(a[c+1]<<8);d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push("=")}else if(1==a.length-c){var f=a[c]<<16;d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push("==")}return d.join("")},d=function(){for(var a=[],c=0;c<b.length;++c)a[b.charCodeAt(c)]=c;return a["=".charCodeAt(0)]=0,a}(),e=function(a){for(var b=0,c=[],e=0|a.length/4;0<e--;){var f=(d[a.charCodeAt(b)]<<18)+(d[a.charCodeAt(b+1)]<<12)+(d[a.charCodeAt(b+2)]<<6)+d[a.charCodeAt(b+3)];c.push(255&f>>16),c.push(255&f>>8),c.push(255&f),b+=4}return c&&("="==a.charAt(b-2)?(c.pop(),c.pop()):"="==a.charAt(b-1)&&c.pop()),c},f={};f.encode=function(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b},f.decode=function(){for(var b=0;b<s.length;++b)a[b]=String.fromCharCode(a[b]);return a.join("")},BASE64.decodeArray=function(a){var b=e(a);return new Uint8Array(b)},BASE64.encodeASCII=function(a){var b=f.encode(a);return c(b)},BASE64.decodeASCII=function(a){var b=e(a);return f.decode(b)},BASE64.encode=function(a){var b=UTF8.encode(a);return c(b)},BASE64.decode=function(a){var b=e(a);return UTF8.decode(b)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),MediaPlayer=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n="1.4.0",o=null,p=!1,q=!1,r=!0,s=!1,t=MediaPlayer.dependencies.BufferController.BUFFER_SIZE_REQUIRED,u=function(){return!!e&&!!f},v=function(){},w=function(){if(!p)throw"MediaPlayer not initialized!";if(!this.capabilities.supportsMediaSource())return void this.errHandler.capabilityError("mediasource");if(!e||!f)throw"Missing view or source.";q=!0,this.debug.log("Playback initiated!"),g=b.getObject("streamController"),g.subscribe(MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED,i),c.subscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,g),c.subscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,i),this[MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED]=v,c.subscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,this),g.initialize(),g.setVideoModel(l),g.setAutoPlay(r),g.setProtectionData(o),m.checkInitialBitrate(),g.load(f),b.mapValue("scheduleWhilePaused",s),b.mapOutlet("scheduleWhilePaused","stream"),b.mapOutlet("scheduleWhilePaused","scheduleController"),b.mapValue("bufferMax",t),b.mapOutlet("bufferMax","bufferController"),h.initialize()},x=function(){u()&&w.call(this)},y=function(){var a=k.getReadOnlyMetricsFor(CL.configs.tracks.video.length>0?"video":"audio");return j.getCurrentDVRInfo(a)},z=function(){return y.call(this).manifestInfo.DVRWindowSize},A=function(a){var b,c=y.call(this);return void 0!==c&&null!==c&&void 0!==c.range&&null!==c.range?(b=c.range.start+a,b>c.range.end&&(b=c.range.end)):b=a,b},B=function(a){CL.configs.isLive===!0&&(CL.configs.minStartTime=null),null!=CL.configs.minStartTime&&a<CL.configs.minStartTime&&(a=CL.configs.minStartTime),a=this.getDVRSeekOffset(a),this.getVideoModel().setCurrentTime(a)},C=function(){var a=y.call(this);return null===a?0:this.duration()-(a.range.end-a.time)},D=function(){var a,b=y.call(this);if(null===b){var c=0;try{void 0!==l&&null!=l&&void 0!==l.getElement()&&null!=l.getElement()&&(c=l.getElement().duration)}catch(d){}return c}return a=b.range.end-b.range.start,a<b.manifestInfo.DVRWindowSize?a:b.manifestInfo.DVRWindowSize},E=function(a){var b,c,d=y.call(this);return null===d?0:(b=d.manifestInfo.availableFrom.getTime()/1e3,c=a+(b+d.range.start))},F=function(){return E.call(this,this.time())},G=function(){return E.call(this,this.duration())},H=function(a,b,c){var d=new Date(1e3*a),e=d.toLocaleDateString(b),f=d.toLocaleTimeString(b,{hour12:c});return f+" "+e},I=function(a){a=Math.max(a,0);var b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.floor(a%3600%60);return(0===b?"":10>b?"0"+b.toString()+":":b.toString()+":")+(10>c?"0"+c.toString():c.toString())+":"+(10>d?"0"+d.toString():d.toString())},J=function(a,b,c){b&&void 0!==a&&null!==a&&(c?h.setRules(a,b):h.addRules(a,b))},K=function(){q&&g&&(g.unsubscribe(MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED,i),c.unsubscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,g),c.unsubscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,i),g.reset(),d.reset(),h.reset(),g=null,q=!1)},L=function(a){for(var b in a){var c=a[b];if("ABRParameters"!==b&&"customHeaders"!==b)CL.manifest[b]=c,"debug"==b&&(CL.configs.debug=c);else for(var d in c){var e=c[d];CL.manifest[b][d]=e}}},M=function(a){var b=a.toLowerCase(),c=CL.configs.element?CL.configs.element:document.querySelector("video");CL.configs.keyRequests=[],CL.configs.activeTrack=[],MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME=CL.manifest.ABRParameters.minBufferLength||MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME,MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD=void 0!==CL.manifest.ABRParameters.minBufferLength?CL.manifest.ABRParameters.minBufferLength/2:MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD,(1==CL.manifest.isSmoothStreaming||(b.indexOf(".ism")>-1||b.indexOf("ism/Manifest")>-1)&&-1==b.indexOf("format=mpd")&&-1==b.indexOf(".mpd"))&&(CL.configs.isSmoothStreaming=!0),CL.manifest.url=a,CL.manifest.activeDRM="unprotected",CL.manifest.customDataEncoded=BASE64.encode(JSON.stringify(CL.manifest.customData));var d,e=[],f=new MediaPlayer.vo.protection.ProtectionData;if(f.laURL=CL.manifest.widevineLicenseServerURL,f.httpRequestHeaders=[],CL.manifest.sendCustomData===!0&&(f.httpRequestHeaders["dt-custom-data"]=CL.manifest.customDataEncoded),null!=CL.manifest.authenticationToken&&""!=CL.manifest.authenticationToken&&(f.httpRequestHeaders["x-dt-auth-token"]=CL.manifest.authenticationToken),void 0!==CL.manifest.customHeaders&&void 0!==CL.manifest.customHeaders.licenseRequest)for(d in CL.manifest.customHeaders.licenseRequest)f.httpRequestHeaders[d]=CL.manifest.customHeaders.licenseRequest[d];e["com.widevine.alpha"]=f,this.attachProtectionData(e),f=new MediaPlayer.vo.protection.ProtectionData,f.laURL=CL.manifest.playReadyLicenseServerURL,f.httpRequestHeaders=[],CL.manifest.sendCustomData===!0&&(f.httpRequestHeaders["http-header-CustomData"]=CL.manifest.customDataEncoded),null!=CL.manifest.authenticationToken&&""!=CL.manifest.authenticationToken&&(f.httpRequestHeaders["x-dt-auth-token"]=CL.manifest.authenticationToken),e["com.microsoft.playready"]=f,e["com.youtube.playready"]=f,this.attachProtectionData(e),p&&this.reset(),c.autoplay=CL.manifest.autoplay,this.startup(),this.setInitialBitrateFor("video",100),this.setInitialBitrateFor("audio",1),this.setAutoPlay(CL.manifest.autoplay),this.attachView(c),this.attachSource(a)},N=function(a){a?O("text",CL.configs.activeTrack.text.id):g.disableTextTracks()},O=function(a,b){CL.configs.debug&&console.log("Setting active "+a+" track to id "+b);for(var c,d=0;d<CL.configs.tracks[a].length;d++)if(c=CL.configs.tracks[a][d],c.id==b){var e=JSON.parse(JSON.stringify(c));return CL.configs.activeTrack[a]=e,CL.manifest.useLookAheadFragments===!0&&(CL.configs.needManifestUpdate=!0),void g.update(a)}CL.configs.debug&&console.log("Could not switch to "+a+" track "+b+", id unknown.")},P=function(a){if("text"!=a&&"audio"!=a)throw"Cannot get available tracks for unknown type "+a+". Valid types are 'audio' and 'text'.";return CL.configs.tracks[a]},Q=dijon.System.prototype.getObject;dijon.System.prototype.getObject=function(a){var b=Q.call(this,a);return"object"!=typeof b||b.getName||(b.getName=function(){return a},b.setMediaType=function(a){b.mediaType=a},b.getMediaType=function(){return b.mediaType}),b},b=new dijon.System,b.mapValue("system",b),b.mapOutlet("system"),b.injectInto(a);var R=a.config?a.config:{},S=a.system.getObject("debug");CL.configs.element?CL.configs.element:document.querySelector("video"),this.currentTime=0,this.duration=0;var T=!1,U=function(){g.pause()},V=function(){g.play()},W=function(){T=!0,g.reset()},X=function(){return T},L=function(a){for(var b in a){var c=a[b];if("ABRParameters"!==b&&"customHeaders"!==b)CL.manifest[b]=c,"debug"==b&&(CL.configs.debug=c,S.setLogToBrowserConsole(CL.configs.debug));else for(var d in c){var e=c[d];CL.manifest[b][d]=e}}};R&&L(R),CL.manifest.disableChromecastSupport===!0&&(CL.configs.isChromecast=!1);var Y={notifier:void 0,debug:void 0,eventBus:void 0,capabilities:void 0,adapter:void 0,errHandler:void 0,uriQueryFragModel:void 0,videoElementExt:void 0,getABRController:function(){return d},setup:function(){j=b.getObject("metricsExt"),c=b.getObject("manifestLoader"),i=b.getObject("manifestUpdater"),d=b.getObject("abrController"),h=b.getObject("rulesController"),k=b.getObject("metricsModel"),m=b.getObject("DOMStorage")},addEventListener:function(a,b,c){this.eventBus.addEventListener(a,b,c)},removeEventListener:function(a,b,c){this.eventBus.removeEventListener(a,b,c)},getVersion:function(){return n},startup:function(){p||(b.injectInto(this),p=!0)},getDebug:function(){return this.debug},getVideoModel:function(){var a=g?g.getActiveStreamInfo():null,b=a?g.getStreamById(a.id):null;return b?b.getVideoModel():l},enableLastBitrateCaching:function(a,b){m.enableLastBitrateCaching(a,b)},setMaxAllowedBitrateFor:function(a,b){d.setMaxAllowedBitrateFor(a,b)},getMaxAllowedBitrateFor:function(a){return d.getMaxAllowedBitrateFor(a)},setAutoPlay:function(a){r=a},getAutoPlay:function(){return r},setScheduleWhilePaused:function(a){s=a},getScheduleWhilePaused:function(){return s},setBufferMax:function(a){t=a},getBufferMax:function(){return t},getMetricsExt:function(){return j},getMetricsFor:function(a){return k.getReadOnlyMetricsFor(a)},getQualityFor:function(a){return d.getQualityFor(a,g.getActiveStreamInfo())},setQualityFor:function(a,b){d.setPlaybackQuality(a,g.getActiveStreamInfo(),b)},getBitrateInfoListFor:function(a){var b=g.getActiveStreamInfo(),c=g.getStreamById(b.id);return c.getBitrateListFor(a)},setInitialBitrateFor:function(a,b){d.setInitialBitrateFor(a,b)},getInitialBitrateFor:function(a){return d.getInitialBitrateFor(a)},getAutoSwitchQuality:function(){return d.getAutoSwitchBitrate()},setAutoSwitchQuality:function(a){d.setAutoSwitchBitrate(a)},setSchedulingRules:function(a){J.call(this,h.SCHEDULING_RULE,a,!0)},addSchedulingRules:function(a){J.call(this,h.SCHEDULING_RULE,a,!1)},setABRRules:function(a){J.call(this,h.ABR_RULE,a,!0)},addABRRules:function(a){J.call(this,h.ABR_RULE,a,!1)},attachView:function(a){if(!p)throw"MediaPlayer not initialized!";e=a,l=null,e&&(l=b.getObject("videoModel"),l.setElement(e)),K.call(this),u.call(this)&&x.call(this)},attachSource:function(a){if(!p)throw"MediaPlayer not initialized!";this.uriQueryFragModel.reset(),f=this.uriQueryFragModel.parseURI(a),K.call(this),u.call(this)&&x.call(this)},attachProtectionData:function(a){o=a},reset:function(){this.attachSource(null),this.attachView(null)},play:w,isReady:u,seek:B,time:C,duration:D,timeAsUTC:F,durationAsUTC:G,getDVRWindowSize:z,getDVRSeekOffset:A,formatUTC:H,convertToTimeCode:I,enableSubtitles:N,setActiveTrack:O,getAvailableTracks:P,loadVideo:M,isDone:X,setConfig:L,pause:U,resume:V,end:W};return CL.configs.isChromecast&&(window.self.firstPlayback=!0,window.self.player=Y,window.self.config=R,loadScript("//www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js",initChromecastReceiver,this)),S.setLogToBrowserConsole(CL.configs.debug),Y},MediaPlayer.prototype={constructor:MediaPlayer},MediaPlayer.dependencies={},MediaPlayer.dependencies.protection={},MediaPlayer.utils={},MediaPlayer.models={},MediaPlayer.vo={},MediaPlayer.vo.metrics={},MediaPlayer.vo.protection={},MediaPlayer.rules={},MediaPlayer.di={},MediaPlayer.events={METRICS_CHANGED:"metricschanged",METRIC_CHANGED:"metricchanged",METRIC_UPDATED:"metricupdated",METRIC_ADDED:"metricadded",MANIFEST_LOADED:"manifestloaded",SWITCH_STREAM:"streamswitched",STREAM_INITIALIZED:"streaminitialized",TEXT_TRACK_ADDED:"texttrackadded",BUFFER_LOADED:"bufferloaded",BUFFER_EMPTY:"bufferstalled",ERROR:"error",LOG:"log"},MediaPlayer.di.Context=function(){"use strict";var a=function(){var a=document.createElement("video");if(MediaPlayer.models.ProtectionModel_21Jan2015.detect(a))this.system.mapClass("protectionModel",MediaPlayer.models.ProtectionModel_21Jan2015);else if(MediaPlayer.models.ProtectionModel_3Feb2014.detect(a))this.system.mapClass("protectionModel",MediaPlayer.models.ProtectionModel_3Feb2014);else if(MediaPlayer.models.ProtectionModel_01b.detect(a))this.system.mapClass("protectionModel",MediaPlayer.models.ProtectionModel_01b);else{var b=this.system.getObject("debug");b.log("No supported version of EME detected on this user agent!"),b.log("Attempts to play encrypted content will fail!")}};return{system:void 0,setup:function(){this.system.autoMapOutlets=!0,this.system.mapSingleton("debug",MediaPlayer.utils.Debug),this.system.mapSingleton("eventBus",MediaPlayer.utils.EventBus),this.system.mapSingleton("capabilities",MediaPlayer.utils.Capabilities),this.system.mapSingleton("DOMStorage",MediaPlayer.utils.DOMStorage),this.system.mapClass("customTimeRanges",MediaPlayer.utils.CustomTimeRanges),this.system.mapSingleton("textTrackExtensions",MediaPlayer.utils.TextTrackExtensions),this.system.mapSingleton("vttParser",MediaPlayer.utils.VTTParser),this.system.mapSingleton("ttmlParser",MediaPlayer.utils.TTMLParser),this.system.mapClass("videoModel",MediaPlayer.models.VideoModel),this.system.mapSingleton("manifestModel",MediaPlayer.models.ManifestModel),this.system.mapSingleton("metricsModel",MediaPlayer.models.MetricsModel),this.system.mapSingleton("uriQueryFragModel",MediaPlayer.models.URIQueryAndFragmentModel),this.system.mapSingleton("ksPlayReady",MediaPlayer.dependencies.protection.KeySystem_PlayReady),this.system.mapSingleton("ksWidevine",MediaPlayer.dependencies.protection.KeySystem_Widevine),this.system.mapSingleton("ksClearKey",MediaPlayer.dependencies.protection.KeySystem_ClearKey),this.system.mapSingleton("requestModifierExt",MediaPlayer.dependencies.RequestModifierExtensions),this.system.mapSingleton("textSourceBuffer",MediaPlayer.dependencies.TextSourceBuffer),this.system.mapSingleton("mediaSourceExt",MediaPlayer.dependencies.MediaSourceExtensions),this.system.mapSingleton("sourceBufferExt",MediaPlayer.dependencies.SourceBufferExtensions),this.system.mapSingleton("abrController",MediaPlayer.dependencies.AbrController),this.system.mapSingleton("errHandler",MediaPlayer.dependencies.ErrorHandler),this.system.mapSingleton("videoExt",MediaPlayer.dependencies.VideoModelExtensions),this.system.mapSingleton("protectionExt",MediaPlayer.dependencies.ProtectionExtensions),this.system.mapClass("protectionController",MediaPlayer.dependencies.ProtectionController),this.system.mapClass("playbackController",MediaPlayer.dependencies.PlaybackController),a.call(this),this.system.mapSingleton("liveEdgeFinder",MediaPlayer.dependencies.LiveEdgeFinder),this.system.mapClass("metrics",MediaPlayer.models.MetricsList),this.system.mapClass("insufficientBufferRule",MediaPlayer.rules.InsufficientBufferRule),this.system.mapClass("bufferOccupancyRule",MediaPlayer.rules.BufferOccupancyRule),this.system.mapClass("throughputRule",MediaPlayer.rules.ThroughputRule),this.system.mapClass("droppedFramesRule",MediaPlayer.rules.DroppedFramesRule),this.system.mapSingleton("abrRulesCollection",MediaPlayer.rules.ABRRulesCollection),this.system.mapSingleton("rulesController",MediaPlayer.rules.RulesController),this.system.mapClass("bufferLevelRule",MediaPlayer.rules.BufferLevelRule),this.system.mapClass("pendingRequestsRule",MediaPlayer.rules.PendingRequestsRule),this.system.mapClass("playbackTimeRule",MediaPlayer.rules.PlaybackTimeRule),this.system.mapClass("sameTimeRequestRule",MediaPlayer.rules.SameTimeRequestRule),this.system.mapSingleton("scheduleRulesCollection",MediaPlayer.rules.ScheduleRulesCollection),this.system.mapClass("liveEdgeBinarySearchRule",MediaPlayer.rules.LiveEdgeBinarySearchRule),this.system.mapClass("liveEdgeWithTimeSynchronizationRule",MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule),this.system.mapSingleton("synchronizationRulesCollection",MediaPlayer.rules.SynchronizationRulesCollection),this.system.mapClass("streamProcessor",MediaPlayer.dependencies.StreamProcessor),this.system.mapClass("eventController",MediaPlayer.dependencies.EventController),this.system.mapClass("textController",MediaPlayer.dependencies.TextController),this.system.mapClass("bufferController",MediaPlayer.dependencies.BufferController),this.system.mapSingleton("manifestLoader",MediaPlayer.dependencies.ManifestLoader),this.system.mapSingleton("manifestUpdater",MediaPlayer.dependencies.ManifestUpdater),this.system.mapClass("fragmentController",MediaPlayer.dependencies.FragmentController),this.system.mapClass("fragmentLoader",MediaPlayer.dependencies.FragmentLoader),this.system.mapClass("fragmentModel",MediaPlayer.dependencies.FragmentModel),this.system.mapSingleton("streamController",MediaPlayer.dependencies.StreamController),this.system.mapClass("stream",MediaPlayer.dependencies.Stream),this.system.mapClass("scheduleController",MediaPlayer.dependencies.ScheduleController),this.system.mapSingleton("timeSyncController",MediaPlayer.dependencies.TimeSyncController),this.system.mapSingleton("notifier",MediaPlayer.dependencies.Notifier)}}},Dash=function(){"use strict";return{modules:{},dependencies:{},vo:{},di:{}}}(),Dash.di.DashContext=function(){"use strict";return{system:void 0,setup:function(){Dash.di.DashContext.prototype.setup.call(this),this.system.mapClass("parser",Dash.dependencies.DashParser),this.system.mapClass("indexHandler",Dash.dependencies.DashHandler),this.system.mapSingleton("baseURLExt",Dash.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",Dash.dependencies.FragmentExtensions),this.system.mapClass("trackController",Dash.dependencies.RepresentationController),this.system.mapSingleton("manifestExt",Dash.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",Dash.dependencies.DashMetricsExtensions),this.system.mapSingleton("timelineConverter",Dash.dependencies.TimelineConverter),this.system.mapSingleton("adapter",Dash.dependencies.DashAdapter)}}},Dash.di.DashContext.prototype=new MediaPlayer.di.Context,Dash.di.DashContext.prototype.constructor=Dash.di.DashContext,Dash.dependencies.DashAdapter=function(){"use strict";var a=[],b={},c=function(a,b){return b.getRepresentationForQuality(a.quality)},d=function(a){return b[a.streamInfo.id][a.index]},e=function(b){var c,d=a.length,e=0;for(e;d>e;e+=1)if(c=a[e],b.id===c.id)return c;return null},f=function(a){var b=new MediaPlayer.vo.TrackInfo,c=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index],d=this.manifestExt.getRepresentationFor(a.index,c);return b.id=a.id,b.quality=a.index,b.bandwidth=this.manifestExt.getBandwidth(d),b.DVRWindow=a.segmentAvailabilityRange,b.fragmentDuration=a.segmentDuration||(a.segments&&a.segments.length>0?a.segments[0].duration:0/0),b.MSETimeOffset=a.MSETimeOffset,b.useCalculatedLiveEdgeTime=a.useCalculatedLiveEdgeTime,b.mediaInfo=g.call(this,a.adaptation),b},g=function(a){var b=new MediaPlayer.vo.MediaInfo,c=this,d=a.period.mpd.manifest.Period_asArray[a.period.index].AdaptationSet_asArray[a.index];return b.id=a.id,b.index=a.index,b.type=a.type,b.streamInfo=h.call(this,a.period),b.trackCount=this.manifestExt.getRepresentationCount(d),b.lang=this.manifestExt.getLanguageForAdaptation(d),b.codec=this.manifestExt.getCodec(d),b.mimeType=this.manifestExt.getMimeType(d),b.contentProtection=this.manifestExt.getContentProtectionData(d),b.bitrateList=this.manifestExt.getBitrateListForAdaptation(d),(b.contentProtection||CL.manifest.generatePSSH===!0&&void 0!==CL.manifest.keyId&&null!==CL.manifest.keyId)&&(CL.configs.isProtected=!0,void 0!==b.contentProtection&&null!==b.contentProtection||CL.manifest.generatePSSH!==!0||void 0===CL.manifest.keyId||null===CL.manifest.keyId||(b.contentProtection=[{KID:CL.manifest.keyId,"cenc:default_KID":CL.manifest.keyId,schemeIdUri:"urn:mpeg:dash:mp4protection:2011",value:"cenc"}]),b.contentProtection.forEach(function(a){a.KID=c.manifestExt.getKID(a)})),b.isText=this.manifestExt.getIsTextTrack(b.mimeType),b},h=function(a){var b=new MediaPlayer.vo.StreamInfo,c=1;return b.id=a.id,b.index=a.index,b.start=a.start,b.duration=a.duration,b.manifestInfo=i.call(this,a.mpd),b.isLast=Math.abs(b.start+b.duration-b.manifestInfo.duration)<c,b},i=function(a){var b=new MediaPlayer.vo.ManifestInfo,c=this.manifestModel.getValue();return b.DVRWindowSize=a.timeShiftBufferDepth,b.loadedTime=a.manifest.loadedTime,b.availableFrom=a.availabilityStartTime,b.minBufferTime=a.manifest.minBufferTime,b.maxFragmentDuration=a.maxSegmentDuration,b.duration=this.manifestExt.getDuration(c),b.isDynamic=this.manifestExt.getIsDynamic(c),b},j=function(a,c,d){var f,h=e(c),i=h.id,j=this.manifestExt.getAdaptationForType(a,c.index,d);return j?(f=this.manifestExt.getIndexForAdaptation(j,a,c.index),b[i]=b[i]||this.manifestExt.getAdaptationsForPeriod(a,h),g.call(this,b[i][f])):null},k=function(a,c,d){var f,h,i,j,k=e(c),l=k.id,m=this.manifestExt.getAdaptationsForType(a,c.index,d),n=this;if(n.capabilities=new MediaPlayer.utils.Capabilities,h=document.querySelector("video"),!m)return null;(d.indexOf("text")>-1||d.indexOf("ttml")>-1)&&(d="text");var o=[];CL.configs.tracks[d]=[];var p=0;for(i=0;i<m.length;i++){f=this.manifestExt.getIndexForAdaptation(m[i],a,c.index),b[l]=b[l]||this.manifestExt.getAdaptationsForPeriod(a,k);var q=g.call(this,b[l][f]),r="text"===d?q.mimeType:q.codec;if(n.capabilities.supportsCodec(h,r)){o.push(q);var s={name:m[i].lang,lang:m[i].lang,id:p,adaptionIndex:f,representations:m[i].Representation_asArray};if("text"===d&&(s.lang=m[i].lang,s.src=m[i].Representation_asArray[0].BaseURL,s.subType=m[i].subType?m[i].subType:"subt",s.trackName=m[i].name?m[i].name:m[i].lang,s.mimeType=m[i].mimeType,m[i].SegmentTemplate&&m[i].SegmentTemplate_asArray.length>0)){s.timescale=m[i].SegmentTemplate_asArray[0].timescale,s.sources=[];var t,u,v=(s.src,m[i].SegmentTemplate_asArray[0].media),w=0,x=0,y=m[i].SegmentTemplate_asArray[0].SegmentTimeline_asArray[0].S_asArray;v=s.src.replace("$Bandwidth$",m[i].Representation_asArray[0].bandwidth);var z,A="";for(var B in CL.configs.customAttributes[m[i].Representation_asArray[0].id])z=CL.configs.customAttributes[m[i].Representation_asArray[0].id][B],A+=z.Name+"="+z.Value+",";for(A.length>0&&(A=A.substring(0,A.length-1),v=v.replace("$CustomAttributes$",A)),j=0;j<y.length;j++)t=y[j],t.t&&(w=t.t,m[i].SegmentTemplate_asArray[0].presentationTimeOffset&&(x=m[i].SegmentTemplate_asArray[0].presentationTimeOffset)),u={src:v.replace("$Time$",w),startTime:w-x},s.sources.push(u),w+=t.d;delete s.src}CL.configs.tracks[d][s.id]=s,p++}}return null==CL.configs.activeTrack[d]&&"text"!=d&&(CL.configs.activeTrack[d]=CL.configs.tracks[d][0],CL.configs.previousActiveTrack[d]=CL.configs.tracks[d][0]),o},l=function(c){var d,e,f,g=[];if(!c)return null;for(d=this.manifestExt.getMpd(c),a=this.manifestExt.getRegularPeriods(c,d),b={},e=a.length,f=0;e>f;f+=1)g.push(h.call(this,a[f]));return g},m=function(a){var b=this.manifestExt.getMpd(a);return i.call(this,b)},n=function(a,b){var c=a.trackController.getRepresentationForQuality(b);return a.indexHandler.getInitRequest(c)},o=function(a,b){var d=c(b,a.trackController);return a.indexHandler.getNextSegmentRequest(d)},p=function(a,b,d,e){var f=c(b,a.trackController);return a.indexHandler.getSegmentRequestForTime(f,d,e)},q=function(a,b,d){var e=c(b,a.trackController);return a.indexHandler.generateSegmentRequestForTime(e,d)},r=function(a){return a.indexHandler.getCurrentTime()},s=function(a,b){return a.indexHandler.setCurrentTime(b)},t=function(a){var b,c,f=e(a.getStreamInfo()),g=a.getMediaInfo(),h=d(g),i=this.manifestModel.getValue(),j=a.getType();(j.indexOf("text")>-1||j.indexOf("ttml")>-1)&&(j="text"),b=g.id,c=b?this.manifestExt.getAdaptationForId(b,i,f.index):this.manifestExt.getAdaptationForIndex(g.index,i,f.index),a.setMediaInfo(g),a.trackController.updateData(c,h,j)},u=function(a,b){var c=a.getRepresentationForQuality(b);return c?f.call(this,c):null},v=function(a){var b=a.getCurrentRepresentation();return b?f.call(this,b):null},w=function(a,b,c){var d=new Dash.vo.Event,e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=c*g+h;return b[e]?(d.eventStream=b[e],d.eventStream.value=f,d.eventStream.timescale=g,d.duration=i,d.id=j,d.presentationTime=l,d.messageData=k,d.presentationTimeDelta=h,d):null},x=function(a,b){var f=this.manifestModel.getValue(),g=[];return a instanceof MediaPlayer.vo.StreamInfo?g=this.manifestExt.getEventsForPeriod(f,e(a)):a instanceof MediaPlayer.vo.MediaInfo?g=this.manifestExt.getEventStreamForAdaptationSet(f,d(a)):a instanceof MediaPlayer.vo.TrackInfo&&(g=this.manifestExt.getEventStreamForRepresentation(f,c(a,b.trackController))),g};return{system:void 0,manifestExt:void 0,manifestModel:void 0,timelineConverter:void 0,metricsList:{TCP_CONNECTION:"TcpConnection",HTTP_REQUEST:"HttpRequest",HTTP_REQUEST_TRACE:"HttpRequestTrace",TRACK_SWITCH:"RepresentationSwitch",BUFFER_LEVEL:"BufferLevel",BUFFER_STATE:"BufferState",DVR_INFO:"DVRInfo",DROPPED_FRAMES:"DroppedFrames",SCHEDULING_INFO:"SchedulingInfo",MANIFEST_UPDATE:"ManifestUpdate",MANIFEST_UPDATE_STREAM_INFO:"ManifestUpdatePeriodInfo",MANIFEST_UPDATE_TRACK_INFO:"ManifestUpdateRepresentationInfo",PLAY_LIST:"PlayList",PLAY_LIST_TRACE:"PlayListTrace"},convertDataToTrack:f,convertDataToMedia:g,convertDataToStream:h,getDataForTrack:c,getDataForMedia:d,getDataForStream:e,getStreamsInfo:l,getManifestInfo:m,getMediaInfoForType:j,getMediaInfosForType:k,getCurrentTrackInfo:v,getTrackInfoForQuality:u,updateData:t,getInitRequest:n,getNextFragmentRequest:o,getFragmentRequestForTime:p,generateFragmentRequestForTime:q,getIndexHandlerTime:r,setIndexHandlerTime:s,getEventsFor:x,getEvent:w,reset:function(){a=[],b={}
}}},Dash.dependencies.DashAdapter.prototype={constructor:Dash.dependencies.DashAdapter},Dash.create=function(a,b,c){if("undefined"==typeof a||"VIDEO"!=a.nodeName)return null;var d,e=a.id||a.name||"video element";return c=c||new Dash.di.DashContext,b=b||[].slice.call(a.querySelectorAll("source")).filter(function(a){return a.type==Dash.supportedManifestMimeTypes.mimeType})[0],d=new MediaPlayer(c),d.startup(),d.attachView(a),d.setAutoPlay(a.autoplay),d.attachSource(b.src),d.getDebug().log("Converted "+e+" to dash.js player and added content: "+b.src),d},Dash.createAll=function(a,b,c){var d=[];a=a||".dashjs-player",b=b||document,c=c||new Dash.di.DashContext;for(var e=b.querySelectorAll(a),f=0;f<e.length;f++){var g=Dash.create(e[f],void 0,c);d.push(g)}return d},Dash.supportedManifestMimeTypes={mimeType:"application/dash+xml"},Dash.dependencies.DashHandler=function(){"use strict";var a,b,c,d=-1,e=0,f=new RegExp("^(?:(?:[a-z]+:)?/)?/","i"),g=function(a,b){for(;a.length<b;)a="0"+a;return a},h=function(a,b,c){for(var d,e,f,h,i=0,j=0,k=b.length,l="%0",m=l.length;;){if(i=a.indexOf("$"+b),0>i)return a;if(j=a.indexOf("$",i+k),0>j)return a;if(d=a.indexOf(l,i+k),d>i&&j>d)switch(e=a.charAt(j-1),f=parseInt(a.substring(d+m,j-1),10),e){case"d":case"i":case"u":h=g(c.toString(),f);break;case"x":h=g(c.toString(16),f);break;case"X":h=g(c.toString(16),f).toUpperCase();break;case"o":h=g(c.toString(8),f);break;default:return this.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),a}else h=c;a=a.substring(0,i)+h+a.substring(j+1)}},i=function(a){return a.split("$$").join("$")},j=function(a,b){if(null===b||-1===a.indexOf("$RepresentationID$"))return a;var c=b.toString();return a.split("$RepresentationID$").join(c)},k=function(a,b){return a.representation.startNumber+b},l=function(a,b){var c,d=b.adaptation.period.mpd.manifest.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index].Representation_asArray[b.index].BaseURL;return c=a===d?a:f.test(a)?a:d+a},m=function(a,c){var d,e,f=this,g=new MediaPlayer.vo.FragmentRequest;return d=a.adaptation.period,g.mediaType=c,g.type="Initialization Segment",-1==a.initialization?(g.url="",g.range=-1):(g.url=l(a.initialization,a),g.range=a.range),e=d.start,g.availabilityStartTime=f.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(e,a.adaptation.period.mpd,b),g.availabilityEndTime=f.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(e+d.duration,d.mpd,b),g.quality=a.index,g},n=function(a){var b,d=this;return a?b=m.call(d,a,c):null},o=function(a){var c,e,f,g=a.adaptation.period,h=!1;return b?h=!1:0>d?h=!1:d<a.availableSegmentsNumber?(e=B(d,a),e&&(f=e.presentationStartTime-g.start,c=a.adaptation.period.duration,this.log(a.segmentInfoType+": "+f+" / "+c),h=f>=c)):h=!0,h},p=function(a,c){var d,e,f,g,h=this;return e=a.segmentDuration,isNaN(e)&&(e=a.adaptation.period.duration),f=a.adaptation.period.start+c*e,g=f+e,d=new Dash.vo.Segment,d.representation=a,d.duration=e,d.presentationStartTime=f,d.mediaStartTime=h.timelineConverter.calcMediaTimeFromPresentationTime(d.presentationStartTime,a),d.availabilityStartTime=h.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(d.presentationStartTime,a.adaptation.period.mpd,b),d.availabilityEndTime=h.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(g,a.adaptation.period.mpd,b),d.wallStartTime=h.timelineConverter.calcWallTimeForSegment(d,b),d.replacementNumber=k(d,c),d.availabilityIdx=c,d},q=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,v=b.adaptation.period.mpd.manifest.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index].Representation_asArray[b.index].SegmentTemplate,w=v.SegmentTimeline,x=b.availableSegmentsNumber>0,y=10,z=[],A=0,B=0,C=-1,D=function(a){return u.call(s,b,A,a.d,p,v.media,a.mediaRange,C)};p=b.timescale,c=w.S_asArray,k=t.call(s,b),k?(n=k.start,o=k.end):m=s.timelineConverter.calcMediaTimeFromPresentationTime(a||0,b);var E=0;for(e=0,f=c.length;f>e;e+=1)if(d=c[e],h=0,d.hasOwnProperty("r")&&(h=d.r),d.hasOwnProperty("t")&&(0===e&&d.t>0&&CL.configs.isLive===!1&&isNaN(v.presentationTimeOffset)&&CL.configs.wasLive===!1&&(E=d.t,CL.configs.ssTimeOffset[b.adaptation.type]=E,CL.configs.ssTimeOffsetTimescale[b.adaptation.type]=p,CL.configs.minStartTime=.1),A=d.t-E,B=A/p),0===e&&(q=B),0>h&&(j=c[e+1],j&&j.hasOwnProperty("t")?i=j.t/p:(i=s.timelineConverter.calcMediaTimeFromPresentationTime(b.segmentAvailabilityRange.end,b),b.segmentDuration=d.d/p),h=Math.ceil((i-B)/(d.d/p))-1),l){if(x)break;C+=h+1}else for(g=0;h>=g;g+=1){if(C+=1,k){if(C>o){if(l=!0,x)break;continue}C>=n&&z.push(D.call(s,d))}else{if(z.length>y){if(l=!0,x)break;continue}B>=m-d.d/p&&z.push(D.call(s,d))}A+=d.d,B=A/p,r=B}return x||(b.availableSegmentsNumber=C+1),z},r=function(a){var c,d,e,f,g,i=[],j=this,k=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].SegmentTemplate,l=a.segmentDuration,m=a.segmentAvailabilityRange,n=null,o=null;for(g=a.startNumber,c=isNaN(l)&&!b?{start:g,end:g}:s.call(j,a),e=c.start,f=c.end,d=e;f>=d;d+=1)n=p.call(j,a,d),n.replacementTime=(g+d-1)*a.segmentDuration,o=k.media,o=h(o,"Number",n.replacementNumber),o=h(o,"Time",n.replacementTime),n.media=o,i.push(n),n=null;return a.availableSegmentsNumber=isNaN(l)?1:Math.ceil((m.end-m.start)/l),i},s=function(c){var e,f,g,h=this,i=c.segmentDuration,j=c.adaptation.period.mpd.manifest.minBufferTime,k=c.segmentAvailabilityRange,l={start:h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,k.start),end:h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,k.end)},m=0/0,n=null,o=c.segments,p=2*i,q=Math.max(2*j,c.segmentAvailabilityRange.end);return l||(l=h.timelineConverter.calcSegmentAvailabilityRange(c,b)),b&&!h.timelineConverter.isTimeSyncCompleted()?(e=Math.floor(l.start/i),f=Math.floor(l.end/i),g={start:e,end:f}):(o&&o.length>0?(n=B(d,c),m=n?h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,n.presentationStartTime):d>0?d*i:h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,a||o[0].presentationStartTime)):m=d>0?d*i:b?l.end:l.start,e=Math.floor(Math.max(m-p,l.start)/i),f=Math.floor(Math.min(e+q/i,l.end/i)),g={start:e,end:f})},t=function(){var c,e,f,g=2,h=10,i=0,j=Number.POSITIVE_INFINITY;return b&&!this.timelineConverter.isTimeSyncCompleted()?f={start:i,end:j}:!b&&a||0>d?null:(c=Math.max(d-g,i),e=Math.min(d+h,j),f={start:c,end:e})},u=function(a,c,d,e,f,g,i){var j,l,m,n,o=this,p=c/e,q=Math.min(d/e,a.adaptation.period.mpd.maxSegmentDuration);j=o.timelineConverter.calcPresentationTimeFromMediaTime(p,a),l=j+q,m=new Dash.vo.Segment,m.representation=a,m.duration=q,m.mediaStartTime=p,m.presentationStartTime=j,m.availabilityStartTime=a.adaptation.period.mpd.manifest.loadedTime,m.availabilityEndTime=o.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(l,a.adaptation.period.mpd,b),m.wallStartTime=o.timelineConverter.calcWallTimeForSegment(m,b),n=CL.configs.ssTimeOffset[void 0!=CL.configs.ssTimeOffset[m.representation.adaptation.id]?m.representation.adaptation.id:m.representation.adaptation.type],m.replacementTime=c+(void 0!=n?n:0);var r=m.replacementTime;return CL.configs.useBigInt===!0&&r<CL.configs.bigIntOffset&&(r=bigInt(m.replacementTime).plus(CL.configs.bigIntOffset).toString()),m.replacementNumber=k(m,i),f=h(f,"Number",m.replacementNumber),f=h(f,"Time",r),m.media=f,m.mediaRange=g,m.availabilityIdx=i,m},v=function(a){var b,c,d,e,f,g,h,i=this,j=[],k=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].SegmentList,l=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].BaseURL,m=k.SegmentURL_asArray.length;for(h=a.startNumber,e=s.call(i,a),f=Math.max(e.start,0),g=Math.min(e.end,k.SegmentURL_asArray.length-1),b=f;g>=b;b+=1)d=k.SegmentURL_asArray[b],c=p.call(i,a,b),c.replacementTime=(h+b-1)*a.segmentDuration,c.media=d.media?d.media:l,c.mediaRange=d.mediaRange,c.index=d.index,c.indexRange=d.indexRange,j.push(c),c=null;return a.availableSegmentsNumber=m,j},w=function(a){var b,c=this,d=a.segmentInfoType;return"SegmentBase"!==d&&"BaseURL"!==d&&C.call(c,a)?("SegmentTimeline"===d?b=q.call(c,a):"SegmentTemplate"===d?b=r.call(c,a):"SegmentList"===d&&(b=v.call(c,a)),x.call(c,a,b)):b=a.segments,b},x=function(a,c){var d,e,f,g;a.segments=c,d=c.length-1,b&&isNaN(this.timelineConverter.getExpectedLiveEdge())&&(g=c[d],e=g.presentationStartTime+g.duration,f=this.metricsModel.getMetricsFor("stream"),this.timelineConverter.setExpectedLiveEdge(e),this.metricsModel.updateManifestUpdateInfo(this.metricsExt.getCurrentManifestUpdate(f),{presentationStartTime:e}))},y=function(a){var b=this;if(!a)throw new Error("no representation");return a.segments=null,w.call(b,a),a},z=function(a,e){var f,g=this,h=a.initialization,i="BaseURL"!==a.segmentInfoType&&"SegmentBase"!==a.segmentInfoType;return a.segmentDuration||a.segments||y.call(g,a),a.segmentAvailabilityRange=null,a.segmentAvailabilityRange=g.timelineConverter.calcSegmentAvailabilityRange(a,b),a.segmentAvailabilityRange.end<a.segmentAvailabilityRange.start&&!a.useCalculatedLiveEdgeTime?(f=new MediaPlayer.vo.Error(Dash.dependencies.DashHandler.SEGMENTS_UNAVAILABLE_ERROR_CODE,"no segments are available yet",{availabilityDelay:Math.abs(a.segmentAvailabilityRange.end)}),void g.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:a},f)):(e||(d=-1),a.segmentDuration&&y.call(g,a),h||g.baseURLExt.loadInitialization(a),i||g.baseURLExt.loadSegments(a,c,a.indexRange),void(h&&i&&g.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:a})))},A=function(a,b,c){var d,e,f,g,h,i=b.segments,j=i?i.length:null,k=-1;if(i&&j>0)for(h=0;j>h;h+=1)if(e=i[h],f=e.presentationStartTime,g=e.duration,d=void 0===c||null===c?g/2:c,a+d>=f&&f+g>a-d){k=e.availabilityIdx;break}return k},B=function(a,b){if(!b||!b.segments)return null;var d,e,f=b.segments.length;for(e=0;f>e;e+=1)if(d=b.segments[e],d.availabilityIdx===a||0===e&&-1===a)return CL.configs.firstIndex[c]&&d.presentationStartTime>0&&0===a&&CL.configs.isLive===!1&&(null!=CL.configs.minStartTime&&d.presentationStartTime>CL.configs.minStartTime||null==CL.configs.minStartTime)&&(CL.configs.minStartTime=d.presentationStartTime,CL.configs.firstIndex[c]=!1),d;return null},C=function(a){var b,c,e=!1,f=a.segments;return f&&0!==f.length?(c=f[0].availabilityIdx,b=f[f.length-1].availabilityIdx,e=c>d||d>b):e=!0,e},D=function(a){if(null===a||void 0===a)return null;var b,d=new MediaPlayer.vo.FragmentRequest,e=a.representation,f=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].bandwidth;b=l(a.media,e),b=h(b,"Number",a.replacementNumber),b=h(b,"Time",a.replacementTime),b=h(b,"Bandwidth",f),b=j(b,e.id);var g,k="";for(var m in CL.configs.customAttributes[e.id])g=CL.configs.customAttributes[e.id][m],k+=g.Name+"="+g.Value+",";return k.length>0&&(k=k.substring(0,k.length-1),b=h(b,"CustomAttributes",k)),b=i(b),d.mediaType=c,d.type="Media Segment",d.url=b,d.range=a.mediaRange,d.startTime=a.presentationStartTime,d.duration=a.duration,d.timescale=e.timescale,d.availabilityStartTime=a.availabilityStartTime,d.availabilityEndTime=a.availabilityEndTime,d.wallStartTime=a.wallStartTime,d.quality=e.index,d.index=a.availabilityIdx,d},E=function(b,e,f){var g,h,i,j=d,k=f?f.keepIdx:!1,l=f?f.timeThreshold:null,m=this;if(!b)return null;e<b.segmentAvailabilityRange.start&&e>0&&CL.configs.isLive===!0&&0===b.segments.length&&(CL.configs.needManifestUpdate=!0,CL.configs.lookAheadFragments={audio:[],video:[],text:[]}),CL.configs.isLive===!0&&CL.configs.adjustLiveEdge===!0&&(CL.configs.adjustLiveEdge=!1,CL.configs.minStartTime=Math.max(e,CL.configs.minStartTime)),1==CL.configs.isLive&&null!=CL.configs.minStartTime&&e<CL.configs.minStartTime&&(e=Math.max(e,CL.configs.minStartTime));var n=e%1;return n>0&&(n>.999999?e+=1-n:1e-6>n&&(e-=n)),a=e,m.log("Getting the request for time: "+e),d=A.call(m,e,b,l),w.call(m,b),0>d&&(d=A.call(m,e,b,l)),0>d&&1==CL.configs.isLive&&(d=0),m.log("Index for "+b.adaptation.type+" time "+e+" is "+d),i=o.call(m,b),i?(g=new MediaPlayer.vo.FragmentRequest,g.action=g.ACTION_COMPLETE,g.index=d,g.mediaType=c,m.log("Signal complete."),m.log(g)):(h=B(d,b),g=D.call(m,h)),k&&(d=j),g},F=function(a,b){var c=(a.segmentAvailabilityRange.end-a.segmentAvailabilityRange.start)/2;return a.segments=null,a.segmentAvailabilityRange={start:b-c,end:b+c},E.call(this,a,b,{keepIdx:!1})},G=function(b){var e,f,g,h,i=this;if(!b)return null;if(-1===d)throw"You must call getSegmentRequestForTime first.";return a=null,d+=1,h=d,g=o.call(i,b),g?(e=new MediaPlayer.vo.FragmentRequest,e.action=e.ACTION_COMPLETE,e.index=h,e.mediaType=c,i.log("Signal complete.")):(w.call(i,b),f=B(h,b),e=D.call(i,f)),e},H=function(a){var b=a.data.representation;b.segments&&this.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:b})},I=function(a){if(!a.error&&c===a.data.mediaType){var b,d,e,f,g=this,h=a.data.segments,i=a.data.representation,j=[],k=0;for(b=0,d=h.length;d>b;b+=1)e=h[b],f=u.call(g,i,e.startTime,e.duration,e.timescale,e.media,e.mediaRange,k),j.push(f),f=null,k+=1;i.segmentAvailabilityRange={start:j[0].presentationStartTime,end:j[d-1].presentationStartTime},i.availableSegmentsNumber=d,x.call(g,i,j),i.initialization&&this.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:i})}};return{log:void 0,baseURLExt:void 0,timelineConverter:void 0,metricsModel:void 0,metricsExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED]=H,this[Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED]=I},initialize:function(a){this.subscribe(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,a.trackController),c=a.getType(),this.setMediaType(c),b=a.isDynamic(),this.streamProcessor=a},getType:function(){return c},setType:function(a){c=a},getIsDynamic:function(){return b},setIsDynamic:function(a){b=a},setCurrentTime:function(a){e=a},getCurrentTime:function(){return e},reset:function(){e=0,a=void 0,d=-1,this.unsubscribe(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,this.streamProcessor.trackController)},getInitRequest:n,getSegmentRequestForTime:E,getNextSegmentRequest:G,generateSegmentRequestForTime:F,updateRepresentation:z}},Dash.dependencies.DashHandler.prototype={constructor:Dash.dependencies.DashHandler},Dash.dependencies.DashHandler.SEGMENTS_UNAVAILABLE_ERROR_CODE=1,Dash.dependencies.DashHandler.eventList={ENAME_REPRESENTATION_UPDATED:"representationUpdated"},Dash.dependencies.DashParser=function(){"use strict";var a=function(){var a,b,c,d;return d=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],a={},a.name="AdaptationSet",a.isRoot=!1,a.isArray=!0,a.parent=null,a.children=[],a.properties=d,b={},b.name="Representation",b.isRoot=!1,b.isArray=!0,b.parent=a,b.children=[],b.properties=d,a.children.push(b),c={},c.name="SubRepresentation",c.isRoot=!1,c.isArray=!0,c.parent=b,c.children=[],c.properties=d,b.children.push(c),a},b=function(){var a,b,c,d;return d=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],a={},a.name="Period",a.isRoot=!1,a.isArray=!0,a.parent=null,a.children=[],a.properties=d,b={},b.name="AdaptationSet",b.isRoot=!1,b.isArray=!0,b.parent=a,b.children=[],b.properties=d,a.children.push(b),c={},c.name="Representation",c.isRoot=!1,c.isArray=!0,c.parent=b,c.children=[],c.properties=d,b.children.push(c),a},c=function(){var a,b,c,d,e;return e=[{name:"BaseURL",merge:!0,mergeFunction:function(a,b){var c;return c=0===b.indexOf("http://")||0===b.indexOf("https://")?b:a+b}}],a={},a.name="mpd",a.isRoot=!0,a.isArray=!0,a.parent=null,a.children=[],a.properties=e,b={},b.name="Period",b.isRoot=!1,b.isArray=!0,b.parent=null,b.children=[],b.properties=e,a.children.push(b),c={},c.name="AdaptationSet",c.isRoot=!1,c.isArray=!0,c.parent=b,c.children=[],c.properties=e,b.children.push(c),d={},d.name="Representation",d.isRoot=!1,d.isArray=!0,d.parent=c,d.children=[],d.properties=e,c.children.push(d),a},d=function(){var d=[];return d.push(a()),d.push(b()),d.push(c()),d},e=function(a,b){var c,e=new X2JS({arrayAccessForm:"property"}),f=new ObjectIron(d()),g=new Date,h=null,i=null;try{1==CL.manifest.fixAudioCodec&&(a=a.replace(/mp4a.40.2/gi,"mp4a.40.5")),a=a.replace(/application.ttaf/gi,"application/ttml"),c=e.xml_str2json(a),c=c.MPD,this.utils.processJSON(c),h=new Date,c.hasOwnProperty("BaseURL")?(c.BaseURL=c.BaseURL_asArray[0],0!==c.BaseURL.toString().indexOf("http")&&(c.BaseURL=b+c.BaseURL)):c.BaseURL=b,c.hasOwnProperty("Location")&&(c.Location=c.Location_asArray[0]),f.run(c),i=new Date,this.log("Parsing complete: ( xml2json: "+(h.getTime()-g.getTime())+"ms, objectiron: "+(i.getTime()-h.getTime())+"ms, total: "+(i.getTime()-g.getTime())/1e3+"s)")}catch(j){return this.errHandler.manifestError("parsing the manifest failed","parse",a),null}return c};return{log:void 0,errHandler:void 0,parse:e,setup:function(){this.utils=this.system.getObject("clUtils")}}},Dash.dependencies.DashParser.prototype={constructor:Dash.dependencies.DashParser},Dash.dependencies.TimelineConverter=function(){"use strict";var a=0,b=!1,c=0/0,d=function(b,c,d,e){var f=0/0;return f=e?d&&c.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(c.availabilityStartTime.getTime()+1e3*(b+c.timeShiftBufferDepth)):c.availabilityEndTime:d?new Date(c.availabilityStartTime.getTime()+1e3*(b-a)):c.availabilityStartTime},e=function(a,b,c){return d.call(this,a,b,c)},f=function(a,b,c){return d.call(this,a,b,c,!0)},g=function(b,c){return(b.getTime()-c.mpd.availabilityStartTime.getTime()+1e3*a)/1e3},h=function(a,b){var c=b.adaptation.period.start,d=b.presentationTimeOffset;return a+(c-d)},i=function(a,b){var c=b.adaptation.period.start,d=b.presentationTimeOffset;return a-c+d},j=function(a,b){var c,d,e;return b&&(c=a.representation.adaptation.period.mpd.suggestedPresentationDelay,d=a.presentationStartTime+c,e=new Date(a.availabilityStartTime.getTime()+1e3*d)),e},k=function(a,c){var d,e,f=a.adaptation.period.duration,h=a.adaptation.period.start,i=h+a.adaptation.period.duration,j={start:h,end:i},k=a.segmentDuration||(a.segments&&a.segments.length?a.segments[a.segments.length-1].duration:0);return c?b&&!isNaN(f)||!a.segmentAvailabilityRange?(d=a.adaptation.period.mpd.checkTime,e=g(new Date,a.adaptation.period),h=Math.max(e-a.adaptation.period.mpd.timeShiftBufferDepth,0),i=(isNaN(d)?e:Math.min(d,e))-k,j={start:h,end:i}):a.segmentAvailabilityRange:j},l=function(a,b){var c=a.adaptation.period.start;return b-c},m=function(a,b){var c=a.adaptation.period.start;return b+c},n=function(d){b||d.error||(a=d.data.liveEdge-(c+d.data.searchTime),b=!0)},o=function(c){b||c.error||(a=c.data.offset/1e3,b=!0)},p=function(a){var b=a.presentationTimeOffset,c=a.adaptation.period.start;return c-b},q=function(){a=0,b=!1,c=0/0};return{setup:function(){this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=n,this[MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED]=o},calcAvailabilityStartTimeFromPresentationTime:e,calcAvailabilityEndTimeFromPresentationTime:f,calcPresentationTimeFromWallTime:g,calcPresentationTimeFromMediaTime:h,calcPeriodRelativeTimeFromMpdRelativeTime:l,calcMpdRelativeTimeFromPeriodRelativeTime:m,calcMediaTimeFromPresentationTime:i,calcSegmentAvailabilityRange:k,calcWallTimeForSegment:j,calcMSETimeOffset:p,reset:q,isTimeSyncCompleted:function(){return b},getClientTimeOffset:function(){return a},getExpectedLiveEdge:function(){return c},setExpectedLiveEdge:function(a){c=a}}},Dash.dependencies.TimelineConverter.prototype={constructor:Dash.dependencies.TimelineConverter},Dash.dependencies.RepresentationController=function(){"use strict";var a,b=null,c=-1,d=!0,e=[],f=function(c,f,h){var j,k,m=this,n=null,o=m.streamProcessor.getStreamInfo();if(m.abrController.updateTopQualityIndex(m.streamProcessor.getMediaInfo()),k=m.abrController.getTopQualityIndexFor(h,o.id),d=!0,m.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED),e=l.call(m,f),null===b?(n=m.abrController.getInitialBitrateFor(h,o),j=m.abrController.getQualityForBitrate(m.streamProcessor.getMediaInfo(),n)):j=m.abrController.getQualityFor(h,o),j>k&&(j=k),a=i.call(m,j),b=c,"video"!==h&&"audio"!==h&&"fragmentedText"!==h)return d=!1,m.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,{data:b,currentRepresentation:a}),void g.call(m);for(var p=0;p<e.length;p+=1)m.indexHandler.updateRepresentation(e[p],!0)},g=function(){var a=new Date,b=this.getCurrentRepresentation(),c=this.streamProcessor.playbackController.getTime();this.metricsModel.addTrackSwitch(b.adaptation.type,a,c,b.id)},h=function(){var b=this.streamProcessor,c=this.timelineConverter.calcSegmentAvailabilityRange(a,b.isDynamic());this.metricsModel.addDVRInfo(b.getType(),b.playbackController.getTime(),b.getStreamInfo().manifestInfo,c)},i=function(a){return e[a]},j=function(a){return e.indexOf(a)},k=function(){for(var a=0,b=e.length;b>a;a+=1)if(null===e[a].segmentAvailabilityRange||null===e[a].initialization||void 0===e[a].segments||null===e[a].segments)return!1;return!0},l=function(a){var d,e=this,f=e.manifestModel.getValue();return c=e.manifestExt.getIndexForAdaptation(b,f,a.period.index),d=e.manifestExt.getRepresentationsForAdaptation(f,a)},m=function(a){for(var b,c=this,d=0,f=e.length;f>d;d+=1)b=e[d],b.segmentAvailabilityRange=c.timelineConverter.calcSegmentAvailabilityRange(b,a)},n=function(b){var c=this,f=1e3*(b+3*a.segmentDuration),g=function(){if(!this.isUpdating()){d=!0,c.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED);for(var a=0;a<e.length;a+=1)c.indexHandler.updateRepresentation(e[a],!0)}};d=!1,setTimeout(g.bind(this),f)},o=function(c){if(this.isUpdating()){var e,f,i=this,l=c.data.representation,m=i.metricsModel.getMetricsFor("stream"),o=i.metricsExt.getCurrentManifestUpdate(m),p=!1;if(c.error&&c.error.code===Dash.dependencies.DashHandler.SEGMENTS_UNAVAILABLE_ERROR_CODE)return h.call(this),n.call(this,c.error.data.availabilityDelay),f=new MediaPlayer.vo.Error(Dash.dependencies.RepresentationController.SEGMENTS_UPDATE_FAILED_ERROR_CODE,"Segments update failed",null),void this.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,{data:b,currentRepresentation:a},f);for(var q=0;q<o.trackInfo.length;q+=1)if(e=o.trackInfo[q],e.index===l.index&&e.mediaType===i.streamProcessor.getType()){p=!0;break}p||i.metricsModel.addManifestUpdateTrackInfo(o,l.id,l.index,l.adaptation.period.index,i.streamProcessor.getType(),l.presentationTimeOffset,l.startNumber,l.segmentInfoType),k()&&(d=!1,i.abrController.setPlaybackQuality(i.streamProcessor.getType(),i.streamProcessor.getStreamInfo(),j.call(this,a)),i.metricsModel.updateManifestUpdateInfo(o,{latency:a.segmentAvailabilityRange.end-i.streamProcessor.playbackController.getTime()}),this.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,{data:b,currentRepresentation:a}),g.call(i))}},p=function(a){m.call(this,a.data.isDynamic)},q=function(b){if(!b.error){m.call(this,!0),this.indexHandler.updateRepresentation(a,!1);var c=this.manifestModel.getValue();a.adaptation.period.mpd.checkTime=this.manifestExt.getCheckTime(c,a.adaptation.period)}},r=function(){h.call(this)},s=function(b){var c=this;b.data.mediaType===c.streamProcessor.getType()&&c.streamProcessor.getStreamInfo().id===b.data.streamInfo.id&&(a=c.getRepresentationForQuality(b.data.newQuality),t.call(c,b.data.mediaType,a.bandwidth),g.call(c))},t=function(a,b){!this.DOMStorage.isSupported(MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL)||"video"!==a&&"audio"!==a||localStorage.setItem(MediaPlayer.utils.DOMStorage["LOCAL_STORAGE_"+a.toUpperCase()+"_BITRATE_KEY"],JSON.stringify({bitrate:b/1e3,timestamp:(new Date).getTime()}))};return{system:void 0,log:void 0,manifestExt:void 0,manifestModel:void 0,metricsModel:void 0,metricsExt:void 0,abrController:void 0,timelineConverter:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,DOMStorage:void 0,setup:function(){this[MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED]=s,this[Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED]=o,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED]=p,this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=q,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED]=r},initialize:function(a){this.streamProcessor=a,this.indexHandler=a.indexHandler},getData:function(){return b},getDataIndex:function(){return c},isUpdating:function(){return d},updateData:f,getRepresentationForQuality:i,getCurrentRepresentation:function(){return a}}},Dash.dependencies.RepresentationController.prototype={constructor:Dash.dependencies.RepresentationController},Dash.dependencies.RepresentationController.SEGMENTS_UPDATE_FAILED_ERROR_CODE=1,Dash.dependencies.RepresentationController.eventList={ENAME_DATA_UPDATE_COMPLETED:"dataUpdateCompleted",ENAME_DATA_UPDATE_STARTED:"dataUpdateStarted"},Dash.dependencies.BaseURLExtensions=function(){"use strict";var a=function(a,b){for(var c,d,e,f,g,h,i,j,k,l,m=new DataView(a),n={},o=0;"sidx"!==j&&o<m.byteLength;){for(k=m.getUint32(o),o+=4,j="",f=0;4>f;f+=1)l=m.getInt8(o),j+=String.fromCharCode(l),o+=1;"moof"!==j&&"traf"!==j&&"sidx"!==j?o+=k-8:"sidx"===j&&(o-=8)}if(e=m.getUint32(o,!1)+o,e>a.byteLength)throw"sidx terminates after array buffer";n.version=m.getUint8(o+8),o+=12,n.timescale=m.getUint32(o+4,!1),o+=8,0===n.version?(n.earliest_presentation_time=m.getUint32(o,!1),n.first_offset=m.getUint32(o+4,!1),o+=8):(n.earliest_presentation_time=utils.Math.to64BitNumber(m.getUint32(o+4,!1),m.getUint32(o,!1)),n.first_offset=(m.getUint32(o+8,!1)<<32)+m.getUint32(o+12,!1),o+=16),n.first_offset+=e+(b||0),n.reference_count=m.getUint16(o+2,!1),o+=4,n.references=[],c=n.first_offset,d=n.earliest_presentation_time;var p=d/n.timescale*1.5;for((null==CL.configs.minStartTime||p>CL.configs.minStartTime)&&(CL.configs.minStartTime=p),f=0;f<n.reference_count;f+=1)h=m.getUint32(o,!1),g=h>>>31,h=2147483647&h,i=m.getUint32(o+4,!1),o+=12,n.references.push({size:h,type:g,offset:c,duration:i,time:d,timescale:n.timescale}),c+=h,d+=i;if(o!==e)throw"Error: final pos "+o+" differs from SIDX end "+e;return n},b=function(b,c,d){var e,f,g,h,i,j,k,l;for(e=a.call(this,b,d),f=e.references,g=[],i=0,j=f.length;j>i;i+=1)h=new Dash.vo.Segment,h.duration=f[i].duration,h.media=c,h.startTime=f[i].time,h.timescale=f[i].timescale,k=f[i].offset,l=f[i].offset+f[i].size-1,h.mediaRange=k+"-"+l,g.push(h);return this.log("Parsed SIDX box: "+g.length+" segments."),g},c=function(a,b,d){var e,f,h,i,j,k,l,m,n=new DataView(a),o=0,p="",q=0,r=!1,s=this;for(s.log("Searching for initialization.");"moov"!==p&&o<n.byteLength;){for(q=n.getUint32(o),o+=4,p="",j=0;4>j;j+=1)k=n.getInt8(o),p+=String.fromCharCode(k),o+=1;"ftyp"===p&&(e=o-8),"moov"===p&&(f=o-8),"moov"!==p&&(o+=q-8)}"moov"!==p?(s.log("Loading more bytes to find initialization."),b.range.start=0,b.range.end=b.bytesLoaded+b.bytesToLoad,l=new XMLHttpRequest,l.onloadend=function(){r||d.call(s,null,new Error("Error loading initialization."))},l.onload=function(){r=!0,b.bytesLoaded=b.range.end,c.call(s,l.response,function(a){d.call(s,a)})},l.onerror=function(){d.call(s,null,new Error("Error loading initialization."))},g.call(s,l,b)):(h=void 0===e?f:e,i=f+q-1,m=h+"-"+i,s.log("Found the initialization.  Range: "+m),d.call(s,m))},d=function(a){var b=new XMLHttpRequest,d=!0,e=this,f=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].BaseURL,h={url:f,range:{},searching:!1,bytesLoaded:0,bytesToLoad:3e3,request:b};e.log("Start searching for initialization."),h.range.start=0,h.range.end=h.bytesToLoad,CL.configs.isSmoothStreaming===!0?(d=!1,h.bytesLoaded=h.range.end,a.initialization=-1,e.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,{representation:a})):(b.onload=function(){b.status<200||b.status>299||(d=!1,h.bytesLoaded=h.range.end,c.call(e,b.response,h,function(b){a.range=b,a.initialization=f,e.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,{representation:a})}))},b.onloadend=b.onerror=function(){d&&(d=!1,e.errHandler.downloadError("initialization",h.url,b),e.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,{representation:a}))},g.call(e,b,h),e.log("Perform init search: "+h.url))},e=function(a,c,d,h){var i,j,k,l,m,n,o,p,q,r=new DataView(a),s=new XMLHttpRequest,t=0,u="",v=0,w=!0,x=!1,y=this;for(y.log("Searching for SIDX box."),y.log(c.bytesLoaded+" bytes loaded.");"sidx"!==u&&t<r.byteLength;){for(v=r.getUint32(t),t+=4,u="",n=0;4>n;n+=1)o=r.getInt8(t),u+=String.fromCharCode(o),t+=1;"sidx"!==u&&(t+=v-8)}if(j=r.byteLength-t,"sidx"!==u)h.call(y);else if(v-8>j)y.log("Found SIDX but we don't have all of it."),c.range.start=0,c.range.end=c.bytesLoaded+(v-j),s.onload=function(){s.status<200||s.status>299||(w=!1,c.bytesLoaded=c.range.end,e.call(y,s.response,c,d,h))},s.onloadend=s.onerror=function(){w&&(w=!1,y.errHandler.downloadError("SIDX",c.url,s),h.call(y))},g.call(y,s,c);else if(c.range.start=t-8,c.range.end=c.range.start+v,y.log("Found the SIDX box.  Start: "+c.range.start+" | End: "+c.range.end),k=new ArrayBuffer(c.range.end-c.range.start),m=new Uint8Array(k),l=new Uint8Array(a,c.range.start,c.range.end-c.range.start),m.set(l),p=this.parseSIDX.call(this,k,c.range.start),q=p.references,null!==q&&void 0!==q&&q.length>0&&(x=1===q[0].type),x){y.log("Initiate multiple SIDX load.");var z,A,B,C,D,E=[],F=0,G=function(a){a?(E=E.concat(a),F+=1,F>=A&&h.call(y,E)):h.call(y)};for(z=0,A=q.length;A>z;z+=1)B=q[z].offset,C=q[z].offset+q[z].size-1,D=B+"-"+C,f.call(y,d,null,D,G)}else y.log("Parsing segments from SIDX."),i=b.call(y,k,c.url,c.range.start),h.call(y,i)},f=function(a,c,d,f){var h,i,j=new XMLHttpRequest,k=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].BaseURL,l=!0,m=this,n={url:k,range:{},searching:!1,bytesLoaded:0,bytesToLoad:3e3,request:j};null===d?(m.log("No known range for SIDX request."),n.searching=!0,n.range.start=0,n.range.end=n.bytesToLoad):(i=d.split("-"),n.range.start=parseFloat(i[0]),n.range.end=parseFloat(i[1])),j.onload=function(){j.status<200||j.status>299||(l=!1,n.searching?(n.bytesLoaded=n.range.end,e.call(m,j.response,n,a,function(b){b&&f.call(m,b,a,c)})):(h=b.call(m,j.response,n.url,n.range.start),f.call(m,h,a,c)))},j.onloadend=j.onerror=function(){l&&(l=!1,m.errHandler.downloadError("SIDX",n.url,j),f.call(m,null,a,c))},g.call(m,j,n),m.log("Perform SIDX load: "+n.url)},g=function(a,b){a.open("GET",this.requestModifierExt.modifyRequestURL(b.url)),a.responseType="arraybuffer",a.setRequestHeader("Range","bytes="+b.range.start+"-"+b.range.end),a=this.requestModifierExt.modifyRequestHeader(a),a.send(null)},h=function(a,b,c){var d=this;
a?d.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,{segments:a,representation:b,mediaType:c}):d.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,{segments:null,representation:b,mediaType:c},new MediaPlayer.vo.Error(null,"error loading segments",null))};return{log:void 0,errHandler:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,loadSegments:function(a,b,c){f.call(this,a,b,c,h.bind(this))},loadInitialization:d,parseSegments:b,parseSIDX:a,findSIDX:e}},Dash.dependencies.BaseURLExtensions.prototype={constructor:Dash.dependencies.BaseURLExtensions},Dash.dependencies.BaseURLExtensions.eventList={ENAME_INITIALIZATION_LOADED:"initializationLoaded",ENAME_SEGMENTS_LOADED:"segmentsLoaded"},Dash.dependencies.DashManifestExtensions=function(){"use strict";this.timelineConverter=void 0},Dash.dependencies.DashManifestExtensions.prototype={constructor:Dash.dependencies.DashManifestExtensions,getIsTypeOf:function(a,b){"use strict";var c,d,e,f=a.ContentComponent_asArray,g=new RegExp("text"!==b?b:"(vtt|ttml)"),h=!1,i=!1;if(a.Representation_asArray.length>0&&a.Representation_asArray[0].hasOwnProperty("codecs")&&"stpp"==a.Representation_asArray[0].codecs)return"fragmentedText"==b;if(f)for(c=0,d=f.length;d>c;c+=1)f[c].contentType===b&&(h=!0,i=!0);if(a.hasOwnProperty("mimeType")&&(h=g.test(a.mimeType),i=!0),!i)for(c=0,d=a.Representation_asArray.length;!i&&d>c;)e=a.Representation_asArray[c],e.hasOwnProperty("mimeType")&&(h=g.test(e.mimeType),i=!0),c+=1;return h},getIsAudio:function(a){"use strict";return this.getIsTypeOf(a,"audio")},getIsVideo:function(a){"use strict";return this.getIsTypeOf(a,"video")},getIsFragmentedText:function(a){"use strict";return this.getIsTypeOf(a,"fragmentedText")},getIsText:function(a){"use strict";return this.getIsTypeOf(a,"text")},getIsTextTrack:function(a){return"text/vtt"===a||"application/ttml+xml"===a},getLanguageForAdaptation:function(a){var b="";return a.hasOwnProperty("lang")&&(b=a.lang),b},getIsMain:function(){"use strict";return!1},processAdaptation:function(a){"use strict";return void 0!==a.Representation_asArray&&null!==a.Representation_asArray&&a.Representation_asArray.sort(function(a,b){return a.bandwidth-b.bandwidth}),a},getAdaptationForId:function(a,b,c){"use strict";var d,e,f=b.Period_asArray[c].AdaptationSet_asArray;for(d=0,e=f.length;e>d;d+=1)if(f[d].hasOwnProperty("id")&&f[d].id===a)return f[d];return null},getAdaptationForIndex:function(a,b,c){"use strict";var d=b.Period_asArray[c].AdaptationSet_asArray;return d[a]},getIndexForAdaptation:function(a,b,c){"use strict";var d,e,f=b.Period_asArray[c].AdaptationSet_asArray;for(d=0,e=f.length;e>d;d+=1)if(f[d]===a)return d;return-1},getAdaptationsForType:function(a,b,c){"use strict";var d,e,f=this,g=a.Period_asArray[b].AdaptationSet_asArray,h=[];for(d=0,e=g.length;e>d;d+=1)this.getIsTypeOf(g[d],c)&&h.push(f.processAdaptation(g[d]));return h},getActiveAdaptationForType:function(a,b,c){"use strict";var d,e,f=this,g=a.Period_asArray[b].AdaptationSet_asArray,h=c;for((c.indexOf("text")>-1||c.indexOf("ttml")>-1)&&(h="text"),d=0,e=g.length;e>d;d+=1)if(this.getIsTypeOf(g[d],c)&&CL.configs.activeTrack[h].adaptionIndex==d)return f.processAdaptation(g[d])},getAdaptationForType:function(a,b,c){"use strict";var d,e,f,g=this;if((c.indexOf("text")>-1||c.indexOf("ttml")>-1)&&(cType="text"),void 0!==CL.configs.activeTrack[c])return this.getActiveAdaptationForType(a,b,c);if(f=this.getAdaptationsForType(a,b,c),!f||0===f.length)return null;for(d=0,e=f.length;e>d;d+=1)if(g.getIsMain(f[d]))return f[d];return f[0]},getCodec:function(a){"use strict";var b=a.Representation_asArray[0],c=b.mimeType+';codecs="'+b.codecs+'"';return c},getMimeType:function(a){"use strict";return a.Representation_asArray[0].mimeType},getKID:function(a){"use strict";return a&&a.hasOwnProperty("cenc:default_KID")?a["cenc:default_KID"]:void 0!==CL.manifest.keyId&&null!==CL.manifest.keyId?CL.manifest.keyId:null},getContentProtectionData:function(a){"use strict";return a&&a.hasOwnProperty("ContentProtection_asArray")&&0!==a.ContentProtection_asArray.length?a.ContentProtection_asArray:null},getIsDynamic:function(a){"use strict";var b=!1,c="dynamic";return a.hasOwnProperty("type")&&(b=a.type===c),b},getIsDVR:function(a){"use strict";var b,c,d=this.getIsDynamic(a);return b=!isNaN(a.timeShiftBufferDepth),c=d&&b},getIsOnDemand:function(a){"use strict";var b=!1;return a.profiles&&a.profiles.length>0&&(b=-1!==a.profiles.indexOf("urn:mpeg:dash:profile:isoff-on-demand:2011")),b},getDuration:function(a){var b;return b=a.hasOwnProperty("mediaPresentationDuration")?a.mediaPresentationDuration:Number.POSITIVE_INFINITY},getBandwidth:function(a){"use strict";return a.bandwidth},getRefreshDelay:function(a){"use strict";var b=0/0,c=2;return a.hasOwnProperty("minimumUpdatePeriod")&&(b=Math.max(parseFloat(a.minimumUpdatePeriod),c)),b},getRepresentationCount:function(a){"use strict";return a.Representation_asArray.length},getBitrateListForAdaptation:function(a){if(!a||!a.Representation_asArray||!a.Representation_asArray.length)return null;for(var b=this.processAdaptation(a),c=b.Representation_asArray,d=c.length,e=[],f=0;d>f;f+=1)e.push(c[f].bandwidth);return e},getRepresentationFor:function(a,b){"use strict";return b.Representation_asArray[a]},getRepresentationsForAdaptation:function(a,b){for(var c,d,e,f,g,h=this,i=h.processAdaptation(a.Period_asArray[b.period.index].AdaptationSet_asArray[b.index]),j=[],k=0;k<i.Representation_asArray.length;k+=1)f=i.Representation_asArray[k],c=new Dash.vo.Representation,c.index=k,c.adaptation=b,f.hasOwnProperty("id")&&(c.id=f.id),f.hasOwnProperty("bandwidth")&&(c.bandwidth=f.bandwidth),f.hasOwnProperty("SegmentBase")?(e=f.SegmentBase,c.segmentInfoType="SegmentBase"):f.hasOwnProperty("SegmentList")?(e=f.SegmentList,c.segmentInfoType="SegmentList",c.useCalculatedLiveEdgeTime=!0):f.hasOwnProperty("SegmentTemplate")?(e=f.SegmentTemplate,e.hasOwnProperty("SegmentTimeline")?(c.segmentInfoType="SegmentTimeline",g=e.SegmentTimeline.S_asArray[e.SegmentTimeline.S_asArray.length-1],(!g.hasOwnProperty("r")||g.r>=0)&&(c.useCalculatedLiveEdgeTime=!0)):c.segmentInfoType="SegmentTemplate",e.hasOwnProperty("initialization")&&(c.initialization=e.initialization.split("$Bandwidth$").join(f.bandwidth).split("$RepresentationID$").join(f.id))):(e=f.BaseURL,c.segmentInfoType="BaseURL"),e.hasOwnProperty("Initialization")?(d=e.Initialization,d.hasOwnProperty("sourceURL")?c.initialization=d.sourceURL:d.hasOwnProperty("range")&&(c.initialization=f.BaseURL,c.range=d.range)):f.hasOwnProperty("mimeType")&&h.getIsTextTrack(f.mimeType)&&(c.initialization=f.BaseURL,c.range=0),e.hasOwnProperty("timescale")&&(c.timescale=e.timescale),e.hasOwnProperty("duration")&&(c.segmentDuration=e.duration/c.timescale),e.hasOwnProperty("startNumber")&&(c.startNumber=e.startNumber),e.hasOwnProperty("indexRange")&&(c.indexRange=e.indexRange),e.hasOwnProperty("presentationTimeOffset")&&(c.presentationTimeOffset=e.presentationTimeOffset/c.timescale),c.MSETimeOffset=h.timelineConverter.calcMSETimeOffset(c),j.push(c);return j},getAdaptationsForPeriod:function(a,b){for(var c,d,e=a.Period_asArray[b.index],f=[],g=0;g<e.AdaptationSet_asArray.length;g+=1)d=e.AdaptationSet_asArray[g],c=new Dash.vo.AdaptationSet,d.hasOwnProperty("id")&&(c.id=d.id),c.index=g,c.period=b,c.type=this.getIsAudio(d)?"audio":this.getIsVideo(d)?"video":this.getIsFragmentedText(d)?"fragmentedText":"text",f.push(c);return f},getRegularPeriods:function(a,b){var c,d,e=this,f=[],g=e.getIsDynamic(a),h=null,i=null,j=null,k=null;for(c=0,d=a.Period_asArray.length;d>c;c+=1)i=a.Period_asArray[c],i.hasOwnProperty("start")?(k=new Dash.vo.Period,k.start=i.start):null!==h&&i.hasOwnProperty("duration")&&null!==j?(k=new Dash.vo.Period,k.start=j.start+j.duration,k.duration=i.duration):0!==c||g||(k=new Dash.vo.Period,k.start=0),null!==j&&isNaN(j.duration)&&(j.duration=k.start-j.start),null!==k&&i.hasOwnProperty("id")&&(k.id=i.id),null!==k&&i.hasOwnProperty("duration")&&(k.duration=i.duration),null!==k&&(k.index=c,k.mpd=b,f.push(k),h=i,j=k),i=null,k=null;return 0===f.length?f:(b.checkTime=e.getCheckTime(a,f[0]),null!==j&&isNaN(j.duration)&&(j.duration=e.getEndTimeForLastPeriod(b)-j.start),f)},getMpd:function(a){var b=new Dash.vo.Mpd;return b.manifest=a,b.availabilityStartTime=new Date(a.hasOwnProperty("availabilityStartTime")?void 0!==a.availabilityStartTime.getTime?a.availabilityStartTime.getTime():Date.parse(a.availabilityStartTime):a.loadedTime.getTime()),a.hasOwnProperty("availabilityEndTime")&&(b.availabilityEndTime=new Date(void 0!==a.availabilityEndTime.getTime?a.availabilityEndTime.getTime():Date.parse(a.availabilityEndTime))),a.hasOwnProperty("suggestedPresentationDelay")&&(b.suggestedPresentationDelay=a.suggestedPresentationDelay),a.hasOwnProperty("timeShiftBufferDepth")&&(b.timeShiftBufferDepth=a.timeShiftBufferDepth),a.hasOwnProperty("maxSegmentDuration")&&(b.maxSegmentDuration=a.maxSegmentDuration),b},getFetchTime:function(a,b){return this.timelineConverter.calcPresentationTimeFromWallTime(a.loadedTime,b)},getCheckTime:function(a,b){var c,d=this,e=0/0;return a.hasOwnProperty("minimumUpdatePeriod")&&(c=d.getFetchTime(a,b),e=c+a.minimumUpdatePeriod),e},getEndTimeForLastPeriod:function(a){var b;if(a.manifest.mediaPresentationDuration)b=a.manifest.mediaPresentationDuration;else{if(isNaN(a.checkTime))throw new Error("Must have @mediaPresentationDuration or @minimumUpdatePeriod on MPD or an explicit @duration on the last period.");b=a.checkTime}return b},getEventsForPeriod:function(a,b){var c=a.Period_asArray,d=c[b.index].EventStream_asArray,e=[];if(d)for(var f=0;f<d.length;f+=1){var g=new Dash.vo.EventStream;if(g.period=b,g.timescale=1,!d[f].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";g.schemeIdUri=d[f].schemeIdUri,d[f].hasOwnProperty("timescale")&&(g.timescale=d[f].timescale),d[f].hasOwnProperty("value")&&(g.value=d[f].value);for(var h=0;h<d[f].Event_asArray.length;h+=1){var i=new Dash.vo.Event;i.presentationTime=0,i.eventStream=g,d[f].Event_asArray[h].hasOwnProperty("presentationTime")&&(i.presentationTime=d[f].Event_asArray[h].presentationTime),d[f].Event_asArray[h].hasOwnProperty("duration")&&(i.duration=d[f].Event_asArray[h].duration),d[f].Event_asArray[h].hasOwnProperty("id")&&(i.id=d[f].Event_asArray[h].id),e.push(i)}}return e},getEventStreams:function(a,b){var c=[];if(!a)return c;for(var d=0;d<a.length;d++){var e=new Dash.vo.EventStream;if(e.timescale=1,e.representation=b,!a[d].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";e.schemeIdUri=a[d].schemeIdUri,a[d].hasOwnProperty("timescale")&&(e.timescale=a[d].timescale),a[d].hasOwnProperty("value")&&(e.value=a[d].value),c.push(e)}return c},getEventStreamForAdaptationSet:function(a,b){var c=a.Period_asArray[b.period.index].AdaptationSet_asArray[b.index].InbandEventStream_asArray;return this.getEventStreams(c,null)},getEventStreamForRepresentation:function(a,b){var c=a.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index].Representation_asArray[b.index].InbandEventStream_asArray;return this.getEventStreams(c,b)},getUTCTimingSources:function(a){"use strict";var b=this,c=CL.configs.isLive=b.getIsDynamic(a),d=a.hasOwnProperty("availabilityStartTime"),e=a.UTCTiming_asArray,f=[];return(c||d)&&e&&e.forEach(function(a){var b=new Dash.vo.UTCTiming;a.hasOwnProperty("schemeIdUri")&&(b.schemeIdUri=a.schemeIdUri,a.hasOwnProperty("value")&&(b.value=a.value.toString(),f.push(b)))}),f}},Dash.dependencies.DashMetricsExtensions=function(){"use strict";var a=function(a,b){var c,d,e,f,g,h,i,j;for(h=0;h<a.length;h+=1)for(c=a[h],e=c.AdaptationSet_asArray,i=0;i<e.length;i+=1)for(d=e[i],g=d.Representation_asArray,j=0;j<g.length;j+=1)if(f=g[j],b===f.id)return j;return-1},b=function(a,b){var c,d,e,f,g,h,i,j;for(h=0;h<a.length;h+=1)for(c=a[h],e=c.AdaptationSet_asArray,i=0;i<e.length;i+=1)for(d=e[i],g=d.Representation_asArray,j=0;j<g.length;j+=1)if(f=g[j],b===f.id)return f;return null},c=function(a,b){return this.manifestExt.getIsTypeOf(a,b)},d=function(a,b){var d,e,f,g;if(!a||!b)return-1;for(e=a.AdaptationSet_asArray,g=0;g<e.length;g+=1)if(d=e[g],f=d.Representation_asArray,c.call(this,d,b))return f.length;return-1},e=function(a){var c,d=this,e=d.manifestModel.getValue(),f=e.Period_asArray;return c=b.call(d,f,a),null===c?null:c.bandwidth},f=function(b){var c,d=this,e=d.manifestModel.getValue(),f=e.Period_asArray;return c=a.call(d,f,b)},g=function(a,b){var c,e=this,f=e.manifestModel.getValue(),g=f.Period_asArray[b];return c=d.call(this,g,a)},h=function(a,b){var c=this.system.getObject("abrController"),d=0;return c&&(d=c.getTopQualityIndexFor(a,b)),d},i=function(a){if(null===a)return null;var b,c,d,e=a.RepSwitchList;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},j=function(a){if(null===a)return null;var b,c,d,e=a.BufferLevel;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},k=function(a){if(null===a)return null;var b,c,d=a.PlayList;return null===d||d.length<=0?null:(b=d[d.length-1].trace,null===b||b.length<=0?null:c=b[b.length-1].playbackspeed)},l=function(a){if(null===a)return null;var b,c,d=a.HttpList,e=null;if(null===d||d.length<=0)return null;for(b=d.length,c=b-1;c>=0;){if(void 0!==d[c].responsecode&&null!==d[c].responsecode){e=d[c];break}c-=1}return e},m=function(a){return null===a?[]:a.HttpList?a.HttpList:[]},n=function(a){if(null===a)return null;var b,c,d,e=a.DroppedFrames;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},o=function(a){if(null===a)return null;var b,c,d,e=a.SchedulingInfo;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},p=function(a){if(null===a)return null;var b,c,d,e=a.ManifestUpdate;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},q=function(a){if(null===a)return null;var b,c,d=a.DVRInfo;return null===d||d.length<=0?null:(b=d.length-1,c=d[b])},r=function(a,b){if(null===a)return null;var c,d=m(a),e=d[d.length-1];return"MPD"===e.type&&(c=t(e.responseHeaders)),void 0===c[b]?null:c[b]},s=function(a,b){if(null===a)return null;var c,d=l(a);return null===d||null===d.responseHeaders?null:(c=t(d.responseHeaders),void 0===c[b]?null:c[b])},t=function(a){var b={};if(!a)return b;for(var c=a.split("\r\n"),d=0,e=c.length;e>d;d++){var f=c[d],g=f.indexOf(": ");g>0&&(b[f.substring(0,g)]=f.substring(g+2))}return b};return{manifestModel:void 0,manifestExt:void 0,system:void 0,getBandwidthForRepresentation:e,getIndexForRepresentation:f,getMaxIndexForBufferType:g,getMaxAllowedIndexForBufferType:h,getCurrentRepresentationSwitch:i,getCurrentBufferLevel:j,getCurrentPlaybackRate:k,getCurrentHttpRequest:l,getHttpRequests:m,getCurrentDroppedFrames:n,getCurrentSchedulingInfo:o,getCurrentDVRInfo:q,getCurrentManifestUpdate:p,getLatestFragmentRequestHeaderValueByID:s,getLatestMPDRequestHeaderValueByID:r}},Dash.dependencies.DashMetricsExtensions.prototype={constructor:Dash.dependencies.DashMetricsExtensions},Dash.dependencies.FragmentExtensions=function(){"use strict";var a=0,b=1,c=3,d=4,e=5,f=0,g=2,h=8,i=9,j=10,k=11,l=function(a){for(var b,c,d,e,f,g,h=new DataView(a),i=0;"tfdt"!==e&&i<h.byteLength;){for(d=h.getUint32(i),i+=4,e="",f=0;4>f;f+=1)g=h.getInt8(i),e+=String.fromCharCode(g),i+=1;"moof"!==e&&"traf"!==e&&"tfdt"!==e&&(i+=d-8)}if(i===h.byteLength)throw"Error finding live offset.";return c=h.getUint8(i),0===c?(i+=4,b=h.getUint32(i,!1)):(i+=d-16,b=utils.Math.to64BitNumber(h.getUint32(i+4,!1),h.getUint32(i,!1))),{version:c,base_media_decode_time:b}},m=function(a){for(var b,c,d,e,f,g,h,i=new DataView(a),j=0;"sidx"!==f&&j<i.byteLength;){for(g=i.getUint32(j),j+=4,f="",e=0;4>e;e+=1)h=i.getInt8(j),f+=String.fromCharCode(h),j+=1;"moof"!==f&&"traf"!==f&&"sidx"!==f?j+=g-8:"sidx"===f&&(j-=8)}return b=i.getUint8(j+8),j+=12,c=i.getUint32(j+4,!1),j+=8,d=0===b?i.getUint32(j,!1):utils.Math.to64BitNumber(i.getUint32(j+4,!1),i.getUint32(j,!1)),{earliestPresentationTime:d,timescale:c}},n=function(f){for(var g,h,i,j,k,l,m,n=new DataView(f),o=0;"tfhd"!==h&&o<n.byteLength;){for(g=n.getUint32(o),o+=4,h="",l=0;4>l;l+=1)m=n.getInt8(o),h+=String.fromCharCode(m),o+=1;"moof"!==h&&"traf"!==h&&"tfhd"!==h&&(o+=g-8)}if(o===n.byteLength)throw"Error finding live offset.";return k={baseDataOffset:0,descriptionIndex:0,sampleDuration:0,sampleSize:0,defaultSampleFlags:0},o+=1,o+=2,i=n.getUint8(o),o+=1,j=intTobitArray(i,8),o+=4,j[a]&&(k.baseDataOffset=utils.Math.to64BitNumber(n.getUint32(o+4,!1),n.getUint32(o,!1)),o+=8),j[b]&&(k.descriptionIndex=n.getUint32(o),o+=4),j[c]&&(k.sampleDuration=n.getUint32(o),o+=4),j[d]&&(k.sampleSize=n.getUint32(o),o+=4),j[e]&&(k.defaultSampleFlags=n.getUint32(o),o+=4),k},o=function(a){for(var b,c,d,e,f,g=new DataView(a),h=0;"mdhd"!==d&&h<g.byteLength;){for(c=g.getUint32(h),h+=4,d="",e=0;4>e;e+=1)f=g.getInt8(h),d+=String.fromCharCode(f),h+=1;"moov"!==d&&"trak"!==d&&"mdia"!==d&&"mdhd"!==d&&(h+=c-8)}if(h===g.byteLength)throw"Error finding live offset.";return b=g.getUint8(h),h+=12,1==b&&(h+=8),g.getUint32(h,!1)},p=function(a){var b,c,d,e,m,o,p,q,r,s,t,u,v,w,x,y,z=new DataView(a),A=0;for(w=n(a),x=l(a);"trun"!==c&&A<z.byteLength;){for(b=z.getUint32(A),A+=4,c="",t=0;4>t;t+=1)u=z.getInt8(A),c+=String.fromCharCode(u),A+=1;"moof"!==c&&"traf"!==c&&"trun"!==c&&(A+=b-8),"moof"==c&&(v=A-8)}if(A===z.byteLength)throw"Error finding live offset.";for(A+=1,A+=1,r=z.getUint16(A),A+=2,s=intTobitArray(r,16),m=z.getUint32(A),A+=4,p=x.base_media_decode_time,s[f]?(y=z.getUint32(A)+w.baseDataOffset,A+=4):y=w.baseDataOffset,s[g]&&(A+=4),q=[],t=0;m>t;t++)s[h]?(d=z.getUint32(A),A+=4):d=w.sampleDuration,s[i]?(o=z.getUint32(A),A+=4):o=w.sampleSize,s[j]&&(A+=4),s[k]?(e=z.getUint32(A),A+=4):e=0,q.push({dts:p,cts:p+e,duration:d,offset:v+y,size:o}),y+=o,p+=d;return q},q=function(a){var b,c=this,d=new XMLHttpRequest,e=a,f=!1,g="Error loading fragment: "+e,h=new MediaPlayer.vo.Error(null,g,null);d.onloadend=function(){f||(g="Error loading fragment: "+e,c.notify(Dash.dependencies.FragmentExtensions.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{fragment:null},h))},d.onload=function(){f=!0,b=l(d.response),c.notify(Dash.dependencies.FragmentExtensions.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{fragment:b})},d.onerror=function(){g="Error loading fragment: "+e,c.notify(Dash.dependencies.FragmentExtensions.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{fragment:null},h)},d.responseType="arraybuffer",d.open("GET",e),d.send(null)};return{log:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,loadFragment:q,parseTFDT:l,parseSIDX:m,getSamplesInfo:p,getMediaTimescaleFromMoov:o}},Dash.dependencies.FragmentExtensions.prototype={constructor:Dash.dependencies.FragmentExtensions},Dash.dependencies.FragmentExtensions.eventList={ENAME_FRAGMENT_LOADING_COMPLETED:"fragmentLoadingCompleted"},Dash.vo.AdaptationSet=function(){"use strict";this.period=null,this.index=-1,this.type=null},Dash.vo.AdaptationSet.prototype={constructor:Dash.vo.AdaptationSet},Dash.vo.Event=function(){"use strict";this.duration=0/0,this.presentationTime=0/0,this.id=0/0,this.messageData="",this.eventStream=null,this.presentationTimeDelta=0/0},Dash.vo.Event.prototype={constructor:Dash.vo.Event},Dash.vo.EventStream=function(){"use strict";this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},Dash.vo.EventStream.prototype={constructor:Dash.vo.EventStream},Dash.vo.Mpd=function(){"use strict";this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.checkTime=0/0,this.clientServerTimeShift=0,this.isClientServerTimeSyncCompleted=!1},Dash.vo.Mpd.prototype={constructor:Dash.vo.Mpd},Dash.vo.Period=function(){"use strict";this.id=null,this.index=-1,this.duration=0/0,this.start=0/0,this.mpd=null},Dash.vo.Period.prototype={constructor:Dash.vo.Period},Dash.vo.Representation=function(){"use strict";this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=0/0,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=0/0,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=0/0},Dash.vo.Representation.prototype={constructor:Dash.vo.Representation},Dash.vo.Segment=function(){"use strict";this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=0/0,this.replacementTime=null,this.replacementNumber=0/0,this.mediaStartTime=0/0,this.presentationStartTime=0/0,this.availabilityStartTime=0/0,this.availabilityEndTime=0/0,this.availabilityIdx=0/0,this.wallStartTime=0/0,this.representation=null},Dash.vo.Segment.prototype={constructor:Dash.vo.Segment},Dash.vo.UTCTiming=function(){"use strict";this.schemeIdUri="",this.value=""},Dash.vo.UTCTiming.prototype={constructor:Dash.vo.UTCTiming},MediaPlayer.dependencies.ErrorHandler=function(){"use strict";var a=MediaPlayer.events.ERROR;return{eventBus:void 0,capabilityError:function(b){this.eventBus.dispatchEvent({type:a,error:"capability",event:b})},downloadError:function(b,c,d){this.eventBus.dispatchEvent({type:a,error:"download",event:{id:b,url:c,request:d}})},manifestError:function(b,c,d){this.eventBus.dispatchEvent({type:a,error:"manifestError",event:{message:b,id:c,manifest:d}})},closedCaptionsError:function(b,c,d){this.eventBus.dispatchEvent({type:a,error:"cc",event:{message:b,id:c,cc:d}})},mediaSourceError:function(b){this.eventBus.dispatchEvent({type:a,error:"mediasource",event:b})},mediaKeySessionError:function(b){this.eventBus.dispatchEvent({type:a,error:"key_session",event:b})},mediaKeyMessageError:function(b){this.eventBus.dispatchEvent({type:a,error:"key_message",event:b})},mediaKeySystemSelectionError:function(b){this.eventBus.dispatchEvent({type:a,error:"key_system_selection",event:b})},licenseError:function(b){this.eventBus.dispatchEvent({type:a,error:"licenseError",event:b})},keyError:function(b){this.eventBus.dispatchEvent({type:a,error:"keyError",event:b})}}},MediaPlayer.dependencies.ErrorHandler.prototype={constructor:MediaPlayer.dependencies.ErrorHandler},MediaPlayer.dependencies.FragmentLoader=function(){"use strict";var a=0,b=500,c=[],d=function(a,e){var f,g=new XMLHttpRequest,h=null,i=!0,j=!0,k=null,l=this,m=function(b){j=!1;var c,d,e=new Date,f=g.response;b.firstByteDate||(b.firstByteDate=b.requestStartDate),b.requestEndDate=e,c=b.firstByteDate.getTime()-b.requestStartDate.getTime(),d=b.requestEndDate.getTime()-b.firstByteDate.getTime(),CL.manifest.debug&&console.log("DownloadRequest finished: "+(c+d)+" "+a.url),h.tresponse=b.firstByteDate,h.tfinish=b.requestEndDate,h.responsecode=g.status,h.responseHeaders=g.getAllResponseHeaders(),l.metricsModel.appendHttpTrace(h,e,e.getTime()-k.getTime(),[f?f.byteLength:0]),k=e};if(void 0===a.url||""===a.url){var n=new Uint8Array(1);return void setTimeout(function(){l.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:a,response:n})},100)}if(c.push(g),a.requestStartDate=new Date,h=l.metricsModel.addHttpRequest(a.mediaType,null,a.type,a.url,null,a.range,a.requestStartDate,null,null,null,null,a.duration,null),l.metricsModel.appendHttpTrace(h,a.requestStartDate,a.requestStartDate.getTime()-a.requestStartDate.getTime(),[0]),k=a.requestStartDate,CL.configs.isIE11||(g.timeout=CL.manifest.fragmentRequestTimeout),g.open("GET",l.requestModifierExt.modifyRequestURL(a.url),!0),g.responseType="arraybuffer",g=l.requestModifierExt.modifyRequestHeader(g),void 0!==CL.manifest.customHeaders&&void 0!==CL.manifest.customHeaders.fragmentRequest)for(f in CL.manifest.customHeaders.fragmentRequest)g.setRequestHeader(f,CL.manifest.customHeaders.fragmentRequest[f]);a.range&&g.setRequestHeader("Range","bytes="+a.range),g.onprogress=function(b){var c=new Date;i&&(i=!1,(!b.lengthComputable||b.lengthComputable&&b.total!=b.loaded)&&(a.firstByteDate=c,h.tresponse=c)),l.metricsModel.appendHttpTrace(h,c,c.getTime()-k.getTime(),[g.response?g.response.byteLength:0]),k=c},g.onload=function(){g.status<200||g.status>299||(m(a,!0),l.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:a,response:g.response}))},g.onloadend=g.onerror=function(){-1!==c.indexOf(g)&&(c.splice(c.indexOf(g),1),j&&(m(a,!1),e>0?(l.log("Failed loading fragment: "+a.mediaType+":"+a.type+":"+a.startTime+", retry in "+b+"ms attempts: "+e),e--,setTimeout(function(){d.call(l,a,e)},b)):(l.log("Failed loading fragment: "+a.mediaType+":"+a.type+":"+a.startTime+" no retry attempts left"),l.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:a,bytes:null},new MediaPlayer.vo.Error(null,"failed loading fragment",null)))))},g.send()},e=function(a){var b=this,c=new XMLHttpRequest,d=!1;c.open("HEAD",a.url,!0),c.onload=function(){c.status<200||c.status>299||(d=!0,b.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,{request:a,exists:!0}))},c.onloadend=c.onerror=function(){d||b.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,{request:a,exists:!1})},c.send()};return{metricsModel:void 0,errHandler:void 0,log:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,load:function(b){b?d.call(this,b,a):this.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:b,bytes:null},new MediaPlayer.vo.Error(null,"request is null",null))},checkForExistence:function(a){return a?void e.call(this,a):void this.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,{request:a,exists:!1})},abort:function(){var a,b,d=c.length;for(a=0;d>a;a+=1)b=c[a],c[a]=null,b.abort(),b=null;c=[]}}},MediaPlayer.dependencies.FragmentLoader.prototype={constructor:MediaPlayer.dependencies.FragmentLoader},MediaPlayer.dependencies.FragmentLoader.eventList={ENAME_LOADING_COMPLETED:"loadingCompleted",ENAME_CHECK_FOR_EXISTENCE_COMPLETED:"checkForExistenceCompleted"},MediaPlayer.dependencies.LiveEdgeFinder=function(){"use strict";var a,b=!1,c=0/0,d=MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES,e=function(a){var b=a.value,d=((new Date).getTime()-c)/1e3;this.notify(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,{liveEdge:b,searchTime:d},null===b?new MediaPlayer.vo.Error(MediaPlayer.dependencies.LiveEdgeFinder.LIVE_EDGE_NOT_FOUND_ERROR_CODE,"live edge has not been found",null):null)},f=function(f){var g=this;!g.streamProcessor.isDynamic()||b||f.error||(a=g.synchronizationRulesCollection.getRules(d),b=!0,c=(new Date).getTime(),g.rulesController.applyRules(a,g.streamProcessor,e.bind(g),null,function(a,b){return b}))},g=function(a){d=a.error?MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES:MediaPlayer.rules.SynchronizationRulesCollection.prototype.TIME_SYNCHRONIZED_RULES};return{system:void 0,synchronizationRulesCollection:void 0,rulesController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED]=f,this[MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED]=g},initialize:function(a){this.streamProcessor=a,this.fragmentLoader=a.fragmentLoader},abortSearch:function(){b=!1,c=0/0}}},MediaPlayer.dependencies.LiveEdgeFinder.prototype={constructor:MediaPlayer.dependencies.LiveEdgeFinder},MediaPlayer.dependencies.LiveEdgeFinder.eventList={ENAME_LIVE_EDGE_SEARCH_COMPLETED:"liveEdgeFound"},MediaPlayer.dependencies.LiveEdgeFinder.LIVE_EDGE_NOT_FOUND_ERROR_CODE=1,MediaPlayer.dependencies.ManifestLoader=function(){"use strict";var a,b=3,c=500,d=function(a){var b=null;return-1!==a.indexOf("/")&&(-1!==a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),b=a.substring(0,a.lastIndexOf("/")+1)),b},e=function(b,f){var g,h,i,j=d(b),k=new XMLHttpRequest,l=new Date,m=null,n=!0,o=this;h=function(){if(!(k.status<200||k.status>299)){if(n=!1,m=new Date,o.metricsModel.addHttpRequest("stream",null,"MPD",b,null,null,l,m,null,k.status,null,null,k.getAllResponseHeaders()),CL.configs.isIE11||CL.configs.isActiveVideoChrome){if(CL.configs.isIE11===!0){var a=k.getResponseHeader("Content-Location");null!==a&&(j=d(a))}}else j=d(k.responseURL);g=o.parser.parse(k.responseText,j),g?(g.url=b,g.loadedTime=m,o.metricsModel.addManifestUpdate("stream",g.type,l,m,g.availabilityStartTime),o.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,{manifest:g})):o.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,{manifest:null},new MediaPlayer.vo.Error(null,"Failed loading manifest: "+b,null))}},i=function(){n&&(n=!1,o.metricsModel.addHttpRequest("stream",null,"MPD",b,null,null,l,new Date,k.status,null,null,k.getAllResponseHeaders()),f>0?(o.log("Failed loading manifest: "+b+", retry in "+c+"ms attempts: "+f),f--,setTimeout(function(){e.call(o,b,f)},c)):(o.log("Failed loading manifest: "+b+" no retry attempts left"),o.errHandler.downloadError("manifest",b,k),o.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,null,new Error("Failed loading manifest: "+b+" no retry attempts left"))))};try{if(k.onload=h,k.onloadend=i,k.onerror=i,CL.configs.isIE11||(k.timeout=CL.manifest.manifestRequestTimeout),k.open("GET",o.requestModifierExt.modifyRequestURL(b),!0),void 0!==CL.manifest.customHeaders&&void 0!==CL.manifest.customHeaders.manifestRequest)for(a in CL.manifest.customHeaders.manifestRequest)k.setRequestHeader(a,CL.manifest.customHeaders.manifestRequest[a]);k.send()}catch(p){k.onerror()}};return{log:void 0,parser:void 0,errHandler:void 0,metricsModel:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,load:function(a){e.call(this,a,b)}}},MediaPlayer.dependencies.ManifestLoader.prototype={constructor:MediaPlayer.dependencies.ManifestLoader},MediaPlayer.dependencies.ManifestLoader.eventList={ENAME_MANIFEST_LOADED:"manifestLoaded"},MediaPlayer.dependencies.ManifestUpdater=function(){"use strict";var a=0/0,b=null,c=!1,d=!1,e=function(){null!==b&&(clearInterval(b),b=null)},f=function(){e.call(this),isNaN(a)||(this.log("Refresh manifest in "+a+" seconds."),b=setTimeout(h.bind(this),Math.min(1e3*a,Math.pow(2,31)-1),this))},g=function(){var b,c,d=this,e=d.manifestModel.getValue();void 0!==e&&null!==e&&(b=d.manifestExt.getRefreshDelay(e),c=((new Date).getTime()-e.loadedTime.getTime())/1e3,a=Math.max(b-c,0),f.call(d))},h=function(){var a,b,c,e,f=this,g=0;if(!d)if(d=!0,a=f.manifestModel.getValue(),b=a.url,c=new Date,e=c.getTime()-a.loadedTime.getTime(),CL.manifest.useLookAheadFragments===!0&&e>1e4&&(CL.configs.needManifestUpdate=!0),a.hasOwnProperty("Location")&&(b=a.Location),a.hasOwnProperty("lookAheadFragmentCount")&&(g=isNaN(a.lookAheadFragmentCount)?0:parseInt(a.lookAheadFragmentCount)),CL.manifest.useLookAheadFragments===!0&&CL.configs.needManifestUpdate===!1&&g>0){var h=["audio","video","text"];new castLabsDashJS.classes.Utils;for(var i in h){var j=h[i];if(void 0!==CL.configs.activeTrack[j]&&void 0!=a.Period_asArray[0].AdaptationSet_asArray[CL.configs.activeTrack[j].adaptionIndex]){for(var k=a.Period_asArray[0].AdaptationSet_asArray[CL.configs.activeTrack[j].adaptionIndex].SegmentTemplate.SegmentTimeline.S_asArray;CL.configs.lookAheadFragments[j].length>0;){var l,m=CL.configs.lookAheadFragments[j].shift();l={t:m.absoluteTime,d:m.absoluteDuration};for(var n=k.length-1;n>0;n--){if(k[n].t<l.t){k.splice(n+1,0,l),k.splice(0,1);break}if(k[n].t==l.t)break}}a.Period_asArray[0].AdaptationSet_asArray[CL.configs.activeTrack[j].adaptionIndex].SegmentTemplate_asArray[0].SegmentTimeline_asArray[0].S_asArray=k.concat([])}}var c=new Date;a.loadedTime.setTime(c.getTime()),a.minimumUpdatePeriod=4,f.manifestLoader.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,{manifest:a})
}else f.manifestLoader.load(b),CL.configs.needManifestUpdate=!1},i=function(a){a.error||(this.manifestModel.setValue(a.data.manifest),this.log("Manifest has been refreshed."),c||g.call(this))},j=function(){this.start()},k=function(){this.stop()},l=function(){d=!1};return{log:void 0,system:void 0,manifestModel:void 0,manifestExt:void 0,manifestLoader:void 0,setup:function(){this[MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED]=l,this[MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED]=i,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED]=j,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED]=k},start:function(){c=!1,g.call(this)},stop:function(){c=!0,e.call(this)}}},MediaPlayer.dependencies.ManifestUpdater.prototype={constructor:MediaPlayer.dependencies.ManifestUpdater},MediaPlayer.dependencies.Notifier=function(){"use strict";var a,b="observableId",c=0,d=function(){return this[b]||(c+=1,this[b]="_id_"+c),this[b]};return{system:void 0,setup:function(){a=this.system,a.mapValue("notify",this.notify),a.mapValue("subscribe",this.subscribe),a.mapValue("unsubscribe",this.unsubscribe)},notify:function(){var b=arguments[0]+d.call(this),c=new MediaPlayer.vo.Event;c.sender=this,c.type=arguments[0],c.data=arguments[1],c.error=arguments[2],c.timestamp=(new Date).getTime(),a.notify.call(a,b,c)},subscribe:function(b,c,e,f){if(!e&&c[b]&&(e=c[b]=c[b].bind(c)),!c)throw"observer object cannot be null or undefined";if(!e)throw"event handler cannot be null or undefined";b+=d.call(this),a.mapHandler(b,void 0,e,f)},unsubscribe:function(b,c,e){e=e||c[b],b+=d.call(this),a.unmapHandler(b,void 0,e)}}},MediaPlayer.dependencies.Notifier.prototype={constructor:MediaPlayer.dependencies.Notifier},MediaPlayer.dependencies.Stream=function(){"use strict";var a,b,c={},d=[],e=!0,f=!1,g=!1,h=!1,i=null,j=!0,k=null,l={},m=null,n=function(){f&&this.playbackController.start()},o=function(){this.playbackController.pause()},p=function(a){f&&(this.log("Do seek: "+a),this.playbackController.seek(a))},q=[],r=null,s=function(a){this.errHandler.mediaKeySessionError(a),this.log(a),this.reset()},t=function(a){var b=MediaPlayer.dependencies.protection.CommonEncryption.getPSSHForKeySystem(r,a);if(b)try{this.protectionController.createKeySession(b,"temporary")}catch(c){s.call(this,"Error creating key session! "+c.message)}else s.call(this,"Selected key system is "+r.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!")},u=function(a){if("cenc"!==a.data.initDataType)return void this.log("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+a.data.initDataType);var b=a.data.initData;if((ArrayBuffer.isView&&ArrayBuffer.isView(b)||b.buffer instanceof ArrayBuffer&&b.byteLength)&&(b=b.buffer),r)t.call(this,b);else if(void 0===r){r=null,q.push(b);try{this.protectionExt.autoSelectKeySystem(this.protectionExt.getSupportedKeySystems(b),this.protectionModel,this.protectionController,c.video,c.audio)}catch(d){s.call(this,d.message)}}else q.push(b)},v=function(){r||(r=this.protectionModel.keySystem);for(var a=0;a<q.length;a++)t.call(this,q[a]);q=[]},w=function(a){a.error?s.call(this,a.error):this.log("DRM: License server certificate successfully updated.")},x=function(a){a.error?s.call(this,a.error):this.log("DRM: Session created.  SessionID = "+a.data.getSessionID())},y=function(){this.log("DRM: Key added.")},z=function(a){var b,c=a.data.sessionToken;b="DRM: MediaKeyError - sessionId: "+c.getSessionID()+".  "+a.data.error,s.call(this,b)},A=function(a){this.log(a.error?a.data.error:"DRM: Session closed.  SessionID = "+a.data)},B=function(a){this.log(a.error?a.data.error:"DRM: Session removed.  SessionID = "+a.data)},C=function(a){var b=a.data.getKeyStatuses(),c=this;b.forEach(function(a){"output-restricted"===a||"output-not-allowed"===a?c.errHandler.keyError("output-restricted"):"output-downscaled"===a?c.errHandler.keyError("output-downscaled"):"expired"===a&&c.errHandler.keyError("expired")}),this.log("DRM: Key status changed")},D=function(a,b){var c,d=this,e=function(f){d.log("MediaSource is open!"),d.log(f),window.URL.revokeObjectURL(c),a.removeEventListener("sourceopen",e),a.removeEventListener("webkitsourceopen",e),b(a)};a.addEventListener("sourceopen",e,!1),a.addEventListener("webkitsourceopen",e,!1),c=d.mediaSourceExt.attachMediaSource(a,d.videoModel)},E=function(){var e,g=this,j=d.length,k=0;for(k;j>k;k+=1)e=d[k],e.reset(h),e=null;m&&m.reset(),d=[],b&&g.mediaSourceExt.detachMediaSource(g.videoModel),f=!1,i=null,c={},b=null,a=null},F=function(a,e){var f,g,h,i=this,j=null,l=function(a){return a.codec},n=function(b,c){var d=null;try{d=i.sourceBufferExt.createSourceBuffer(b,c)}catch(e){i.errHandler.mediaSourceError("Error creating "+a+" source buffer.")}return d},o=i.adapter.getMediaInfosForType(e,k,a),p=null;if(0==o.length)return void i.log("No "+a+" data.");"text"===a&&(l=function(a){return j=a.mimeType});for(var q=0;q<CL.configs.tracks[a].length;q++)if("text"!==a||CL.manifest.useUniversalSubtitleEngine!==!0){p=null!=CL.configs.activeTrack[a]?CL.configs.activeTrack[a]:CL.configs.tracks[a][q],h=o.length>0?o[p.id]:null,i.log("Create "+a+" buffer.");var r,s=l.call(i,h),t=null;if("text"===a||"fragmentedText"===a)t=n(b,h);else if(f=s,i.log(a+" codec: "+f),c[a]=h,r=h.contentProtection,r&&!i.capabilities.supportsEncryptedMedia())i.errHandler.capabilityError("encryptedmedia");else if(i.capabilities.supportsCodec(i.videoModel.getElement(),f))t=n(b,h);else{var u=a+"Codec ("+f+") is not supported.";i.errHandler.manifestError(u,"codec",e),i.log(u)}if(null!==t){CL.configs.activeTrack[a]=p;break}}null===t||void 0===t?i.log("No buffer was created, skipping "+a+" data."):(g=i.system.getObject("streamProcessor"),d.push(g),g.initialize(j||a,t,i.videoModel,i.fragmentController,i.playbackController,b,i,m,r),g.setMediaInfo(h),i.abrController.updateTopQualityIndex(h),i.adapter.updateData(g),"fragmentedText"===a&&(g.bufferController.videoModel=i.videoModel,t.initialize(a,g.bufferController)))},G=function(){var b,c=this;if(m=c.system.getObject("eventController"),m.initialize(c.videoModel),b=c.adapter.getEventsFor(k),m.addInlineEvents(b),F.call(c,"video",a),F.call(c,"audio",a),F.call(c,"text",a),CL.configs.isChromecast){var d=(window.mediaManager.getMediaInformation(),CL.configs.tracks.text),e=CL.configs.tracks.audio;window.self.audioTracks=e,window.self.textTracks=d}},H=function(){var a,c,d=this;a=k.manifestInfo.duration,c=d.mediaSourceExt.setDuration(b,a),d.log("Duration successfully set to: "+c),f=!0,K.call(d)},I=function(){this.log("element loaded!"),g=!0,J.call(this)},J=function(){f&&g&&0===k.index&&(m.start(),e&&n.call(this))},K=function(){var a=this,b=d.length,c=!!l.audio||!!l.video,e=c?new MediaPlayer.vo.Error(MediaPlayer.dependencies.Stream.DATA_UPDATE_FAILED_ERROR_CODE,"Data update failed",null):null,g=0;if(f){for(g;b>g;g+=1)if(d[g].isUpdating())return;j=!1,a.eventBus.dispatchEvent({type:MediaPlayer.events.STREAM_INITIALIZED,data:{streamInfo:k}}),a.notify(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,null,e)}},L=function(a){for(var b=d.length,c=null,e=0;b>e;e+=1)if(c=d[e],c.getType()===a)return c.getMediaInfo();return null},M=function(a){var b=a.data.error.code,c="";if(-1!==b){switch(b){case 1:c="MEDIA_ERR_ABORTED";break;case 2:c="MEDIA_ERR_NETWORK";break;case 3:c="MEDIA_ERR_DECODE";break;case 4:c="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:c="MEDIA_ERR_ENCRYPTED"}h=!0,this.log("Video Element Error: "+c),this.log(a.error),this.errHandler.mediaSourceError(c),this.reset()}},N=function(c){var e,f=this,g=function(c){if(b=c,G.call(f),0===d.length){var e="No streams to play.";f.errHandler.manifestError(e,"nostreams",a),f.log(e)}else f.liveEdgeFinder.initialize(d[0]),f.liveEdgeFinder.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,f.playbackController),H.call(f),J.call(f)};a=c,e=f.mediaSourceExt.createMediaSource(),D.call(f,e,g)},O=function(){var a=Q(),c=a.length,d=0;for(d;c>d;d+=1)if(!a[d].isBufferingCompleted())return;b&&k.isLast&&this.mediaSourceExt.signalEndOfStream(b)},P=function(a){var b=a.sender.streamProcessor.getType();l[b]=a.error,K.call(this)},Q=function(){var a,b,c=[],e=0,f=d.length;for(e;f>e;e+=1)b=d[e],a=b.getType(),("audio"===a||"video"===a)&&c.push(b);return c},R=function(){var a,b=this,c=d.length,e=0;for(e;c>e;e+=1){a=d[e];var f=a.getType();if((f.indexOf("text")>-1||f.indexOf("ttml")>-1)&&(f="text"),"text"===f){a.bufferController.clearFutureBuffer(b.getDuration());break}}},S=function(b){var c,e,f,g=this,h=d.length,i=0,l=!1;for(j=!0,a=g.manifestModel.getValue(),b&&(b.duration?k=b:l=!0),g.log("Manifest updated... set new data on buffers."),m&&(e=g.adapter.getEventsFor(k),m.addInlineEvents(e)),i;h>i;i+=1){f=d[i];var n=f.getType();if((n.indexOf("text")>-1||n.indexOf("ttml")>-1)&&(n="text"),l!==!0||n===b){if(c=g.adapter.getMediaInfosForType(a,k,n),"text"===n||CL.configs.previousActiveTrack[n]&&CL.configs.previousActiveTrack[n].id!=CL.configs.activeTrack[n].id){var o=function(){var b=g.playbackController.getTime()+g.playbackController.getTimeToStreamEnd(),c=f.getFragmentModel();"text"!=n&&(f.bufferController.scheduleController.stop(),c.abortRequests(),c.removeExecutedRequestsBeforeTime(b),c.cancelPendingRequests(g.abrController.getQualityFor(n,CL.configs.previousActiveTrack[n])));var d=function(){"text"!=n?(f.bufferController.scheduleController.start(),f.indexHandler.setCurrentTime(g.playbackController.getTime())):F.call(g,"text",a),CL.configs.previousActiveTrack[n]=JSON.parse(JSON.stringify(CL.configs.activeTrack[n]))};"text"!=n&&f.bufferController.subscribe("bufferCleared",g,d,!0),f.bufferController.clearFutureBuffer(b),"text"===n&&d()};g.playbackController.isSeeking()===!0&&"text"!=n?g.playbackController.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKED,g,o,!0):"audio"===n&&CL.configs.isLive===!0?CL.configs.previousActiveTrack[n]=JSON.parse(JSON.stringify(CL.configs.activeTrack[n])):o()}if(CL.configs.isSmoothStreaming===!0&&CL.configs.isLive===!0&&i==h-1&&F.call(g,"text",a),void 0==CL.configs.activeTrack[n]&&console.log(CL.configs.activeTrack[n]),f.setMediaInfo(c[CL.configs.activeTrack[n].id]),g.adapter.updateData(f),l===!0)break}}};return{system:void 0,eventBus:void 0,manifestModel:void 0,mediaSourceExt:void 0,sourceBufferExt:void 0,adapter:void 0,fragmentController:void 0,playbackController:void 0,protectionModel:void 0,protectionController:void 0,protectionExt:void 0,capabilities:void 0,log:void 0,errHandler:void 0,liveEdgeFinder:void 0,abrController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED]=O,this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=P,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR]=M,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY]=I,this[MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY]=u.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=v.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED]=w.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED]=y.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR]=z.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED]=C.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED]=x.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED]=A.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED]=B.bind(this),r=void 0},load:function(a){N.call(this,a)},setVideoModel:function(a){this.videoModel=a},initProtection:function(a){if(this.capabilities.supportsEncryptedMedia()){this.protectionModel=this.system.getObject("protectionModel"),this.protectionModel.init(this.getVideoModel()),this.protectionModel.setMediaElement(this.videoModel.getElement()),this.protectionController=this.system.getObject("protectionController"),this.protectionController.init(this.protectionModel),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this);var b=(this.adapter.getMediaInfoForType(a,k,"video"),this.adapter.getMediaInfoForType(a,k,"audio")),c=this.adapter.getMediaInfoForType(a,k,"video"),d=c?c:b;this.protectionExt.getSupportedKeySystemsFromContentProtection(d.contentProtection),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this)}},getVideoModel:function(){return this.videoModel},setAutoPlay:function(a){e=a},getAutoPlay:function(){return e},reset:function(){o.call(this),this.protectionModel&&(this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),r=void 0,this.protectionController.teardown(),this.protectionModel.teardown(),this.protectionController=void 0,this.protectionModel=void 0),E.call(this),this.fragmentController&&this.fragmentController.reset(),this.fragmentController=void 0,this.playbackController.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR,this),this.playbackController.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY,this),this.playbackController.reset(),this.liveEdgeFinder.abortSearch(),this.liveEdgeFinder.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,this.playbackController),g=!1,l={}},getDuration:function(){return k.duration},getStartTime:function(){return k.start},getStreamIndex:function(){return k.index},getId:function(){return k.id},setStreamInfo:function(a){k=a},getStreamInfo:function(){return k},hasMedia:function(a){return null!==L.call(this,a)},getBitrateListFor:function(a){return this.abrController.getBitrateList(c[a])},startEventController:function(){m.start()},resetEventController:function(){m.reset()},setPlaybackController:function(a){this.playbackController=a,a.initialize(k,this.videoModel)},getPlaybackController:function(){return this.playbackController},isUpdating:function(){return j},updateData:S,disableTextTracks:R,play:n,seek:p,pause:o}},MediaPlayer.dependencies.Stream.prototype={constructor:MediaPlayer.dependencies.Stream},MediaPlayer.dependencies.Stream.DATA_UPDATE_FAILED_ERROR_CODE=1,MediaPlayer.dependencies.Stream.eventList={ENAME_STREAM_UPDATED:"streamUpdated"},MediaPlayer.dependencies.StreamProcessor=function(){"use strict";var a,b,c,d,e,f=function(a){var b=this,c="video"===a||"audio"===a||"fragmentedText"===a?"bufferController":"textController";return b.system.getObject(c)};return{system:void 0,indexHandler:void 0,liveEdgeFinder:void 0,timelineConverter:void 0,abrController:void 0,baseURLExt:void 0,adapter:void 0,initialize:function(c,g,h,i,j,k,l,m,n){var o,p=this,q=p.system.getObject("trackController"),r=p.system.getObject("scheduleController"),s=p.liveEdgeFinder,t=p.abrController,u=p.indexHandler,v=p.baseURLExt,w=this.system.getObject("fragmentLoader"),x=f.call(p,c);b=l,d=c,e=m,a=b.getStreamInfo().manifestInfo.isDynamic,p.bufferController=x,p.playbackController=j,p.scheduleController=r,p.trackController=q,p.videoModel=h,p.fragmentController=i,p.fragmentLoader=w,q.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,x),i.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED,x),"video"===d||"audio"===d||"fragmentedText"===d?(t.subscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,x),t.subscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,q),t.subscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,r),s.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,this.timelineConverter),s.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,q),s.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,r),q.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED,r),q.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,r),q.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,b),b.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,r),j.streamProcessor||(j.streamProcessor=p,q.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,j)),i.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED,x),i.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START,r),i.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,r),i.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,x),i.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,r.scheduleRulesCollection.bufferLevelRule),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,h),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED,r),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,r),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,r),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,q),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,r),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED,r),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED,b),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED,r),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,r.scheduleRulesCollection.bufferLevelRule),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,r.scheduleRulesCollection.bufferLevelRule),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,j),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,x),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,x),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,x),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,r),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,x),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,r),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,r),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,r.scheduleRulesCollection.playbackTimeRule),a&&j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,q),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,x),j.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,r),v.subscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,u),v.subscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,u)):x.subscribe(MediaPlayer.dependencies.TextController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED,r),u.initialize(this),x.initialize(d,g,k,p,n),r.initialize(d,this),t.initialize(d,this),o=this.getFragmentModel(),o.setLoader(w),o.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED,i),o.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,i),o.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED,i),o.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,r),w.subscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,o),("video"===d||"audio"===d||"fragmentedText"===d)&&(x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,o),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,o),x.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED,o)),q.initialize(this)},isUpdating:function(){return this.trackController.isUpdating()},getType:function(){return d},getFragmentLoader:function(){return this.fragmentLoader},getFragmentModel:function(){return this.scheduleController.getFragmentModel()},getPlaybackController:function(){return this.playbackController},getStreamInfo:function(){return b.getStreamInfo()},setMediaInfo:function(a){c=a},getMediaInfo:function(){return c},getScheduleController:function(){return this.scheduleController},getEventController:function(){return e},start:function(){this.scheduleController.start()},stop:function(){this.scheduleController.stop()},getCurrentTrack:function(){return this.adapter.getCurrentTrackInfo(this.trackController)},getTrackForQuality:function(a){return this.adapter.getTrackInfoForQuality(this.trackController,a)},isBufferingCompleted:function(){return this.bufferController.isBufferingCompleted()},isDynamic:function(){return a},reset:function(a){var c=this,d=c.bufferController,e=c.trackController,f=c.scheduleController,g=c.liveEdgeFinder,h=c.fragmentController,i=c.abrController,j=c.playbackController,k=this.indexHandler,l=this.baseURLExt,m=this.getFragmentModel(),n=this.fragmentLoader,o=c.videoModel;i.unsubscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,d),i.unsubscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,e),i.unsubscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,f),g.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,this.timelineConverter),g.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,f),g.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,e),e.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED,f),e.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,d),e.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,f),e.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,b),e.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,j),b.unsubscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,f),h.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED,d),h.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED,d),h.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START,f),h.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,f),h.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,d),h.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,f.scheduleRulesCollection.bufferLevelRule),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,o),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED,f),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,f),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,f),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,e),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,f),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED,f),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED,b),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED,f),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,f.scheduleRulesCollection.bufferLevelRule),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,f.scheduleRulesCollection.bufferLevelRule),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,j),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,d),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,d),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,d),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,f),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,d),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,f),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,f),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,e),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,d),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,f),j.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,f.scheduleRulesCollection.playbackTimeRule),l.unsubscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,k),l.unsubscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,k),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,m),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,m),d.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED,m),m.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED,h),m.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,h),m.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED,h),m.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,f),n.unsubscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,m),m.reset(),k.reset(),this.bufferController.reset(a),this.scheduleController.reset(),this.bufferController=null,this.scheduleController=null,this.trackController=null,this.videoModel=null,this.fragmentController=null}}},MediaPlayer.dependencies.StreamProcessor.prototype={constructor:MediaPlayer.dependencies.StreamProcessor},MediaPlayer.utils.TTMLParser=function(){"use strict";var a,b=3600,c=60,d=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])((\.[0-9][0-9][0-9])|(:[0-9][0-9]))$/,e=function(e){var f,g,h,i=d.test(e);if(!i)return 0/0;if(f=e.split(":"),g=parseFloat(f[0])*b+parseFloat(f[1])*c+parseFloat(f[2]),f[3]){if(h=a.tt._frameRate,!h||isNaN(h))return 0/0;g+=parseFloat(f[3])/h}return g},f=function(){var b=!1,c=a.hasOwnProperty("tt"),d=c?a.tt.hasOwnProperty("head"):!1,e=d?a.tt.head.hasOwnProperty("layout"):!1,f=d?a.tt.head.hasOwnProperty("styling"):!1,g=c?a.tt.hasOwnProperty("body"):!1,h=d?a.tt.head.hasOwnProperty("profile"):!1;return c&&d&&e&&f&&g&&(b=!0),b&&(b=h&&("http://www.w3.org/ns/ttml/profile/sdp-us"===a.tt.head.profile.use||"http://www.w3.org/ns/ttml/profile/sdp-us"===a.tt.head.profile._use)),b},g=function(a,b){var c=Object.keys(a).filter(function(c){return"xmlns"===c.split(":")[0]&&a[c]===b}).map(function(a){return a.split(":")[1]});return 1!=c.length?null:c[0]},h=function(b){var c,d,h,i,j,k,l,m,n,o=[],p=new X2JS([],"",!1);if(a=p.xml_str2json(b),!f())throw c="TTML document has incorrect structure";if(k=g(a.tt,"http://www.w3.org/ns/ttml#parameter"),a.tt.hasOwnProperty(k+":frameRate")&&(a.tt.frameRate=parseInt(a.tt[k+":frameRate"],10)),d=a.tt.body.div.p,!d||0===d.length)throw c="TTML document does not contain any cues";for(m=0;m<d.length;m+=1){if(h=d[m],i=e(h._begin),j=e(h._end),isNaN(i)||isNaN(j))throw c="TTML document has incorrect timing value";if(void 0!==h["smpte:backgroundImage"]){var q=a.tt.head.metadata.image_asArray;for(n=0;n<q.length;n+=1)"#"+q[n]["xml:id"]==h["smpte:backgroundImage"]&&o.push({start:i,end:j,id:q[n]["xml:id"],data:"data:image/"+q[n].imagetype.toLowerCase()+";base64, "+q[n].__text,type:"image"})}else l=h.span_asArray?h.span_asArray[0].__text:h.__text,o.push({start:i,end:j,data:l,type:"text"})}return o};return{parse:h}},MediaPlayer.dependencies.TextSourceBuffer=function(){var a,b;return{system:void 0,eventBus:void 0,errHandler:void 0,initialize:function(c,d){b=c,this.videoModel=d.videoModel,a=d.streamProcessor.getCurrentTrack().mediaInfo,this.buffered=this.system.getObject("customTimeRanges"),this.initializationSegmentReceived=!1,this.timescale=9e4},append:function(c,d){var e,f,g,h,i,j=this,k=this.system.getObject("clUtils"),l=k.B64Tools.decode(k.arrToBase64(c));if("fragmentedText"==b){var m;if(this.initializationSegmentReceived)for(m=j.system.getObject("fragmentExt"),h=m.getSamplesInfo(c.buffer),i=0;i<h.length;i++){this.firstSubtitleStart||(this.firstSubtitleStart=h[0].cts-d.startTime*this.timescale),h[i].cts-=this.firstSubtitleStart,this.buffered.add(h[i].cts/this.timescale,(h[i].cts+h[i].duration)/this.timescale),l=window.UTF8.decode(new Uint8Array(c.buffer.slice(h[i].offset,h[i].offset+h[i].size)));var n=this.system.getObject("ttmlParser");try{e=n.parse(l),this.textTrackExtensions.addCaptions(this.firstSubtitleStart/this.timescale,e)}catch(o){}}else this.initializationSegmentReceived=!0,f=a.id,g=a.lang,this.textTrackExtensions=j.getTextTrackExtensions(),this.textTrackExtensions.addTextTrack(j.videoModel.getElement(),e,f,g,!0),j.eventBus.dispatchEvent({type:MediaPlayer.events.TEXT_TRACK_ADDED}),m=j.system.getObject("fragmentExt"),this.timescale=m.getMediaTimescaleFromMoov(c.buffer)
}else{l=window.UTF8.decode(c);try{e=j.getParser().parse(l),f=a.id,g=a.lang,j.getTextTrackExtensions().addTextTrack(j.videoModel.getElement(),e,f,g,!0),j.eventBus.dispatchEvent({type:MediaPlayer.events.TEXT_TRACK_ADDED})}catch(o){j.errHandler.closedCaptionsError(o,"parse",l)}}},abort:function(){this.getTextTrackExtensions().deleteCues(this.videoModel.getElement())},getParser:function(){var a;return"text/vtt"===b?a=this.system.getObject("vttParser"):"application/ttml+xml"===b&&(a=this.system.getObject("ttmlParser")),a},getTextTrackExtensions:function(){return this.system.getObject("textTrackExtensions")},addEventListener:function(a,b,c){this.eventBus.addEventListener(a,b,c)},removeEventListener:function(a,b,c){this.eventBus.removeEventListener(a,b,c)}}},MediaPlayer.dependencies.TextSourceBuffer.prototype={constructor:MediaPlayer.dependencies.TextSourceBuffer},MediaPlayer.dependencies.TimeSyncController=function(){"use strict";var a=5e3,b=0,c=!1,d=!1,e=function(a){c=a},f=function(){return c},g=function(a){d=a},h=function(a){b=a},i=function(){return b},j=function(a){var b,c,d=60,e=60,f=1e3,g=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,h=g.exec(a);return b=Date.UTC(parseInt(h[1],10),parseInt(h[2],10)-1,parseInt(h[3],10),parseInt(h[4],10),parseInt(h[5],10),h[6]&&(parseInt(h[6],10)||0),h[7]&&parseFloat(h[7])*f||0),h[9]&&h[10]&&(c=parseInt(h[9],10)*e+parseInt(h[10],10),b+=("+"===h[8]?-1:1)*c*d*f),new Date(b).getTime()},k=function(a){var b=Date.parse(a);return isNaN(b)&&(b=j(a)),b},l=function(a){return Date.parse(a)},m=function(a){return Date.parse(a)},n=function(a,b,c){c()},o=function(a,b,c){var d=k(a);return isNaN(d)?void c():void b(d)},p=function(b,c,d,e,f){var g,h,i=!1,j=new XMLHttpRequest,k=f?"HEAD":"GET",l=c.match(/\S+/g);c=l.shift(),g=function(){i||(i=!0,l.length?p(b,l.join(" "),d,e,f):e())},h=function(){var a,c;200===j.status&&(a=f?j.getResponseHeader("Date"):j.response,c=b(a),isNaN(c)||(d(c),i=!0))},j.open(k,c),j.timeout=a||0,j.onload=h,j.onloadend=g,j.send()},q=function(a,b,c){p.call(this,m,a,b,c,!0)},r={"urn:mpeg:dash:utc:http-head:2014":q,"urn:mpeg:dash:utc:http-xsdate:2014":p.bind(null,k),"urn:mpeg:dash:utc:http-iso:2014":p.bind(null,l),"urn:mpeg:dash:utc:direct:2014":o,"urn:mpeg:dash:utc:http-head:2012":q,"urn:mpeg:dash:utc:http-xsdate:2012":p.bind(null,k),"urn:mpeg:dash:utc:http-iso:2012":p.bind(null,l),"urn:mpeg:dash:utc:direct:2012":o,"urn:mpeg:dash:utc:http-ntp:2014":n,"urn:mpeg:dash:utc:ntp:2014":n,"urn:mpeg:dash:utc:sntp:2014":n},s=function(a,b){var c=this,d=b||0,f=a[d],g=function(a,b){var d=!a||!b;e(!1),c.notify(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,{time:a,offset:b},d?new MediaPlayer.vo.Error(MediaPlayer.dependencies.TimeSyncController.TIME_SYNC_FAILED_ERROR_CODE):null)};e(!0),f?r.hasOwnProperty(f.schemeIdUri)?r[f.schemeIdUri](f.value,function(a){var b=(new Date).getTime(),d=a-b;h(d),c.log("Local time:      "+new Date(b)),c.log("Server time:     "+new Date(a)),c.log("Difference (ms): "+d),g.call(c,a,d)},function(){s.call(c,a,d+1)}):s.call(c,a,d+1):(h(0),g.call(c))};return{log:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,getOffsetToDeviceTimeMs:function(){return i()},initialize:function(a){f()||(s.call(this,a),g(!0))},reset:function(){g(!1),e(!1)}}},MediaPlayer.dependencies.TimeSyncController.prototype={constructor:MediaPlayer.dependencies.TimeSyncController},MediaPlayer.dependencies.TimeSyncController.eventList={ENAME_TIME_SYNCHRONIZATION_COMPLETED:"timeSynchronizationComplete"},MediaPlayer.dependencies.TimeSyncController.TIME_SYNC_FAILED_ERROR_CODE=1,MediaPlayer.utils.VTTParser=function(){"use strict";var a=/(?:\r\n|\r|\n)/gm,b=/-->/,c=/(^[\s]+|[\s]+$)/g,d=/\s\b/g,e=function(a){var b=a.split(":"),c=b.length-1;return a=60*parseInt(b[c-1],10)+parseFloat(b[c]),2===c&&(a+=3600*parseInt(b[0],10)),a},f=function(a){var c=a.split(b),e=c[1].split(d);return e.shift(),c[1]=e[0],e.shift(),{cuePoints:c,styles:g(e)}},g=function(a){var b={};return a.forEach(function(a){(a.match(/align/)||a.match(/A/))&&(b.align=a.split(/:/)[1]),(a.match(/line/)||a.match(/L/))&&(b.line=a.split(/:/)[1].replace(/%/,"")),(a.match(/position/)||a.match(/P/))&&(b.position=a.split(/:/)[1].replace(/%/,"")),(a.match(/size/)||a.match(/S/))&&(b.size=a.split(/:/)[1].replace(/%/,""))}),b},h=function(a,b){for(var c,d=b,e="";""!==a[d]&&d<a.length;)d++;if(c=d-b,c>1)for(var f=0;c>f;f++)e+=a[b+f],f!==c-1&&(e+="\n");else e=a[b];return e};return{parse:function(d){var g,i=[];d=d.split(a),g=d.length;for(var j=0;g>j;j++){var k=d[j];if(k.length>0&&"WEBVTT"!==k&&k.match(b)){var l=f(k),m=l.cuePoints,n=l.styles,o=h(d,j+1);i.push({start:e(m[0].replace(c,"")),end:e(m[1].replace(c,"")),data:o,styles:n})}}return i}}},MediaPlayer.dependencies.AbrController=function(){"use strict";var a=!0,b={},c={},d={},e={},f={},g=[],h=-1,i=function(a,b){var d;return c[b]=c[b]||{},c[b].hasOwnProperty(a)||(c[b][a]=0),d=c[b][a]},j=function(a,b,d){c[b]=c[b]||{},c[b][a]=d},k=function(a,b){var c;return d[b]=d[b]||{},d[b].hasOwnProperty(a)||(d[b][a]=0),c=d[b][a]},l=function(a,b,c){d[b]=d[b]||{},d[b][a]=c},m=function(a,c,d){b[c]=b[c]||{},b[c][a]=d},n=function(a){return e[a]},o=function(a,b){e[a]=b},p=function(a){return e.hasOwnProperty("max")&&e.max.hasOwnProperty(a)?e.max[a]:0/0},q=function(a,b){e.max=e.max||{},e.max[a]=b},r=function(a,c){var d;return b[c]=b[c]||{},b[c].hasOwnProperty(a)||(b[c][a]=0),d=s.call(this,b[c][a],a)},s=function(a,b){var c=p(b);if(isNaN(c))return a;var d=this.getQualityForBitrate(f[b].getMediaInfo(),c);return Math.min(a,d)};return{log:void 0,abrRulesCollection:void 0,rulesController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,initialize:function(a,b){f[a]=b,g.audio=!0,g.video=!0},getAutoSwitchBitrate:function(){return a},setAutoSwitchBitrate:function(b){a=b},getPlaybackQuality:function(b){var c,d,e,f,m,n=this,o=b.getType(),p=b.getStreamInfo().id,q=function(a){var e=r.call(n,o,p);c=a.value,f=a.confidence,0>c&&(c=0),c>e&&(c=e),d=i(o,p),c!==d&&(g[o]=!1,j(o,p,c),l(o,p,f),n.notify(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,{mediaType:o,streamInfo:b.getStreamInfo(),oldQuality:d,newQuality:c}))};if(c=i(o,p),f=k(o,p),a){if(CL.manifest.ABRParameters.qualitySwitchThreshold>0){if(m=(new Date).getTime(),m-h<CL.manifest.ABRParameters.qualitySwitchThreshold)return;h=m}g[o]!==!1&&(e=n.abrRulesCollection.getRules(MediaPlayer.rules.ABRRulesCollection.prototype.QUALITY_SWITCH_RULES),n.rulesController.applyRules(e,b,q.bind(n),c,function(a,b){return a=a===MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE?0:a,Math.max(a,b)}))}},setPlaybackQuality:function(a,b,c){var d=b.id,e=i(a,d),f=null!==c&&!isNaN(c)&&c%1===0;if(!f)throw"argument is not an integer";g[a]!==!1&&g[a]===!0&&c!==e&&c>=0&&c<=r.call(this,a,d)&&(g[a]=!1,j(a,b.id,c),this.notify(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,{mediaType:a,streamInfo:b,oldQuality:e,newQuality:c}))},setQualitySwitchAllowed:function(a,b){g[a]=b},getQualitySwitchAllowed:function(a){return g[a]},getQualityFor:function(a,b){return i(a,b.id)},getConfidenceFor:function(a,b){return k(a,b.id)},setInitialBitrateFor:function(a,b){o(a,b)},getInitialBitrateFor:function(a){return n(a)},setMaxAllowedBitrateFor:function(a,b){q(a,b)},getMaxAllowedBitrateFor:function(a){return p(a)},getQualityForBitrate:function(a,b){for(var c,d=this.getBitrateList(a),e=d.length,f=0;e>f;f+=1)if(c=d[f],1e3*b<=c.bitrate)return f;return e-1},getBitrateList:function(a){if(!a||!a.bitrateList)return null;for(var b,c=a.bitrateList,d=a.type,e=[],f=0,g=c.length;g>f;f+=1)b=new MediaPlayer.vo.BitrateInfo,b.mediaType=d,b.qualityIndex=f,b.bitrate=c[f],e.push(b);return e},updateTopQualityIndex:function(a){var b,c=a.type,d=a.streamInfo.id;return b=a.trackCount-1,m(c,d,b),b},isPlayingAtTopQuality:function(a){var b,c=this,d=a.id,e=c.getQualityFor("audio",a),f=c.getQualityFor("video",a);return b=e===r.call(this,"audio",d)&&f===r.call(this,"video",d)},getTopQualityIndexFor:r,reset:function(){a=!0,b={},c={},d={},f={},g.audio=!0,g.video=!0}}},MediaPlayer.dependencies.AbrController.prototype={constructor:MediaPlayer.dependencies.AbrController},MediaPlayer.dependencies.AbrController.eventList={ENAME_QUALITY_CHANGED:"qualityChanged"},MediaPlayer.dependencies.AbrController.DEFAULT_VIDEO_BITRATE=1e3,MediaPlayer.dependencies.AbrController.DEFAULT_AUDIO_BITRATE=100,MediaPlayer.dependencies.BufferController=function(){"use strict";var a,b,c,d,e=.5,f=[],g=0,h=-1,i=!1,j=0,k=0,l=Number.POSITIVE_INFINITY,m=-1,n=-1,o=null,p=null,q=!1,r=!1,s=[],t=!1,u=!1,v=function(){var a=this.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING});return u===!0?!1:h!=g&&(w(s,h)||w(a,h))?!0:!(h===g)},w=function(a,b){var c=0,d=a.length;for(c;d>c;c+=1)if(a[c].quality===b)return!0;return!1},x=function(a,b){var c=function(a,c){return a[b]<c[b]?-1:a[b]>c[b]?1:0};a.sort(c)},y=function(a){var c=this;a.data.fragmentModel===c.streamProcessor.getFragmentModel()&&(c.log("Initialization finished loading: "+b),f[a.data.quality]=a.data.bytes,a.data.quality===g&&v.call(c)&&_.call(c))},z=function(a){if(a.data.fragmentModel===this.streamProcessor.getFragmentModel()){var c,d=a.data.bytes,e=a.data.quality,f=a.data.index,g=a.data.startTime,h=this.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,quality:e,index:f})[0],i=this.streamProcessor.getTrackForQuality(e),j=this.adapter.getEventsFor(i.mediaInfo,this.streamProcessor),k=this.adapter.getEventsFor(i,this.streamProcessor);(j.length>0||k.length>0)&&(c=D.call(this,d,h,j,k),this.streamProcessor.getEventController().addInbandEvents(c)),d=E.call(this,d);var l=g*h.timescale,a=l%1;a>0&&(a>.99?l+=1-a:.01>a&&(l-=a)),s.push({bytes:d,quality:e,index:f,startTimeInTimescale:l,startTime:g}),x(s,"index"),CL.configs.lastAppendedSegment[b]=h,S.call(this)}},A=function(a,c,e,f,i){if(void 0===i)var i=null;r=!0,d={quality:c,index:e,startTime:f};var j=this,k=isNaN(e);if(c!==g&&k||c!==h&&!k)return void U.call(j,c,e);var l=j.utils,m=l.getBoxType(a);if(CL.manifest.enableSmoothStreamingCompatibility===!0&&(CL.manifest.parseMoofFragments=!0),CL.configs.isSmoothStreaming===!0&&("moof"!=m||CL.manifest.parseMoofFragments===!0)){var n=this.streamProcessor.getTrackForQuality(c);a=l.parseSmoothStreamingFragment(n,a,b,i)}if("ftyp"===m&&CL.manifest.generatePSSH===!0&&(CL.configs.debug&&console.log(l.byteArrayToHexString(a)),a=l.getSubBox(a,"moov"),m=l.getBoxType(a)),"moov"===m&&CL.manifest.generatePSSH===!0){var p=l.generatePSSHBox(j.contentProtectionData);a=l.injectPSSHBox(a,p)}if("moov"===m&&CL.configs.isIE11===!0&&CL.configs.isProtected===!0&&(a=l.filterUUIDBox(a)),k===!0){var j=this,q=function(){var a=j.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING});return w(s,h)||w(a,h)?!0:!1},t=d,v=setInterval(function(){return null===j.streamProcessor||null===j.streamProcessor.bufferController||null===j.streamProcessor.fragmentController||null===j.streamProcessor.trackController||null===j.streamProcessor.videoModel?void clearInterval(v):void(q()?r=!1:(r=!0,clearInterval(v),d=t,CL.configs.debug&&"video"===j.getMediaType()&&console.log("Append init for quality "+c),j.sourceBufferExt.append(o,a,t)))},100);return void(u=!0)}CL.configs.debug&&"video"===j.getMediaType()&&console.log("Append data for quality "+c),j.sourceBufferExt.append(o,a,d)},B=function(c){if(o===c.data.buffer){this.isBufferingCompleted()&&this.streamProcessor.getStreamInfo().isLast&&this.mediaSourceExt.signalEndOfStream(a);var e,f=this;if(c.error)return c.error.code===MediaPlayer.dependencies.SourceBufferExtensions.QUOTA_EXCEEDED_ERROR_CODE&&(s.unshift({bytes:c.data.bytes,quality:d.quality,index:d.index}),l=.8*L.call(f),f.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED,{criticalBufferLevel:l}),I.call(f)),void(r=!1);C.call(f),H.call(f)||(f.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED,{criticalBufferLevel:l}),I.call(f)),e=f.sourceBufferExt.getAllRanges(o);var g=f.streamProcessor.videoModel,h=g.getElement();if(e&&e.length>0){var i,j;for(f.log("Number of buffered "+b+" ranges: "+e.length),i=0,j=e.length;j>i;i+=1)f.log("Buffered "+b+" Range: "+e.start(i)+" - "+e.end(i)),CL.configs.isLive===!0&&h.seeking===!1&&h.paused===!1&&0===h.playbackRate&&Math.abs(h.currentTime-e.end(i))<1&&j-1>i&&(CL.configs.bufferGap=Math.max(e.start(i+1),CL.configs.bufferGap));null!=CL.configs.minStartTime&&CL.configs.minStartTime>0&&0==g.getCurrentTime()&&0==CL.configs.isIE11&&g.setCurrentTime(CL.configs.minStartTime)}if(CL.configs.isLive===!0&&h.seeking===!1&&h.paused===!1&&0===h.playbackRate&&CL.configs.bufferGap>0){var k=CL.configs.bufferGap+.1,m=-1;m=setInterval(function(){try{h.currentTime<k?(h.currentTime=k,k+=.1):(CL.configs.bufferGap=0,clearInterval(m))}catch(a){try{clearInterval(m)}catch(a){}}},1e3)}T.call(f,d.quality,d.index),f.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,{quality:d.quality,index:d.index,bufferedRanges:e})}},C=function(){var a=this,b=a.playbackController.getTime();return this.playbackController.getTimeToStreamEnd(),j=a.sourceBufferExt.getBufferLength(o,b),a.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,{bufferLevel:j}),F.call(a),N.call(a),CL.configs.debug&&"video"===a.getMediaType()&&console.log("BufferLevel: "+a.getMediaType()+" :"+j),e>j&&!i&&P.call(a,!1),!0},D=function(a,b,c,d){var e,f,g,h,i=[],j=0,k=Math.pow(256,2),l=Math.pow(256,3),m=Math.max(isNaN(b.startTime)?0:b.startTime,0),n=[];t=!1,h=c.concat(d);for(var o=0;o<h.length;o++)n[h[o].schemeIdUri]=h[o];for(;j<a.length&&(e=String.fromCharCode(a[j+4],a[j+5],a[j+6],a[j+7]),f=a[j]*l+a[j+1]*k+256*a[j+2]+1*a[j+3],"moov"!=e&&"moof"!=e);){if("emsg"==e){t=!0;for(var p=["","",0,0,0,0,""],q=0,r=j+12;f+j>r;)0===q||1==q||6==q?(0!==a[r]?p[q]+=String.fromCharCode(a[r]):q+=1,r+=1):(p[q]=a[r]*l+a[r+1]*k+256*a[r+2]+1*a[r+3],r+=4,q+=1);g=this.adapter.getEvent(p,n,m),g&&i.push(g)}j+=f}return i},E=function(a){if(!t)return a;for(var b,c,d=a.length,e=0,f=0,g=Math.pow(256,2),h=Math.pow(256,3),i=new Uint8Array(a.length);d>e;){if(b=String.fromCharCode(a[e+4],a[e+5],a[e+6],a[e+7]),c=a[e]*h+a[e+1]*g+256*a[e+2]+1*a[e+3],"emsg"!=b)for(var j=e;e+c>j;j++)i[f]=a[j],f+=1;e+=c}return i.subarray(0,f)},F=function(){var a=G.call(this),b=2*c,d=j-a;d>=b&&!q?(q=!0,this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN)):b/2>d&&q&&(this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED),q=!1,S.call(this))},G=function(){var a=this.metricsModel.getReadOnlyMetricsFor("video"),b=this.metricsExt.getCurrentBufferLevel(a),c=this.metricsModel.getReadOnlyMetricsFor("audio"),d=this.metricsExt.getCurrentBufferLevel(c),e=null;return e=null===b||null===d?null!==d?d.level:null!==b?b.level:null:Math.min(d.level,b.level)},H=function(){var a=this,b=L.call(a);return l>b},I=function(){var b,c,d,e,f,g=this;o&&(b=g.playbackController.getTime(),f=g.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,time:b})[0],d=f&&!isNaN(f.startTime)?f.startTime:Math.floor(b),e=g.sourceBufferExt.getBufferRange(o,b),null===e&&o.buffered.length>0&&(d=o.buffered.end(o.buffered.length-1)),c=o.buffered.start(0),g.sourceBufferExt.remove(o,c,d,a))},J=function(b){var c,d=this,e=(d.playbackController.getTime(),b);o&&(e=b,c=0,CL.configs.debug&&console.log("clear buffered audio from "+c+" to "+e),d.sourceBufferExt.waitForUpdateEnd(o,function(){d.sourceBufferExt.remove(o,c,e,a)}))},K=function(a){o===a.data.buffer&&(C.call(this),this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED,{from:a.data.from,to:a.data.to,hasEnoughSpaceToAppend:H.call(this)}),H.call(this)||setTimeout(I.bind(this),1e3*c))},L=function(){var a,b,c=this,d=c.sourceBufferExt.getAllRanges(o),e=0;if(!d)return e;for(b=0,a=d.length;a>b;b+=1)e+=d.end(b)-d.start(b);return e},M=function(){var a=m===n-1;a&&!i&&(i=!0,this.streamProcessor.abrController.setAutoSwitchBitrate(!1),this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED))},N=function(){var a=this.playbackController.getTimeToStreamEnd();this.streamProcessor.isDynamic()?c/2:c,e>j&&(a>c&&!i||c>=a)?c>=a||P.call(this,!1):P.call(this,!0)},O=function(){return p?MediaPlayer.dependencies.BufferController.BUFFER_LOADED:MediaPlayer.dependencies.BufferController.BUFFER_EMPTY},P=function(a){if(p!==a){p=a;var c=O(),d=c===MediaPlayer.dependencies.BufferController.BUFFER_LOADED?MediaPlayer.events.BUFFER_LOADED:MediaPlayer.events.BUFFER_EMPTY;this.metricsModel.addBufferState(b,c,k),this.eventBus.dispatchEvent({type:d,data:{bufferType:b}}),this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,{hasSufficientBuffer:a}),this.log(p?"Got enough buffer to start.":"Waiting for more buffer before starting playback.")}},Q=function(a){o.timestampOffset===a||isNaN(a)||(o.timestampOffset=a)},R=function(){var a=this,c=this.streamProcessor.getScheduleController().getFragmentToLoadCount(),d=this.streamProcessor.getCurrentTrack().fragmentDuration;C.call(a),k=c>0?c*d+j:k,this.metricsModel.addBufferState(b,O(),k),S.call(a)},S=function(){v.call(this)?_.call(this):X.call(this)},T=function(a,b){r=!1,isNaN(b)?V.call(this,a):W.call(this,b),S.call(this)},U=function(a,b){r=!1,this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED,{quality:a,index:b}),S.call(this)},V=function(a){h=a,u=!1,this.streamProcessor.abrController.setQualitySwitchAllowed(b,!0)},W=function(a){m=Math.max(a,m),M.call(this)},X=function(){var a;return 0===s.length||q||r||v.call(this)||!H.call(this)?void 0:(a=s.shift(),u===!0&&a.quality!==h?void s.push(a):void A.call(this,a.bytes,a.quality,a.index,a.startTime,a.startTimeInTimescale))},Y=function(a){if(!a.error){var b,d=this;Q.call(d,a.data.currentRepresentation.MSETimeOffset),b=d.streamProcessor.getStreamInfo().manifestInfo.minBufferTime,CL.manifest.ignoreManifestBufferSettings===!0&&(b=MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME/2),CL.configs.debug&&console.log("Min Buffer time: "+b),c!==b&&(d.setMinBufferTime(b),d.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_MIN_BUFFER_TIME_UPDATED,{minBufferTime:b}))}},Z=function(a){var b=this;a.data.fragmentModel===b.streamProcessor.getFragmentModel()&&(n=a.data.request.index,M.call(b))},$=function(a){if(b===a.data.mediaType&&this.streamProcessor.getStreamInfo().id===a.data.streamInfo.id){var c=this,d=a.data.newQuality;g!==d&&(Q.call(c,c.streamProcessor.getTrackForQuality(d).MSETimeOffset),g=d,v.call(c)||_.call(c))}},_=function(){var a=this;if(f[g]){if(r)return;A.call(a,f[g],g)}else a.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED,{requiredQuality:g})},ab=function(){S.call(this)},bb=function(){N.call(this)};return{sourceBufferExt:void 0,eventBus:void 0,bufferMax:void 0,mediaSourceExt:void 0,metricsModel:void 0,metricsExt:void 0,adapter:void 0,log:void 0,system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=Y,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED]=y,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED]=z,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=Z,this[MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED]=$,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS]=R,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=R,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED]=R,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED]=bb,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED]=ab,B=B.bind(this),K=K.bind(this),this.sourceBufferExt.subscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,this,B),this.sourceBufferExt.subscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,this,K)},initialize:function(a,c,d,e,f){var g=this;g.utils=this.system.getObject("clUtils"),b=a,g.setMediaType(b),g.setMediaSource(d),g.setBuffer(c),g.streamProcessor=e,g.fragmentController=e.fragmentController,g.scheduleController=e.scheduleController,g.playbackController=e.playbackController,g.contentProtectionData=f},getStreamProcessor:function(){return this.streamProcessor},setStreamProcessor:function(a){this.streamProcessor=a},getBuffer:function(){return o},setBuffer:function(a){o=a},getBufferLevel:function(){return j},getMinBufferTime:function(){return c},setMinBufferTime:function(a){c=a},getCriticalBufferLevel:function(){return l},setMediaSource:function(b){a=b},isBufferingCompleted:function(){return i},isInitPending:function(){return u},reset:function(b){var e=this;f=[],l=Number.POSITIVE_INFINITY,p=null,c=null,h=-1,g=0,e.sourceBufferExt.unsubscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,e,B),e.sourceBufferExt.unsubscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,e,K),d=null,q=!1,r=!1,s=[],b||(e.sourceBufferExt.abort(a,o),e.sourceBufferExt.removeSourceBuffer(a,o)),o=null},clearFutureBuffer:J,setAudioTrack:function(a){CL.configs.debug&&console.log("CL: Switch audio track request");var b=this,c=b.manifestModel.getValue();b.manifestExt.getAudioDatas(c,periodInfo.index).then(function(c){a<c.length?(c[a],CL.configs.debug&&console.log("CL: Switching to audio track #"+a),dataChanged=!0,J.call(b)):CL.configs.debug&&console.log("CL: Abort switching audio track. Selected track ()"+a+" doesn't exist.")})}}},MediaPlayer.dependencies.BufferController.BUFFER_SIZE_REQUIRED="required",MediaPlayer.dependencies.BufferController.BUFFER_SIZE_MIN="min",MediaPlayer.dependencies.BufferController.BUFFER_SIZE_INFINITY="infinity",MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME=8,MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD=4,MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY=20,MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM=25,MediaPlayer.dependencies.BufferController.LONG_FORM_CONTENT_DURATION_THRESHOLD=600,MediaPlayer.dependencies.BufferController.RICH_BUFFER_THRESHOLD=20,MediaPlayer.dependencies.BufferController.BUFFER_LOADED="bufferLoaded",MediaPlayer.dependencies.BufferController.BUFFER_EMPTY="bufferStalled",MediaPlayer.dependencies.BufferController.prototype={constructor:MediaPlayer.dependencies.BufferController},MediaPlayer.dependencies.BufferController.eventList={ENAME_BUFFER_LEVEL_STATE_CHANGED:"bufferLevelStateChanged",ENAME_BUFFER_LEVEL_UPDATED:"bufferLevelUpdated",ENAME_QUOTA_EXCEEDED:"quotaExceeded",ENAME_BYTES_APPENDED:"bytesAppended",ENAME_BYTES_REJECTED:"bytesRejected",ENAME_BUFFERING_COMPLETED:"bufferingCompleted",ENAME_BUFFER_CLEARED:"bufferCleared",ENAME_INIT_REQUESTED:"initRequested",ENAME_BUFFER_LEVEL_OUTRUN:"bufferLevelOutrun",ENAME_BUFFER_LEVEL_BALANCED:"bufferLevelBalanced",ENAME_MIN_BUFFER_TIME_UPDATED:"minBufferTimeUpdated"},MediaPlayer.dependencies.EventController=function(){"use strict";var a=[],b=[],c=[],d=null,e=100,f=e/1e3,g="urn:mpeg:dash:event:2012",h=1,i=function(){j(),a=null,b=null,c=null},j=function(){null!==d&&(clearInterval(d),d=null)},k=function(){var a=this;a.log("Start Event Controller"),isNaN(e)||(d=setInterval(n.bind(this),e))},l=function(b){var c=this;a=[],b&&b.length>0&&(a=b),c.log("Added "+b.length+" inline events")},m=function(a){for(var c=this,d=0;d<a.length;d++){var e=a[d];b[e.id]=e,c.log("Add inband event with id "+e.id)}},n=function(){o.call(this,b),o.call(this,a),p.call(this)},o=function(a){var b,d=this,e=this.videoModel.getCurrentTime();if(a)for(var i=0;i<a.length;i++){var j=a[i];void 0!==j&&(b=j.presentationTime/j.eventStream.timescale,(0===b||e>=b&&b+f>e)&&(d.log("Start Event at "+e),j.duration>0&&c.push(j),j.eventStream.schemeIdUri==g&&j.eventStream.value==h&&q.call(this),a.splice(i,1)))}},p=function(){var a=this;if(c)for(var b=this.videoModel.getCurrentTime(),d=0;d<c.length;d++){var e=c[d];null!==e&&(e.duration+e.presentationTime)/e.eventStream.timescale<b&&(a.log("Remove Event at time "+b),e=null,c.splice(d,1))}},q=function(){var a=this,b=a.manifestModel.getValue(),c=b.url;b.hasOwnProperty("Location")&&(c=b.Location),a.log("Refresh manifest @ "+c),a.manifestLoader.load(c)};return{manifestModel:void 0,manifestLoader:void 0,log:void 0,system:void 0,addInlineEvents:l,addInbandEvents:m,reset:i,clear:j,start:k,getVideoModel:function(){return this.videoModel},setVideoModel:function(a){this.videoModel=a},initialize:function(a){this.setVideoModel(a)}}},MediaPlayer.dependencies.EventController.prototype={constructor:MediaPlayer.dependencies.EventController},MediaPlayer.dependencies.FragmentController=function(){"use strict";var a=[],b=!1,c=function(b){for(var c=a.length,d=0;c>d;d++)if(a[d].getContext()==b)return a[d];return null},d=function(b,c){var d=this,e=a[0].getContext().streamProcessor,f=e.getStreamInfo().id,g=d.scheduleRulesCollection.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_EXECUTE_RULES);-1!==g.indexOf(this.scheduleRulesCollection.sameTimeRequestRule)&&this.scheduleRulesCollection.sameTimeRequestRule.setFragmentModels(a,f),d.rulesController.applyRules(g,e,c,b,function(a,b){return b})},e=function(a){var b=this,c=a.data.request;b.isInitializationRequest(c)?b.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADING_START,{request:c,fragmentModel:a.sender}):b.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START,{request:c,fragmentModel:a.sender})},f=function(a){var b=this,c=a.data.request,d=b.process(a.data.response);if(null===d){b.log("No "+c.mediaType+" bytes to push.");var e=a.sender.getContext(),f=e.streamProcessor.getStreamInfo(),g=c.quality-1;return 0>g&&(g=e.abrController.getTopQualityIndexFor(c.mediaType,f.id)),void e.streamProcessor.abrController.setPlaybackQuality(c.mediaType,f,g)}if(b.isInitializationRequest(c)){if(-1==c.range){var h=new Uint8Array(8);h[0]=0,h[1]=0,h[2]=2,h[3]=182,h[4]=109,h[5]=111,h[6]=111,h[7]=118,d=h}b.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED,{bytes:d,quality:c.quality,fragmentModel:a.sender})}else b.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED,{bytes:d,quality:c.quality,index:c.index,startTime:c.startTime,fragmentModel:a.sender});j.call(this)},g=function(a){this.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,{request:a.data.request,fragmentModel:a.sender})},h=function(){j.call(this)},i=function(c){var d,e,f,g,h,i=c.value;for(g=0;g<i.length;g+=1)if(e=i[g])for(h=0;h<a.length;h+=1)f=a[h],d=f.getContext().streamProcessor.getType(),e.mediaType===d&&(e instanceof MediaPlayer.vo.FragmentRequest||(e=f.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING,time:e.startTime})[0]),f.executeRequest(e));b=!1},j=function(a){b||(b=!0,d.call(this,a,i.bind(this)))};return{system:void 0,log:void 0,scheduleRulesCollection:void 0,rulesController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED]=e,this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED]=f,this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED]=g,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED]=h,this.scheduleRulesCollection.sameTimeRequestRule&&this.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,this.scheduleRulesCollection.sameTimeRequestRule)},process:function(a){var b=null;return null!==a&&void 0!==a&&a.byteLength>0&&(b=new Uint8Array(a)),b},getModel:function(b){if(!b)return null;var d=c(b);return d||(d=this.system.getObject("fragmentModel"),d.setContext(b),a.push(d)),d},detachModel:function(b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},isInitializationRequest:function(a){return a&&a.type&&-1!==a.type.toLowerCase().indexOf("initialization")},prepareFragmentForLoading:function(a,b){a&&b&&a.addRequest(b)&&j.call(this,b)},executePendingRequests:function(){j.call(this)},reset:function(){a=[],this.scheduleRulesCollection.sameTimeRequestRule&&this.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,this.scheduleRulesCollection.sameTimeRequestRule)}}},MediaPlayer.dependencies.FragmentController.prototype={constructor:MediaPlayer.dependencies.FragmentController},MediaPlayer.dependencies.FragmentController.eventList={ENAME_STREAM_COMPLETED:"streamCompleted",ENAME_INIT_FRAGMENT_LOADING_START:"initFragmentLoadingStart",ENAME_MEDIA_FRAGMENT_LOADING_START:"mediaFragmentLoadingStart",ENAME_INIT_FRAGMENT_LOADED:"initFragmentLoaded",ENAME_MEDIA_FRAGMENT_LOADED:"mediaFragmentLoaded"},MediaPlayer.dependencies.PlaybackController=function(){"use strict";var a,b,c,d=1e3,e=0,f=0/0,g=null,h={},i={},j=function(a){var b,d=parseInt(this.uriQueryFragModel.getURIFragmentData().s);return c?(!isNaN(d)&&d>1262304e3&&(b=d-a.manifestInfo.availableFrom.getTime()/1e3,(b>f||b<f-a.manifestInfo.DVRWindowSize)&&(b=null)),b=b||f):b=!isNaN(d)&&d<a.duration&&d>=0?d:a.start,b},k=function(b){var c,d=this,e=d.metricsModel.getReadOnlyMetricsFor("video")||d.metricsModel.getReadOnlyMetricsFor("audio"),f=d.metricsExt.getCurrentDVRInfo(e),g=f?f.range:null;return g?b>=g.start&&b<=g.end?b:c=Math.max(g.end-2*a.manifestInfo.minBufferTime,g.start):0/0},l=function(){if(null===g){var a=this,b=function(){E.call(a)};g=setInterval(b,d)}},m=function(){clearInterval(g),g=null},n=function(){var b=j.call(this,a);b=Math.max(b,CL.configs.minStartTime),CL.configs.minStartTime=b,null==CL.configs.initialStartTime||isNaN(CL.configs.initialStartTime)||(b=Math.max(b,CL.configs.initialStartTime),CL.configs.initialStartTime=null),this.log("Starting playback at offset: "+b),this.seek(b)},o=function(){if(!this.isPaused()&&c){var a=this.getTime(),b=k.call(this,a);!isNaN(b)&&b!==a}},p=function(b){if(!b.error){var d=this.adapter.convertDataToTrack(b.data.currentRepresentation);a=d.mediaInfo.streamInfo,c=b.sender.streamProcessor.isDynamic(),o.call(this)}},q=function(a){a.error||0===b.getElement().readyState||n.call(this)},r=function(){b&&(b.unlisten("play",t),b.unlisten("playing",u),b.unlisten("pause",v),b.unlisten("error",D),b.unlisten("seeking",w),b.unlisten("seeked",x),b.unlisten("timeupdate",y),b.unlisten("progress",z),b.unlisten("ratechange",A),b.unlisten("loadedmetadata",B),b.unlisten("ended",C))},s=function(){this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY)},t=function(){this.log("<video> play"),o.call(this),l.call(this),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,{startTime:this.getTime()})},u=function(){this.log("<video> playing"),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PLAYING,{playingTime:this.getTime()})},v=function(){this.log("<video> pause"),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED)},w=function(){b.getElement().currentTime<CL.configs.minStartTime&&null===CL.configs.initialStartTime&&!CL.configs.minStartTimeSeekInProgress&&(b.getElement().currentTime=CL.configs.minStartTime,CL.configs.minStartTimeSeekInProgress=!0);var a=this.streamProcessor.getFragmentModel();a.abortRequests();var c=this.metricsModel.getMetricsFor("video"),d=c.SchedulingInfo;
d.length>0&&a.cancelPendingRequests(d[d.length-1].quality),this.log("<video> seek"),l.call(this),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,{seekTime:this.getTime()})},x=function(){this.log("<video> seeked");var a=b.getElement();a.paused===!1&&0==a.playbackRate&&(a.playbackRate=1,this.log("<video> Continuing playback")),CL.configs.minStartTimeSeekInProgress=!1,this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKED)},y=function(){var a=this.getTime();a!==e&&(e=a,this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,{timeToEnd:this.getTimeToStreamEnd()}))},z=function(){var c,d,e,f=b.getElement().buffered;f.length&&(c=f.length-1,d=f.end(c),e=j.call(this,a)+a.duration-d),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,{bufferedRanges:b.getElement().buffered,remainingUnbufferedDuration:e})},A=function(){this.log("<video> ratechange: ",this.getPlaybackRate()),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED)},B=function(){this.log("<video> loadedmetadata"),(!c||this.timelineConverter.isTimeSyncCompleted())&&n.call(this),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_METADATA_LOADED),l.call(this)},C=function(){this.log("<video> ended"),m.call(this)},D=function(a){this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR,{error:a.srcElement.error})},E=function(){this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,{isDynamic:c,time:new Date})},F=function(b){var c,d=b.data.bufferedRanges,e=a.id,f=this.getTime(),g=b.sender.streamProcessor.getType(),j=this.system.getObject("streamController").getStreamById(a.id),k=h[e];0===b.data.index&&(i[e]=i[e]||{},i[e][g]=!0,i.ready=!(j.hasMedia("audio")&&!i[e].audio||j.hasMedia("video")&&!i[e].video)),d&&d.length&&(c=Math.max(d.start(0),a.start),h[e]=void 0===h[e]?c:Math.max(h[e],c),k===h[e]||!i.ready||f>h[e])},G=function(a){b=a,b.listen("canplay",s),b.listen("play",t),b.listen("playing",u),b.listen("pause",v),b.listen("error",D),b.listen("seeking",w),b.listen("seeked",x),b.listen("timeupdate",y),b.listen("progress",z),b.listen("ratechange",A),b.listen("loadedmetadata",B),b.listen("ended",C)};return{system:void 0,log:void 0,timelineConverter:void 0,uriQueryFragModel:void 0,metricsModel:void 0,metricsExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,adapter:void 0,setup:function(){this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=p,this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=q,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED]=F,s=s.bind(this),t=t.bind(this),u=u.bind(this),v=v.bind(this),D=D.bind(this),w=w.bind(this),x=x.bind(this),y=y.bind(this),z=z.bind(this),A=A.bind(this),B=B.bind(this),C=C.bind(this)},initialize:function(c,d){a=c,b!==d&&(r.call(this),G.call(this,d))},getTimeToStreamEnd:function(){var c=b.getCurrentTime();return j.call(this,a)+a.duration-c},getStreamId:function(){return a.id},getStreamDuration:function(){return a.duration},getTime:function(){return b.getCurrentTime()},getPlaybackRate:function(){return b.getPlaybackRate()},getPlayedRanges:function(){return b.getElement().played},setLiveStartTime:function(a){f=a},getLiveStartTime:function(){return f},getLiveDelay:function(){return CL.manifest.ABRParameters.liveDelay&&!isNaN(CL.manifest.ABRParameters.liveDelay)?CL.manifest.ABRParameters.liveDelay:2*a.manifestInfo.minBufferTime},start:function(){b.play()},isPaused:function(){return b.isPaused()},pause:function(){b&&b.pause()},isSeeking:function(){return b.getElement().seeking},seek:function(a){a!==this.getTime()&&b.setCurrentTime(a)},reset:function(){m.call(this),r.call(this),b=null,a=null,e=0,f=0/0,h=null}}},MediaPlayer.dependencies.PlaybackController.prototype={constructor:MediaPlayer.dependencies.PlaybackController},MediaPlayer.dependencies.PlaybackController.eventList={ENAME_CAN_PLAY:"canPlay",ENAME_PLAYBACK_STARTED:"playbackStarted",ENAME_PLAYBACK_PLAYING:"playbackPlaying",ENAME_PLAYBACK_STOPPED:"playbackStopped",ENAME_PLAYBACK_PAUSED:"playbackPaused",ENAME_PLAYBACK_SEEKING:"playbackSeeking",ENAME_PLAYBACK_SEEKED:"playbackSeeked",ENAME_PLAYBACK_TIME_UPDATED:"playbackTimeUpdated",ENAME_PLAYBACK_PROGRESS:"playbackProgress",ENAME_PLAYBACK_RATE_CHANGED:"playbackRateChanged",ENAME_PLAYBACK_METADATA_LOADED:"playbackMetaDataLoaded",ENAME_PLAYBACK_ERROR:"playbackError",ENAME_WALLCLOCK_TIME_UPDATED:"wallclockTimeUpdated"},MediaPlayer.dependencies.ProtectionController=function(){"use strict";var a=null,b=function(a){if(a.error)this.log(a.error);else{var b=a.data;this.protectionModel.keySystem.doLicenseRequest(b.message,b.defaultURL,b.sessionToken)}},c=function(a){a.error?(this.log("DRM: License request failed! -- "+a.error),this.errHandler.licenseError(a)):(this.log("DRM: License request successful.  Session ID = "+a.data.requestData.getSessionID()),this.updateKeySession(a.data.requestData,a.data.message))},d=function(a){this.log("DRM: Selecting the key system failed: "+a.error),this.errHandler.mediaKeySystemSelectionError(a)},e=function(){this.protectionModel.keySystem.subscribe(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,this)};return{system:void 0,log:void 0,protectionExt:void 0,setup:function(){this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE]=b.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=e.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_NOT_SELECTED]=d.bind(this),this[MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE]=c.bind(this)},init:function(b){this.protectionModel=b,a=this.protectionExt.getKeySystems(),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_NOT_SELECTED,this)},teardown:function(){this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_NOT_SELECTED,this),this.protectionModel.keySystem&&this.protectionModel.keySystem.unsubscribe(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,this)},requestKeySystemAccess:function(a){this.protectionModel.requestKeySystemAccess(a)},selectKeySystem:function(a){if(this.protectionModel.keySystem)throw new Error("DRM: KeySystem already selected!");CL.manifest.drm=a.keySystem.systemString,this.protectionModel.selectKeySystem(a)},createKeySession:function(a,b){this.protectionModel.createKeySession(a,b)},updateKeySession:function(a,b){this.protectionModel.updateKeySession(a,b)},loadKeySession:function(a){this.protectionModel.loadKeySession(a)},removeKeySession:function(a){this.protectionModel.removeKeySession(a)},closeKeySession:function(a){this.protectionModel.closeKeySession(a)},setServerCertificate:function(a){this.protectionModel.setServerCertificate(a)},errHandler:void 0}},MediaPlayer.dependencies.ProtectionController.prototype={constructor:MediaPlayer.dependencies.ProtectionController},MediaPlayer.dependencies.ScheduleController=function(){"use strict";var a,b,c,d,e,f=0,g=!0,h=null,i=!1,j=null,k=null,l=!0,m=[],n=function(a,b){var c=0,d=null;l===!1&&(d=k.start,c=a.getTime()-d.getTime(),k.duration=c,k.stopreason=b,l=!0)},o=function(){b&&(i=!1,g&&(g=!1),this.log("start"),x.call(this))},p=function(){g&&(s.call(this,e.quality),M.call(this,MediaPlayer.vo.metrics.PlayList.INITIAL_PLAY_START_REASON)),o.call(this)},q=function(a){i||(i=!0,this.log("stop"),a&&c.cancelPendingRequests(),n(new Date,MediaPlayer.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON))},r=function(a){var b=this,c=b.scheduleRulesCollection.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.NEXT_FRAGMENT_RULES);b.rulesController.applyRules(c,b.streamProcessor,a,null,function(a,b){return b})},s=function(a){var b,d=this;return b=d.adapter.getInitRequest(d.streamProcessor,a),null!==b&&d.fragmentController.prepareFragmentForLoading(c,b),b},t=function(a){var b=this,c=b.scheduleRulesCollection.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_SCHEDULE_RULES);b.rulesController.applyRules(c,b.streamProcessor,a,f,function(a,b){return void 0===a&&(a=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE),a=a===MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE?0:a,Math.max(a,b)})},u=function(a){var b,d,f,g=a.length,h=.1;for(f=0;g>f;f+=1)b=a[f],d=b.startTime+b.duration/2+h,b=this.adapter.getFragmentRequestForTime(this.streamProcessor,e,d,{timeThreshold:0}),this.fragmentController.prepareFragmentForLoading(c,b)},v=function(a){var b=this;return f=a.value,0>=f?void b.fragmentController.executePendingRequests():void r.call(b,w.bind(b))},w=function(a){var b=a.value;null===b||b instanceof MediaPlayer.vo.FragmentRequest||(b=this.adapter.getFragmentRequestForTime(this.streamProcessor,e,b.startTime)),b?(f--,this.fragmentController.prepareFragmentForLoading(c,b)):this.fragmentController.executePendingRequests()},x=function(){var b=(new Date).getTime(),e=h?b-h>c.getLoadingTime():!0;this.abrController.getPlaybackQuality(this.streamProcessor),!e||i||this.playbackController.isPaused()&&this.playbackController.getPlayedRanges().length>0&&(!this.scheduleWhilePaused||d)||(h=b,m[a]!==!0&&t.call(this,v.bind(this)))},y=function(){var b=this;null!==a&&""!==a&&b.metricsModel.clearCurrentMetricsForType(a)},z=function(a){a.error||(e=this.adapter.convertDataToTrack(a.data.currentRepresentation))},A=function(a){a.error||(e=this.streamProcessor.getCurrentTrack(),d||(b=!0),b&&p.call(this))},B=function(a){a.data.fragmentModel===this.streamProcessor.getFragmentModel()&&(this.log("Stream is complete"),n(new Date,MediaPlayer.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON))},C=function(a){var b=this;a.data.fragmentModel===b.streamProcessor.getFragmentModel()&&x.call(b)},D=function(b){if(b.error){var d=this;m[a]=!0,this.streamProcessor.bufferController.scheduleController.stop(),this.abrController.setPlaybackQuality(a,d.streamProcessor.getStreamInfo(),Math.max(b.data.request.quality-2,0)),c.cancelPendingRequests(b.data.request.quality),this.streamProcessor.indexHandler.setCurrentTime(b.data.request.startTime),d.streamProcessor.bufferController.scheduleController.start(),m[a]=!1}},E=function(){N.call(this)},F=function(){q.call(this,!1)},G=function(a){s.call(this,a.data.requiredQuality)},H=function(a){c.removeExecutedRequestsBeforeTime(a.data.to),a.data.hasEnoughSpaceToAppend&&o.call(this)},I=function(b){var c=this;b.data.hasSufficientBuffer||c.playbackController.isSeeking()||(c.log("Stalling "+a+" Buffer: "+a),n(new Date,MediaPlayer.vo.metrics.PlayList.Trace.REBUFFERING_REASON))},J=function(b){var c=this;c.metricsModel.addBufferLevel(a,new Date,b.data.bufferLevel),x.call(this)},K=function(){q.call(this,!1)},L=function(b){if(a===b.data.mediaType&&this.streamProcessor.getStreamInfo().id===b.data.streamInfo.id){var d,f=this;if(d=c.cancelPendingRequests(b.data.oldQuality),e=f.streamProcessor.getTrackForQuality(b.data.newQuality),null===e||void 0===e)throw"Unexpected error!";u.call(f,d),n(new Date,MediaPlayer.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON)}},M=function(b){var c=new Date,d=this.playbackController.getTime();n(c,MediaPlayer.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),j=this.metricsModel.addPlayList(a,c,d,b)},N=function(){var a=this,b=a.playbackController.getTime(),c=a.playbackController.getPlaybackRate(),d=new Date;l===!0&&e&&j&&(l=!1,k=a.metricsModel.appendPlayListTrace(j,e.id,null,d,b,null,c,null))},O=function(a){var b=this,d=s.call(b,a.data.CCIndex);c.executeRequest(d)},P=function(){o.call(this)},Q=function(a){g||c.cancelPendingRequests();var b=this.metricsModel.getMetricsFor("stream"),d=this.metricsExt.getCurrentManifestUpdate(b);this.log("seek: "+a.data.seekTime),M.call(this,MediaPlayer.vo.metrics.PlayList.SEEK_START_REASON),this.metricsModel.updateManifestUpdateInfo(d,{latency:e.DVRWindow.end-this.playbackController.getTime()})},R=function(){N.call(this)},S=function(){x.call(this)},T=function(a){if(!a.error){var c,d,f=this,g=a.data.liveEdge,h=(e.mediaInfo.streamInfo.manifestInfo,g-f.playbackController.getLiveDelay()),i=f.metricsModel.getMetricsFor("stream"),j=f.metricsExt.getCurrentManifestUpdate(i),k=f.playbackController.getLiveStartTime();!isNaN(CL.manifest.relativeDVRWindowPlaybackPosition)&&CL.manifest.relativeDVRWindowPlaybackPosition>=0&&CL.manifest.relativeDVRWindowPlaybackPosition<=1&&(h=Math.max(e.DVRWindow.start,e.DVRWindow.start+(Math.min(e.DVRWindow.end,g)-e.DVRWindow.start-e.fragmentDuration)*CL.manifest.relativeDVRWindowPlaybackPosition)),c=f.adapter.getFragmentRequestForTime(f.streamProcessor,e,h),d=c.startTime,(isNaN(k)||d>k)&&f.playbackController.setLiveStartTime(d),f.metricsModel.updateManifestUpdateInfo(j,{currentTime:d,presentationStartTime:g,latency:g-d,clientTimeOffset:f.timelineConverter.getClientTimeOffset()}),b=!0,e&&p.call(f)}};return{log:void 0,system:void 0,metricsModel:void 0,metricsExt:void 0,scheduleWhilePaused:void 0,timelineConverter:void 0,abrController:void 0,adapter:void 0,scheduleRulesCollection:void 0,rulesController:void 0,setup:function(){this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=T,this[MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED]=L,this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED]=F,this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=z,this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED]=A,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START]=C,this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED]=D,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=B,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED]=H,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED]=E,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED]=I,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED]=J,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED]=G,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED]=K,this[MediaPlayer.dependencies.TextController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED]=O,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED]=P,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=Q,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED]=R,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED]=S},initialize:function(b,e){var f=this;m.video=!1,m.audio=!1,a=b,f.setMediaType(a),f.streamProcessor=e,f.playbackController=e.playbackController,f.fragmentController=e.fragmentController,f.liveEdgeFinder=e.liveEdgeFinder,f.bufferController=e.bufferController,d=e.isDynamic(),c=this.fragmentController.getModel(this),f.scheduleRulesCollection.bufferLevelRule&&f.scheduleRulesCollection.bufferLevelRule.setScheduleController(f),f.scheduleRulesCollection.pendingRequestsRule&&f.scheduleRulesCollection.pendingRequestsRule.setScheduleController(f),f.scheduleRulesCollection.playbackTimeRule&&f.scheduleRulesCollection.playbackTimeRule.setScheduleController(f)},getFragmentModel:function(){return c},getFragmentToLoadCount:function(){return f},reset:function(){var a=this;q.call(a,!0),a.bufferController.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,a.scheduleRulesCollection.bufferLevelRule),a.bufferController.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,a.scheduleRulesCollection.bufferLevelRule),c.abortRequests(),a.fragmentController.detachModel(c),y.call(a),f=0},start:o,stop:q}},MediaPlayer.dependencies.ScheduleController.prototype={constructor:MediaPlayer.dependencies.ScheduleController},MediaPlayer.dependencies.StreamController=function(){"use strict";var a,b=[],c=6,d=.2,e=!0,f=!1,g=function(){a.play()},h=function(){a.pause()},i=function(b){a.seek(b)},j=function(a,b){var c=a.getElement(),d=b.getElement();d.parentNode||c.parentNode.insertBefore(d,c),c.style.width="0px",d.style.width="100%",m(c,d)},k=function(a){var b=a.getPlaybackController();b.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,this.manifestUpdater),b.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED,this.manifestUpdater),b.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,this),b.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,this),b.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,this)},l=function(a){var b=this,c=a.getPlaybackController();setTimeout(function(){c.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,b.manifestUpdater),c.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED,b.manifestUpdater),c.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,b),c.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,b),c.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,b)},1)},m=function(a,b){["controls","loop","muted","volume"].forEach(function(c){b[c]=a[c]})},n=function(a,b){this.eventBus.dispatchEvent({type:MediaPlayer.events.SWITCH_STREAM,data:{fromStreamInfo:a?a.getStreamInfo():null,toStreamInfo:b.getStreamInfo()}})},o=function(a){!a.data.remainingUnbufferedDuration||a.data.remainingUnbufferedDuration>=c||r()},p=function(b){var c=this,e=c.videoExt.getPlaybackQuality(a.getVideoModel().getElement());e&&c.metricsModel.addDroppedFrames("video",e),s()&&(a.getVideoModel().getElement().seeking||b.data.timeToEnd<d&&w.call(this,a,s()))},q=function(b){var c=t(b.data.seekTime);c&&c!==a&&w.call(this,a,c,b.data.seekTime)},r=function(){var a=s();a&&a.seek(a.getStartTime())},s=function(){var c=a.getStreamIndex()+1;return c<b.length?b[c]:null},t=function(a){var c=0,d=null,e=b.length;e>0&&(c+=b[0].getStartTime());for(var f=0;e>f;f++)if(d=b[f],c+=d.getDuration(),c>a)return d;return null},u=function(){var a=this.system.getObject("videoModel"),b=document.createElement("video");return a.setElement(b),a},v=function(a){a.parentNode&&a.parentNode.removeChild(a)},w=function(b,c,d){!f&&b&&c&&b!==c&&(f=!0,b.pause(),a=c,j.call(this,b.getVideoModel(),c.getVideoModel()),l.call(this,b),k.call(this,c),i(d?b.getPlaybackController().getTime():c.getStartTime()),g(),b.resetEventController(),a.startEventController(),f=!1,n.call(this,b,c))},x=function(){var c,d,f,g,h,i,j,l,m=this,o=m.manifestModel.getValue(),p=m.metricsModel.getMetricsFor("stream"),q=m.metricsExt.getCurrentManifestUpdate(p),r=a?a.getVideoModel():m.getVideoModel();if(o){j=m.adapter.getStreamsInfo(o);try{if(0===j.length)throw new Error("There are no streams");for(m.metricsModel.updateManifestUpdateInfo(q,{currentTime:r.getCurrentTime(),buffered:r.getElement().buffered,presentationStartTime:j[0].start,clientTimeOffset:m.timelineConverter.getClientTimeOffset()}),h=0,f=j.length;f>h;h+=1){for(d=j[h],i=0,g=b.length;g>i;i+=1)b[i].getId()===d.id&&(l=b[i],l.updateData(d));l||(l=m.system.getObject("stream"),c=m.system.getObject("playbackController"),l.setStreamInfo(d),l.setVideoModel(0===h?m.videoModel:u.call(m)),l.setPlaybackController(c),c.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR,l),c.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY,l),l.initProtection(o),l.setAutoPlay(e),l.load(o),l.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,m),b.push(l)),m.metricsModel.addManifestUpdateStreamInfo(q,d.id,d.index,d.start,d.duration),l=null}a||(a=b[0],k.call(m,a),a.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,this.liveEdgeFinder),n.call(m,null,a))}catch(s){m.errHandler.manifestError(s.message,"nostreamscomposed",m.manifestModel.getValue()),m.reset()}}},y=function(){var a=this,c=b.length,d=0;for(d;c>d;d+=1)if(b[d].isUpdating())return;a.notify(MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED)},z=function(){x.call(this)},A=function(a){a.error?this.reset():(this.manifestModel.setValue(a.data.manifest),this.log("Manifest has loaded."),this.timeSyncController.initialize(this.manifestExt.getUTCTimingSources(a.data.manifest)))};return{system:void 0,videoModel:void 0,manifestLoader:void 0,manifestUpdater:void 0,manifestModel:void 0,manifestExt:void 0,adapter:void 0,log:void 0,metricsModel:void 0,metricsExt:void 0,videoExt:void 0,liveEdgeFinder:void 0,timelineConverter:void 0,protectionExt:void 0,timeSyncController:void 0,errHandler:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED]=A,this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED]=y,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=q,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS]=o,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED]=p,this[MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED]=z},setAutoPlay:function(a){e=a},getAutoPlay:function(){return e},setProtectionData:function(a){this.protectionExt.init(a)},getVideoModel:function(){return this.videoModel},setVideoModel:function(a){this.videoModel=a},getActiveStreamInfo:function(){return a?a.getStreamInfo():null},getStreamById:function(a){return b.filter(function(b){return b.getStreamInfo().id===a})[0]},initialize:function(){this.timeSyncController.subscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.timelineConverter),this.timeSyncController.subscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.liveEdgeFinder),this.timeSyncController.subscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this)},load:function(a){this.manifestLoader.load(a),this.manifestUpdater.start()},reset:function(){a&&(l.call(this,a),a.getVideoModel()!==this.getVideoModel()&&j.call(this,a.getVideoModel(),this.getVideoModel())),this.timeSyncController.unsubscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.timelineConverter),this.timeSyncController.unsubscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.liveEdgeFinder),this.timeSyncController.unsubscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this),this.timeSyncController.reset();for(var c=0,d=b.length;d>c;c++){var e=b[c];e.unsubscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,this),e.reset(),e.getVideoModel()!==this.getVideoModel()&&v(e.getVideoModel().getElement())}b=[],this.manifestUpdater.stop(),this.metricsModel.clearAllCurrentMetrics(),this.manifestModel.setValue(null),this.timelineConverter.reset(),this.adapter.reset(),f=!1,a=null},update:function(b){a.updateData(b)},disableTextTracks:function(){a.disableTextTracks()},play:g,seek:i,pause:h}},MediaPlayer.dependencies.StreamController.prototype={constructor:MediaPlayer.dependencies.StreamController},MediaPlayer.dependencies.StreamController.eventList={ENAME_STREAMS_COMPOSED:"streamsComposed"},MediaPlayer.dependencies.TextController=function(){var a,b,c,d=!1,e=function(){d||(b.hasOwnProperty("initialize")&&b.initialize(c,this),d=!0),this.notify(MediaPlayer.dependencies.TextController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED,{CCIndex:0})},f=function(a){var c=this;a.data.fragmentModel===c.streamProcessor.getFragmentModel()&&null!==a.data.bytes&&c.sourceBufferExt.append(b,a.data.bytes,c.videoModel)},g=function(){b.getTextTrackExtensions().deleteCues(this.videoModel.getElement())};return{sourceBufferExt:void 0,log:void 0,system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=e,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED]=f},initialize:function(a,b,d,e){var f=this;c=a,f.setBuffer(b),f.setMediaSource(d),f.videoModel=e.videoModel,f.trackController=e.trackController,f.streamProcessor=e},getBuffer:function(){return b},setBuffer:function(a){b=a},setMediaSource:function(b){a=b},reset:function(c){c||(this.sourceBufferExt.abort(a,b),this.sourceBufferExt.removeSourceBuffer(a,b))},clearFutureBuffer:g}},MediaPlayer.dependencies.TextController.prototype={constructor:MediaPlayer.dependencies.TextController},MediaPlayer.dependencies.TextController.eventList={ENAME_CLOSED_CAPTIONING_REQUESTED:"closedCaptioningRequested"},MediaPlayer.dependencies.MediaSourceExtensions=function(){"use strict"},MediaPlayer.dependencies.MediaSourceExtensions.prototype={constructor:MediaPlayer.dependencies.MediaSourceExtensions,createMediaSource:function(){"use strict";var a="WebKitMediaSource"in window,b="MediaSource"in window;return b?new MediaSource:a?new WebKitMediaSource:null},attachMediaSource:function(a,b){"use strict";var c=window.URL.createObjectURL(a);return b.setSource(c),c},detachMediaSource:function(){"use strict"},setDuration:function(a,b){"use strict";return b+=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,a.duration!=b&&(a.duration=b),a.duration},signalEndOfStream:function(a){"use strict";var b=a.sourceBuffers,c=b.length,d=0;if("open"===a.readyState){for(d;c>d;d+=1)if(b[d].updating)return;a.endOfStream()}}},MediaPlayer.dependencies.ProtectionExtensions=function(){"use strict";this.system=void 0,this.log=void 0,this.keySystems=[],this.clearkeyKeySystem=void 0},MediaPlayer.dependencies.ProtectionExtensions.prototype={constructor:MediaPlayer.dependencies.ProtectionExtensions,setup:function(){var a;a=this.system.getObject("ksPlayReady"),this.keySystems.push(a),a=this.system.getObject("ksWidevine"),this.keySystems.push(a),a=this.system.getObject("ksClearKey"),this.keySystems.push(a),this.clearkeyKeySystem=a},init:function(a){for(var b=(function(b){var c=null;return a&&(c=b in a?a[b]:null),c}),c=0;c<this.keySystems.length;c++){var d=this.keySystems[c];d.init(b(d.systemString))}var c,e,f=[];if(CL.manifest.drm){for(var g=-1,e=0;e<this.keySystems.length;++e)if(CL.manifest.drm==this.keySystems[e].systemString){f[0]=this.keySystems[e],g=e;break}if(g>-1){c=1;for(var e=0;e<this.keySystems.length;++e)e!=g&&(f[c]=this.keySystems[e],c++)}else f=this.keySystems}else f=this.keySystems;this.keySystems=f},getKeySystems:function(){return this.keySystems},getKeySystemBySystemString:function(a){for(var b=0;b<this.keySystems.length;b++)if(this.keySystems[b].systemString===a)return this.keySystems[b];return null},isClearKey:function(a){return a===this.clearkeyKeySystem},initDataEquals:function(a,b){var c,d,e=new castLabsDashJS.classes.Utils;if(c=e.byteArrayToHexString(new Uint8Array(a)),d=e.byteArrayToHexString(new Uint8Array(b)),CL.configs.isIE11===!0){var f,g,h,i;if(f=e.utf8ArrayToStr(e.getSubBox(new Uint8Array(a),"pssh")).trim().replace(/[^\w<>\/]/gi,"").toLowerCase(),g=e.utf8ArrayToStr(e.getSubBox(new Uint8Array(b),"pssh")).trim().replace(/[^\w<>\/]/gi,"").toLowerCase(),f.indexOf("<kid>")>-1&&g.indexOf("kid")>-1)return h=f.substring(f.indexOf("<kid>")+5,f.indexOf("</kid>")),i=g.substring(g.indexOf("<kid>")+5,g.indexOf("</kid>")),h===i}return c===d},getSupportedKeySystemsFromContentProtection:function(a){var b,c,d,e,f=[];if(a)for(d=0;d<this.keySystems.length;++d)for(c=this.keySystems[d],e=0;e<a.length;++e)if(b=a[e],b.schemeIdUri.toLowerCase()===c.schemeIdURI){var g=c.getInitData(b);g&&f.push({ks:this.keySystems[d],initData:g})}return f},getSupportedKeySystems:function(a){var b,c=[];for(pssh=MediaPlayer.dependencies.protection.CommonEncryption.parsePSSHList(a),b=0;b<this.keySystems.length;++b)this.keySystems[b].uuid in pssh&&c.push({ks:this.keySystems[b],initData:pssh[this.keySystems[b].uuid]});return c},autoSelectKeySystem:function(a,b,c,d,e){if(0===a.length)throw new Error("DRM system for this content not supported by the player!");var f=[],g=[],h="";void 0!=CL.manifest.robustnessLevel&&null!=CL.manifest.robustnessLevel&&""!=CL.manifest.robustnessLevel&&(h=CL.manifest.robustnessLevel),d&&g.push(new MediaPlayer.vo.protection.MediaCapability(d.codec,h)),e&&f.push(new MediaPlayer.vo.protection.MediaCapability(e.codec,h));for(var i=new MediaPlayer.vo.protection.KeySystemConfiguration(f,g),j=[],k=0;k<a.length;k++)j.push({ks:a[k].ks,configs:[i]});var l=this;!function(a,b){var c={};c[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(c){if(a.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),c.error)l.log(c.error);else{var d=c.data;l.log("KeySystem Access Granted ("+d.keySystem.systemString+")!"),b.selectKeySystem(d)}},a.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,c),b.requestKeySystemAccess(j)}(b,c)}},MediaPlayer.dependencies.RequestModifierExtensions=function(){"use strict";return{modifyRequestURL:function(a){return a},modifyRequestHeader:function(a){return a}}},MediaPlayer.dependencies.SourceBufferExtensions=function(){"use strict";this.system=void 0,this.notify=void 0,this.subscribe=void 0,this.unsubscribe=void 0},MediaPlayer.dependencies.SourceBufferExtensions.prototype={constructor:MediaPlayer.dependencies.SourceBufferExtensions,createSourceBuffer:function(a,b){"use strict";var c=this,d=b.codec,e=null;try{e=a.addSourceBuffer(d)}catch(f){if(!b.isText&&-1==d.indexOf('codecs="stpp"'))throw f;e=c.system.getObject("textSourceBuffer")}return e},removeSourceBuffer:function(a,b){"use strict";try{a.removeSourceBuffer(b)}catch(c){}},getBufferRange:function(a,b,c){"use strict";var d,e,f=null,g=0,h=0,i=null,j=null,k=0,l=c||.15;try{f=a.buffered}catch(m){return null}if(null!==f&&void 0!==f){for(e=0,d=f.length;d>e;e+=1)if(g=f.start(e),h=f.end(e),g-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,h-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,null===i)k=Math.abs(g-b),b>=g&&h>b?(i=g,j=h):l>=k&&(i=g,j=h);else{if(k=g-j,!(l>=k))break;j=h}if(null!==i)return{start:i,end:j}}return null},getAllRanges:function(a){var b=null;try{return b=a.buffered}catch(c){return null}},getBufferLength:function(a,b,c){"use strict";var d,e,f=this;return d=f.getBufferRange(a,b,c),e=null===d?0:d.end-b},waitForUpdateEnd:function(a,b){"use strict";var c,d=50,e=function(){a.updating||(clearInterval(c),b())},f=function(){a.updating||(a.removeEventListener("updateend",f,!1),b())};if(!a.updating)return void b();if("function"==typeof a.addEventListener)try{a.addEventListener("updateend",f,!1)}catch(g){c=setInterval(e,d)}else c=setInterval(e,d)},append:function(a,b,c){var d=this,e="append"in a?"append":"appendBuffer"in a?"appendBuffer":null;if(e)try{d.waitForUpdateEnd(a,function(){CL.configs.isActiveVideoChrome===!0?a[e](b):a[e](b,c),d.waitForUpdateEnd(a,function(){d.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,{buffer:a,bytes:b})
})})}catch(f){d.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,{buffer:a,bytes:b},new MediaPlayer.vo.Error(f.code,f.message,null))}},remove:function(a,b,c,d){var e=this;try{b>=0&&c>b&&"ended"!==d.readyState&&a.remove(b,c),this.waitForUpdateEnd(a,function(){e.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:b,to:c})})}catch(f){e.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:b,to:c},new MediaPlayer.vo.Error(f.code,f.message,null))}},abort:function(a,b){"use strict";try{"open"===a.readyState&&b.abort()}catch(c){}}},MediaPlayer.dependencies.SourceBufferExtensions.QUOTA_EXCEEDED_ERROR_CODE=22,MediaPlayer.dependencies.SourceBufferExtensions.eventList={ENAME_SOURCEBUFFER_REMOVE_COMPLETED:"sourceBufferRemoveCompleted",ENAME_SOURCEBUFFER_APPEND_COMPLETED:"sourceBufferAppendCompleted"},MediaPlayer.utils.TextTrackExtensions=function(){"use strict";var a;return{setup:function(){a=window.VTTCue||window.TextTrackCue},addTextTrack:function(b,c,d,e,f){var g=b.addTextTrack("captions",d,e);g["default"]=f,g.mode="showing";for(var h in c){var i=c[h];g.addCue(new a(i.start,i.end,i.data))}return g},deleteCues:function(a){for(var b=0;b<a.textTracks.length;b++){var c=a.textTracks[b],d=c.cues;if(null!=d){f=d.length-1;for(var e=f;e>=0;e--)c.removeCue(d[e]);c.mode="disabled",c["default"]=!1}}return;var e,c,d,f,e}}},MediaPlayer.dependencies.VideoModelExtensions=function(){"use strict";return{getPlaybackQuality:function(a){var b="webkitDroppedFrameCount"in a,c="getVideoPlaybackQuality"in a,d=null;return c?d=a.getVideoPlaybackQuality():b&&(d={droppedVideoFrames:a.webkitDroppedFrameCount,creationTime:new Date}),d}}},MediaPlayer.dependencies.VideoModelExtensions.prototype={constructor:MediaPlayer.dependencies.VideoModelExtensions},MediaPlayer.dependencies.FragmentModel=function(){"use strict";var a,b=[],c=[],d=[],e=[],f=!1,g=function(a){var b=this;b.notify(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED,{request:a}),b.fragmentLoader.load(a)},h=function(a,b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},i=function(a,b,c){var d,e=a.length-1,f=0/0,g=0/0,h=null;for(d=e;d>=0;d-=1)if(h=a[d],f=h.startTime,g=f+h.duration,c=c||h.duration/2,!isNaN(f)&&!isNaN(g)&&b+c>=f&&g>b-c||isNaN(f)&&isNaN(b))return h;return null},j=function(a,b){return b?b.hasOwnProperty("time")?[i.call(this,a,b.time,b.threshold)]:a.filter(function(a){for(var c in b)if("state"!==c&&b.hasOwnProperty(c)&&a[c]!=b[c])return!1;return!0}):a},k=function(a){var f;switch(a){case MediaPlayer.dependencies.FragmentModel.states.PENDING:f=c;break;case MediaPlayer.dependencies.FragmentModel.states.LOADING:f=d;break;case MediaPlayer.dependencies.FragmentModel.states.EXECUTED:f=b;break;case MediaPlayer.dependencies.FragmentModel.states.REJECTED:f=e;break;default:f=[]}return f},l=function(a,b){if(a){var c=a.mediaType,d=new Date,e=a.type,f=a.startTime,g=a.availabilityStartTime,h=a.duration,i=a.quality,j=a.range;this.metricsModel.addSchedulingInfo(c,d,e,f,g,h,i,j,b)}},m=function(a){var c=a.data.request,e=a.data.response,f=a.error;d.splice(d.indexOf(c),1),e&&!f&&b.push(c),l.call(this,c,f?MediaPlayer.dependencies.FragmentModel.states.FAILED:MediaPlayer.dependencies.FragmentModel.states.EXECUTED),this.notify(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{request:c,response:e},f)},n=function(a){var c=this.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,quality:a.data.quality,index:a.data.index})[0];c&&(h.call(this,b,c),isNaN(a.data.index)||(e.push(c),l.call(this,c,MediaPlayer.dependencies.FragmentModel.states.REJECTED)))},o=function(){f=!0},p=function(){f=!1};return{system:void 0,log:void 0,metricsModel:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN]=o,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED]=p,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED]=n,this[MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED]=m},setLoader:function(a){this.fragmentLoader=a},setContext:function(b){a=b},getContext:function(){return a},getIsPostponed:function(){return f},addRequest:function(a){return!a||this.isFragmentLoadedOrPending(a)?!1:(c.push(a),l.call(this,a,MediaPlayer.dependencies.FragmentModel.states.PENDING),!0)},isFragmentLoadedOrPending:function(a){var e=function(a,b){return"complete"===a.action&&a.action===b.action},f=function(a,b){return!isNaN(a.index)&&!isNaN(b.index)&&(a.startTime===b.startTime||a.url===b.url&&void 0===a.range&&void 0===reg2.range)},g=function(a,b){return isNaN(a.index)&&isNaN(b.index)&&a.quality===b.quality},h=function(b){var c,d,h=!1,i=b.length;for(d=0;i>d;d+=1)if(c=b[d],f(a,c)||g(a,c)||e(a,c)){h=!0;break}return h};return h(c)||h(d)||h(b)},getRequests:function(a){var b,c=[],d=[],e=1;if(!a||!a.state)return c;a.state instanceof Array?(e=a.state.length,b=a.state):b=[a.state];for(var f=0;e>f;f+=1)c=k.call(this,b[f]),d=d.concat(j.call(this,c,a));return d},getLoadingTime:function(){var a,c,d=0;for(c=b.length-1;c>=0;c-=1)if(a=b[c],a.requestEndDate instanceof Date&&a.firstByteDate instanceof Date){d=a.requestEndDate.getTime()-a.firstByteDate.getTime();break}return d},removeExecutedRequest:function(a){h.call(this,b,a)},removeRejectedRequest:function(a){h.call(this,e,a)},removeExecutedRequestsBeforeTime:function(a){var c,d=b.length-1,e=0/0,f=null;for(c=d;c>=0;c-=1)f=b[c],e=f.startTime,!isNaN(e)&&a>e&&h.call(this,b,f)},cancelPendingRequests:function(a){var b=this,d=c,e=d;return c=[],void 0!==a&&(c=d.filter(function(b){return b.quality===a?!1:(e.splice(e.indexOf(b),1),!0)})),e.forEach(function(a){l.call(b,a,MediaPlayer.dependencies.FragmentModel.states.CANCELED)}),e},abortRequests:function(){var a=[];for(this.fragmentLoader.abort();d.length>0;)a.push(d[0]),h.call(this,d,d[0]);return d=[],a},executeRequest:function(a){var e=this,f=c.indexOf(a);if(a&&-1!==f)switch(c.splice(f,1),a.action){case"complete":b.push(a),l.call(e,a,MediaPlayer.dependencies.FragmentModel.states.EXECUTED),e.notify(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED,{request:a});break;case"download":d.push(a),l.call(e,a,MediaPlayer.dependencies.FragmentModel.states.LOADING),g.call(e,a);break;default:this.log("Unknown request action.")}},reset:function(){this.abortRequests(),this.cancelPendingRequests()}}},MediaPlayer.dependencies.FragmentModel.prototype={constructor:MediaPlayer.dependencies.FragmentModel},MediaPlayer.dependencies.FragmentModel.eventList={ENAME_STREAM_COMPLETED:"streamCompleted",ENAME_FRAGMENT_LOADING_STARTED:"fragmentLoadingStarted",ENAME_FRAGMENT_LOADING_COMPLETED:"fragmentLoadingCompleted"},MediaPlayer.dependencies.FragmentModel.states={PENDING:"pending",LOADING:"loading",EXECUTED:"executed",REJECTED:"rejected",CANCELED:"canceled",FAILED:"failed"},MediaPlayer.models.ManifestModel=function(){"use strict";var a;return{system:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,getValue:function(){return a},setValue:function(b){a=b,this.eventBus.dispatchEvent({type:MediaPlayer.events.MANIFEST_LOADED,data:b}),this.notify(MediaPlayer.models.ManifestModel.eventList.ENAME_MANIFEST_UPDATED,{manifest:b})}}},MediaPlayer.models.ManifestModel.prototype={constructor:MediaPlayer.models.ManifestModel},MediaPlayer.models.ManifestModel.eventList={ENAME_MANIFEST_UPDATED:"manifestUpdated"},MediaPlayer.models.MetricsModel=function(){"use strict";return{system:void 0,eventBus:void 0,adapter:void 0,streamMetrics:{},metricsChanged:function(){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRICS_CHANGED,data:{}})},metricChanged:function(a){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRIC_CHANGED,data:{stream:a}}),this.metricsChanged()},metricUpdated:function(a,b,c){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRIC_UPDATED,data:{stream:a,metric:b,value:c}}),this.metricChanged(a)},metricAdded:function(a,b,c){if(this.eventBus.dispatchEvent({type:MediaPlayer.events.METRIC_ADDED,data:{stream:a,metric:b,value:c}}),this.metricChanged(a),CL.configs.isChromecast===!0||CL.manifest.disableChromecastSupport===!0){void 0===this.lastCheck&&(this.lastCheck=[]),void 0===this.lastCheck[a]&&(this.lastCheck[a]=new Date);var d,e,f=new Date;if(f.getTime()-this.lastCheck[a].getTime()>1e4){var g,h=this.getMetricsFor(a);for(var i in h)if(d=h[i],Array.isArray(d)&&(g=Object.keys(d).length,g>50)){if(d=d.slice(-10),"HttpList"==i)for(var j in d)e=d[j],Array.isArray(e)&&(e.trace=e.trace.slice(-3));h[i]=d}this.lastCheck[a]=f,f=null}}},clearCurrentMetricsForType:function(a){delete this.streamMetrics[a],this.metricChanged(a)},clearAllCurrentMetrics:function(){var a=this;this.streamMetrics={},this.metricsChanged.call(a)},getReadOnlyMetricsFor:function(a){return this.streamMetrics.hasOwnProperty(a)?this.streamMetrics[a]:null},getMetricsFor:function(a){var b;return this.streamMetrics.hasOwnProperty(a)?b=this.streamMetrics[a]:(b=this.system.getObject("metrics"),this.streamMetrics[a]=b),b},addTcpConnection:function(a,b,c,d,e,f){var g=new MediaPlayer.vo.metrics.TCPConnection;return g.tcpid=b,g.dest=c,g.topen=d,g.tclose=e,g.tconnect=f,this.getMetricsFor(a).TcpList.push(g),this.metricAdded(a,this.adapter.metricsList.TCP_CONNECTION,g),g},addHttpRequest:function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=new MediaPlayer.vo.metrics.HTTPRequest;return n.stream=a,n.tcpid=b,n.type=c,n.url=d,n.actualurl=e,n.range=f,n.trequest=g,n.tresponse=h,n.tfinish=i,n.responsecode=j,n.interval=k,n.mediaduration=l,n.responseHeaders=m,this.getMetricsFor(a).HttpList.push(n),this.metricAdded(a,this.adapter.metricsList.HTTP_REQUEST,n),n},appendHttpTrace:function(a,b,c,d){var e=new MediaPlayer.vo.metrics.HTTPRequest.Trace;return e.s=b,e.d=c,e.b=d,a.trace.push(e),this.metricUpdated(a.stream,this.adapter.metricsList.HTTP_REQUEST_TRACE,a),e},addTrackSwitch:function(a,b,c,d,e){var f=new MediaPlayer.vo.metrics.TrackSwitch;return f.t=b,f.mt=c,f.to=d,f.lto=e,this.getMetricsFor(a).RepSwitchList.push(f),this.metricAdded(a,this.adapter.metricsList.TRACK_SWITCH,f),f},addBufferLevel:function(a,b,c){var d=new MediaPlayer.vo.metrics.BufferLevel;return d.t=b,d.level=c,this.getMetricsFor(a).BufferLevel.push(d),this.metricAdded(a,this.adapter.metricsList.BUFFER_LEVEL,d),d},addBufferState:function(a,b,c){var d=new MediaPlayer.vo.metrics.BufferState;return d.target=c,d.state=b,this.getMetricsFor(a).BufferState.push(d),this.metricAdded(a,this.adapter.metricsList.BUFFER_STATE,d),d},addDVRInfo:function(a,b,c,d){var e=new MediaPlayer.vo.metrics.DVRInfo;return e.time=b,e.range=d,e.manifestInfo=c,this.getMetricsFor(a).DVRInfo.push(e),this.metricAdded(a,this.adapter.metricsList.DVR_INFO,e),e},addDroppedFrames:function(a,b){var c=new MediaPlayer.vo.metrics.DroppedFrames,d=this.getMetricsFor(a).DroppedFrames;c.time=b.creationTime,c.droppedFrames=b.droppedVideoFrames;var e=c.droppedFrames-CL.configs.droppedFramesCountOffset;return void 0!==CL.manifest.ABRParameters.droppedFrameThreshold&&CL.manifest.ABRParameters.droppedFrameThreshold>0&&e>CL.manifest.ABRParameters.droppedFrameThreshold&&(CL.configs.droppedFramesCountOffset+=e,CL.configs.limitRepresentation=!0,CL.configs.lowerRepresentation=!0),d.length>0&&d[d.length-1]==c?d[d.length-1]:(d.push(c),this.metricAdded(a,this.adapter.metricsList.DROPPED_FRAMES,c),c)},addSchedulingInfo:function(a,b,c,d,e,f,g,h,i){var j=new MediaPlayer.vo.metrics.SchedulingInfo;return j.mediaType=a,j.t=b,j.type=c,j.startTime=d,j.availabilityStartTime=e,j.duration=f,j.quality=g,j.range=h,j.state=i,this.getMetricsFor(a).SchedulingInfo.push(j),this.metricAdded(a,this.adapter.metricsList.SCHEDULING_INFO,j),j},addManifestUpdate:function(a,b,c,d,e,f,g,h,i,j){var k=new MediaPlayer.vo.metrics.ManifestUpdate,l=this.getMetricsFor("stream");return k.mediaType=a,k.type=b,k.requestTime=c,k.fetchTime=d,k.availabilityStartTime=e,k.presentationStartTime=f,k.clientTimeOffset=g,k.currentTime=h,k.buffered=i,k.latency=j,l.ManifestUpdate.push(k),this.metricAdded(a,this.adapter.metricsList.MANIFEST_UPDATE,k),k},updateManifestUpdateInfo:function(a,b){for(var c in b)a[c]=b[c];this.metricUpdated(a.mediaType,this.adapter.metricsList.MANIFEST_UPDATE,a)},addManifestUpdateStreamInfo:function(a,b,c,d,e){var f=new MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo;return f.id=b,f.index=c,f.start=d,f.duration=e,a.streamInfo.push(f),this.metricUpdated(a.mediaType,this.adapter.metricsList.MANIFEST_UPDATE_STREAM_INFO,a),f},addManifestUpdateTrackInfo:function(a,b,c,d,e,f,g,h){var i=new MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo;return i.id=b,i.index=c,i.streamIndex=d,i.mediaType=e,i.startNumber=g,i.fragmentInfoType=h,i.presentationTimeOffset=f,a.trackInfo.push(i),this.metricUpdated(a.mediaType,this.adapter.metricsList.MANIFEST_UPDATE_TRACK_INFO,a),i},addPlayList:function(a,b,c,d){var e=new MediaPlayer.vo.metrics.PlayList;return e.stream=a,e.start=b,e.mstart=c,e.starttype=d,this.getMetricsFor(a).PlayList.push(e),this.metricAdded(a,this.adapter.metricsList.PLAY_LIST,e),e},appendPlayListTrace:function(a,b,c,d,e,f,g,h){var i=new MediaPlayer.vo.metrics.PlayList.Trace;return i.representationid=b,i.subreplevel=c,i.start=d,i.mstart=e,i.duration=f,i.playbackspeed=g,i.stopreason=h,a.trace.push(i),this.metricUpdated(a.stream,this.adapter.metricsList.PLAY_LIST_TRACE,a),i}}},MediaPlayer.models.MetricsModel.prototype={constructor:MediaPlayer.models.MetricsModel},MediaPlayer.models.ProtectionModel={},MediaPlayer.models.ProtectionModel.eventList={ENAME_NEED_KEY:"needkey",ENAME_KEY_SYSTEM_ACCESS_COMPLETE:"keySystemAccessComplete",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected",ENAME_KEY_SYSTEM_NOT_SELECTED:"keySystemNotSelected",ENAME_VIDEO_ELEMENT_SELECTED:"videoElementSelected",ENAME_SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",ENAME_KEY_MESSAGE:"keyMessage",ENAME_KEY_ADDED:"keyAdded",ENAME_KEY_ERROR:"keyError",ENAME_KEY_SESSION_CREATED:"keySessionCreated",ENAME_KEY_SESSION_REMOVED:"keySessionRemoved",ENAME_KEY_SESSION_CLOSED:"keySessionClosed",ENAME_KEY_STATUSES_CHANGED:"keyStatusesChanged"},MediaPlayer.models.ProtectionModel_01b=function(){var a,b=null,c=null,d=[],e=[],f=function(){var b=this;return{handleEvent:function(f){var g=null;switch(f.type){case c.needkey:b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,new MediaPlayer.vo.protection.NeedKey(f.initData,"cenc"));break;case c.keyerror:if(g=h(e,f.sessionId),g||(g=h(d,f.sessionId)),g){var i="";switch(f.errorCode.code){case 1:i+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:i+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:i+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:i+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:i+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:i+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}i+="  System Code = "+f.systemCode,b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new MediaPlayer.vo.protection.KeyError(g,i))}else b.log("No session token found for key error");break;case c.keyadded:g=h(e,f.sessionId),g||(g=h(d,f.sessionId)),g?b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,g):b.log("No session token found for key added");break;case c.keymessage:a=null!==f.sessionId&&void 0!==f.sessionId,a?(g=h(e,f.sessionId),!g&&d.length>0&&(g=d.shift(),e.push(g),g.sessionID=f.sessionId)):d.length>0&&(g=d.shift(),e.push(g),0!==d.length&&b.errHandler.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),g?(g.keyMessage=f.message,b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new MediaPlayer.vo.protection.KeyMessage(g,f.message,f.defaultURL))):b.log("No session token found for key message")}}}},g=null,h=function(a,b){if(b&&a){for(var c=a.length,d=0;c>d;d++)if(a[d].sessionID==b)return a[d];return null}return null},i=function(){b.removeEventListener(c.keyerror,g),b.removeEventListener(c.needkey,g),b.removeEventListener(c.keymessage,g),b.removeEventListener(c.keyadded,g)};return{system:void 0,log:void 0,errHandler:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){g=f.call(this)},init:function(){var a=document.createElement("video");c=MediaPlayer.models.ProtectionModel_01b.detect(a)},teardown:function(){b&&i();for(var a=0;a<e.length;a++)this.closeKeySession(e[a])},requestKeySystemAccess:function(a){var c=b;c||(c=document.createElement("video"));for(var d=!1,e=0;e<a.length;e++)for(var f=a[e].ks.systemString,g=a[e].configs,h=null,i=null,j=0;j<g.length;j++){var k=g[j].videoCapabilities;if(k&&0!==k.length){i=[];for(var l=0;l<k.length;l++)""!==c.canPlayType(k[l].contentType,f)&&i.push(k[l])}if(!(!h&&!i||h&&0===h.length||i&&0===i.length)){d=!0;var m=new MediaPlayer.vo.protection.KeySystemConfiguration(h,i),n=this.protectionExt.getKeySystemBySystemString(f),o=new MediaPlayer.vo.protection.KeySystemAccess(n,m);this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,o);break}}d||this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(a){this.keySystem=a.keySystem,this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)},setMediaElement:function(a){b&&i(),b=a,b.addEventListener(c.keyerror,g),b.addEventListener(c.needkey,g),b.addEventListener(c.keymessage,g),b.addEventListener(c.keyadded,g),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)},createKeySession:function(f){if(!this.keySystem)throw new Error("Can not create sessions until you have selected a key system");var g;for(g=0;g<e.length;g++)if(this.protectionExt.initDataEquals(f,e[g].initData))return;for(g=0;g<d.length;g++)if(this.protectionExt.initDataEquals(f,d[g].initData))return;if(a||0===e.length){var h={prototype:(new MediaPlayer.models.SessionToken).prototype,sessionID:null,initData:f,getSessionID:function(){return this.sessionID}};return d.push(h),b[c.generateKeyRequest](this.keySystem.systemString,new Uint8Array(f)),h}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(a,d){var e=a.sessionID;if(this.protectionExt.isClearKey(this.keySystem))for(var f=0;f<d.keyPairs.length;f++)b[c.addKey](this.keySystem.systemString,d.keyPairs[f].key,d.keyPairs[f].keyID,e);else b[c.addKey](this.keySystem.systemString,d,a.initData,e)},closeKeySession:function(a){b[c.cancelKeyRequest](this.keySystem.systemString,a.sessionID)},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){}}},MediaPlayer.models.ProtectionModel_01b.prototype={constructor:MediaPlayer.models.ProtectionModel_01b},MediaPlayer.models.ProtectionModel_01b.APIs=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],MediaPlayer.models.ProtectionModel_01b.detect=function(a){for(var b=MediaPlayer.models.ProtectionModel_01b.APIs,c=0;c<b.length;c++){var d=b[c];if("function"==typeof a[d.generateKeyRequest]&&"function"==typeof a[d.addKey]&&"function"==typeof a[d.cancelKeyRequest])return d}return null},MediaPlayer.models.ProtectionModel_21Jan2015=function(){var a=null,b=null,c=[],d=function(a,b){var c=this;!function(b){var e=a[b].ks,f=a[b].configs;0==f[0].audioCapabilities.length&&(f[0].audioCapabilities=[{contentType:'audio/mp4;codecs="mp4a.40.2"',robustness:void 0}]),(CL.manifest.fixVideoCodec===!0||0===CL.configs.tracks.video.length)&&(f[0].videoCapabilities=[{contentType:'video/mp4;codecs="avc1.42c00c"',robustness:void 0}]),navigator.requestMediaKeySystemAccess(e.systemString,f).then(function(a){var b="function"==typeof a.getConfiguration?a.getConfiguration():null,d=new MediaPlayer.vo.protection.KeySystemAccess(e,b);d.mksa=a,c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,d)})["catch"](function(){++b<a.length?d.call(c,a,b):c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_NOT_SELECTED,null,"Key system access denied!")})}(b)},e=function(){var a=this;return{handleEvent:function(b){switch(b.type){case"encrypted":a.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,new MediaPlayer.vo.protection.NeedKey(b.initData,b.initDataType))}}}},f=null,g=function(a){for(var b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}},h=function(a,b){var d=this,e={prototype:(new MediaPlayer.models.SessionToken).prototype,session:a,initData:b,handleEvent:function(a){switch(a.type){case"keystatuseschange":d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this);break;case"message":d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new MediaPlayer.vo.protection.KeyMessage(this,a.message,void 0,a.messageType))}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return this.session.expiration},getKeyStatuses:function(){return this.session.keyStatuses}};return a.addEventListener("keystatuseschange",e),a.addEventListener("message",e),a.closed.then(function(){g(e),d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,e.getSessionID())}),c.push(e),e};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){f=e.call(this)},init:function(){},teardown:function(){a&&a.removeEventListener("encrypted",f);for(var b=0;b<c.length;b++)this.closeKeySession(c[b])},requestKeySystemAccess:function(a){d.call(this,a,0)},selectKeySystem:function(c){var d=this;c.mksa.createMediaKeys().then(function(e){d.keySystem=c.keySystem,b=e,a&&a.setMediaKeys(b).then(function(){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)},function(){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+c.keySystem.systemString+")! Could not create MediaKeys")})})["catch"](function(){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_NOT_SELECTED,null,"Content Decryption Module is not available!")})},setMediaElement:function(c){a&&a.removeEventListener("encrypted",f),a=c,a.addEventListener("encrypted",f),b&&a.setMediaKeys(b)},setServerCertificate:function(a){if(!this.keySystem||!b)throw new Error("Can not set server certificate until you have selected a key system");var c=this;b.setServerCertificate(a).then(function(){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED)})["catch"](function(a){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,null,"Error updating server certificate -- "+a.name)})},createKeySession:function(a,d){if(!this.keySystem||!b)throw new Error("Can not create sessions until you have selected a key system");for(var e=0;e<c.length;e++)if(this.protectionExt.initDataEquals(a,c[e].initData))return;var f=b.createSession(d),i=h.call(this,f,a),j=this;f.generateRequest("cenc",a).then(function(){j.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,i)})["catch"](function(a){g(i),j.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,"Error generating key request -- "+a.name)})},updateKeySession:function(a,b){var c=a.session,d=this;this.protectionExt.isClearKey(this.keySystem)&&(b=b.toJWK()),c.update(b)["catch"](function(b){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new MediaPlayer.vo.protection.KeyError(a,"Error sending update() message! "+b.name))})},loadKeySession:function(a){if(!this.keySystem||!b)throw new Error("Can not load sessions until you have selected a key system");var c=b.createSession(),d=this;c.load(a).then(function(b){if(b){var e=h.call(this,c);d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,e)}else d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,"Could not load session! Invalid Session ID ("+a+")")})["catch"](function(b){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,"Could not load session ("+a+")! "+b.name)})},removeKeySession:function(a){var b=a.session,c=this;b.remove().then(function(){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,a.getSessionID())})["catch"](function(b){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,null,"Error removing session ("+a.getSessionID()+"). "+b.name)})},closeKeySession:function(a){var b=a.session;b.removeEventListener("keystatuseschange",a),b.removeEventListener("message",a);var c=this;b.close()["catch"](function(b){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,null,"Error closing session ("+a.getSessionID()+") "+b.name)})}}},MediaPlayer.models.ProtectionModel_21Jan2015.detect=function(a){return void 0===a.onencrypted||void 0===a.mediaKeys?!1:void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess?!1:!0},MediaPlayer.models.ProtectionModel_21Jan2015.prototype={constructor:MediaPlayer.models.ProtectionModel_21Jan2015},MediaPlayer.models.ProtectionModel_3Feb2014=function(){var a=null,b=null,c=null,d=null,e=[],f=function(){var a=this;return{handleEvent:function(b){switch(b.type){case d.needkey:a.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,new MediaPlayer.vo.protection.NeedKey(b.initData,"cenc"))}}}},g=null,h=function(){var c=function(){a[d.setMediaKeys](b),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)};a.readyState>=1?c.call(this):a.addEventListener("loadedmetadata",c.bind(this))},i=function(a,b){var c=this;return{prototype:(new MediaPlayer.models.SessionToken).prototype,session:a,initData:b,handleEvent:function(a){switch(a.type){case d.error:var b="KeyError";c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new MediaPlayer.vo.protection.KeyError(this,b));break;case d.message:c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new MediaPlayer.vo.protection.KeyMessage(this,a.message,a.destinationURL));break;case d.ready:c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this);break;case d.close:c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this.getSessionID())}},getSessionID:function(){return this.session.sessionId}}};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){g=f.call(this)},init:function(){var a=document.createElement("video");d=MediaPlayer.models.ProtectionModel_3Feb2014.detect(a)},teardown:function(){a&&a.removeEventListener(d.needkey,g);for(var b=0;b<e.length;b++)this.closeKeySession(e[b])},requestKeySystemAccess:function(a){for(var b=!1,c=0;c<a.length;c++)for(var e=a[c].ks.systemString,f=a[c].configs,g=null,h=null,i=0;i<f.length;i++){var j=f[i].audioCapabilities,k=f[i].videoCapabilities;if(j&&0!==j.length){g=[];for(var l=0;l<j.length;l++)window[d.MediaKeys].isTypeSupported(e,j[l].contentType)&&g.push(j[l])}if(k&&0!==k.length){h=[];for(var m=0;m<k.length;m++)window[d.MediaKeys].isTypeSupported(e,k[m].contentType)&&h.push(k[m])}if(!(!g&&!h||g&&0===g.length||h&&0===h.length)){b=!0;var n=new MediaPlayer.vo.protection.KeySystemConfiguration(g,h),o=this.protectionExt.getKeySystemBySystemString(e),p=new MediaPlayer.vo.protection.KeySystemAccess(o,n);this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,p);break}}b||this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(e){try{b=e.mediaKeys=new window[d.MediaKeys](e.keySystem.systemString),this.keySystem=e.keySystem,c=e,a&&h.call(this),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}catch(f){this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+this.keySystem.systemString+")! Could not create MediaKeys -- TODO")}},setMediaElement:function(c){a&&a.removeEventListener(d.needkey,g),a=c,a.addEventListener(d.needkey,g),b&&h.call(this)},createKeySession:function(a){if(!this.keySystem||!b||!c)throw new Error("Can not create sessions until you have selected a key system");for(var f=0;f<e.length;f++)if(this.protectionExt.initDataEquals(a,e[f].initData))return;var g=c.ksConfiguration.videoCapabilities[0].contentType,h=b.createSession(g,new Uint8Array(a)),j=i.call(this,h,a);h.addEventListener(d.error,j),h.addEventListener(d.message,j),h.addEventListener(d.ready,j),h.addEventListener(d.close,j),e.push(j),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,j)},updateKeySession:function(a,b){var c=a.session;c.update(this.protectionExt.isClearKey(this.keySystem)?new Uint8Array(b.toJWK()):b)},closeKeySession:function(a){var b=a.session;b.removeEventListener(d.error,a),b.removeEventListener(d.message,a),b.removeEventListener(d.ready,a),b.removeEventListener(d.close,a);for(var c=0;c<e.length;c++)if(e[c]===a){e.splice(c,1);break}b[d.release]()},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){}}},MediaPlayer.models.ProtectionModel_3Feb2014.APIs=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}],MediaPlayer.models.ProtectionModel_3Feb2014.detect=function(a){for(var b=MediaPlayer.models.ProtectionModel_3Feb2014.APIs,c=0;c<b.length;c++){var d=b[c];if("function"==typeof a[d.setMediaKeys]&&"function"==typeof window[d.MediaKeys])return d}return null},MediaPlayer.models.ProtectionModel_3Feb2014.prototype={constructor:MediaPlayer.models.ProtectionModel_3Feb2014},MediaPlayer.models.URIQueryAndFragmentModel=function(){"use strict";var a=new MediaPlayer.vo.URIFragmentData,b=[],c=function(c){function d(a,b,c,d){var e=d[0].split(/[=]/);return d.push({key:e[0],value:e[1]}),d.shift(),d}if(!c)return null;var e=[];return b.length>0&&(b=b.reduce(d,null)),e.length>0&&(e=e.reduce(d,null),e.forEach(function(b){a[b.key]=b.value})),c};return{parseURI:c,getURIFragmentData:function(){return a},getURIQueryData:function(){return b},reset:function(){a=new MediaPlayer.vo.URIFragmentData,b=[]}}},MediaPlayer.models.URIQueryAndFragmentModel.prototype={constructor:MediaPlayer.models.URIQueryAndFragmentModel},MediaPlayer.models.VideoModel=function(){"use strict";var a,b=[],c=function(){return b.length>0},d=function(c){null===c||a.seeking||(this.setPlaybackRate(0),b[c]!==!0&&(b.push(c),b[c]=!0))},e=function(a){if(null!==a){b[a]=!1;var d=b.indexOf(a);-1!==d&&b.splice(d,1),c()===!1&&this.setPlaybackRate(1)
}},f=function(a,b){b?d.call(this,a):e.call(this,a)},g=function(a){var b=a.sender.streamProcessor.getType();f.call(this,b,!a.data.hasSufficientBuffer)};return{system:void 0,setup:function(){this.bufferLevelStateChanged=g},play:function(){null!=CL.configs.minStartTime&&CL.configs.minStartTime>0&&0==a.currentTime&&0==CL.configs.isIE11,a.play()},pause:function(){a.pause()},isPaused:function(){return a.paused},getPlaybackRate:function(){return a.playbackRate},setPlaybackRate:function(b){!a||a.readyState<2||(a.playbackRate=b)},getCurrentTime:function(){var b=a.currentTime;return b-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,b=Math.max(0,b)},setCurrentTime:function(b){b+=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,a.currentTime!=b&&(a.currentTime=b)},listen:function(b,c){a.addEventListener(b,c,!1)},unlisten:function(b,c){a.removeEventListener(b,c,!1)},getElement:function(){return a},setElement:function(b){a=b},setSource:function(b){a.src=b}}},MediaPlayer.models.VideoModel.prototype={constructor:MediaPlayer.models.VideoModel},MediaPlayer.dependencies.protection.CommonEncryption={findCencContentProtection:function(a){for(var b=null,c=0;c<a.length;++c){var d=a[c];"urn:mpeg:dash:mp4protection:2011"===d.schemeIdUri.toLowerCase()&&"cenc"===d.value.toLowerCase()&&(b=d)}return b},getPSSHData:function(a){return a.slice(32)},getPSSHForKeySystem:function(a,b){var c=MediaPlayer.dependencies.protection.CommonEncryption.parsePSSHList(b);return c.hasOwnProperty(a.uuid.toLowerCase())?c[a.uuid.toLowerCase()]:null},parseInitDataFromContentProtection:function(a){return"pssh"in a?BASE64.decodeArray(a.pssh.__text).buffer:null},parsePSSHList:function(a){if(null===a)return[];for(var b=new DataView(a),c=!1,d={},e=0;!c;){var f,g,h,i,j,k=e;if(e>=b.buffer.byteLength)break;if(f=b.getUint32(e),g=e+f,e+=4,1886614376===b.getUint32(e))if(e+=4,h=b.getUint8(e),0===h||1===h){e+=1,e+=3,i="";var l,m;for(l=0;4>l;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=4,i+="-",l=0;2>l;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=2,i+="-",l=0;2>l;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=2,i+="-",l=0;2>l;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=2,i+="-",l=0;6>l;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;e+=6,i=i.toLowerCase(),j=b.getUint32(e),e+=4,d[i]=b.buffer.slice(k,g),e=g}else e=g;else e=g}return d}},MediaPlayer.dependencies.protection.KeySystem={eventList:{ENAME_LICENSE_REQUEST_COMPLETE:"licenseRequestComplete"}},MediaPlayer.dependencies.protection.KeySystem_Access=function(){"use strict"},MediaPlayer.dependencies.protection.KeySystem_Access.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_Access},MediaPlayer.dependencies.protection.KeySystem_ClearKey=function(){"use strict";var a,b="org.w3.clearkey",c="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",d=function(b,c){var d,e=this,f=a&&a.laURL&&""!==a.laURL?a.laURL:null,g=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b)));if(f){for(f+="/?",d=0;d<g.kids.length;d++)f+=g.kids[d]+"&";f=f.substring(0,f.length-1);var h=new XMLHttpRequest;h.onload=function(){if(200==h.status){for(h.response.hasOwnProperty("keys")||e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: ClearKey Remote update, Illegal response JSON")),d=0;d<h.response.keys.length;d++){var a=h.response.keys[d],b=a.kid.replace(/=/g,"");k=a.k.replace(/=/g,""),i.push(new MediaPlayer.vo.protection.KeyPair(b,k))}var f=new MediaPlayer.vo.protection.LicenseRequestComplete(new MediaPlayer.vo.protection.ClearKeyKeySet(i),c);e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,f)}else e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: ClearKey Remote update, XHR aborted. status is "'+h.statusText+'" ('+h.status+"), readyState is "+h.readyState))},h.onabort=function(){e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: ClearKey update, XHR aborted. status is "'+h.statusText+'" ('+h.status+"), readyState is "+h.readyState))},h.onerror=function(){e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: ClearKey update, XHR error. status is "'+h.statusText+'" ('+h.status+"), readyState is "+h.readyState))},h.open("GET",f),h.responseType="json",h.send()}else if(a.clearkeys){var i=[];for(d=0;d<g.kids.length;d++){var j=g.kids[d],k=a.clearkeys.hasOwnProperty(j)?a.clearkeys[j]:null;k||this.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: ClearKey keyID ("+j+") is not known!")),i.push(new MediaPlayer.vo.protection.KeyPair(j,k))}var l=new MediaPlayer.vo.protection.LicenseRequestComplete(new MediaPlayer.vo.protection.ClearKeyKeySet(i),c);this.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,l)}else e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: ClearKey has no way (URL or protection data) to retrieve keys"))};return{system:void 0,schemeIdURI:"urn:uuid:"+c,systemString:b,uuid:c,notify:void 0,subscribe:void 0,unsubscribe:void 0,init:function(b){a=b},doLicenseRequest:function(a,b,c){d.call(this,a,c)},getInitData:MediaPlayer.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection}},MediaPlayer.dependencies.protection.KeySystem_ClearKey.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_ClearKey},MediaPlayer.dependencies.protection.KeySystem_PlayReady=function(){"use strict";var a,b="com.microsoft.playready",c="9a04f079-9840-4286-ab92-e65be0885f95",d=function(b,c,d){var e,f,g,h,i,j,k=null,l={},m=new DOMParser,n=this;if(j=new Uint16Array(void 0!=b.buffer?b.buffer:b),i=String.fromCharCode.apply(null,j),h=m.parseFromString(i,"application/xml"),h.getElementsByTagName("Challenge")[0]){var o=h.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;if(o&&(k=BASE64.decode(o),void 0===c||null===c||""===c)){var p=k.toLowerCase().indexOf("<la_url>"),q=k.toLowerCase().indexOf("</la_url>");p>-1&&q>p&&(c=k.substring(p+8,q))}}else n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,"DRM: playready update, can not find Challenge in keyMessage",null));var r=h.getElementsByTagName("name"),s=h.getElementsByTagName("value");r.length!=s.length&&n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,"DRM: playready update, invalid header name/value pair in keyMessage",null));for(var t=0;t<r.length;t++)l[r[t].childNodes[0].nodeValue]=s[t].childNodes[0].nodeValue;a&&a.bearerToken&&(l.Authorization=a.bearerToken);var u=new XMLHttpRequest;if(CL.configs.isIE11||(u.timeout=CL.manifest.licenseRequestTimeout),u.onload=function(){if(200==u.status){var a=new MediaPlayer.vo.protection.LicenseRequestComplete(new Uint8Array(u.response),d);n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,a)}else{var b={message:'DRM: playready update, XHR status is "'+u.statusText+'" ('+u.status+"), expected to be 200. readyState is "+u.readyState+".  ",response:this.response?String.fromCharCode.apply(null,new Uint8Array(this.response)):"NONE",status:u.status,statusText:u.statusText,responseURL:u.responseURL};n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,b)}},u.onabort=function(){var a={message:'DRM: playready update, XHR aborted. status is "'+u.statusText+'" ('+u.status+"), readyState is "+u.readyState,response:"NONE",status:u.status,statusText:u.statusText,responseURL:u.responseURL};n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,a)},u.onerror=function(){var a={message:'DRM: playready update, XHR error. status is "'+u.statusText+'" ('+u.status+"), readyState is "+u.readyState,response:"NONE",status:u.status,statusText:u.statusText,responseURL:u.responseURL};n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,a)},u.ontimeout=function(){var a={message:'DRM: playready update, XHR timeout. status is "'+u.statusText+'" ('+u.status+"), readyState is "+u.readyState,response:"NONE",status:u.status,statusText:u.statusText,responseURL:u.responseURL};n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,a)},CL.configs.isIE11||(u.timeout=CL.manifest.licenseRequestTimeout),u.open("POST",a&&a.laURL&&""!==a.laURL?a.laURL:c),u.responseType="arraybuffer",g=a?a.httpRequestHeaders:null)for(f in g)l[f]=g[f];for(e in l)"authorization"===e.toLowerCase()&&(u.withCredentials=!0),u.setRequestHeader(e,l[e]);a&&a.withCredentials&&(u.withCredentials=!0),u.send(k)},e=function(a){var b,c,d,e,f,g=0,h=new Uint8Array([112,115,115,104,0,0,0,0]),i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),j=null;if("pro"in a)j=BASE64.decodeArray(a.pro.text);else{if(!("prheader"in a))return null;j=BASE64.decodeArray(a.prheader.text)}return b=j.length,c=4+h.length+i.length+4+b,d=new ArrayBuffer(c),e=new Uint8Array(d),f=new DataView(d),f.setUint32(g,c),g+=4,e.set(h,g),g+=h.length,e.set(i,g),g+=i.length,f.setUint32(g,b),g+=4,e.set(j,g),g+=b,e.buffer},f=function(){return!1};return{schemeIdURI:"urn:uuid:"+c,systemString:b,uuid:c,notify:void 0,subscribe:void 0,unsubscribe:void 0,init:function(b){a=b},doLicenseRequest:d,getInitData:e,initDataEquals:f}},MediaPlayer.dependencies.protection.KeySystem_PlayReady.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_PlayReady},MediaPlayer.dependencies.protection.KeySystem_Widevine=function(){"use strict";var keySystemStr="com.widevine.alpha",keySystemUUID="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",protData,utils=new castLabsDashJS.classes.Utils,requestLicense=function(message,laURL,requestData){var xhr=new XMLHttpRequest,headers={},key,headerOverrides,headerName,url,self=this;if(url=protData&&protData.laURL&&""!==protData.laURL?protData.laURL:laURL){if(CL.configs.isIE11||(xhr.timeout=CL.manifest.licenseRequestTimeout),xhr.open("POST",url,!0),xhr.responseType="arraybuffer",xhr.onload=function(){if(200==this.status){for(var license,responseBytes=new Uint8Array(this.response),parsed_message="",it=0;it<responseBytes.byteLength;++it)parsed_message+=String.fromCharCode(responseBytes[it]);var msgTrimmed=parsed_message.trim();if(0==msgTrimmed.indexOf("{")&&msgTrimmed.lastIndexOf("}")==msgTrimmed.length-1){var message_json=eval("("+parsed_message+")");license=utils.base64DecToArr(message_json.license);try{var debug_text=UTF8ArrToStr(base64DecToArr(message_json.debug_info));CL.configs.debug&&console.log("debug text:"+debug_text)}catch(e){CL.configs.debug&&console.log("no property 'debug_info'")}}else license=responseBytes;var event=new MediaPlayer.vo.protection.LicenseRequestComplete(license,requestData);self.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,event)}else{var error={message:'DRM: widevine update, XHR status is "'+xhr.statusText+'" ('+xhr.status+"), expected to be 200. readyState is "+xhr.readyState+".  ",response:this.response?String.fromCharCode.apply(null,new Uint8Array(this.response)):"NONE",status:xhr.status,statusText:xhr.statusText,responseURL:xhr.responseURL};self.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,error)}},xhr.onabort=function(){var a={message:'DRM: widevine update, XHR aborted. status is "'+xhr.statusText+'" ('+xhr.status+"), readyState is "+xhr.readyState,response:"NONE",status:xhr.status,statusText:xhr.statusText,responseURL:xhr.responseURL};self.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,a)},xhr.onerror=function(){var a={message:'DRM: widevine update, XHR aborted. status is "'+xhr.statusText+'" ('+xhr.status+"), readyState is "+xhr.readyState,response:"NONE",status:xhr.status,statusText:xhr.statusText,responseURL:xhr.responseURL};self.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,a)},xhr.ontimeout=function(){var a={message:'DRM: widevine update, XHR timeout. status is "'+xhr.statusText+'" ('+xhr.status+"), readyState is "+xhr.readyState,response:"NONE",status:xhr.status,statusText:xhr.statusText,responseURL:xhr.responseURL};self.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,a)},headerOverrides=protData?protData.httpRequestHeaders:null)for(key in headerOverrides)headers[key]=headerOverrides[key];for(headerName in headers)"authorization"===headerName.toLowerCase()&&(xhr.withCredentials=!0),xhr.setRequestHeader(headerName,headers[headerName]);xhr.send(message)}else self.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: No valid Widevine Proxy Server URL specified!"))},parseInitDataFromContentProtection=function(){return null},isInitDataEqual=function(a,b){return utils.arrToBase64(a)===utils.arrToBase64(b)};return{schemeIdURI:"urn:uuid:"+keySystemUUID,systemString:keySystemStr,uuid:keySystemUUID,notify:void 0,subscribe:void 0,unsubscribe:void 0,init:function(a){protData=a},doLicenseRequest:requestLicense,getInitData:parseInitDataFromContentProtection,initDataEquals:isInitDataEqual}},MediaPlayer.dependencies.protection.KeySystem_Widevine.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_Widevine},MediaPlayer.rules.ABRRulesCollection=function(){"use strict";var a=[];return{insufficientBufferRule:void 0,bufferOccupancyRule:void 0,throughputRule:void 0,droppedFramesRule:void 0,getRules:function(b){switch(b){case MediaPlayer.rules.ABRRulesCollection.prototype.QUALITY_SWITCH_RULES:return a;default:return null}},setup:function(){a.push(this.insufficientBufferRule),a.push(this.throughputRule),CL.manifest.ABRParameters.disableBufferOccupancyRule&&1!=CL.manifest.ABRParameters.disableBufferOccupancyRule&&a.push(this.bufferOccupancyRule),a.push(this.droppedFramesRule)}}},MediaPlayer.rules.ABRRulesCollection.prototype={constructor:MediaPlayer.rules.ABRRulesCollection,QUALITY_SWITCH_RULES:"qualitySwitchRules"},MediaPlayer.rules.BufferOccupancyRule=function(){"use strict";var a=0;return{log:void 0,metricsModel:void 0,execute:function(b,c){var d=this,e=(new Date).getTime()/1e3,f=b.getMediaInfo(),g=b.getTrackInfo(),h=f.type,i=isNaN(g.fragmentDuration)?2:g.fragmentDuration/2,j=b.getCurrentValue(),k=this.metricsModel.getReadOnlyMetricsFor(h),l=k.BufferLevel.length>0?k.BufferLevel[k.BufferLevel.length-1]:null,m=k.BufferState.length>0?k.BufferState[k.BufferState.length-1]:null,n=!1,o=f.trackCount-1,p=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);return i>e-a||CL.configs.limitRepresentation===!0?void c(p):(null!==l&&null!==m&&l.level>m.target&&(n=l.level-m.target>MediaPlayer.dependencies.BufferController.RICH_BUFFER_THRESHOLD,n&&f.trackCount>1&&(p=new MediaPlayer.rules.SwitchRequest(o,MediaPlayer.rules.SwitchRequest.prototype.STRONG))),p.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&p.value!==j&&d.log("BufferOccupancyRule requesting switch to index: ",p.value,"type: ",h," Priority: ",p.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":p.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak"),void c(p))},reset:function(){a=0}}},MediaPlayer.rules.BufferOccupancyRule.prototype={constructor:MediaPlayer.rules.BufferOccupancyRule},MediaPlayer.rules.DownloadRatioRule=function(){"use strict";var a=1,b=[],c=20,d=3,e=CL.manifest.ABRParameters.downloadRatioSafetyFactor||1.4,f=function(a,b,c){return a.getTrackForQuality(b).bandwidth/a.getTrackForQuality(c).bandwidth},g=function(a){var d=0,e=b.length;if(a=a>e?e:a,e>0){for(var f=e-a,g=0,h=f;e>h;h++)g+=b[h];d=g/a}return b.length>c&&b.shift(),d};return{debug:void 0,metricsExt:void 0,metricsModel:void 0,execute:function(a,c){var h,i,j,k,l,m,n,o=this,p=a.getMediaInfo(),q=p.type,r=a.getCurrentValue(),s=a.getStreamProcessor(),t=s.isDynamic(),u=o.metricsModel.getReadOnlyMetricsFor(q),v=o.metricsExt.getCurrentHttpRequest(u),w=u.BufferLevel[u.BufferLevel.length-1]||null,x=null;if(!u||null===v||null===v.mediaduration||void 0===v.mediaduration||v.mediaduration<=0||isNaN(v.mediaduration))return void c(new MediaPlayer.rules.SwitchRequest);if(i=(v.tfinish.getTime()-v.trequest.getTime())/1e3,h=(v.tfinish.getTime()-v.tresponse.getTime())/1e3,0>=i)return void c(new MediaPlayer.rules.SwitchRequest);if(l=v.mediaduration/i,k=v.mediaduration/h,1/0!==k&&b.push(k),j=g(d),isNaN(j)||isNaN(k)||isNaN(l))return void c(new MediaPlayer.rules.SwitchRequest);if(1>j){if(r>0)for(n=r-1;n>0;n--)if(m=f.call(o,s,n,r),j>m*e){x=new MediaPlayer.rules.SwitchRequest(n,MediaPlayer.rules.SwitchRequest.prototype.STRONG);break}}else if(null!==w&&w.level>=w.target||t&&null!==w&&w.level>=MediaPlayer.dependencies.BufferController.DEFAULT_STARTUP_BUFFER_TIME){var y=p.trackCount-1;if(CL.configs.limitRepresentation===!0&&CL.configs.maxIndex>-1&&"video"===q&&(y=CL.configs.maxIndex),y>r)for(n=y;n>0;n--)if(m=f.call(o,s,n,r),j>m){r!==n&&(x=new MediaPlayer.rules.SwitchRequest(n,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT));break}}null===x&&(x=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT)),x.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&o.debug.log("DownloadRatioRule requesting switch to index: ",x.value,"type: ",q," priority: ",x.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"default":x.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"strong":"weak"),c(x)},reset:function(){a=1,b=[]}}},MediaPlayer.rules.DownloadRatioRule.prototype={constructor:MediaPlayer.rules.DownloadRatioRule},MediaPlayer.rules.DroppedFramesRule=function(){"use strict";var a=0,b=-1;return{log:void 0,metricsModel:void 0,execute:function(a,b){var c=this,d=((new Date).getTime()/1e3,a.getMediaInfo()),e=a.getTrackInfo(),f=d.type,g=(isNaN(e.fragmentDuration)?2:e.fragmentDuration/2,a.getCurrentValue()),h=(this.metricsModel.getReadOnlyMetricsFor(f),d.trackCount-1,Math.max(0,g-1)),i=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);CL.configs.lowerRepresentation===!0&&h!==g?(i=new MediaPlayer.rules.SwitchRequest(h,MediaPlayer.rules.SwitchRequest.prototype.STRONG),CL.configs.maxIndex=h,CL.configs.limitRepresentation=!0,CL.configs.lowerRepresentation=!1):b(i),i.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&i.value!==g&&c.log("DroppedFramesRule requesting switch to index: ",i.value,"type: ",f," Priority: ",i.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":i.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak"),b(i)},reset:function(){a=0,b=-1}}},MediaPlayer.rules.DroppedFramesRule.prototype={constructor:MediaPlayer.rules.DroppedFramesRule},MediaPlayer.rules.InsufficientBufferRule=function(){"use strict";var a={},b=0,c=1e3,d=function(b,c){a[b]=a[b]||{},a[b].state=c,c!==MediaPlayer.dependencies.BufferController.BUFFER_LOADED||a[b].firstBufferLoadedEvent||(a[b].firstBufferLoadedEvent=!0)};return{log:void 0,metricsModel:void 0,execute:function(e,f){var g=this,h=(new Date).getTime(),i=e.getMediaInfo().type,j=e.getCurrentValue(),k=g.metricsModel.getReadOnlyMetricsFor(i),l=e.getStreamInfo(),m=e.getTrackInfo(),n=l.duration,o=e.getStreamProcessor().getPlaybackController().getTime(),p=e.getStreamProcessor(),q=p.isDynamic(),r=k.BufferLevel.length>0?k.BufferLevel[k.BufferLevel.length-1]:null,s=k.BufferState.length>0?k.BufferState[k.BufferState.length-1]:null,t=Math.max(m.fragmentDuration,MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD/2),u=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);if(c>h-b||null===s)return void f(u);if(d(i,s.state),s.state===MediaPlayer.dependencies.BufferController.BUFFER_EMPTY&&void 0!==a[i].firstBufferLoadedEvent)u=new MediaPlayer.rules.SwitchRequest(0,MediaPlayer.rules.SwitchRequest.prototype.STRONG);else if(!q&&a[i].state===MediaPlayer.dependencies.BufferController.BUFFER_LOADED&&r.level<2*t&&n-2*t>o){var v=r.level>t?MediaPlayer.rules.SwitchRequest.prototype.DEFAULT:MediaPlayer.rules.SwitchRequest.prototype.STRONG;u=new MediaPlayer.rules.SwitchRequest(Math.max(j-1,0),v)}u.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&u.value!==j&&g.log("InsufficientBufferRule requesting switch to index: ",u.value,"type: ",i," Priority: ",u.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":u.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak"),b=h,f(u)},reset:function(){a={},b=0}}},MediaPlayer.rules.InsufficientBufferRule.prototype={constructor:MediaPlayer.rules.InsufficientBufferRule},MediaPlayer.rules.LimitSwitchesRule=function(){"use strict";var a=0,b=CL.manifest.ABRParameters.qualitySwitchThreshold||2e3;return{debug:void 0,metricsModel:void 0,execute:function(c,d){var e,f=c.getCurrentValue(),g=(new Date).getTime();return e=g-a,b>e?void d(new MediaPlayer.rules.SwitchRequest(f,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT)):(a=g,void d(new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK)))}}},MediaPlayer.rules.LimitSwitchesRule.prototype={constructor:MediaPlayer.rules.LimitSwitchesRule},MediaPlayer.rules.ThroughputRule=function(){"use strict";var a=[],b=0,c=2,d=3,e=CL.manifest.ABRParameters.bandwidthSafetyFactor||1,f=function(b,c){a[b]=a[b]||[],1/0!==c&&c!==a[b][a[b].length-1]&&a[b].push(c)},g=function(b,e){var f=0,g=e?c:d,h=a[b],i=h.length;if(g=g>i?i:g,i>0){for(var j=i-g,k=0,l=j;i>l;l++)k+=h[l];f=k/g}return h.length>g&&h.shift(),f};return{log:void 0,metricsExt:void 0,metricsModel:void 0,manifestExt:void 0,manifestModel:void 0,execute:function(a,c){var d,h,i,j,k=this,l=(new Date).getTime()/1e3,m=a.getMediaInfo(),n=m.type,o=a.getCurrentValue(),p=a.getTrackInfo(),q=this.manifestModel.getValue(),r=k.metricsModel.getReadOnlyMetricsFor(n),s=a.getStreamProcessor().isDynamic(),t=k.metricsExt.getCurrentHttpRequest(r),u=isNaN(p.fragmentDuration)?2:p.fragmentDuration/2,v=r.BufferState.length>0?r.BufferState[r.BufferState.length-1]:null,w=r.BufferLevel.length>0?r.BufferLevel[r.BufferLevel.length-1]:null,x=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);if(u>l-b||!r||null===t||t.type!==MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE||null===v||null===w)return void c(x);d=(t.tfinish.getTime()-t.tresponse.getTime())/1e3,h=t.tfinish.getTime()-t.trequest.getTime(),j=Math.round(8*t.trace[t.trace.length-1].b/d);var y=t.trace[t.trace.length-1].b/1024;if(CL.manifest.ABRParameters.limitThroughputRule===!0&&"video"===n&&(.05>d||100>y||j/1024>1e5))return void c(x);if(void 0===t.responsecode||t.responsecode<200||t.responsecode>=400)return void c(x);f(n,j),i=Math.round(g(n,s));var z=this.manifestExt.getAdaptationForType(q,m.streamInfo.index,n),A=m.trackCount-1;if(CL.configs.limitRepresentation===!0&&CL.configs.maxIndex>-1&&"video"===n&&(A=CL.configs.maxIndex),v.state===MediaPlayer.dependencies.BufferController.BUFFER_LOADED&&(w.level>=MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD/2||s))for(var B=A;B>0;B--){var C=this.manifestExt.getRepresentationFor(B,z).bandwidth;if(i>0&&i>=C*e){x=new MediaPlayer.rules.SwitchRequest(B,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT),b=l;break}}x.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&x.value!==o&&k.log("ThroughputRule requesting switch to index: ",x.value,"type: ",n," Priority: ",x.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":x.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak","Average throughput",Math.round(i/1024),"kbps"),c(x)},reset:function(){a=[],b=0}}},MediaPlayer.rules.ThroughputRule.prototype={constructor:MediaPlayer.rules.ThroughputRule},MediaPlayer.rules.RulesContext=function(a,b){"use strict";var c=a.getCurrentTrack(),d=a;return{getStreamInfo:function(){return c.mediaInfo.streamInfo},getMediaInfo:function(){return c.mediaInfo},getTrackInfo:function(){return c},getCurrentValue:function(){return b},getManifestInfo:function(){return c.mediaInfo.streamInfo.manifestInfo},getStreamProcessor:function(){return d}}},MediaPlayer.rules.RulesContext.prototype={constructor:MediaPlayer.rules.RulesContext},MediaPlayer.rules.RulesController=function(){"use strict";var a={},b=["execute"],c=function(a){return a===this.SCHEDULING_RULE||a===this.ABR_RULE},d=function(a){var c=b.length,d=0;for(d;c>d;d+=1)if(!a.hasOwnProperty(b[d]))return!1;return!0},e=function(a,b){return new MediaPlayer.rules.RulesContext(a,b)},f=function(a){var b=a.execute.bind(a);return a.execute=function(c,d){var e=function(b){d.call(a,new MediaPlayer.rules.SwitchRequest(b.value,b.priority))};b(c,e)},"function"!=typeof a.reset&&(a.reset=function(){}),a},g=function(a,b,c){var e,g,h,i,j,k;for(g in b)if(i=b[g],j=i.length)for(k=0;j>k;k+=1)e=i[k],d.call(this,e)&&(e=f.call(this,e),h=a.getRules(g),c&&(c=!1,h.length=0),this.system.injectInto(e),h.push(e))};return{system:void 0,log:void 0,SCHEDULING_RULE:0,ABR_RULE:1,SYNC_RULE:2,initialize:function(){a[this.ABR_RULE]=this.system.getObject("abrRulesCollection"),a[this.SCHEDULING_RULE]=this.system.getObject("scheduleRulesCollection"),a[this.SYNC_RULE]=this.system.getObject("synchronizationRulesCollection")},setRules:function(b,d){c.call(this,b)&&d&&g.call(this,a[b],d,!0)},addRules:function(b,d){c.call(this,b)&&d&&g.call(this,a[b],d,!1)},applyRules:function(a,b,c,f,g){var h,i,j=a.length,k=j,l={},m=e.call(this,b,f),n=function(a){var b,d;a.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(l[a.priority]=g(l[a.priority],a.value)),--j||(l[MediaPlayer.rules.SwitchRequest.prototype.WEAK]!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(d=MediaPlayer.rules.SwitchRequest.prototype.WEAK,b=l[MediaPlayer.rules.SwitchRequest.prototype.WEAK]),l[MediaPlayer.rules.SwitchRequest.prototype.DEFAULT]!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(d=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,b=l[MediaPlayer.rules.SwitchRequest.prototype.DEFAULT]),l[MediaPlayer.rules.SwitchRequest.prototype.STRONG]!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(d=MediaPlayer.rules.SwitchRequest.prototype.STRONG,b=l[MediaPlayer.rules.SwitchRequest.prototype.STRONG]),d!=MediaPlayer.rules.SwitchRequest.prototype.STRONG&&d!=MediaPlayer.rules.SwitchRequest.prototype.WEAK&&(d=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT),c({value:void 0!==b?b:f,confidence:d}))};for(l[MediaPlayer.rules.SwitchRequest.prototype.STRONG]=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,l[MediaPlayer.rules.SwitchRequest.prototype.WEAK]=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,l[MediaPlayer.rules.SwitchRequest.prototype.DEFAULT]=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,i=0;k>i;i+=1)h=a[i],d.call(this,h)?h.execute(m,n):j--},reset:function(){var b,c,d=a[this.ABR_RULE],e=a[this.SCHEDULING_RULE],f=a[this.SYNC_RULE],g=(d.getRules(MediaPlayer.rules.ABRRulesCollection.prototype.QUALITY_SWITCH_RULES)||[]).concat(e.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.NEXT_FRAGMENT_RULES)||[]).concat(e.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_SCHEDULE_RULES)||[]).concat(e.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_EXECUTE_RULES)||[]).concat(f.getRules(MediaPlayer.rules.SynchronizationRulesCollection.prototype.TIME_SYNCHRONIZED_RULES)||[]).concat(f.getRules(MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES)||[]),h=g.length;for(c=0;h>c;c+=1)b=g[c],"function"==typeof b.reset&&b.reset();a={}}}},MediaPlayer.rules.RulesController.prototype={constructor:MediaPlayer.rules.RulesController},MediaPlayer.rules.BufferLevelRule=function(){"use strict";var a={},b={},c={},d=function(a){var b=this.metricsExt.getCurrentHttpRequest(a);return null!==b?(b.tresponse.getTime()-b.trequest.getTime())/1e3:0},e=function(a,b,c,d){var e;return e=c?Math.min(MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME,d.playbackController.getLiveDelay()):isNaN(b)||MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME<b&&b>a?Math.max(MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME,a):a>=b?Math.min(b,MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME):Math.min(b,a)},f=function(a,b,c){var f=this,g=c.bufferController.getCriticalBufferLevel(),h=f.metricsModel.getReadOnlyMetricsFor("video"),i=f.metricsModel.getReadOnlyMetricsFor("audio"),j=e.call(this,c.bufferController.getMinBufferTime(),b,a,c),k=j,l=c.bufferController.bufferMax,m=0;return l===MediaPlayer.dependencies.BufferController.BUFFER_SIZE_MIN?m=j:l===MediaPlayer.dependencies.BufferController.BUFFER_SIZE_INFINITY?m=b:l===MediaPlayer.dependencies.BufferController.BUFFER_SIZE_REQUIRED&&(!a&&f.abrController.isPlayingAtTopQuality(c.streamProcessor.getStreamInfo())&&(k=null===CL.manifest.ABRParameters.maxBufferLength||isNaN(CL.manifest.ABRParameters.maxBufferLength)?MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY:CL.manifest.ABRParameters.maxBufferLength),m=k+Math.max(d.call(f,h),d.call(f,i))),m=Math.min(m,g)},g=function(a,c){return b[a]&&b[a][c]},h=function(b,c){return a[b]&&a[b][c]},i=function(a){var c=a.data.fragmentModel.getContext().streamProcessor.getStreamInfo().id;b[c]=b[c]||{},b[c][a.data.request.mediaType]=!0},j=function(b){var c=b.sender.streamProcessor.getStreamInfo().id;a[c]=a[c]||{},a[c][b.sender.streamProcessor.getType()]=!0},k=function(b){var c=b.sender.streamProcessor.getStreamInfo().id;a[c]=a[c]||{},a[c][b.sender.streamProcessor.getType()]=!1};return{metricsExt:void 0,metricsModel:void 0,abrController:void 0,playbackController:void 0,setup:function(){this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN]=j,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED]=k,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=i},setScheduleController:function(a){var b=a.streamProcessor.getStreamInfo().id;c[b]=c[b]||{},c[b][a.streamProcessor.getType()]=a},execute:function(a,b){var d=a.getStreamInfo(),e=d.id,i=a.getMediaInfo().type;if(h(e,i))return void b(new MediaPlayer.rules.SwitchRequest(0,MediaPlayer.rules.SwitchRequest.prototype.STRONG));var j,k,l=this.metricsModel.getReadOnlyMetricsFor(i),m=this.metricsExt.getCurrentBufferLevel(l)?this.metricsExt.getCurrentBufferLevel(l).level:0,n=c[e][i],o=n.streamProcessor.getCurrentTrack(),p=n.streamProcessor.isDynamic(),q=this.metricsExt.getCurrentPlaybackRate(l),r=d.duration,s=m/Math.max(q,1),t=o.fragmentDuration,u=n.playbackController.getTime(),v=p?Number.POSITIVE_INFINITY:r-u,w=Math.min(f.call(this,p,r,n),v),x=Math.max(w-s,0);j=w>t&&x>w?0:Math.ceil(x/t),k=(new Date).getTime(),void 0==this.lastCheckTime&&(this.lastCheckTime=[]),void 0==this.lastCheckTime[i]&&(this.lastCheckTime[i]=k),void 0==this.lastFragmentCount&&(this.lastFragmentCount=[]),void 0==this.lastFragmentCount[i]&&(this.lastFragmentCount[i]=0,this.isFirstFragment=[],this.isFirstFragment[i]=!0),void 0==this.checkTimeInterval&&(this.checkTimeInterval=[]),void 0==this.checkTimeInterval[i]&&(this.checkTimeInterval[i]=0),this.checkTimeInterval[i]=100,this.lastFragmentCount[i]>0&&(p||this.abrController.isPlayingAtTopQuality(n.streamProcessor.getStreamInfo())||(this.checkTimeInterval[i]=Math.min(2e3,t/2*1e3))),this.isFirstFragment[i]===!0&&(this.isFirstFragment[i]=!1,this.checkTimeInterval[i]=0),n.streamProcessor.bufferController.isInitPending()===!0&&(j=0),s>=v&&!g(e,i)&&(j=j||1),j=Math.min(1,j),k-this.lastCheckTime[i]<this.checkTimeInterval[i]?(j=0,this.lastFragmentCount[i]=1):(this.lastFragmentCount[i]=j,this.lastCheckTime[i]=k),b(new MediaPlayer.rules.SwitchRequest(j,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT))
},reset:function(){a={},b={},c={}}}},MediaPlayer.rules.BufferLevelRule.prototype={constructor:MediaPlayer.rules.BufferLevelRule},MediaPlayer.rules.PendingRequestsRule=function(){"use strict";var a=0,b={};return{metricsExt:void 0,setScheduleController:function(a){var c=a.streamProcessor.getStreamInfo().id;b[c]=b[c]||{},b[c][a.streamProcessor.getType()]=a},execute:function(c,d){var e=c.getMediaInfo().type,f=c.getStreamInfo().id,g=c.getCurrentValue(),h=b[f][e],i=h.getFragmentModel(),j=i.getRequests({state:[MediaPlayer.dependencies.FragmentModel.states.PENDING,MediaPlayer.dependencies.FragmentModel.states.LOADING]}),k=i.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.REJECTED}),l=k.length,m=j.length,n=Math.max(g-m,0);return l>0?void d(new MediaPlayer.rules.SwitchRequest(l,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT)):m>a?void d(new MediaPlayer.rules.SwitchRequest(0,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT)):0===g?void d(new MediaPlayer.rules.SwitchRequest(n,MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE)):void d(new MediaPlayer.rules.SwitchRequest(n,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT))},reset:function(){b={}}}},MediaPlayer.rules.PendingRequestsRule.prototype={constructor:MediaPlayer.rules.PendingRequestsRule},MediaPlayer.rules.PlaybackTimeRule=function(){"use strict";var a={},b={},c=function(b){var c=b.sender.getStreamId(),d=b.data.seekTime;a[c]=a[c]||{},a[c].audio=d,a[c].video=d,a[c].fragmentedText=d};return{adapter:void 0,sourceBufferExt:void 0,setup:function(){this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=c},setScheduleController:function(a){var c=a.streamProcessor.getStreamInfo().id;b[c]=b[c]||{},b[c][a.streamProcessor.getType()]=a},execute:function(c,d){var e,f,g,h=c.getMediaInfo().type,i=c.getStreamInfo().id,j=b[i][h],k=.1,l=b[i][h].streamProcessor,m=l.getCurrentTrack(),n=a[i]?a[i][h]:null,o=void 0!==n&&null!==n,p=o?MediaPlayer.rules.SwitchRequest.prototype.STRONG:MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,q=j.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.REJECTED})[0],r=!!q&&!o,s=this.adapter.getIndexHandlerTime(l),t=l.playbackController.getTime(),u=q?q.startTime+q.duration:null,v=!o&&q&&(u>t&&q.startTime<=s||isNaN(s));if(f=o?n:v?q.startTime:s,q&&j.getFragmentModel().removeRejectedRequest(q),isNaN(f))return void d(new MediaPlayer.rules.SwitchRequest(null,p));for(a[i]&&(a[i][h]=null),e=this.sourceBufferExt.getBufferRange(l.bufferController.getBuffer(),f),null!==e&&(f=e.end),g=this.adapter.getFragmentRequestForTime(l,m,f,{keepIdx:r}),v&&g&&g.index!==q.index&&(g=this.adapter.getFragmentRequestForTime(l,m,q.startTime+q.duration/2+k,{keepIdx:r}));g&&l.getFragmentModel().isFragmentLoadedOrPending(g);){if("complete"===g.action){g=null,this.adapter.setIndexHandlerTime(l,0/0);break}g=this.adapter.getNextFragmentRequest(l,m)}g&&!v&&this.adapter.setIndexHandlerTime(l,Math.floor(g.startTime+g.duration)),d(new MediaPlayer.rules.SwitchRequest(g,p))},reset:function(){a={},b={}}}},MediaPlayer.rules.PlaybackTimeRule.prototype={constructor:MediaPlayer.rules.PlaybackTimeRule},MediaPlayer.rules.SameTimeRequestRule=function(){"use strict";var a=0,b={},c=function(a,b){var c,d,f,g,h,i=0,j=a.length;for(i;j>i;i+=1)for(f=a[i].getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING}),e.call(this,f,"index"),g=0,h=f.length;h>g;g++){if(c=f[g],isNaN(c.startTime)&&"complete"!==c.action){d=c;break}c.startTime>b&&(!d||c.startTime<d.startTime)&&(d=c)}return d||c},d=function(a,b){var c,d,e=a.length,f=null;for(d=0;e>d;d+=1)c=a[d].getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING,time:b})[0],c&&(!f||c.startTime>f.startTime)&&(f=c);return f},e=function(a,b){var c=function(a,c){return a[b]<c[b]||isNaN(a[b])&&"complete"!==a.action?-1:a[b]>c[b]?1:0};a.sort(c)},f=function(a,c){return b[a]&&b[a][c]?b[a][c]:0/0},g=function(a){var c=a.data.fragmentModel,d=a.data.request,e=c.getContext().streamProcessor.getStreamInfo().id,f=d.mediaType;b[e]=b[e]||{},b[e][f]=d.index-1};return{setup:function(){this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=g},setFragmentModels:function(a,b){this.fragmentModels=this.fragmentModels||{},this.fragmentModels[b]=a},execute:function(b,e){var g,h,i,j,k,l,m,n,o,p=b.getStreamInfo().id,q=b.getCurrentValue(),r=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,s=this.fragmentModels[p],t=new Date,u=null,v=s?s.length:null,w=!1,x=[];if(!s||!v)return void e(new MediaPlayer.rules.SwitchRequest([],r));if(l=s[0].getContext().playbackController.getTime(),m=d(s,l),k=m||c(s,l)||q,!k)return void e(new MediaPlayer.rules.SwitchRequest([],r));for(j=0;v>j;j+=1)if(h=s[j],g=h.getContext().streamProcessor.getType(),("video"===g||"audio"===g||"fragmentedText"===g)&&(n=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING}),o=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING}).length,!h.getIsPostponed()||isNaN(k.startTime))){if(o>a)return void e(new MediaPlayer.rules.SwitchRequest([],r));if(u=u||(k===m?l:k.startTime),-1===n.indexOf(k)){if(i=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING,time:u})[0],i||0!==k.index||(i=n.filter(function(a){return a.index===k.index})[0]),i)x.push(i);else if(i=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING,time:u})[0]||h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,time:u})[0],!i&&k.index!==f.call(this,p,k.mediaType)&&CL.configs.isLive===!1){w=!0;break}}else x.push(k)}return x=x.filter(function(a){return"complete"===a.action||t.getTime()>=a.availabilityStartTime.getTime()}),w?void e(new MediaPlayer.rules.SwitchRequest([],r)):void e(new MediaPlayer.rules.SwitchRequest(x,r))},reset:function(){b={}}}},MediaPlayer.rules.SameTimeRequestRule.prototype={constructor:MediaPlayer.rules.SameTimeRequestRule},MediaPlayer.rules.ScheduleRulesCollection=function(){"use strict";var a=[],b=[],c=[];return{bufferLevelRule:void 0,pendingRequestsRule:void 0,playbackTimeRule:void 0,sameTimeRequestRule:void 0,getRules:function(d){switch(d){case MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_SCHEDULE_RULES:return a;case MediaPlayer.rules.ScheduleRulesCollection.prototype.NEXT_FRAGMENT_RULES:return c;case MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_EXECUTE_RULES:return b;default:return null}},setup:function(){a.push(this.bufferLevelRule),a.push(this.pendingRequestsRule),c.push(this.playbackTimeRule),b.push(this.sameTimeRequestRule)}}},MediaPlayer.rules.ScheduleRulesCollection.prototype={constructor:MediaPlayer.rules.ScheduleRulesCollection,FRAGMENTS_TO_SCHEDULE_RULES:"fragmentsToScheduleRules",NEXT_FRAGMENT_RULES:"nextFragmentRules",FRAGMENTS_TO_EXECUTE_RULES:"fragmentsToExecuteRules"},MediaPlayer.rules.SwitchRequest=function(a,b){"use strict";this.value=a,this.priority=b,void 0===this.value&&(this.value=999),void 0===this.priority&&(this.priority=.5)},MediaPlayer.rules.SwitchRequest.prototype={constructor:MediaPlayer.rules.SwitchRequest,NO_CHANGE:999,DEFAULT:.5,STRONG:1,WEAK:0},MediaPlayer.rules.LiveEdgeBinarySearchRule=function(){"use strict";var a,b,c,d=43200,e=0/0,f=null,g=0/0,h=null,i=!1,j=0/0,k=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,l=function(a,d,e,f){var g,i=this;if(null===f)g=i.adapter.generateFragmentRequestForTime(c,h,a),l.call(i,a,d,e,g);else{var j=function(c){b.unsubscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,i,j),c.data.exists?d.call(i,c.data.request,a):e.call(i,c.data.request,a)};b.subscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,i,j),b.checkForExistence(f)}},m=function(b,d){var j,p,q;return i?void o.call(this,!1,d):(q=d-e,j=q>0?e-q:e+Math.abs(q)+g,void(j<f.start&&j>f.end?a(new MediaPlayer.rules.SwitchRequest(null,k)):(p=this.adapter.getFragmentRequestForTime(c,h,j),l.call(this,j,n,m,p))))},n=function(b,d){var m,n,p=b.startTime,q=this;if(!i){if(!h.fragmentDuration)return void a(new MediaPlayer.rules.SwitchRequest(p,k));if(i=!0,f.end=p+2*g,d===e)return n=d+j,m=q.adapter.getFragmentRequestForTime(c,h,n),void l.call(q,n,function(){o.call(q,!0,n)},function(){a(new MediaPlayer.rules.SwitchRequest(n,k))},m)}o.call(this,!0,d)},o=function(b,d){var e,g,i;b?f.start=d:f.end=d,e=Math.floor(f.end-f.start)<=j,e?a(new MediaPlayer.rules.SwitchRequest(b?d:d-j,k)):(i=(f.start+f.end)/2,g=this.adapter.getFragmentRequestForTime(c,h,i),l.call(this,i,n,m,g))};return{metricsExt:void 0,adapter:void 0,timelineConverter:void 0,execute:function(i,o){var p,q,r=this;if(a=o,c=i.getStreamProcessor(),b=c.getFragmentLoader(),h=i.getTrackInfo(),j=h.fragmentDuration,q=h.DVRWindow,e=q.end,h.useCalculatedLiveEdgeTime){var s=r.timelineConverter.getExpectedLiveEdge();return r.timelineConverter.setExpectedLiveEdge(e),void a(new MediaPlayer.rules.SwitchRequest(s,k))}f={start:Math.max(0,e-d),end:e+d},g=Math.floor((q.end-q.start)/2),p=r.adapter.getFragmentRequestForTime(c,h,e),l.call(r,e,n,m,p)},reset:function(){e=0/0,f=null,g=0/0,h=null,i=!1,j=0/0,c=null,b=null}}},MediaPlayer.rules.LiveEdgeBinarySearchRule.prototype={constructor:MediaPlayer.rules.LiveEdgeBinarySearchRule},MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule=function(){"use strict";return{execute:function(a,b){b(new MediaPlayer.rules.SwitchRequest(a.getTrackInfo().DVRWindow.end,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT))}}},MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule.prototype={constructor:MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule},MediaPlayer.rules.SynchronizationRulesCollection=function(){"use strict";var a=[],b=[];return{liveEdgeBinarySearchRule:void 0,liveEdgeWithTimeSynchronizationRule:void 0,getRules:function(c){switch(c){case MediaPlayer.rules.SynchronizationRulesCollection.prototype.TIME_SYNCHRONIZED_RULES:return a;case MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES:return b;default:return null}},setup:function(){a.push(this.liveEdgeWithTimeSynchronizationRule),b.push(this.liveEdgeBinarySearchRule)}}},MediaPlayer.rules.SynchronizationRulesCollection.prototype={constructor:MediaPlayer.rules.SynchronizationRulesCollection,TIME_SYNCHRONIZED_RULES:"withAccurateTimeSourceRules",BEST_GUESS_RULES:"bestGuestRules"},MediaPlayer.utils.Capabilities=function(){"use strict"},MediaPlayer.utils.Capabilities.prototype={constructor:MediaPlayer.utils.Capabilities,system:void 0,log:void 0,supportsMediaSource:function(){"use strict";var a="WebKitMediaSource"in window,b="MediaSource"in window;return a||b},supportsEncryptedMedia:function(){return this.system.hasMapping("protectionModel")},supportsCodec:function(a,b){"use strict";if(!(a instanceof HTMLMediaElement))throw"element must be of type HTMLMediaElement.";var c=a.canPlayType(b);return(b.indexOf("vtt")>-1||b.indexOf("ttml")>-1)&&(c="probably"),"probably"===c||"maybe"===c}},MediaPlayer.utils.CustomTimeRanges=function(){return{customTimeRangeArray:[],length:0,add:function(a,b){var c=0;for(c=0;c<this.customTimeRangeArray.length&&a>this.customTimeRangeArray[c].start;c++);for(this.customTimeRangeArray.splice(c,0,{start:a,end:b}),c=0;c<this.customTimeRangeArray.length-1;c++)this.mergeRanges(c,c+1)&&c--;this.length=this.customTimeRangeArray.length},remove:function(a,b){for(var c=0;c<this.customTimeRangeArray.length;c++)if(a<=this.customTimeRangeArray[c].start&&b>=this.customTimeRangeArray[c].end)this.customTimeRangeArray.splice(c,1),c--;else{if(a>this.customTimeRangeArray[c].start&&b<this.customTimeRangeArray[c].end){this.customTimeRangeArray.splice(c+1,0,{start:b,end:this.customTimeRangeArray[c].end}),this.customTimeRangeArray[c].end=a;break}a>this.customTimeRangeArray[c].start&&a<this.customTimeRangeArray[c].end?this.customTimeRangeArray[c].end=a:b>this.customTimeRangeArray[c].start&&b<this.customTimeRangeArray[c].end&&(this.customTimeRangeArray[c].end=a)}},mergeRanges:function(a,b){var c=this.customTimeRangeArray[a],d=this.customTimeRangeArray[b];return c.start<=d.start&&d.start<=c.end&&c.end<=d.end?(c.end=d.end,this.customTimeRangeArray.splice(b,1),!0):d.start<=c.start&&c.start<=d.end&&d.end<=c.end?(c.start=d.start,this.customTimeRangeArray.splice(b,1),!0):d.start<=c.start&&c.start<=d.end&&c.end<=d.end?(this.customTimeRangeArray.splice(a,1),!0):c.start<=d.start&&d.start<=c.end&&d.end<=c.end?(this.customTimeRangeArray.splice(b,1),!0):!1},start:function(a){return this.customTimeRangeArray[a].start},end:function(a){return this.customTimeRangeArray[a].end}}},MediaPlayer.utils.CustomTimeRanges.prototype={constructor:MediaPlayer.utils.CustomTimeRanges},MediaPlayer.utils.DOMStorage=function(){var a=!0,b=function(){["video","audio"].forEach(function(b){if(void 0===this.abrController.getInitialBitrateFor(b)){if(this.isSupported(MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL)&&a){var c=MediaPlayer.utils.DOMStorage["LOCAL_STORAGE_"+b.toUpperCase()+"_BITRATE_KEY"],d=JSON.parse(localStorage.getItem(c))||{},e=(new Date).getTime()-parseInt(d.timestamp)>=MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_BITRATE_EXPIRATION||!1,f=parseInt(d.bitrate);isNaN(f)||e?e&&localStorage.removeItem(c):(this.abrController.setInitialBitrateFor(b,f),this.log("Last bitrate played for "+b+" was "+f))}void 0===this.abrController.getInitialBitrateFor(b)&&this.abrController.setInitialBitrateFor(b,MediaPlayer.dependencies.AbrController["DEFAULT_"+b.toUpperCase()+"_BITRATE"])}},this)};return{system:void 0,log:void 0,abrController:void 0,checkInitialBitrate:b,enableLastBitrateCaching:function(b,c){a=b,void 0===c||isNaN(c)||"number"!=typeof c||(MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_BITRATE_EXPIRATION=c)},isSupported:function(a){return a===MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL?window.localStorage||!1:a===MediaPlayer.utils.DOMStorage.STORAGE_TYPE_SESSION?window.sessionStorage||!1:!1}}},MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_VIDEO_BITRATE_KEY="dashjs_vbitrate",MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_AUDIO_BITRATE_KEY="dashjs_abitrate",MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_BITRATE_EXPIRATION=36e4,MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL="local",MediaPlayer.utils.DOMStorage.STORAGE_TYPE_SESSION="session",MediaPlayer.utils.DOMStorage.prototype={constructor:MediaPlayer.utils.DOMStorage},MediaPlayer.utils.Debug=function(){"use strict";var a,b=!0,c=!1,d=!1,e=(new Date).getTime();return{system:void 0,eventBus:void 0,setup:function(){this.system.mapValue("log",this.log),a=this.eventBus},setLogTimestampVisible:function(a){c=a},showCalleeName:function(a){d=a},setLogToBrowserConsole:function(a){b=a},getLogToBrowserConsole:function(){return b},log:function(){var f="",g=null;c&&(g=(new Date).getTime(),f+="["+(g-e)+"]"),d&&this.getName&&(f+="["+this.getName()+"]"),this.getMediaType&&this.getMediaType()&&(f+="["+this.getMediaType()+"]"),f.length>0&&(f+=" "),Array.apply(null,arguments).forEach(function(a){f+=a+" "}),b&&console.log(f),a.dispatchEvent({type:"log",message:f})}}},MediaPlayer.utils.EventBus=function(){"use strict";var a,b=function(b,c){var d=(c?"1":"0")+b;return d in a||(a[d]=[]),a[d]},c=function(){a={}};return c(),{addEventListener:function(a,c,d){var e=b(a,d),f=e.indexOf(c);-1===f&&e.push(c)},removeEventListener:function(a,c,d){var e=b(a,d),f=e.indexOf(c);-1!==f&&e.splice(f,1)},dispatchEvent:function(a){for(var c=b(a.type,!1).slice(),d=0;d<c.length;d++)c[d].call(this,a);return!a.defaultPrevented}}},MediaPlayer.vo.BitrateInfo=function(){"use strict";this.mediaType=null,this.bitrate=null,this.qualityIndex=0/0},MediaPlayer.vo.BitrateInfo.prototype={constructor:MediaPlayer.vo.BitrateInfo},MediaPlayer.vo.Error=function(a,b,c){"use strict";this.code=a||null,this.message=b||null,this.data=c||null},MediaPlayer.vo.Error.prototype={constructor:MediaPlayer.vo.Error},MediaPlayer.vo.Event=function(){"use strict";this.type=null,this.sender=null,this.data=null,this.error=null,this.timestamp=0/0},MediaPlayer.vo.Event.prototype={constructor:MediaPlayer.vo.Event},MediaPlayer.vo.FragmentRequest=function(){"use strict";this.action="download",this.startTime=0/0,this.mediaType=null,this.type=null,this.duration=0/0,this.timescale=0/0,this.range=null,this.url=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=0/0,this.index=0/0,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null},MediaPlayer.vo.FragmentRequest.prototype={constructor:MediaPlayer.vo.FragmentRequest,ACTION_DOWNLOAD:"download",ACTION_COMPLETE:"complete"},MediaPlayer.vo.ManifestInfo=function(){"use strict";this.DVRWindowSize=0/0,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=0/0,this.duration=0/0,this.isDynamic=!1,this.maxFragmentDuration=null},MediaPlayer.vo.ManifestInfo.prototype={constructor:MediaPlayer.vo.ManifestInfo},MediaPlayer.vo.MediaInfo=function(){"use strict";this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.trackCount=0,this.lang=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null},MediaPlayer.vo.MediaInfo.prototype={constructor:MediaPlayer.vo.MediaInfo},MediaPlayer.models.MetricsList=function(){"use strict";return{TcpList:[],HttpList:[],RepSwitchList:[],BufferLevel:[],BufferState:[],PlayList:[],DroppedFrames:[],SchedulingInfo:[],DVRInfo:[],ManifestUpdate:[]}},MediaPlayer.models.MetricsList.prototype={constructor:MediaPlayer.models.MetricsList},MediaPlayer.vo.StreamInfo=function(){"use strict";this.id=null,this.index=null,this.start=0/0,this.duration=0/0,this.manifestInfo=null,this.isLast=!0},MediaPlayer.vo.StreamInfo.prototype={constructor:MediaPlayer.vo.StreamInfo},MediaPlayer.vo.TrackInfo=function(){"use strict";this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},MediaPlayer.vo.TrackInfo.prototype={constructor:MediaPlayer.vo.TrackInfo},MediaPlayer.vo.URIFragmentData=function(){"use strict";this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null},MediaPlayer.vo.URIFragmentData.prototype={constructor:MediaPlayer.vo.URIFragmentData},MediaPlayer.vo.metrics.BufferLevel=function(){"use strict";this.t=null,this.level=null},MediaPlayer.vo.metrics.BufferLevel.prototype={constructor:MediaPlayer.vo.metrics.BufferLevel},MediaPlayer.vo.metrics.BufferState=function(){"use strict";this.target=null,this.state=MediaPlayer.dependencies.BufferController.BUFFER_EMPTY},MediaPlayer.vo.metrics.BufferState.prototype={constructor:MediaPlayer.vo.metrics.BufferState},MediaPlayer.vo.metrics.DVRInfo=function(){"use strict";this.time=null,this.range=null,this.manifestInfo=null},MediaPlayer.vo.metrics.DVRInfo.prototype={constructor:MediaPlayer.vo.metrics.DVRInfo},MediaPlayer.vo.metrics.DroppedFrames=function(){"use strict";this.time=null,this.droppedFrames=null},MediaPlayer.vo.metrics.DroppedFrames.prototype={constructor:MediaPlayer.vo.metrics.DroppedFrames},MediaPlayer.vo.metrics.HTTPRequest=function(){"use strict";this.stream=null,this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.tfinish=null,this.responsecode=null,this.interval=null,this.mediaduration=null,this.responseHeaders=null,this.trace=[]},MediaPlayer.vo.metrics.HTTPRequest.prototype={constructor:MediaPlayer.vo.metrics.HTTPRequest},MediaPlayer.vo.metrics.HTTPRequest.Trace=function(){"use strict";this.s=null,this.d=null,this.b=[]},MediaPlayer.vo.metrics.HTTPRequest.Trace.prototype={constructor:MediaPlayer.vo.metrics.HTTPRequest.Trace},MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE="Media Segment",MediaPlayer.vo.metrics.HTTPRequest.MPD_TYPE="MPD",MediaPlayer.vo.metrics.ManifestUpdate=function(){"use strict";this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.trackInfo=[]},MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo=function(){"use strict";this.id=null,this.index=null,this.start=null,this.duration=null},MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo=function(){"use strict";this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null},MediaPlayer.vo.metrics.ManifestUpdate.prototype={constructor:MediaPlayer.vo.metrics.ManifestUpdate},MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo.prototype={constructor:MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo},MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo.prototype={constructor:MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo},MediaPlayer.vo.metrics.PlayList=function(){"use strict";this.stream=null,this.start=null,this.mstart=null,this.starttype=null,this.trace=[]},MediaPlayer.vo.metrics.PlayList.Trace=function(){"use strict";this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null},MediaPlayer.vo.metrics.PlayList.prototype={constructor:MediaPlayer.vo.metrics.PlayList},MediaPlayer.vo.metrics.PlayList.INITIAL_PLAY_START_REASON="initial_start",MediaPlayer.vo.metrics.PlayList.SEEK_START_REASON="seek",MediaPlayer.vo.metrics.PlayList.Trace.prototype={constructor:MediaPlayer.vo.metrics.PlayList.Trace()},MediaPlayer.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON="user_request",MediaPlayer.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",MediaPlayer.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON="end_of_content",MediaPlayer.vo.metrics.PlayList.Trace.REBUFFERING_REASON="rebuffering",MediaPlayer.vo.metrics.TrackSwitch=function(){"use strict";this.t=null,this.mt=null,this.to=null,this.lto=null},MediaPlayer.vo.metrics.TrackSwitch.prototype={constructor:MediaPlayer.vo.metrics.TrackSwitch},MediaPlayer.vo.metrics.SchedulingInfo=function(){"use strict";this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},MediaPlayer.vo.metrics.SchedulingInfo.prototype={constructor:MediaPlayer.vo.metrics.SchedulingInfo},MediaPlayer.vo.metrics.TCPConnection=function(){"use strict";this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null},MediaPlayer.vo.metrics.TCPConnection.prototype={constructor:MediaPlayer.vo.metrics.TCPConnection},MediaPlayer.vo.protection.ClearKeyKeySet=function(a,b){if(b&&"persistent"!==b&&"temporary"!==b)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=a,this.type=b,this.toJWK=function(){var a,b=this.keyPairs.length,c={};for(c.keys=[],a=0;b>a;a++){var d={kty:"oct",alg:"A128KW",kid:this.keyPairs[a].keyID,k:this.keyPairs[a].key};c.keys.push(d)}this.type&&(c.type=this.type);var e=JSON.stringify(c),f=e.length,g=new ArrayBuffer(f),h=new Uint8Array(g);for(a=0;f>a;a++)h[a]=e.charCodeAt(a);return g}},MediaPlayer.vo.protection.ClearKeyKeySet.prototype={constructor:MediaPlayer.vo.protection.ClearKeyKeySet},MediaPlayer.vo.protection.KeyError=function(a,b){"use strict";this.sessionToken=a,this.error=b},MediaPlayer.vo.protection.KeyError.prototype={constructor:MediaPlayer.vo.protection.KeyError},MediaPlayer.vo.protection.KeyMessage=function(a,b,c,d){"use strict";this.sessionToken=a,this.message=b,this.defaultURL=c,this.messageType=d},MediaPlayer.vo.protection.KeyMessage.prototype={constructor:MediaPlayer.vo.protection.KeyMessage},MediaPlayer.vo.protection.KeyPair=function(a,b){"use strict";if(!a||16!==a.length)throw new Error("Illegal key ID length! Must be 16 bytes (128 bits)");if(!b||16!==b.length)throw new Error("Illegal key length! Must be 16 bytes (128 bits)");this.keyID=a,this.key=b},MediaPlayer.vo.protection.KeyPair.prototype={constructor:MediaPlayer.vo.protection.KeyPair},MediaPlayer.vo.protection.KeySystemAccess=function(a,b){this.keySystem=a,this.ksConfiguration=b},MediaPlayer.vo.protection.KeySystemAccess.prototype={constructor:MediaPlayer.vo.protection.KeySystemAccess},MediaPlayer.vo.protection.KeySystemConfiguration=function(a,b,c,d){this.initDataTypes=["cenc"],this.audioCapabilities=a,this.videoCapabilities=b,this.distinctiveIdentifier=c,this.persistentState=d},MediaPlayer.vo.protection.KeySystemConfiguration.prototype={constructor:MediaPlayer.vo.protection.KeySystemConfiguration},MediaPlayer.vo.protection.LicenseRequestComplete=function(a,b){"use strict";this.message=a,this.requestData=b},MediaPlayer.vo.protection.LicenseRequestComplete.prototype={constructor:MediaPlayer.vo.protection.LicenseRequestComplete},MediaPlayer.vo.protection.MediaCapability=function(a,b){this.contentType=a,this.robustness=b},MediaPlayer.vo.protection.MediaCapability.prototype={constructor:MediaPlayer.vo.protection.MediaCapability},MediaPlayer.vo.protection.NeedKey=function(a,b){this.initData=a,this.initDataType=b},MediaPlayer.vo.protection.NeedKey.prototype={constructor:MediaPlayer.vo.protection.NeedKey},MediaPlayer.vo.protection.ProtectionData=function(a,b,c,d){this.laURL=a,this.httpRequestHeaders=b,this.bearerToken=c,this.clearkeys=d},MediaPlayer.vo.protection.ProtectionData.prototype={constructor:MediaPlayer.vo.protection.ProtectionData},MediaPlayer.models.SessionToken=function(){"use strict"},MediaPlayer.models.SessionToken.prototype={initData:null,getSessionID:function(){return""},getExpirationTime:function(){return 0/0},getKeyStatuses:function(){return null}};var CL;if(!window.castLabs)var castLabs={};Number.prototype.round=function(a){return+(Math.round(this+"e+"+a)+"e-"+a)},castLabsDashJS=function(){"use strict";castLabs={},CL=window.CL||{},CL.configs={ua:navigator.userAgent.toLowerCase(),debug:!1,minBufferTime:1e3,validateInterval:5e3,bufferingValidateInterval:500,mergeSegmentsThreshold:5e3,switchBitratesWaitTime:5e3,useEME2:!0,isIE10:!1,isIE11:!1,isChromeDesktop:!1,isChromeAndroid:!1,isChromecast:!1,isSafari:!1,isSafari9:!1,isFirefox:!1,isOpera:!1,isOperaEME:!1,isActiveVideoChrome:!1,isWindows:!1,isPlatformSupported:!1,element:null,isSmoothStreaming:!1,ssTimeOffset:{video:0,audio:0,text:0},ssTimeOffsetMedia:{video:0,audio:0,text:0},ssTimeOffsetTimescale:{video:1,audio:1,text:1},codecPrivateData:{},firstIndex:{audio:!0,video:!0},adjustLiveEdge:!0,audioInitData:{},repHeight:{},repWidth:{},timescale:{},customAttributes:{},isProtected:!1,audioTracks:[],activeAudioTrack:null,textTracks:[],activeTextTrack:null,previousActiveTrack:{text:null,audio:null,video:null},activeTrack:{text:null,audio:null,video:null},tracks:{text:[],audio:[],video:[]},subtitlesOff:!1,activePlayer:null,minStartTime:null,initialStartTime:null,minStartTimeSeekInProgress:!1,keyRequests:[],isLive:!1,lookAheadFragments:{audio:[],video:[],text:[]},needManifestUpdate:!1,sourceCleaningInProgress:0,manifestTimeOffset:0,limitRepresentation:!1,lowerRepresentation:!1,maxIndex:-1,droppedFramesCountOffset:0,lastAppendedSegment:{audio:{},video:{}},wasLive:!1,bufferGap:0,useBigInt:!1,bigIntOffset:0},CL.manifest={drm:"auto",debug:!1,key:null,keyId:null,customData:{userId:null,sessionId:null,merchant:null},assetId:null,variantId:null,authenticationToken:null,sendCustomData:!0,playReadyLicenseServerURL:null,widevineLicenseServerURL:null,accessLicenseServerURL:null,generatePSSH:!1,parseMoofFragments:!1,enableSmoothStreamingCompatibility:!1,ignoreManifestBufferSettings:!1,isSmoothStreaming:!1,useLookAheadFragments:!1,useUniversalSubtitleEngine:!0,fixAudioCodec:!1,fixVideoCodec:!1,widevineHeader:{provider:null,contentId:null,trackType:null,policy:null},playreadyHeader:{laUrl:"http://example.com/RightsManager.asmx",luiUrl:"http://example.com"},autoplay:!1,loop:!1,controls:!0,ABRParameters:{qualitySwitchThreshold:2e3,bandwidthSafetyFactor:1.5,minBufferLength:15,maxBufferLength:25,liveDelay:8,disableBufferOccupancyRule:!1,droppedFrameThreshold:0,limitThroughputRule:!1},licenseRequestTimeout:0,manifestRequestTimeout:0,fragmentRequestTimeout:0,disableChromecastSupport:!1,disableDASHJSOnIE11:!1,pictureSize:"normal",customHeaders:{manifestRequest:{},licenseRequest:{},fragmentRequest:{}},calculateTimeShiftBufferDepth:!1,relativeDVRWindowPlaybackPosition:-1,useNativeSilverlightControls:!1,isUnprotected:!1,enableHTML5OnFirefox:!1,enableHTML5OnSafari:!1,initialSeekTime:null,robustnessLevel:null};try{CL.defaultConfigs=JSON?JSON.parse(JSON.stringify(CL.configs)):null,CL.defaultManifest=JSON?JSON.parse(JSON.stringify(CL.manifest)):null}catch(a){}return{classes:{}}}();try{window.self={}}catch(e){}var initChromecastReceiver=function(){var a="urn:x-cast:com.castlabs.chromecast";if(CL.manifest.useUniversalSubtitleEngine=!1,window.self.video=document.querySelector("video"),void 0==window.mediaManager){window.mediaManager=new cast.receiver.MediaManager(window.self.video),window.castReceiverManager=cast.receiver.CastReceiverManager.getInstance(),CL.configs.debug&&console.log("Initializing Chromecast receiver app..."),window.castReceiverManager.onReady=function(){CL.configs.debug&&console.log("window.castReceiverManager is ready.")},window.castReceiverManager.onSenderConnected=function(){CL.configs.debug&&console.log("Sender has connected.")},window.castReceiverManager.onSenderDisconnected=function(a){CL.configs.debug&&console.log("Sender has disconnected.");var b=window.castReceiverManager.getSenders();0===b.length&&a.reason==cast.receiver.system.DisconnectReason.REQUESTED_BY_SENDER&&window.close()},window.castReceiverManager.onShutdown=function(){for(var a,b=window.castReceiverManager.getSenders(),c=0;c<b.length;c++)a=b[c],console.log("Connected sender: "+a);CL.configs.debug&&console.log("Application has shutdown.")},window.castReceiverManager.onSystemVolumeChanged=function(){CL.configs.debug&&console.log("System volume has changed.")},window.castReceiverManager.onVisibilityChanged=function(){CL.configs.debug&&console.log("Visibility has changed.")},window.messageBus=castReceiverManager.getCastMessageBus(a,cast.receiver.CastMessageBus.MessageType.JSON),window.messageBus.onMessage=function(a){var b=(a.senderId,a.data),c=b.command;switch(c){case"setActiveTrack":"audio"===b.type&&CL.configs.activeTrack.audio.id!=b.id&&window.self.player.setActiveTrack("audio",b.id),"text"===b.type&&window.self.player.setActiveTrack("text",b.id);break;case"enableSubtitles":window.self.player.enableSubtitles(!0);break;case"disableSubtitles":window.self.player.enableSubtitles(!1)}};var b=function(a){return a.currentTime=window.self.currentTime,a.customData={duration:window.self.duration,audioTracks:window.self.audioTracks,textTracks:window.self.textTracks},void 0!=a.media&&(a.media.duration=window.self.duration),(null==a.idleReason||"ERROR"==a.idleReason)&&(a.idleReason=cast.receiver.media.IdleReason.CANCELLED),a.playerState==cast.receiver.media.PlayerState.BUFFERING&&4==window.self.video.readyState&&1==window.self.video.playbackRate&&(a.playerState=cast.receiver.media.PlayerState.PLAYING),a};window.mediaManager.customizedStatusCallback=b;var c=(new Date).getTime();onVideoStateChange=function(a){window.self.currentTime=window.self.video.currentTime,window.self.duration=window.self.video.duration,CL.configs.isChromecast&&("ended"==a&&CL.manifest.loop===!0&&setTimeout(window.self.loadVideo(CL.manifest.url),5e3),now=(new Date).getTime(),now-c>500&&(c=now,window.mediaManager.broadcastStatus(!0)))},window.mediaManager.onStopOrig=window.mediaManager.onStop,window.mediaManager.onStop=function(a){window.self.player.reset(),window.mediaManager.onStopOrig(a)},window.mediaManager.onLoadOrig=window.mediaManager.onLoad,window.mediaManager.onLoad=function(a){if(void 0!=window.self.firstPlayback&&window.self.firstPlayback===!1){if(CL.configs=JSON.parse(JSON.stringify(CL.defaultConfigs)),CL.manifest=JSON.parse(JSON.stringify(CL.defaultManifest)),window.self.player&&window.self.player.pause){try{window.self.player.pause()}catch(b){}if(window.self.player.removeEventListener)try{window.self.player.removeEventListener(),window.self.player.reset()
}catch(b){}}}else CL.defaultConfigs=JSON?JSON.parse(JSON.stringify(CL.configs)):null,CL.defaultManifest=JSON?JSON.parse(JSON.stringify(CL.manifest)):null;try{var c=void 0===window.self.video.setMediaKeys,d=function(){window.self.video.removeEventListener("timeupdate",onVideoStateChange),window.self.video.removeEventListener("durationchange",onVideoStateChange),window.self.video.removeEventListener("ended",onVideoStateChange),window.self.video.removeEventListener("pause",onVideoStateChange),window.self.video.removeEventListener("play",onVideoStateChange),window.self.video.removeEventListener("ratechange",onVideoStateChange),(window.self.firstPlayback===!0||c)&&(window.self.player=new MediaPlayer(new castLabsDashJS.classes.DRMtodayContext(window.config))),window.self.video=document.querySelector("video"),window.mediaManager.setMediaElement(window.self.video),window.self.video.addEventListener("timeupdate",onVideoStateChange.bind(this,"timeupdate")),window.self.video.addEventListener("durationchange",onVideoStateChange.bind(this,"durationchange")),window.self.video.addEventListener("ended",onVideoStateChange.bind(this,"ended")),window.self.video.addEventListener("pause",onVideoStateChange.bind(this,"pause")),window.self.video.addEventListener("play",onVideoStateChange.bind(this,"play")),window.self.video.addEventListener("ratechange",onVideoStateChange.bind(this,"ratechange")),MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY=15,CL.configs.event=a;var b=a.data.media.contentId;window.self.player.manifestUrl=b;var d={};(void 0===CL.manifest.drm||null===CL.manifest.drm||"auto"===CL.manifest.drm||""===CL.manifest.drm)&&(d.drm="com.widevine.alpha"),d.debug=!1,d.autoplay=!0,d.customData={userId:a.data.media.customData.userId,sessionId:a.data.media.customData.sessionId,merchant:a.data.media.customData.merchant},void 0!==a.data.media.customData.authenticationToken&&(d.authenticationToken=a.data.media.customData.authenticationToken),d.useUniversalSubtitleEngine=!1,window.self.player.setConfig(d),cast.receiver.logger.setLevelValue(CL.configs.debug?cast.receiver.LoggerLevel.DEBUG:cast.receiver.LoggerLevel.NONE);var e=a.data.currentTime;void 0===e||null===e||isNaN(parseInt(e))||(CL.configs.initialStartTime=parseInt(e)),window.self.player.loadVideo(b),window.self.firstPlayback=!1,window.mediaManager.onLoadOrig(a)};c===!1?(CL.configs.sourceCleaningInProgress=(new Date).getTime(),window.self.video.src="",window.self.video.setMediaKeys?window.self.video.setMediaKeys(null).then(function(){d()},function(){d()}):d()):d()}catch(b){}},window.mediaManager.customizedStatusCallback=b,MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY=15,window.castReceiverManager.start(),CL.configs.debug&&console.log("Done initializing Chromecast receiver");var d=new Event("chromecastReady");window.dispatchEvent(d)}},loadScript=function(a,b,c){var d=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src=a,e.onreadystatechange=b,e.onload=function(){b.call(c)},d.appendChild(e)};castLabsDashJS.classes.DRMtodayContext=function(a){"use strict";return{config:a,system:void 0,setup:function(){castLabsDashJS.classes.DRMtodayContext.prototype.setup.call(this),this.system.mapSingleton("clUtils",castLabsDashJS.classes.Utils),this.system.mapSingleton("parser",castLabsDashJS.classes.SmoothParser);var a=navigator.userAgent.toLowerCase(),b=navigator.platform.toLowerCase();CL.configs.useEME2=!1,CL.configs.isChromecast=!1,CL.configs.isChromeAndroid=!1,CL.configs.isChromeDesktop=!1,CL.configs.isIE10=!1,CL.configs.isIE11=!1,CL.configs.isPlatformSupported=!1,CL.configs.debug&&console.log(a);var c=!1;if(a.indexOf("chrome")>-1&&a.indexOf("crkey")>-1&&b.indexOf("linux armv7l")>-1)CL.configs.isChromecast=!0,CL.configs.useEME2=!1,c=!0,CL.configs.debug=!1;else if(a.indexOf("chrome")>-1&&a.indexOf("android")>-1&&b.indexOf("linux armv7l")>-1)CL.configs.isChromeAndroid=!0,CL.configs.useEME2=!1,c=!0;else if(a.indexOf("opr/")>-1&&(a.indexOf("macintosh")>-1||a.indexOf("windows")>-1||a.indexOf("linux")>-1)){var d=new RegExp(/opr\/\d\d/gi),e=d.exec(a),f=30;if(null==e);else try{f=parseInt(e[0].replace("opr/",""))}catch(g){}f>=31?(CL.configs.isOperaEME=!0,c=!0):(CL.configs.isOpera=!0,c=!1)}else-1==a.indexOf("edge")&&a.indexOf("chrome")>-1&&(a.indexOf("macintosh")>-1||a.indexOf("windows")>-1||a.indexOf("linux")>-1||a.indexOf("cros"))?(CL.configs.isChromeDesktop=!0,CL.configs.useEME2=!1,c=!0):a.indexOf("trident")>-1&&a.indexOf("rv:11")>-1&&(a.indexOf("windows nt 6.3")>-1||a.indexOf("windows nt 10.0")>-1)?(CL.configs.isIE11=!0,CL.configs.useEME2=!0,c=!0):a.indexOf("edge")>-1&&a.indexOf("windows nt 10")>-1?(CL.configs.isIE11=!0,CL.configs.useEME2=!0,CL.configs.isWindows=!0,c=!0):a.indexOf("trident")>-1&&(a.indexOf("trident/6.0")>-1&&a.indexOf("windows nt 6.1")>-1||a.indexOf("msie 10.0")>-1)?(CL.configs.isIE10=!0,CL.configs.isWindows=!0):a.indexOf("applewebkit")>-1&&a.indexOf("version")>-1&&a.indexOf("mac os x")>-1&&(CL.configs.isSafari=!0,a.indexOf("version/9")>-1?(CL.configs.isSafari9=!0,c=!0):c=!1);CL.configs.isPlatformSupported=!0}}},castLabsDashJS.classes.DRMtodayContext.prototype=new Dash.di.DashContext,castLabsDashJS.classes.DRMtodayContext.prototype.constructor=castLabsDashJS.classes.DRMtodayContext,castLabsDashJS.classes.ParsableBitArray=function(){var a,b,c,d,e=function(e){a=e,b=0,c=0,d=e.length},f=function(a){b+=a/8,c+=a%8,c>7&&(b++,c-=8),l()},g=function(){return 1==h(1)},h=function(d){if(0==d)return 0;for(var e=0,f=Math.floor(d/8),g=0;f>g;g++){var h;h=0!=c?(255&a[b])<<c|(255&a[b+1])>>>8-c:a[b],d-=8,e|=(255&h)<<d,b++}if(d>0){var i=c+d,j=255>>8-d;i>8?(e|=((255&a[b])<<i-8|(255&a[b+1])>>16-i)&j,b++):(e|=(255&a[b])>>8-i&j,8==i&&b++),c=i%8}return l(),e},i=function(){return k()},j=function(){var a=k();return(a%2==0?-1:1)*((a+1)/2)},k=function(){for(var a=0;!g();)a++;return(1<<a)-1+(a>0?h(a):0)},l=function(){};return{init:e,readBit:g,readBits:h,skipBits:f,readUnsignedExpGolombCodedInt:i,readSignedExpGolombCodedInt:j}},castLabsDashJS.classes.SmoothParser=function(){"use strict";var a,b=function(a){this.system=a,this.utils=this.system.getObject("clUtils")},c=function(b,c){if(a=new Dash.dependencies.DashParser,a.log=this.log,a.errHandler=this.errHandler,a.debug=this.debug,CL.configs.isSmoothStreaming===!0){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=31536e3,J=2592e3,K=86400,L=3600,M=60,N=60,O=1e3,P=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)+/,Q=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,R=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,S=[{type:"duration",test:function(a){return P.test(a)},converter:function(a){var b=P.exec(a);return parseFloat(b[2]||0)*I+parseFloat(b[4]||0)*J+parseFloat(b[6]||0)*K+parseFloat(b[8]||0)*L+parseFloat(b[10]||0)*M+parseFloat(b[12]||0)}},{type:"datetime",test:function(a){return Q.test(a)},converter:function(a){var b,c=Q.exec(a);if(b=Date.UTC(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),c[6]&&parseInt(c[6],10)||0,c[7]&&parseFloat(c[7])*O||0),c[9]&&c[10]){var d=parseInt(c[9],10)*N+parseInt(c[10],10);b+=("+"===c[8]?-1:1)*d*M*O}return new Date(b)}},{type:"numeric",test:function(a){return R.test(a)},converter:function(a){return parseFloat(a)}}],T=function(a){var b="",c=parseInt(a/3600)%24,d=parseInt(a/60)%60,e=(a%60).toFixed(4);return b="PT"+(c>0?c+"H":"")+(d>0?d+"M":"")+(e>0?e+"S":"")},U=new X2JS(S,"",!0),V=!1,W=0,X=0,Y=!1;U=new X2JS;try{if(this.debug.log("Converting from Smooth->DASH"),d=U.xml_str2json(b),d=d.SmoothStreamingMedia,this.utils.processJSON(d),B=void 0!==d.TimeScale?d.TimeScale:void 0!==d.Timescale?d.Timescale:null,null===B&&(B=1e7),y=T(d.Duration/B),void 0!==d.IsLive&&"true"==d.IsLive.toLowerCase()?(Y=!0,CL.configs.isLive=!0,CL.configs.wasLive=!0,void 0===d.DVRWindowLength&&(d.DVRWindowLength=1e8),H=T(d.DVRWindowLength/B)):CL.configs.isLive=!1,x=Y?"PT8S":"PT2S",D=d.LookAheadFragmentCount,(void 0!=d.Protection&&void 0!=d.Protection.ProtectionHeader||1==CL.manifest.generatePSSH)&&(CL.configs.isProtected=!0,CL.manifest.generatePSSH=!0,V=!0,void 0!=d.Protection&&void 0!=d.Protection.ProtectionHeader?(F=this.utils.arrayToString(this.utils.removeZeros(this.utils.base64DecToArr(d.Protection.ProtectionHeader.text))),E=F.substring(F.toLowerCase().indexOf("<kid>")+5,F.toLowerCase().indexOf("</kid>")),E=this.utils.toMsGuid(this.utils.byteArrayToHexString(this.utils.base64DecToArr(E))),null==CL.manifest.keyId?CL.manifest.keyId=E:E=CL.manifest.keyId):E=CL.manifest.keyId,CL.manifest.widevineHeader.contentId&&null!=CL.manifest.widevineHeader.contentId&&""!=CL.manifest.widevineHeader.contentId||(CL.manifest.widevineHeader.contentId=this.utils.hexStringToBase64(E.replace(/-/g,""))),void 0==E||null==E||""==E))throw"Could not find content protection data for this Smooth Content. Please check your configuration.";if(f={MPD:{_profiles:"urn:mpeg:dash:profile:isoff-on-demand:2011",_type:Y?"dynamic":"static",_minBufferTime:x,_mediaPresentationDuration:y,_xmlns:"urn:mpeg:dash:schema:mpd:2011","_xmlns:cenc":"urn:mpeg:cenc:2013",ProgramInformation:{_moreInformationURL:"www.castLabs.com"},Period:{_id:0,_start:"PT0S",_duration:y},_lookAheadFragmentCount:D}},Y===!0&&(f.MPD._profiles="urn:mpeg:dash:profile:isoff-live:2011",f.MPD._type="dynamic",f.MPD._timeShiftBufferDepth=H),r=[],!Array.isArray(d.StreamIndex)){var Z=d.StreamIndex;d.StreamIndex=[],d.StreamIndex[0]=Z}var $=[],_=0;if("video"===d.StreamIndex[d.StreamIndex.length-1].Type)for(var ab=d.StreamIndex.length-1;ab>=0;ab--)$[_]=d.StreamIndex[ab],_++;else for(var ab=0;ab<d.StreamIndex.length;ab++)$[_]=d.StreamIndex[ab],_++;A=[],C=[];for(var ab=0;ab<d.StreamIndex.length;ab++){if(g=$[ab],n=[],!Array.isArray(g.QualityLevel)){var Z=g.QualityLevel;g.QualityLevel=[],g.QualityLevel[0]=Z}if(t=0,u=0,q={_segmentAlignment:"true",_maxFrameRate:25,_par:"16:9"},q._lang=g.Language,h=g.Type,"subtitle"===h&&(h="text"),q._id=h+"_"+ab,C[q._id]=void 0!==g.TimeScale?g.TimeScale:void 0!==d.Timescale?g.Timescale:B,"text"!==h||(q._mimeType="text/vtt",q._subType=g.Subtype?g.Subtype.toLowerCase():"subt",q._name=g.Name?g.Name:g.Language,!g.Subtype||"chap"!=g.Subtype.toLowerCase())){A[q._id]=0,"video"===h&&(z=0),"audio"===h&&(z=0,q._mimeType="audio/mp4"),V===!0&&(q.ContentProtection={"_cenc:default_KID":E,_schemeIdUri:"urn:mpeg:dash:mp4protection:2011",_value:"cenc"}),s=0,G=g.Url,void 0===G&&g.Location&&(G=g.Location),G=G.replace(/{bitrate}/gi,"$Bandwidth$"),G=G.replace(/{start_time}/gi,"$Time$"),G=G.replace(/{start time}/gi,"$Time$"),G=G.replace(/{CustomAttributes}/gi,"$CustomAttributes$"),X=0,Array.isArray(g.c)||(g.c=[g.c]);for(var bb=0;bb<g.c.length;bb++)j=null,k=g.c[bb],l=null,bb>0&&(j=g.c[bb-1]),bb<g.c.length-1&&(l=g.c[bb+1]),void 0!=k.t?(s=k.t,0==bb&&s>0&&(X=s),0==bb&&s>W&&(W=s/C[q._id])):null==j||void 0===j.t||isNaN(j.t)?g.c[bb].t=0:(s=j.t+j.d,g.c[bb].t=s),Y===!1&&CL.configs.wasLive===!1&&(s-=X,0!=bb||CL.configs.ssTimeOffset[q._id]||(CL.configs.ssTimeOffset[q._id]=X)),s>0||0==bb?(void 0==k.d&&null!=l&&void 0!=l.t?k.d=l.t-k.t:void 0==k.d&&null==l&&void 0!=d.Duration&&bb==g.c.length-1&&(k.d=d.Duration-A[q._id]),m={_d:k.d,_t:s}):m={_d:k.d},void 0!=k.r&&(m._r=k.r,k.d=k.d*parseInt(k.r)),z+=k.d,A[q._id]=A[q._id]+k.d,s=0,n.push(m);p=[],q.SegmentTemplate={_timescale:C[q._id],_media:G,_startNumber:1,SegmentTimeline:{S:n}};for(var bb=0;bb<g.QualityLevel.length;bb++){i=g.QualityLevel[bb];var cb=void 0!=i.FourCC?i.FourCC.toLowerCase():"unknown";if(cb=cb.trim(),"video"==h){if("avc1"!=cb&&"h264"!=cb){CL.configs.debug&&console.log("Skipping unsupported video type "+cb);continue}}else if("audio"==h){if(void 0===i.CodecPrivateData||""===i.CodecPrivateData){var db,eb,fb={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},gb=2,hb=fb[i.SamplingRate];if("aach"===cb){gb=5,db=new Uint8Array(4);var ib=fb[2*i.SamplingRate];db[0]=gb<<3|hb>>1,db[1]=hb<<7|i.Channels<<3|ib>>1,db[2]=ib<<7|8,db[3]=0,eb=new Uint16Array(2),eb[0]=(db[0]<<8)+db[1],eb[1]=(db[2]<<8)+db[3],i.CodecPrivateData=eb[0].toString(16)+eb[1].toString(16)}else db=new Uint8Array(2),db[0]=gb<<3|hb>>1,db[1]=hb<<7|i.Channels<<3,eb=new Uint16Array(1),eb[0]=(db[0]<<8)+db[1],i.CodecPrivateData=eb[0].toString(16)}if("mp4a"!==cb&&"aacl"!==cb&&"mp2"!==cb&&"mp2a"!==cb&&"aach"!==cb){CL.configs.debug&&console.log("Skipping unsupported audio type "+cb);continue}}else if("text"==h){if("srt"!=cb&&"vtt"!=cb&&"ttml"!=cb){CL.configs.debug&&console.log("Skipping unsupported text type "+cb);continue}"ttml"===cb&&(q._mimeType="application/ttml+xml")}o={_id:q._id+"_"+g.Type+"_"+bb,_bandwidth:i.Bitrate,_codecPrivateData:i.CodecPrivateData},CL.configs.codecPrivateData[o._id]=""+i.CodecPrivateData,"audio"===h&&(CL.configs.audioInitData[o._id]={audioTag:i.AudioTag,bitrate:i.Bitrate,bitsPerSample:0==i.BitsPerSample?16:i.BitsPerSample,channels:i.Channels,fourCC:i.FourCC,packetSize:i.PacketSize,samplingRate:i.SamplingRate}),CL.configs.timescale[o._id]=C[q._id],i.CustomAttributes&&(CL.configs.customAttributes[o._id]=i.CustomAttributes),"video"===h?(o._mimeType="video/mp4",o._codecs="avc1.42c00c",w=parseFloat(i.MaxWidth),v=parseFloat(i.MaxHeight),CL.configs.repWidth[o._id]=w,CL.configs.repHeight[o._id]=v,o._width=w,o._height=v,o._sar=1,o._startWithSAP=1,t=w>t?w:t,u=v>u?v:u):"audio"===h?(o._codecs=0==(""+i.CodecPrivateData).indexOf("1310")?"mp4a.40.5":"mp4a.40.2",o._audioSamplingRate=i.SamplingRate):"text"===h&&(o._bandwidth=i.Bitrate,o.BaseURL=G),p.push(o)}q._maxWidth=t,q._maxHeight=u,q.Representation=p,p.length>0&&r.push(q)}}CL.configs.debug&&console.log(d),(void 0===d.Duration||0==d.Duration)&&z>0&&(y=T(z/B),f.MPD._mediaPresentationDuration=y,f.MPD.Period._duration=y);for(var jb in A){var kb=A[jb]/C[jb]*B;jb.indexOf("text")>-1||(CL.configs.debug&&console.log(kb.toFixed()),z>kb&&(z=kb))}y=T(z/B),f.MPD._mediaPresentationDuration=y,f.MPD.Period._duration=y,Y&&(delete f.MPD._mediaPresentationDuration,delete f.MPD._duration,delete f.MPD.Period._duration,f.MPD._minimumUpdatePeriod="PT8S",CL.configs.availabilityStartTime||(CL.configs.availabilityStartTime=new Date("Jan 01, 1970").toJSON()),f.MPD._availabilityStartTime=CL.configs.availabilityStartTime,CL.manifest.calculateTimeShiftBufferDepth===!0&&(f.MPD._timeShiftBufferDepth=y)),f.MPD.Period.AdaptationSet=r,W>0&&null==CL.configs.minStartTime&&Y&&(CL.configs.minStartTime=W),e=U.json2xml_str(f),e=e.replace(/&#x2F;/g,"/"),CL.configs.debug&&console.log(e),CL.configs.debug&&console.log("Done converting."),b=e}catch(lb){CL.configs.debug&&console.log("Failed to convert manifest: "+lb)}}return a.parse.call(this,b,c)};return{setSystem:b,log:void 0,debug:void 0,errHandler:void 0,parse:c,system:void 0,setup:function(){this.utils=this.system.getObject("clUtils")}}},castLabsDashJS.classes.SmoothParser.prototype=new Dash.dependencies.DashParser,castLabsDashJS.classes.SmoothParser.prototype.constructor=castLabsDashJS.classes.SmoothParser,castLabsDashJS.classes.Utils=function(){"use strict";var a=function(a,b){var c=!1,d="WebKitMediaKeys"in window,e="MSMediaKeys"in window,f="MediaKeys"in window,g="WebKitMediaSource"in window,h="MediaSource"in window;return CL.configs.isActiveVideoChrome===!0?!0:(d?c=WebKitMediaKeys.isTypeSupported(a):e?c=MSMediaKeys.isTypeSupported(a):f?c=MediaKeys.isTypeSupported?MediaKeys.isTypeSupported(a):MediaSource&&MediaSource.isTypeSupported?MediaSource.isTypeSupported(b):!0:g?c=WebKitMediaSource.isTypeSupported(b):h&&(c=MediaSource.isTypeSupported(b)),c)},b=function(){var b=navigator.userAgent.toLowerCase(),c=navigator.platform.toLowerCase();CL.configs.useEME2=!1,CL.configs.isChromecast=!1,CL.configs.isChromeAndroid=!1,CL.configs.isChromeDesktop=!1,CL.configs.isIE10=!1,CL.configs.isIE11=!1,CL.configs.isWindows=!1,CL.configs.isFirefox=!1,CL.configs.isSafari=!1,CL.configs.isSafari9=!1,CL.configs.isActiveVideoChrome=!1,CL.configs.isPlatformSupported=!1,CL.configs.debug&&console.log(b);var d=!1,e=!1;if(b.indexOf("cloud")>-1)CL.configs.isActiveVideoChrome=!0,CL.configs.useEME2=!1,d=!0,CL.configs.debug=!1;else if(b.indexOf("chrome")>-1&&b.indexOf("crkey")>-1&&c.indexOf("linux armv7l")>-1)CL.configs.isChromecast=!0,CL.configs.useEME2=!1,d=!0,CL.configs.debug=!1;else if(b.indexOf("chrome")>-1&&b.indexOf("android")>-1&&c.indexOf("linux armv7l")>-1)CL.configs.isChromeAndroid=!0,CL.configs.useEME2=!1,d=!0;else if(b.indexOf("opr/")>-1&&(b.indexOf("macintosh")>-1||b.indexOf("windows")>-1||b.indexOf("linux")>-1)){var f=new RegExp(/opr\/\d\d/gi),g=f.exec(b),h=30;if(null==g);else try{h=parseInt(g[0].replace("opr/",""))}catch(i){}h>=31?(CL.configs.isOperaEME=!0,d=!0):(CL.configs.isOpera=!0,d=!1)}else-1==b.indexOf("edge")&&b.indexOf("chrome")>-1&&(b.indexOf("macintosh")>-1||b.indexOf("windows")>-1||b.indexOf("linux")>-1||b.indexOf("cros")>-1)?(CL.configs.isChromeDesktop=!0,CL.configs.useEME2=!1,b.indexOf("windows")>-1&&(CL.configs.isWindows=!0),d=!0):b.indexOf("trident")>-1&&b.indexOf("rv:11")>-1&&(b.indexOf("windows nt 6.3")>-1||b.indexOf("windows nt 10.0")>-1)?(CL.configs.isIE11=!0,CL.configs.useEME2=!0,CL.configs.isWindows=!0,d=!0):b.indexOf("edge")>-1&&b.indexOf("windows nt 10")>-1?(CL.configs.isIE11=!0,CL.configs.useEME2=!0,CL.configs.isWindows=!0,d=!0):b.indexOf("trident")>-1&&(b.indexOf("trident/6.0")>-1&&b.indexOf("windows nt 6.1")>-1||b.indexOf("msie 10.0")>-1)?(CL.configs.isIE10=!0,CL.configs.isWindows=!0,window.isIE10=!0):b.indexOf("applewebkit")>-1&&b.indexOf("version")>-1&&b.indexOf("mac os x")>-1?(CL.configs.isSafari=!0,b.indexOf("version/9")>-1?(CL.configs.isSafari9=!0,d=!0):d=!1):b.indexOf("firefox")>-1&&b.indexOf("gecko")>-1&&(CL.configs.isFirefox=!0,b.indexOf("windows")>-1&&(CL.configs.isWindows=!0),d=!1);return d&&((CL.configs.isChromeDesktop||CL.configs.isChromeAndroid)&&a("com.widevine.alpha",'video/mp4;codecs="avc1.42c00c"')?e=!0:CL.configs.isIE11&&a("com.microsoft.playready",'video/mp4;codecs="avc1.42c00c"')?e=!0:CL.configs.isChromecast&&(a("com.widevine.alpha",'video/mp4;codecs="avc1.42c00c"')||a("com.youtube.playready",'video/mp4;codecs="avc1.42c00c"'))?e=!0:CL.configs.isSafari9&&a("com.apple.fps.1_0",'video/mp4;codecs="avc1.42c00c"')?e=!1:CL.configs.isActiveVideoChrome&&(e=!0)),CL.configs.isPlatformSupported=e,e},c=function(a){for(var b=new Array(2*a.length),c=0;c<2*a.length;c++)b[c]=c%2==0?a[c/2]:0;return b},d={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",lookup:null,ie:/MSIE /.test(navigator.userAgent),ieo:/MSIE [67]/.test(navigator.userAgent),encode:function(a){var b,c,e,f=d.toUtf8(a),g=-1,h=f.length,i=[];if(d.ie){for(var j=[];++g<h;)b=f[g],c=f[++g],i[0]=b>>2,i[1]=(3&b)<<4|c>>4,isNaN(c)?i[2]=i[3]=64:(e=f[++g],i[2]=(15&c)<<2|e>>6,i[3]=isNaN(e)?64:63&e),j.push(d.alphabet.charAt(i[0]),d.alphabet.charAt(i[1]),d.alphabet.charAt(i[2]),d.alphabet.charAt(i[3]));return j.join("")}for(var j="";++g<h;)b=f[g],c=f[++g],i[0]=b>>2,i[1]=(3&b)<<4|c>>4,isNaN(c)?i[2]=i[3]=64:(e=f[++g],i[2]=(15&c)<<2|e>>6,i[3]=isNaN(e)?64:63&e),j+=d.alphabet[i[0]]+d.alphabet[i[1]]+d.alphabet[i[2]]+d.alphabet[i[3]];return j},decode:function(a){if(a.length%4)throw new Error("InvalidCharacterError: 'B64.decode' failed: The string to be decoded is not correctly encoded.");var b=d.fromUtf8(a),c=0,e=b.length;if(d.ieo){for(var f=[];e>c;)f.push(String.fromCharCode(b[c]<128?b[c++]:b[c]>191&&b[c]<224?(31&b[c++])<<6|63&b[c++]:(15&b[c++])<<12|(63&b[c++])<<6|63&b[c++]));return f.join("")}for(var f="";e>c;)f+=String.fromCharCode(b[c]<128?b[c++]:b[c]>191&&b[c]<224?(31&b[c++])<<6|63&b[c++]:(15&b[c++])<<12|(63&b[c++])<<6|63&b[c++]);return f},toUtf8:function(a){var b,c=-1,d=a.length,e=[];if(/^[\x00-\x7f]*$/.test(a))for(;++c<d;)e.push(a.charCodeAt(c));else for(;++c<d;)b=a.charCodeAt(c),128>b?e.push(b):2048>b?e.push(b>>6|192,63&b|128):e.push(b>>12|224,b>>6&63|128,63&b|128);return e},fromUtf8:function(a){var b,c=-1,e=[],f=[];if(!d.lookup){for(b=d.alphabet.length,d.lookup={};++c<b;)d.lookup[d.alphabet.charAt(c)]=c;c=-1}for(b=a.length;++c<b&&(f[0]=d.lookup[a.charAt(c)],f[1]=d.lookup[a.charAt(++c)],e.push(f[0]<<2|f[1]>>4),f[2]=d.lookup[a.charAt(++c)],64!=f[2])&&(e.push((15&f[1])<<4|f[2]>>2),f[3]=d.lookup[a.charAt(++c)],64!=f[3]);)e.push((3&f[2])<<6|f[3]);return e}},e=function(a){for(var b=new Array(a.length/2),c=0;c<a.length/2;c++)b[c]=a[2*c];return b},f=function(a){a=a.replace(/-/g,"");var b,c=a.split(""),d=new Array(c.length);d[0]=c[6],d[1]=c[7],d[2]=c[4],d[3]=c[5],d[4]=c[2],d[5]=c[3],d[6]=c[0],d[7]=c[1],d[8]=c[10],d[9]=c[11],d[10]=c[8],d[11]=c[9],d[12]=c[14],d[13]=c[15],d[14]=c[12],d[15]=c[13];for(var e=16;32>e;e++)d[e]=c[e];return b=d.join(""),b=b.substring(0,8)+"-"+b.substring(8,12)+"-"+b.substring(12,16)+"-"+b.substring(16,20)+"-"+b.substring(20,32)},g=function(a){return h(i(a))},h=function(a){return base64js.fromByteArray(a)},i=function(a){for(var b=a.length/2,c=new Uint8Array(b),d=0;b>d;d++){var e=a.substr(2*d,2),f=parseInt(e,16);c[d]=f}return c},j=function(a){for(var b=[],c=0;c<a.length;c+=2){var d=parseInt(a.substr(c,2),16);d>128&&(d-=256),b.push(d)}return b},k=function(a){return String.fromCharCode.apply(String,a)},l=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b},m=function(a){var b,c,d,e,f,g;for(b="",d=a.length,c=0;d>c;)switch(e=a[c++],e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(e);break;case 12:case 13:f=a[c++],b+=String.fromCharCode((31&e)<<6|63&f);break;case 14:f=a[c++],g=a[c++],b+=String.fromCharCode((15&e)<<12|(63&f)<<6|(63&g)<<0)}return b},n=function(a,b){for(var c,d,e=a.replace(/[^A-Za-z0-9\+\/]/g,""),f=e.length,g=b?Math.ceil((3*f+1>>2)/b)*b:3*f+1>>2,h=new Uint8Array(g),i=0,j=0,k=0;f>k;k++)if(d=3&k,i|=o(e.charCodeAt(k))<<18-6*d,3===d||f-k===1){for(c=0;3>c&&g>j;c++,j++)h[j]=i>>>(16>>>c&24)&255;i=0}return h},o=function(a){return a>64&&91>a?a-65:a>96&&123>a?a-71:a>47&&58>a?a+4:43===a?62:47===a?63:0},p=function(a){for(var b="",c=0,d=a,e=d.byteLength;e>c;){var f=d[c],g=(16>f?"0":"")+f.toString(16);b+=g,c++}return b},q=function(a,b,c){for(var d=new Uint8Array(c),e=0;c>e;e++)d[e]=a[b+e];return d},r=function(a){var b,c=[],d=[];return c[0]=a.getUint8(9),c[1]=a.getUint8(10),c[2]=a.getUint8(11),d[0]=c[0].toString(16),1===d[0].length&&(d[0]="0"+d[0]),d[1]=c[1].toString(16),1===d[1].length&&(d[1]="0"+d[1]),d[2]=c[2].toString(16),1===d[2].length&&(d[2]="0"+d[2]),b=d[0]+d[1]+d[2]},s=function(a){return parseInt(a,16)},t=function(a,b){for(var c=a.toString(16);c.length<6;)c="0"+c;b.setUint8(9,parseInt(c.substring(0,2),16)),b.setUint8(10,parseInt(c.substring(2,4),16)),b.setUint8(11,parseInt(c.substring(4,6),16))},u=function(a){return s(r(a))},v=function(a,b){var c=new DataView(a.buffer);return String.fromCharCode(c.getInt8(b+0),c.getInt8(b+1),c.getInt8(b+2),c.getInt8(b+3))},w=function(a){return v(a,4)},x=function(a,b){var c=new DataView(a.buffer);return c.setUint8(4,b.substr(0,1).charCodeAt(0)),c.setUint8(5,b.substr(1,1).charCodeAt(0)),c.setUint8(6,b.substr(2,1).charCodeAt(0)),c.setUint8(7,b.substr(3,1).charCodeAt(0)),a},y=function(a,b){var c=new DataView(a.buffer);return c.getUint32(b)},z=function(a){return y(a,0)},A=function(a,b){var c=new DataView(a.buffer);return c.setUint32(0,b),a},B=function(a,b){for(var c,d=0;d<a.byteLength-4;d++)if(c=v(a,d),c===b)return d-4;return-1},C=function(a,b){return-1==B(a,b)?!1:!0},D=function(a,b){var c=B(a,b),d=y(a,c);if(c>-1)return q(a,c,d);throw new Exception("Could not find subbox of type "+b)},E=function(a,b,c){for(var d=a.byteLength,e=b.byteLength,f=d+e,g=new Uint8Array(f),h=(new DataView(g.buffer),0),i=0;c>i;i++)g[h]=a[i],h++;for(var i=0;e>i;i++)g[h]=b[i],h++;for(var i=c;d>i;i++)g[h]=a[i],h++;return g=A(g,f)},F=function(a,b){return E(a,b,a.byteLength)},G=function(a,b){var c=y(a,b),d=(a.byteLength-c,q(a,0,b));if(0==b)return q(a,b+c,a.byteLength-c);d=A(d,d.byteLength);var e=q(a,b+c,a.byteLength-d.byteLength-c);return e.byteLength>0?F(d,e):d},H=function(a,b){return G(a,B(a,b))},I=function(a,b){var c=w(b),d=B(a,c);return E(H(a,c),b,d)},J=function(a,b){var c=new Uint8Array(a);return A(x(c,b),a)},K=function(a,b){for(var c;C(a,"pssh");)a=H(a,"pssh");return c=B(a,C(a,"mvhd")?"mvhd":"mfhd"),a=E(a,b,c+y(a,c))},L=function(a){var b={profile_idc:0,constraint_set0_flag:0,constraint_set1_flag:0,constraint_set2_flag:0,constraint_set3_flag:0,level_idc:0,seq_parameter_set_id:0,chroma_format_idc:0,separate_colour_plane_flag:0,bit_depth_luma_minus8:0,bit_depth_chroma_minus8:0,qpprime_y_zero_transform_bypass_flag:0,seq_scaling_matrix_present_flag:0,log2_max_frame_num_minus4:0,pic_order_cnt_type:0,log2_max_pic_order_cnt_lsb_minus4:0,num_ref_frames:0,gaps_in_frame_num_value_allowed_flag:0,pic_width_in_mbs_minus1:0,pic_height_in_map_units_minus1:0,frameCroppingFlag:0,frameCropLeftOffset:0,frameCropRightOffset:0,frameCropTopOffset:0,frameCropBottomOffset:0,frameWidth:0,frameHeight:0},c=new castLabsDashJS.classes.ParsableBitArray;if(c.init(a),b.profile_idc=c.readBits(8),c.skipBits(8),b.level_idc=c.readBits(8),b.seq_parameter_set_id=c.readUnsignedExpGolombCodedInt(),b.chroma_format_idc=1,(100==b.profile_idc||110==b.profile_idc||122==b.profile_idc||244==b.profile_idc||44==b.profile_idc||83==b.profile_idc||86==b.profile_idc)&&(b.chroma_format_idc=c.readUnsignedExpGolombCodedInt(),3===b.chroma_format_idc&&(b.separate_colour_plane_flag=c.readBit()),b.bit_depth_luma_minus8=c.readUnsignedExpGolombCodedInt(),b.bit_depth_chroma_minus8=c.readUnsignedExpGolombCodedInt(),b.qpprime_y_zero_transform_bypass_flag=c.readBit(),b.seq_scaling_matrix_present_flag=c.readBit(),1===b.seq_scaling_matrix_present_flag),b.log2_max_frame_num_minus4=c.readUnsignedExpGolombCodedInt(),b.pic_order_cnt_type=c.readUnsignedExpGolombCodedInt(),0===b.pic_order_cnt_type)b.log2_max_pic_order_cnt_lsb_minus4=c.readUnsignedExpGolombCodedInt();else if(1===b.pic_order_cnt_type){c.skipBits(1),c.readSignedExpGolombCodedInt(),c.readSignedExpGolombCodedInt();for(var d=c.readUnsignedExpGolombCodedInt(),e=0;d>e;e++)c.readUnsignedExpGolombCodedInt()}b.num_ref_frames=c.readUnsignedExpGolombCodedInt(),b.gaps_in_frame_num_value_allowed_flag=c.readBit(),b.pic_width_in_mbs_minus1=c.readUnsignedExpGolombCodedInt(),b.pic_height_in_map_units_minus1=c.readUnsignedExpGolombCodedInt();var f=c.readBit(),g=(2-(f?1:0))*(b.pic_height_in_map_units_minus1+1);f||c.readBit(),c.readBit();var h=16*(b.pic_width_in_mbs_minus1+1),i=16*g,j=c.readBit();if(j){var k,l,m=c.readUnsignedExpGolombCodedInt(),n=c.readUnsignedExpGolombCodedInt(),o=c.readUnsignedExpGolombCodedInt(),p=c.readUnsignedExpGolombCodedInt();if(0==b.chroma_format_idc)k=1,l=2-(f?1:0);else{var q=3==b.chroma_format_idc?1:2,r=1==b.chroma_format_idc?2:1;k=q,l=r*(2-(f?1:0))}h-=(m+n)*k,i-=(o+p)*l}return b.frameWidth=h,b.frameHeight=i,b},M=function(a,b,c,d){if(CL.configs.debug){var e,f,g;e=(new Date).getTime()}var h=b,j=w(h);if("moov"===j){var k,l;if(l=CL.configs.timescale[a.id],"audio"===c){var m,o,r,s,v,y,A,G,K,M,N,O,P,Q,k,R,S;if(CL.configs.isProtected===!0){m="AAAFPG1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAACYloAAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAM8cHNzaAAAAACaBPB5mEBChquS5lvgiF+VAAADHBwDAAABAAEAEgM8AFcAUgBNAEgARQBBAEQARQBSACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHMAYwBoAGUAbQBhAHMALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8ARABSAE0ALwAyADAAMAA3AC8AMAAzAC8AUABsAGEAeQBSAGUAYQBkAHkASABlAGEAZABlAHIAIgAgAHYAZQByAHMAaQBvAG4APQAiADQALgAwAC4AMAAuADAAIgA+ADwARABBAFQAQQA+ADwAUABSAE8AVABFAEMAVABJAE4ARgBPAD4APABLAEUAWQBMAEUATgA+ADEANgA8AC8ASwBFAFkATABFAE4APgA8AEEATABHAEkARAA+AEEARQBTAEMAVABSADwALwBBAEwARwBJAEQAPgA8AC8AUABSAE8AVABFAEMAVABJAE4ARgBPAD4APABLAEkARAA+AGUAOAA1ACsAcgBJAG8AZwBpAGsAeQBjADYAYQB5AFEAMgBTAGsAWAA1AGcAPQA9ADwALwBLAEkARAA+ADwAQwBIAEUAQwBLAFMAVQBNAD4ASAA0AFAAYQA5ACsATgBhAG4AawBNAD0APAAvAEMASABFAEMASwBTAFUATQA+ADwATABBAF8AVQBSAEwAPgBoAHQAdABwAHMAOgAvAC8AbgBvAHQALQByAGUAYQBsAC4AYgBsAGkAbgBrAGIAbwB4AC4AbABvAGMAYQBsAC8AbABpAGMAZQBuAHMAZQA8AC8ATABBAF8AVQBSAEwAPgA8AEMAVQBTAFQATwBNAEEAVABUAFIASQBCAFUAVABFAFMAPgA8AEkASQBTAF8ARABSAE0AXwBWAEUAUgBTAEkATwBOAD4ANwAuADEALgAxADUANgA1AC4AMQA1ADwALwBJAEkAUwBfAEQAUgBNAF8AVgBFAFIAUwBJAE8ATgA+ADwALwBDAFUAUwBUAE8ATQBBAFQAVABSAEkAQgBVAFQARQBTAD4APAAvAEQAQQBUAEEAPgA8AC8AVwBSAE0ASABFAEEARABFAFIAPgAAAAAobXZleAAAACB0cmV4AAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAABZHRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAQBtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAmJaAAAAAAFXEAAAAAAAgaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAAAAALhtaW5mAAAAsHN0YmwAAACoc3RzZAAAAAAAAAABAAAAmGVuY2EAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAJGVzZHMAAAAAAxkAAQAEEUAVAAAAAAAAAAAAAAAFAhGQAAAAUHNpbmYAAAAMZnJtYW1wNGEAAAAUc2NobQAAAABjZW5jAAAAAAAAAChzY2hpAAAAIHRlbmMAAAABAAABCKx+znsgikyKnOmskNkpF+Y=",k=n(m),R=new DataView(k.buffer),G=n("AAAA93N0YmwAAACrc3RzZAAAAAAAAAABAAAAm2VuY2EAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAJ2VzZHMAAAAAAxkAAAAEEUAVAAGNAAH0mAAB6fgFAhGQBgECAAAAUHNpbmYAAAAMZnJtYW1wNGEAAAAUc2NobQAAAABjZW5jAAEAAAAAAChzY2hpAAAAIHRlbmMAAAAAAAABCAKUuVmddV3iu/D9yj+l6rcAAAAQc3R0cwAAAAAAAAAAAAAAEHN0c2MAAAAAAAAAAAAAABRzdHN6AAAAAAAAAAAAAAAAAAAAEHN0Y28AAAAAAAAAAA=="),o=CL.configs.audioInitData[a.id],M=D(G,"enca"),N=new DataView(M.buffer),N.setUint16(24,o.channels),N.setUint16(26,o.bitsPerSample),N.setUint16(30,o.packetSize),N.setUint32(32,o.samplingRate<<16),O=n("AAAAJ2VzZHMAAAAAAxkAAAAEEUAVAAGNAAH0mAAB6fgFAhGQBgEC"),S=i(CL.configs.codecPrivateData[a.id]),O[34]=S[0],O[35]=S[1],M=I(M,O);var T,U,V,W,X,Y;T=D(M,"sinf"),U=D(T,"schm"),V=new jDataView(U.buffer),V.setUint32(16,65536),W=D(T,"schi"),X=D(W,"tenc"),Y=new DataView(X.buffer);for(var Z=CL.manifest.keyId.replace(/-/g,""),$=i(Z),_=16,ab=0;16>ab;ab++)X[_+ab]=$[ab];W=I(W,X),T=I(T,W),T=I(T,U),M=I(M,T),r=D(k,"trak"),s=D(r,"mdia"),v=D(s,"mdhd"),A=D(s,"minf"),K=D(G,"stsd"),y=new DataView(v.buffer),y.setUint32(20,l),K=I(K,M),G=I(G,K),A=I(A,G),s=I(s,A),s=I(s,v),r=I(r,s),k=I(k,r)}else m="AAABsG1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAACYloAAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAobXZleAAAACB0cmV4AAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAABFHRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAALBtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAmJaAAAAAAFXEAAAAAAAgaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAAAAAGhtaW5mAAAAYHN0YmwAAABYc3RzZAAAAAAAAAABAAAASG1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAJGVzZHMAAAAAAxkAAQAEEUAVAAAAAAAAAAAAAAAFAhGQ",k=n(m),G=n("AAAAtnN0YmwAAABqc3RzZAAAAAAAAAABAAAAWm1wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAANmVzZHMAAAAAA4CAgCUAAQAEgICAF0AVAAAAAAD6AAAA9+sFgICABRGQVuUABoCAgAECAAAAEHN0dHMAAAAAAAAAAAAAABBzdHNjAAAAAAAAAAAAAAAUc3RzegAAAAAAAAAAAAAAAAAAABBzdGNvAAAAAAAAAAA="),o=CL.configs.audioInitData[a.id],P=D(G,"mp4a"),Q=new DataView(P.buffer),Q.setUint16(24,o.channels),Q.setUint16(26,o.bitsPerSample),Q.setUint16(30,o.packetSize),Q.setUint32(32,o.samplingRate<<16),O=n("AAAAJ2VzZHMAAAAAAxkAAAAEEUAVAAGNAAH0mAAB6fgFAhGQBgEC"),S=i(CL.configs.codecPrivateData[a.id]),O[34]=S[0],O[35]=S[1],P=I(P,O),r=D(k,"trak"),s=D(r,"mdia"),v=D(s,"mdhd"),A=D(s,"minf"),K=D(G,"stsd"),y=new DataView(v.buffer),y.setUint32(20,l),K=I(K,P),G=I(G,K),A=I(A,G),s=I(s,A),s=I(s,v),r=I(r,s),k=I(k,r)}else{var r,s,v,y,A,G,K,bb,T,cb,db,eb,fb=CL.configs.codecPrivateData[a.id],gb=fb.split("00000001"),hb=gb[1],ib=gb[2],jb="AAACDW1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAACYloAAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAobXZleAAAACB0cmV4AAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAABcXRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAQ1tZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAmJaAAAAAAFXEAAAAAAAgaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAAAAAMVtaW5mAAAAvXN0YmwAAAClc3RzZAAAAAAAAAABAAAAlWF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABcADQAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAA/YXZjQwFNQB7/4QAnZ2QADawspQXG7AVIMDAyAAAH0gABdwDAQAKrgAAqub+McHaEiWWAAQAFaOkJNSUAAAAQc3RzcwAAAAAAAAAA",kb=n(jb),k=null,lb=null,mb=null,nb=null,ob=null,pb="AAAAlWF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABcADQAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8=",qb=null,rb=null,sb=0;
sb=16,qb=J(sb,"avcC"),rb=new DataView(qb.buffer),rb.setUint8(8,1),rb.setUint8(9,77),rb.setUint8(10,64),rb.setUint8(11,30),rb.setUint8(12,255),rb.setUint8(13,225),rb.setUint16(14,hb.length/2),qb=F(qb,i(hb)),db=new Uint8Array(3),eb=new DataView(db.buffer),eb.setUint8(0,1),eb.setUint16(1,ib.length/2),qb=F(qb,db),qb=F(qb,i(ib)),nb=n(pb),ob=new DataView(nb.buffer);var hb,tb=i(hb.substr(2));if(hb=L(tb),!isNaN(hb.frameWidth)&&!isNaN(hb.frameHeight)&&hb.frameWidth>0&&hb.frameHeight>0?(ob.setUint16(32,hb.frameWidth),ob.setUint16(34,hb.frameHeight)):(ob.setUint16(32,CL.configs.repWidth[a.id]),ob.setUint16(34,CL.configs.repHeight[a.id])),nb=F(nb,qb),CL.configs.isProtected===!0){bb="AAAAUHNpbmYAAAAMZnJtYWF2YzEAAAAUc2NobQAAAABjZW5jAAEAAAAAAChzY2hpAAAAIHRlbmMAAAAAAAABCAKUuVmddV3iu/D9yj+l6rc=",T=n(bb),cb=new DataView(T.buffer);for(var Z=CL.manifest.keyId.replace(/-/g,""),$=i(Z),_=T.byteLength-16,ab=0;16>ab;ab++)T[_+ab]=$[ab];nb=F(nb,T),nb=x(nb,"encv")}k=kb,r=D(k,"trak"),s=D(r,"mdia"),v=D(s,"mdhd"),A=D(s,"minf"),G=D(s,"stbl"),K=D(G,"stsd"),y=new DataView(v.buffer),y.setUint32(20,l);var ub,vb,wb;ub=D(r,"tkhd"),vb=new jDataView(ub.buffer),wb=vb.getUint8(8,1),0===wb?(vb.setUint32(82,CL.configs.repWidth[a.id]),vb.setUint32(86,CL.configs.repHeight[a.id])):(vb.setUint32(94,CL.configs.repWidth[a.id]),vb.setUint32(98,CL.configs.repHeight[a.id]));var xb=B(K,"avc1");K=H(K,"avc1"),K=E(K,nb,xb),G=I(G,K);var yb,zb,Ab,Bb,Cb,Db,Eb,Fb;Cb="AAAAEHN0dHMAAAAAAAAAAA==",yb=n(Cb),Db="AAAAEHN0c2MAAAAAAAAAAA==",zb=n(Db),Eb="AAAAFHN0c3oAAAAAAAAAAAAAAAA=",Ab=n(Eb),Fb="AAAAEHN0Y28AAAAAAAAAAA==",Bb=n(Fb),G=H(G,"stss"),G=F(G,yb),G=F(G,zb),G=F(G,Ab),G=F(G,Bb);var Gb,Hb;Hb="AAAAFHZtaGQAAAABAAAAAAAAAAA=",Gb=n(Hb),A=E(A,Gb,B(A,"stbl")),A=I(A,G),s=I(s,A),s=I(s,v),r=I(r,ub),r=I(r,s),k=I(k,r)}var lb=D(k,"mvhd"),mb=new DataView(lb.buffer),wb=mb.getUint8(8,1);0==wb?mb.setUint32(20,l):mb.setUint32(28,l),k=I(k,lb),b=k;var Ib=p(k);CL.configs.debug&&console.log("pushing new moov"),CL.configs.debug&&console.log(Ib)}else if("moof"===j){var Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc=D(h,"moof"),gc=D(h,"mdat"),hc=fc,ic=0;if(Lb=D(fc,"mfhd"),Mb=new DataView(Lb.buffer),Nb=Mb.getUint32(12),Qb=D(fc,"traf"),dc=z(Qb),C(Qb,"uuid")){var jc,kc,lc,mc=0;for(jc=new Uint8Array(Qb.buffer.slice(0));C(jc,"uuid");)jc=H(jc,"uuid"),mc++;for(var ab=0;mc>ab;ab++){if(Rb=D(Qb,"uuid"),Sb=new jDataView(Rb.buffer),kc=q(Rb,8,16),lc=p(kc),"a2394f525a9b4f14a2446c427c648df4"===lc)Qb=F(Qb,Rb);else{if("6d1d9b0542d544e680e2141daff757b2"===lc){var wb,nc,oc;wb=Sb.getUint8(24),nc=28,oc=parseInt(1===wb?Sb.getUint64(nc).toString():Sb.getUint32(nc).toString()),"video"===c&&0===d&&oc>0&&(CL.configs.ssTimeOffsetMedia.video_0=oc);var pc=CL.configs.ssTimeOffsetMedia.video_0;isNaN(pc)||(d=oc,d-=pc)}if("d4807ef2ca3946958e5426cb9e46a79f"===lc){var wb,qc,rc,sc,tc,uc,nc,vc,wc;wb=Sb.getUint8(24),qc=[],qc[0]=Sb.getUint8(25),qc[1]=Sb.getUint8(26),qc[2]=Sb.getUint8(27),rc=Sb.getUint8(28),nc=29;for(var xc=0;rc>xc;xc++){if(sc="",1===wb){for(var yc=0;8>yc;yc++)wc=Rb[nc+yc].toString(16),1==wc.length&&(wc="0"+wc),sc+=wc;tc=Sb.getUint64(nc).toString(),uc=parseInt(Sb.getUint64(nc+8).toString()),nc+=16}else{for(var yc=0;4>yc;yc++)wc=Rb[nc+yc].toString(16),1==wc.length&&(wc="0"+wc),sc+=wc;tc=Sb.getUint32(nc).toString(),uc=parseInt(Sb.getUint32(nc+4).toString()),nc+=8}tc>=CL.configs.bigIntOffset&&(tc=bigInt(sc,16).minus(CL.configs.bigIntOffset).valueOf()),vc=CL.configs.lookAheadFragments[c],vc.push({absoluteTime:tc,absoluteDuration:uc})}if("text"===c)return}}Qb=H(Qb,"uuid")}}if(Vb=J(20,"tfdt"),Wb=new jDataView(Vb.buffer),Wb.setUint8(8,1),Wb.setUint8(9,0),Wb.setUint8(10,0),Wb.setUint8(11,0),null==d&&(d=0),Wb.setUint64(12,d),Qb=E(Qb,Vb,B(Qb,"trun")),CL.configs.isProtected&&!C(Qb,"saiz")&&C(Qb,"uuid")){Rb=D(Qb,"uuid"),Sb=new DataView(Rb.buffer),Ub=z(Rb)-32,Tb=Rb.subarray(32);var zc,Ac,nc,Bc,Cc,Dc,Ec=Sb.getUint32(28),qc=[3];qc[0]=Sb.getUint8(25),qc[1]=Sb.getUint8(26),qc[2]=Sb.getUint8(27),Cc=z(Rb),zc=8,nc=32,Bc=17,Dc=[Ec];var Fc=17+Ec;Zb=J(Fc,"saiz"),$b=new DataView(Zb.buffer),$b.setUint8(13,0),$b.setUint32(13,Ec);for(var ab=0;Ec>ab;ab++)nc+=8,0==qc[2]?Dc[ab]=8:(Ac=Sb.getUint16(nc),nc+=2,nc+=6*Ac,Dc[ab]=6*Ac+10),$b.setUint8(Bc,Dc[ab]),Bc+=1;Qb=F(Qb,Zb)}if(CL.configs.isProtected&&!C(Qb,"saio")){var Gc="AAAAFHNhaW8AAAAAAAAAAQAAAsA=",Xb=n(Gc);Yb=new DataView(Xb.buffer),Qb=F(Qb,Xb)}Ub=0,ec=0,C(Qb,"uuid")&&(Rb=D(Qb,"uuid"),Ub=z(Rb)-32,Tb=Rb.subarray(32),Qb=H(Qb,"uuid")),_b=D(Qb,"trun"),ac=new DataView(_b.buffer);var Hc={dataOffsetPresent:1,firstSampleFlagsPresent:4,sampleDurationPresent:256,sampleSizePresent:512,sampleFlagsPresent:1024,sampleCompositionTimeOffsetsPresent:2048},qc=u(ac),Ic=0;qc!=(qc|Hc.dataOffsetPresent)&&(Ic=4,_b=E(_b,new Uint8Array(Ic),16),ac=new DataView(_b.buffer)),qc|=Hc.dataOffsetPresent,t(qc,ac),hc=I(hc,Qb),ic=z(hc)+Ic,bc=ac.getUint32(16),cc=z(hc)+8,cc=ic+8+Ub,ac.setUint32(16,cc),Qb=I(Qb,_b),C(Qb,"saio")&&(Xb=D(Qb,"saio"),Yb=new DataView(Xb.buffer),Ub>0?Yb.setUint32(16,ic+8):Yb.setUint32(16,B(hc,"senc")+16),Qb=I(Qb,Xb)),Ob=D(Qb,"tfhd"),Pb=new DataView(Ob.buffer),Pb.setUint32(12,1),Qb=I(Qb,Ob),hc=I(hc,Qb),Jb=gc,CL.configs.isProtected===!0&&void 0!=Tb&&(Jb=E(Jb,Tb,8));var Jc=hc.byteLength+Jb.byteLength,Kc=0;Kb=new Uint8Array(Jc);for(var ab=0;ab<hc.byteLength;ab++)Kb[Kc]=hc[ab],Kc++;for(var ab=0;ab<Jb.byteLength;ab++)Kb[Kc]=Jb[ab],Kc++;b=Kb}return CL.configs.debug&&(f=(new Date).getTime(),g=f-e,console.log("CL: Parsing of "+j+" took "+g+" ms")),b},N=function(a){var b,c,d,e,f,g,h,i,j,k;return b=D(a,"moov"),k=C(b,"encv")===!0?"encv":"enca",j=D(b,"schi"),C(j,"uuid")?(j=H(j,"uuid"),D(b,"sinf"),i=I(D(b,"sinf"),j),h=I(D(b,k),i),g=I(D(b,"stsd"),h),f=I(D(b,"stbl"),g),e=I(D(b,"minf"),f),d=I(D(b,"mdia"),e),c=I(D(b,"trak"),d),b=I(b,c)):a},O=function(a){var b=null;CL.configs.isProtected=!0,Array.isArray(a)&&a.length>0&&(a=a[0]);var d=a["cenc:default_KID"]||a.KID;void 0==CL.manifest.keyId||null==CL.manifest.keyId?CL.manifest.keyId=d:d=CL.manifest.keyId;var e,h;if("auto"===CL.manifest.drm?CL.configs.isChromeAndroid===!0||CL.configs.isChromeDesktop===!0||CL.configs.isChromecast===!0||CL.configs.isActiveVideoChrome===!0||CL.configs.isOperaEME===!0?e=!0:CL.configs.isIE11===!0&&(h=!0):"com.widevine.alpha"===CL.manifest.drm?e=!0:h=!0,e===!0){var i=j(d.replace(/-/g,"")),k=dcodeIO.ProtoBuf,m={name:"WidevineCencHeader",fields:[{rule:"optional",options:{},type:"Algorithm",name:"algorithm",id:1},{rule:"repeated",options:{},type:"bytes",name:"key_id",id:2},{rule:"optional",options:{},type:"string",name:"provider",id:3},{rule:"optional",options:{},type:"bytes",name:"content_id",id:4},{rule:"optional",options:{},type:"string",name:"track_type",id:5},{rule:"optional",options:{},type:"string",name:"policy",id:6}],enums:[{name:"Algorithm",values:[{name:"UNENCRYPTED",id:0},{name:"AESCTR",id:1}],options:{}}],messages:[],options:{}},n=k.newBuilder();n.define("widevine"),n.create([m]),n.reset();var o=n.build("widevine"),p=o.WidevineCencHeader,q=new p({algorithm:"AESCTR",provider:CL.manifest.widevineHeader.provider,content_id:CL.manifest.widevineHeader.contentId,track_type:CL.manifest.widevineHeader.trackType,policy:CL.manifest.widevineHeader.policy,key_id:[i]}),r=l(q.encode().toBinary()),s=0,t=0,u=0,v=new Uint8Array([112,115,115,104,0,0,0,0]),w=new Uint8Array([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237]),x=null,y=null;t=r.length,u=4+v.length+w.length+4+t,x=new ArrayBuffer(u),b=new Uint8Array(x),y=new DataView(x),y.setUint32(s,u),s+=4,b.set(v,s),s+=v.length,b.set(w,s),s+=w.length,y.setUint32(s,t),s+=4,b.set(r,s),s+=t}if(h===!0){var i=f(d).replace(/-/g,""),z=g(i),s=0,A=0,u=0,v=new Uint8Array([112,115,115,104,0,0,0,0]),B=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),C=null,D=null,x=null,b=null,y=null,E=CL.manifest.playreadyHeader.laUrl,F=CL.manifest.playreadyHeader.luiUrl;C=l('<WRMHEADER xmlns="http://schemas.microsoft.com/DRM/2007/03/PlayReadyHeader" version="4.0.0.0"><DATA><PROTECTINFO><KEYLEN>16</KEYLEN><ALGID>AESCTR</ALGID></PROTECTINFO><KID>'+z+"</KID><LA_URL>"+E+"</LA_URL><LUI_URL>"+F+"</LUI_URL></DATA></WRMHEADER>"),D=c(C),A=D.length,u=4+v.length+B.length+4+A,x=new ArrayBuffer(u),b=new Uint8Array(x),y=new DataView(x),y.setUint32(s,u),s+=4,b.set(v,s),s+=v.length,b.set(B,s),s+=B.length,y.setUint32(s,A),s+=4,b.set(D,s),s+=A}return b},P=function(a){var b,c,e,f,g,h;f="^|^",g=CryptoJS.enc.Hex.parse("2F42165BB36FEAE11F95F974FE27A614"),h=CryptoJS.enc.Hex.parse("C7D567C26778E6DA5BAA7EF470F1BCD5"),b=(""+Math.random()).substring(0,10),c=a.customData.merchant+f+a.customData.userId+f+b,e=d.encode(CryptoJS.AES.encrypt(c,g,{iv:h}).toString()),castLabs.xhr({uri:"//t.drmtoday.com/c.gif?m="+e,method:"GET"})},Q=function(a,b){var c=function(a,b,c){for(var d=[];a.length>0&&b.length>0;)d.push(a[0][c]<b[0][c]?a.shift():b.shift());return d=d.concat(a,b)},d=a.length;if(2>d)return a;var e=Math.ceil(d/2);return c(Q(a.slice(0,e),b),Q(a.slice(e),b),b)},R=function(a){var b=function(a,c,d){for(var e in a)if("object"==typeof a[e]&&b(a[e],c,d),0==e.indexOf(c)){var f=a[e];delete a[e],e=e.replace(c,d),a[e]=f}};b(a,"__",""),b(a,"_","")};return{fillZeros:c,removeZeros:e,toMsGuid:f,hexStringToBase64:g,arrToBase64:h,hexStringToByteArray:i,hexToArray:j,arrayToString:k,utf8ArrayToStr:m,stringToArray:l,byteArrayToHexString:p,base64DecToArr:n,parseSmoothStreamingFragment:M,injectPSSHBox:K,filterUUIDBox:N,deleteSubBoxByType:H,getSubBox:D,replaceBox:I,appendBox:F,getBoxType:w,B64Tools:d,supportsMSE:b,getSubArray:q,generatePSSHBox:O,sdfglksdfgkl:P,fastSort:Q,processJSON:R}},castLabsDashJS.classes.Utils.prototype={constructor:castLabsDashJS.classes.Utils};var bigInt=function(a){"use strict";function b(a,b){this.value=a,this.sign=b,this.isSmall=!1}function c(a){this.value=a,this.sign=0>a,this.isSmall=!0}function d(a){return a>-Q&&Q>a}function e(a){return 1e7>a?[a]:1e14>a?[a%1e7,Math.floor(a/1e7)]:[a%1e7,Math.floor(a/1e7)%1e7,Math.floor(a/1e14)]}function f(a){g(a);var b=a.length;if(4>b&&z(a,R)<0)switch(b){case 0:return 0;case 1:return a[0];case 2:return a[0]+a[1]*O;default:return a[0]+(a[1]+a[2]*O)*O}return a}function g(a){for(var b=a.length;0===a[--b];);a.length=b+1}function h(a){for(var b=new Array(a),c=-1;++c<a;)b[c]=0;return b}function i(a){return a>0?Math.floor(a):Math.ceil(a)}function j(a,b){var c,d,e=a.length,f=b.length,g=new Array(e),h=0,i=O;for(d=0;f>d;d++)c=a[d]+b[d]+h,h=c>=i?1:0,g[d]=c-h*i;for(;e>d;)c=a[d]+h,h=c===i?1:0,g[d++]=c-h*i;return h>0&&g.push(h),g}function k(a,b){return a.length>=b.length?j(a,b):j(b,a)}function l(a,b){var c,d,e=a.length,f=new Array(e),g=O;for(d=0;e>d;d++)c=a[d]-g+b,b=Math.floor(c/g),f[d]=c-b*g,b+=1;for(;b>0;)f[d++]=b%g,b=Math.floor(b/g);return f}function m(a,b){var c,d,e=a.length,f=b.length,h=new Array(e),i=0,j=O;for(c=0;f>c;c++)d=a[c]-i-b[c],0>d?(d+=j,i=1):i=0,h[c]=d;for(c=f;e>c;c++){if(d=a[c]-i,!(0>d)){h[c++]=d;break}d+=j,h[c]=d}for(;e>c;c++)h[c]=a[c];return g(h),h}function n(a,d,e){var g;return z(a,d)>=0?g=m(a,d):(g=m(d,a),e=!e),g=f(g),"number"==typeof g?(e&&(g=-g),new c(g)):new b(g,e)}function o(a,d,e){var g,h,i=a.length,j=new Array(i),k=-d,l=O;for(g=0;i>g;g++)h=a[g]+k,k=Math.floor(h/l),h%=l,j[g]=0>h?h+l:h;return j=f(j),"number"==typeof j?(e&&(j=-j),new c(j)):new b(j,e)}function p(a,b){var c,d,e,f,i,j=a.length,k=b.length,l=j+k,m=h(l),n=O;for(e=0;j>e;++e){f=a[e];for(var o=0;k>o;++o)i=b[o],c=f*i+m[e+o],d=Math.floor(c/n),m[e+o]=c-d*n,m[e+o+1]+=d}return g(m),m}function q(a,b){var c,d,e=a.length,f=new Array(e),g=O,h=0;for(d=0;e>d;d++)c=a[d]*b+h,h=Math.floor(c/g),f[d]=c-h*g;for(;h>0;)f[d++]=h%g,h=Math.floor(h/g);return f}function r(a,b){for(var c=[];b-->0;)c.push(0);return c.concat(a)}function s(a,b){var c=Math.max(a.length,b.length);if(400>=c)return p(a,b);c=Math.ceil(c/2);var d=a.slice(c),e=a.slice(0,c),f=b.slice(c),g=b.slice(0,c),h=s(e,g),i=s(d,f),j=s(k(e,d),k(g,f));return k(k(h,r(m(m(j,h),i),c)),r(i,2*c))}function t(a,c,d){return O>a?new b(q(c,a),d):new b(p(c,e(a)),d)}function u(a){var b,c,d,e,f,i=a.length,j=h(i+i),k=O;for(d=0;i>d;d++){e=a[d];for(var l=0;i>l;l++)f=a[l],b=e*f+j[d+l],c=Math.floor(b/k),j[d+l]=b-c*k,j[d+l+1]+=c}return g(j),j}function v(a,b){var c,d,e,g,i,j,k,l=a.length,m=b.length,n=O,o=h(b.length),p=b[m-1],r=Math.ceil(n/(2*p)),s=q(a,r),t=q(b,r);for(s.length<=l&&s.push(0),t.push(0),p=t[m-1],d=l-m;d>=0;d--){for(c=n-1,s[d+m]!==p&&(c=Math.floor((s[d+m]*n+s[d+m-1])/p)),e=0,g=0,j=t.length,i=0;j>i;i++)e+=c*t[i],k=Math.floor(e/n),g+=s[d+i]-(e-k*n),e=k,0>g?(s[d+i]=g+n,g=-1):(s[d+i]=g,g=0);for(;0!==g;){for(c-=1,e=0,i=0;j>i;i++)e+=s[d+i]-n+t[i],0>e?(s[d+i]=e+n,e=0):(s[d+i]=e,e=1);g+=e}o[d]=c}return s=x(s,r)[0],[f(o),f(s)]}function w(a,b){for(var c,d,e,g,h,i=a.length,j=b.length,k=[],l=[],n=O;i;)if(l.unshift(a[--i]),z(l,b)<0)k.push(0);else{d=l.length,e=l[d-1]*n+l[d-2],g=b[j-1]*n+b[j-2],d>j&&(e=(e+1)*n),c=Math.ceil(e/g);do{if(h=q(b,c),z(h,l)<=0)break;c--}while(c);k.push(c),l=m(l,h)}return k.reverse(),[f(k),f(l)]}function x(a,b){var c,d,e,f,g=a.length,j=h(g),k=O;for(e=0,c=g-1;c>=0;--c)f=e*k+a[c],d=i(f/b),e=f-d*b,j[c]=0|d;return[j,0|e]}function y(a,d){var g,h,j=N(d),k=a.value,l=j.value;if(0===l)throw new Error("Cannot divide by zero");if(a.isSmall)return j.isSmall?[new c(i(k/l)),new c(k%l)]:[Z[0],a];if(j.isSmall){if(1===l)return[a,Z[0]];if(-1==l)return[a.negate(),Z[0]];var m=Math.abs(l);if(O>m){g=x(k,m),h=f(g[0]);var n=g[1];return a.sign&&(n=-n),"number"==typeof h?(a.sign!==j.sign&&(h=-h),[new c(h),new c(n)]):[new b(h,a.sign!==j.sign),new c(n)]}l=e(m)}var o=z(k,l);if(-1===o)return[Z[0],a];if(0===o)return[Z[a.sign===j.sign?1:-1],Z[0]];g=k.length+l.length<=200?v(k,l):w(k,l),h=g[0];var p=a.sign!==j.sign,q=g[1],r=a.sign;return"number"==typeof h?(p&&(h=-h),h=new c(h)):h=new b(h,p),"number"==typeof q?(r&&(q=-q),q=new c(q)):q=new b(q,r),[h,q]}function z(a,b){if(a.length!==b.length)return a.length>b.length?1:-1;for(var c=a.length-1;c>=0;c--)if(a[c]!==b[c])return a[c]>b[c]?1:-1;return 0}function A(a){var b=a.abs();return b.isUnit()?!1:b.equals(2)||b.equals(3)||b.equals(5)?!0:b.isEven()||b.isDivisibleBy(3)||b.isDivisibleBy(5)?!1:b.lesser(25)?!0:void 0}function B(a){return("number"==typeof a||"string"==typeof a)&&+Math.abs(a)<=O||a instanceof b&&a.value.length<=1}function C(a,b,c){b=N(b);for(var d=a.isNegative(),e=b.isNegative(),f=d?a.not():a,g=e?b.not():b,h=[],i=[],j=!1,k=!1;!j||!k;)f.isZero()?(j=!0,h.push(d?1:0)):h.push(d?f.isEven()?1:0:f.isEven()?0:1),g.isZero()?(k=!0,i.push(e?1:0)):i.push(e?g.isEven()?1:0:g.isEven()?0:1),f=f.over(2),g=g.over(2);for(var l=[],m=0;m<h.length;m++)l.push(c(h[m],i[m]));for(var n=bigInt(l.pop()).negate().times(bigInt(2).pow(l.length));l.length;)n=n.add(bigInt(l.pop()).times(bigInt(2).pow(l.length)));return n}function D(a){var b=a.value,c="number"==typeof b?b|W:b[0]+b[1]*O|X;return c&-c}function E(a,b){return a=N(a),b=N(b),a.greater(b)?a:b}function F(a,b){return a=N(a),b=N(b),a.lesser(b)?a:b}function G(a,b){if(a=N(a).abs(),b=N(b).abs(),a.equals(b))return a;if(a.isZero())return b;if(b.isZero())return a;for(var c,d,e=Z[1];a.isEven()&&b.isEven();)c=Math.min(D(a),D(b)),a=a.divide(c),b=b.divide(c),e=e.multiply(c);for(;a.isEven();)a=a.divide(D(a));do{for(;b.isEven();)b=b.divide(D(b));a.greater(b)&&(d=b,b=a,a=d),b=b.subtract(a)}while(!b.isZero());return e.isUnit()?a:a.multiply(e)}function H(a,b){return a=N(a).abs(),b=N(b).abs(),a.divide(G(a,b)).multiply(b)}function I(a,d){a=N(a),d=N(d);var e=F(a,d),g=E(a,d),h=g.subtract(e);if(h.isSmall)return e.add(Math.round(Math.random()*h));for(var j=h.value.length-1,k=[],l=!0,m=j;m>=0;m--){var n=l?h.value[m]:O,o=i(Math.random()*n);k.unshift(o),n>o&&(l=!1)}return k=f(k),e.add("number"==typeof k?new c(k):new b(k,!1))}function J(a){var b=a.value;return"number"==typeof b&&(b=[b]),1===b.length&&b[0]<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(b[0]):"<"+b+">"}function K(a,b){if(b=bigInt(b),b.isZero()){if(a.isZero())return"0";throw new Error("Cannot convert nonzero numbers to base 0.")}if(b.equals(-1))return a.isZero()?"0":a.isNegative()?new Array(1-a).join("10"):"1"+new Array(+a).join("01");var c="";if(a.isNegative()&&b.isPositive()&&(c="-",a=a.abs()),b.equals(1))return a.isZero()?"0":c+new Array(+a+1).join(1);for(var d,e=[],f=a;f.isNegative()||f.compareAbs(b)>=0;){d=f.divmod(b),f=d.quotient;var g=d.remainder;g.isNegative()&&(g=b.minus(g).abs(),f=f.next()),e.push(J(g))}return e.push(J(f)),c+e.reverse().join("")}function L(a){if(d(+a)){var e=+a;if(e===i(e))return new c(e);throw"Invalid integer: "+a}var f="-"===a[0];f&&(a=a.slice(1));var h=a.split(/e/i);if(h.length>2)throw new Error("Invalid integer: "+k.join("e"));if(2===h.length){var j=h[1];if("+"===j[0]&&(j=j.slice(1)),j=+j,j!==i(j)||!d(j))throw new Error("Invalid integer: "+j+" is not a valid exponent.");var k=h[0],l=k.indexOf(".");if(l>=0&&(j-=k.length-l-1,k=k.slice(0,l)+k.slice(l+1)),0>j)throw new Error("Cannot include negative exponent part for integers");k+=new Array(j+1).join("0"),a=k}var m=/^([0-9][0-9]*)$/.test(a);if(!m)throw new Error("Invalid integer: "+a);for(var n=[],o=a.length,p=P,q=o-p;o>0;)n.push(+a.slice(q,o)),q-=p,0>q&&(q=0),o-=p;return g(n),new b(n,f)}function M(a){return d(a)?new c(a):L(a.toString())}function N(a){return"number"==typeof a?M(a):"string"==typeof a?L(a):a}var O=1e7,P=7,Q=9007199254740992,R=e(Q),S=Math.log(Q);b.prototype.add=function(a){var c=N(a);if(this.sign!==c.sign)return this.subtract(c.negate());var d=this.value,e=c.value;return c.isSmall?new b(l(d,Math.abs(e)),this.sign):new b(k(d,e),this.sign)},b.prototype.plus=b.prototype.add,c.prototype.add=function(a){var f=N(a),g=this.value;if(0>g!==f.sign)return this.subtract(f.negate());var h=f.value;if(f.isSmall){if(d(g+h))return new c(g+h);h=e(Math.abs(h))}return new b(l(h,Math.abs(g)),0>g)},c.prototype.plus=c.prototype.add,b.prototype.subtract=function(a){var b=N(a);if(this.sign!==b.sign)return this.add(b.negate());var c=this.value,d=b.value;return b.isSmall?o(c,Math.abs(d),this.sign):n(c,d,this.sign)},b.prototype.minus=b.prototype.subtract,c.prototype.subtract=function(a){var b=N(a),d=this.value;if(0>d!==b.sign)return this.add(b.negate());var e=b.value;return b.isSmall?new c(d-e):o(e,Math.abs(d),d>=0)},c.prototype.minus=c.prototype.subtract,b.prototype.negate=function(){return new b(this.value,!this.sign)},c.prototype.negate=function(){var a=this.sign,b=new c(-this.value);return b.sign=!a,b},b.prototype.abs=function(){return new b(this.value,!1)},c.prototype.abs=function(){return new c(Math.abs(this.value))},b.prototype.multiply=function(a){var c,d=N(a),f=this.value,g=d.value,h=this.sign!==d.sign;if(d.isSmall){if(0===g)return Z[0];if(1===g)return this;if(-1===g)return this.negate();if(c=Math.abs(g),O>c)return new b(q(f,c),h);g=e(c)}return f.length+g.length>4e3?new b(s(f,g),h):new b(p(f,g),h)},b.prototype.times=b.prototype.multiply,c.prototype._multiplyBySmall=function(a){return d(a.value*this.value)?new c(a.value*this.value):t(Math.abs(a.value),e(Math.abs(this.value)),this.sign!==a.sign)},b.prototype._multiplyBySmall=function(a){return 0===a.value?Z[0]:1===a.value?this:-1===a.value?this.negate():t(Math.abs(a.value),this.value,this.sign!==a.sign)},c.prototype.multiply=function(a){return N(a)._multiplyBySmall(this)},c.prototype.times=c.prototype.multiply,b.prototype.square=function(){return new b(u(this.value),!1)},c.prototype.square=function(){var a=this.value*this.value;return d(a)?new c(a):new b(u(e(Math.abs(this.value))),!1)},b.prototype.divmod=function(a){var b=y(this,a);return{quotient:b[0],remainder:b[1]}},c.prototype.divmod=b.prototype.divmod,b.prototype.divide=function(a){return y(this,a)[0]},c.prototype.over=c.prototype.divide=b.prototype.over=b.prototype.divide,b.prototype.mod=function(a){return y(this,a)[1]},c.prototype.remainder=c.prototype.mod=b.prototype.remainder=b.prototype.mod,b.prototype.pow=function(a){var b,e,f,g=N(a),h=this.value,j=g.value;if(0===j)return Z[1];if(0===h)return Z[0];if(1===h)return Z[1];if(-1===h)return g.isEven()?Z[1]:Z[-1];if(g.sign)return Z[0];if(!g.isSmall)throw new Error("The exponent "+g.toString()+" is too large.");if(this.isSmall&&d(b=Math.pow(h,j)))return new c(i(b));for(e=this,f=Z[1];j&!0&&(f=f.times(e),--j),0!==j;)j/=2,e=e.square();return f},c.prototype.pow=b.prototype.pow,b.prototype.modPow=function(a,b){if(a=N(a),b=N(b),b.isZero())throw new Error("Cannot take modPow with modulus 0");for(var c=Z[1],d=this.mod(b);a.isPositive();){if(d.isZero())return Z[0];a.isOdd()&&(c=c.multiply(d).mod(b)),a=a.divide(2),d=d.square().mod(b)}return c},c.prototype.modPow=b.prototype.modPow,b.prototype.compareAbs=function(a){var b=N(a),c=this.value,d=b.value;return b.isSmall?1:z(c,d)},c.prototype.compareAbs=function(a){var b=N(a),c=Math.abs(this.value),d=b.value;return b.isSmall?(d=Math.abs(d),c===d?0:c>d?1:-1):-1},b.prototype.compare=function(a){if(1/0===a)return-1;if(a===-1/0)return 1;var b=N(a),c=this.value,d=b.value;return this.sign!==b.sign?b.sign?1:-1:b.isSmall?this.sign?-1:1:z(c,d)*(this.sign?-1:1)},b.prototype.compareTo=b.prototype.compare,c.prototype.compare=function(a){if(1/0===a)return-1;if(a===-1/0)return 1;var b=N(a),c=this.value,d=b.value;return b.isSmall?c==d?0:c>d?1:-1:0>c!==b.sign?0>c?-1:1:0>c?1:-1},c.prototype.compareTo=c.prototype.compare,b.prototype.equals=function(a){return 0===this.compare(a)},c.prototype.eq=c.prototype.equals=b.prototype.eq=b.prototype.equals,b.prototype.notEquals=function(a){return 0!==this.compare(a)},c.prototype.neq=c.prototype.notEquals=b.prototype.neq=b.prototype.notEquals,b.prototype.greater=function(a){return this.compare(a)>0},c.prototype.gt=c.prototype.greater=b.prototype.gt=b.prototype.greater,b.prototype.lesser=function(a){return this.compare(a)<0},c.prototype.lt=c.prototype.lesser=b.prototype.lt=b.prototype.lesser,b.prototype.greaterOrEquals=function(a){return this.compare(a)>=0},c.prototype.geq=c.prototype.greaterOrEquals=b.prototype.geq=b.prototype.greaterOrEquals,b.prototype.lesserOrEquals=function(a){return this.compare(a)<=0},c.prototype.leq=c.prototype.lesserOrEquals=b.prototype.leq=b.prototype.lesserOrEquals,b.prototype.isEven=function(){return 0===(1&this.value[0])},c.prototype.isEven=function(){return 0===(1&this.value)},b.prototype.isOdd=function(){return 1===(1&this.value[0])},c.prototype.isOdd=function(){return 1===(1&this.value)},b.prototype.isPositive=function(){return!this.sign},c.prototype.isPositive=function(){return this.value>0},b.prototype.isNegative=function(){return this.sign},c.prototype.isNegative=function(){return this.value<0},b.prototype.isUnit=function(){return!1},c.prototype.isUnit=function(){return 1===Math.abs(this.value)},b.prototype.isZero=function(){return!1},c.prototype.isZero=function(){return 0===this.value},b.prototype.isDivisibleBy=function(a){var b=N(a),c=b.value;return 0===c?!1:1===c?!0:2===c?this.isEven():this.mod(b).equals(Z[0])},c.prototype.isDivisibleBy=b.prototype.isDivisibleBy,b.prototype.isPrime=function(){var b=A(this);if(b!==a)return b;for(var c,d,e,f,g=this.abs(),h=g.prev(),i=[2,3,5,7,11,13,17,19],j=h;j.isEven();)j=j.divide(2);for(e=0;e<i.length;e++)if(f=bigInt(i[e]).modPow(j,g),!f.equals(Z[1])&&!f.equals(h)){for(d=!0,c=j;d&&c.lesser(h);c=c.multiply(2))f=f.square().mod(g),f.equals(h)&&(d=!1);if(d)return!1}return!0},c.prototype.isPrime=b.prototype.isPrime,b.prototype.isProbablePrime=function(b){var c=A(this);if(c!==a)return c;for(var d=this.abs(),e=b===a?5:b,f=0;e>f;f++){var g=bigInt.randBetween(2,d.minus(2));if(!g.modPow(d.prev(),d).isUnit())return!1}return!0},c.prototype.isProbablePrime=b.prototype.isProbablePrime,b.prototype.next=function(){var a=this.value;return this.sign?o(a,1,this.sign):new b(l(a,1),this.sign)},c.prototype.next=function(){var a=this.value;return Q>a+1?new c(a+1):new b(R,!1)},b.prototype.prev=function(){var a=this.value;return this.sign?new b(l(a,1),!0):o(a,1,this.sign)},c.prototype.prev=function(){var a=this.value;return a-1>-Q?new c(a-1):new b(R,!0)};for(var T=[1];T[T.length-1]<=O;)T.push(2*T[T.length-1]);var U=T.length,V=T[U-1];b.prototype.shiftLeft=function(a){if(!B(a))throw new Error(String(a)+" is too large for shifting.");if(a=+a,0>a)return this.shiftRight(-a);for(var b=this;a>=U;)b=b.multiply(V),a-=U-1;return b.multiply(T[a])},c.prototype.shiftLeft=b.prototype.shiftLeft,b.prototype.shiftRight=function(a){var b;if(!B(a))throw new Error(String(a)+" is too large for shifting.");if(a=+a,0>a)return this.shiftLeft(-a);for(var c=this;a>=U;){if(c.isZero())return c;b=y(c,V),c=b[1].isNegative()?b[0].prev():b[0],a-=U-1}return b=y(c,T[a]),b[1].isNegative()?b[0].prev():b[0]},c.prototype.shiftRight=b.prototype.shiftRight,b.prototype.not=function(){return this.negate().prev()},c.prototype.not=b.prototype.not,b.prototype.and=function(a){return C(this,a,function(a,b){return a&b})},c.prototype.and=b.prototype.and,b.prototype.or=function(a){return C(this,a,function(a,b){return a|b})},c.prototype.or=b.prototype.or,b.prototype.xor=function(a){return C(this,a,function(a,b){return a^b})},c.prototype.xor=b.prototype.xor;var W=1<<30,X=(O&-O)*(O&-O)|W,Y=function(a,b){var d=Z[0],e=Z[1],f=a.length;if(b>=2&&36>=b&&f<=S/Math.log(b))return new c(parseInt(a,b));b=N(b);var g,h=[],i="-"===a[0];for(g=i?1:0;g<a.length;g++){var j=a[g].toLowerCase(),k=j.charCodeAt(0);if(k>=48&&57>=k)h.push(N(j));else if(k>=97&&122>=k)h.push(N(j.charCodeAt(0)-87));else{if("<"!==j)throw new Error(j+" is not a valid character");var l=g;do g++;while(">"!==a[g]);h.push(N(a.slice(l+1,g)))}}for(h.reverse(),g=0;g<h.length;g++)d=d.add(h[g].times(e)),e=e.times(b);return i?d.negate():d};b.prototype.toString=function(b){if(b===a&&(b=10),10!==b)return K(this,b);for(var c,d=this.value,e=d.length,f=String(d[--e]),g="0000000";--e>=0;)c=String(d[e]),f+=g.slice(c.length)+c;var h=this.sign?"-":"";return h+f},c.prototype.toString=function(b){return b===a&&(b=10),10!=b?K(this,b):String(this.value)},b.prototype.valueOf=function(){return+this.toString()},b.prototype.toJSNumber=b.prototype.valueOf,c.prototype.valueOf=function(){return this.value},c.prototype.toJSNumber=c.prototype.valueOf;for(var Z=function(a,b){return"undefined"==typeof a?Z[0]:"undefined"!=typeof b?10===+b?N(a):Y(a,b):N(a)},$=0;1e3>$;$++)Z[$]=new c($),$>0&&(Z[-$]=new c(-$));return Z.one=Z[1],Z.zero=Z[0],Z.minusOne=Z[-1],Z.max=E,Z.min=F,Z.gcd=G,Z.lcm=H,Z.isInstance=function(a){return a instanceof b||a instanceof c},Z.randBetween=I,Z}();"undefined"!=typeof module&&module.hasOwnProperty("exports")&&(module.exports=bigInt),function(a){function b(a){function b(a,d,e){if("undefined"==typeof a&&(a=b.DEFAULT_CAPACITY),"undefined"==typeof d&&(d=b.DEFAULT_ENDIAN),"undefined"==typeof e&&(e=b.DEFAULT_NOASSERT),!e){if(a|=0,0>a)throw new RangeError("Illegal capacity: 0 <= "+a);if("boolean"!=typeof d)throw new TypeError("Illegal littleEndian: Not a boolean");if("boolean"!=typeof e)throw new TypeError("Illegal noAssert: Not a boolean")}this.buffer=0===a?c:new ArrayBuffer(a),this.view=0===a?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=a,this.littleEndian="undefined"!=typeof d?!!d:!1,this.noAssert=!!e}b.VERSION="3.1.0",b.LITTLE_ENDIAN=!0,b.BIG_ENDIAN=!1,b.DEFAULT_CAPACITY=16,b.DEFAULT_ENDIAN=b.BIG_ENDIAN,b.DEFAULT_NOASSERT=!1,b.Long=a||null;var c=new ArrayBuffer(0);b.allocate=function(a,c,d){return new b(a,c,d)},b.concat=function(a,c,d,e){("boolean"==typeof c||"string"!=typeof c)&&(e=d,d=c,c=void 0);for(var f,g=0,h=0,i=a.length;i>h;++h)b.isByteBuffer(a[h])||(a[h]=b.wrap(a[h],c)),f=a[h].limit-a[h].offset,f>0&&(g+=f);if(0===g)return new b(0,d,e);for(c=new b(g,d,e),e=new Uint8Array(c.buffer),h=0;i>h;)d=a[h++],f=d.limit-d.offset,0>=f||(e.set(new Uint8Array(d.buffer).subarray(d.offset,d.limit),c.offset),c.offset+=f);return c.limit=c.offset,c.offset=0,c},b.isByteBuffer=function(a){return a&&a instanceof b},b.type=function(){return ArrayBuffer},b.wrap=function(a,c,d,e){if("string"!=typeof c&&(e=d,d=c,c=void 0),"string"==typeof a)switch("undefined"==typeof c&&(c="utf8"),c){case"base64":return b.fromBase64(a,d);case"hex":return b.fromHex(a,d);case"binary":return b.fromBinary(a,d);case"utf8":return b.fromUTF8(a,d);case"debug":return b.fromDebug(a,d);default:throw new TypeError("Unsupported encoding: "+c)}if(null===a||"object"!=typeof a)throw new TypeError("Illegal buffer: null or non-object");if(b.isByteBuffer(a))return c=b.prototype.clone.call(a),c.markedOffset=-1,c;if(a instanceof Uint8Array)c=new b(0,d,e),0<a.length&&(c.buffer=a.buffer,c.offset=a.byteOffset,c.limit=a.byteOffset+a.length,c.view=0<a.length?new DataView(a.buffer):null);else if(a instanceof ArrayBuffer)c=new b(0,d,e),0<a.byteLength&&(c.buffer=a,c.offset=0,c.limit=a.byteLength,c.view=0<a.byteLength?new DataView(a):null);else{if("[object Array]"!==Object.prototype.toString.call(a))throw new TypeError("Illegal buffer");for(c=new b(a.length,d,e),c.limit=a.length,i=0;i<a.length;++i)c.view.setUint8(i,a[i])}return c},b.prototype.writeInt8=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setInt8(b-1,a),c&&(this.offset+=1),this},b.prototype.writeByte=b.prototype.writeInt8,b.prototype.readInt8=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}return a=this.view.getInt8(a),b&&(this.offset+=1),a},b.prototype.readByte=b.prototype.readInt8,b.prototype.writeUint8=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setUint8(b-1,a),c&&(this.offset+=1),this},b.prototype.readUint8=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}return a=this.view.getUint8(a),b&&(this.offset+=1),a},b.prototype.writeInt16=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setInt16(b-2,a,this.littleEndian),c&&(this.offset+=2),this},b.prototype.writeShort=b.prototype.writeInt16,b.prototype.readInt16=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}return a=this.view.getInt16(a,this.littleEndian),b&&(this.offset+=2),a},b.prototype.readShort=b.prototype.readInt16,b.prototype.writeUint16=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)
}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setUint16(b-2,a,this.littleEndian),c&&(this.offset+=2),this},b.prototype.readUint16=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}return a=this.view.getUint16(a,this.littleEndian),b&&(this.offset+=2),a},b.prototype.writeInt32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setInt32(b-4,a,this.littleEndian),c&&(this.offset+=4),this},b.prototype.writeInt=b.prototype.writeInt32,b.prototype.readInt32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}return a=this.view.getInt32(a,this.littleEndian),b&&(this.offset+=4),a},b.prototype.readInt=b.prototype.readInt32,b.prototype.writeUint32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setUint32(b-4,a,this.littleEndian),c&&(this.offset+=4),this},b.prototype.readUint32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}return a=this.view.getUint32(a,this.littleEndian),b&&(this.offset+=4),a},a&&(b.prototype.writeInt64=function(b,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw new TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b&&(b=a.fromNumber(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},b.prototype.writeLong=b.prototype.writeInt64,b.prototype.readInt64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}return b=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!1):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!1),c&&(this.offset+=8),b},b.prototype.readLong=b.prototype.readInt64,b.prototype.writeUint64=function(b,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw new TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b&&(b=a.fromNumber(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},b.prototype.readUint64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}return b=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!0):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!0),c&&(this.offset+=8),b}),b.prototype.writeFloat32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw new TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setFloat32(b-4,a,this.littleEndian),c&&(this.offset+=4),this},b.prototype.writeFloat=b.prototype.writeFloat32,b.prototype.readFloat32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}return a=this.view.getFloat32(a,this.littleEndian),b&&(this.offset+=4),a},b.prototype.readFloat=b.prototype.readFloat32,b.prototype.writeFloat64=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw new TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=8;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setFloat64(b-8,a,this.littleEndian),c&&(this.offset+=8),this},b.prototype.writeDouble=b.prototype.writeFloat64,b.prototype.readFloat64=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+8) <= "+this.buffer.byteLength)}return a=this.view.getFloat64(a,this.littleEndian),b&&(this.offset+=8),a},b.prototype.readDouble=b.prototype.readFloat64,b.MAX_VARINT32_BYTES=5,b.calculateVarint32=function(a){return a>>>=0,128>a?1:16384>a?2:2097152>a?3:268435456>a?4:5},b.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0},b.zigZagDecode32=function(a){return a>>>1^-(1&a)|0},b.prototype.writeVarint32=function(a,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e=b.calculateVarint32(a);c+=e;var f=this.buffer.byteLength;return c>f&&this.resize((f*=2)>c?f:c),c-=e,this.view.setUint8(c,e=128|a),a>>>=0,a>=128?(e=a>>7|128,this.view.setUint8(c+1,e),a>=16384?(e=a>>14|128,this.view.setUint8(c+2,e),a>=2097152?(e=a>>21|128,this.view.setUint8(c+3,e),a>=268435456?(this.view.setUint8(c+4,a>>28&15),e=5):(this.view.setUint8(c+3,127&e),e=4)):(this.view.setUint8(c+2,127&e),e=3)):(this.view.setUint8(c+1,127&e),e=2)):(this.view.setUint8(c,127&e),e=1),d?(this.offset+=e,this):e},b.prototype.writeVarint32ZigZag=function(a,c){return this.writeVarint32(b.zigZagEncode32(a),c)},b.prototype.readVarint32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d=0,e=0;do c=this.view.getUint8(a+d),5>d&&(e|=(127&c)<<7*d>>>0),++d;while(128===(128&c));return e|=0,b?(this.offset+=d,e):{value:e,length:d}},b.prototype.readVarint32ZigZag=function(a){return a=this.readVarint32(a),"object"==typeof a?a.value=b.zigZagDecode32(a.value):a=b.zigZagDecode32(a),a},a&&(b.MAX_VARINT64_BYTES=10,b.calculateVarint64=function(b){"number"==typeof b&&(b=a.fromNumber(b));var c=b.toInt()>>>0,d=b.shiftRightUnsigned(28).toInt()>>>0;return b=b.shiftRightUnsigned(56).toInt()>>>0,0==b?0==d?16384>c?128>c?1:2:2097152>c?3:4:16384>d?128>d?5:6:2097152>d?7:8:128>b?9:10},b.zigZagEncode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftLeft(1).xor(b.shiftRight(63)).toUnsigned()},b.zigZagDecode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftRightUnsigned(1).xor(b.and(a.ONE).toSigned().negate()).toSigned()},b.prototype.writeVarint64=function(c,d){var e="undefined"==typeof d;if(e&&(d=this.offset),!this.noAssert){if("number"==typeof c)c=a.fromNumber(c);else if(!(c&&c instanceof a))throw new TypeError("Illegal value: "+c+" (not an integer or Long)");if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}"number"==typeof c?c=a.fromNumber(c,!1):!1!==c.unsigned&&(c=c.toSigned());var f=b.calculateVarint64(c),g=c.toInt()>>>0,h=c.shiftRightUnsigned(28).toInt()>>>0,i=c.shiftRightUnsigned(56).toInt()>>>0;d+=f;var j=this.buffer.byteLength;switch(d>j&&this.resize((j*=2)>d?j:d),d-=f,f){case 10:this.view.setUint8(d+9,i>>>7&1);case 9:this.view.setUint8(d+8,9!==f?128|i:127&i);case 8:this.view.setUint8(d+7,8!==f?h>>>21|128:h>>>21&127);case 7:this.view.setUint8(d+6,7!==f?h>>>14|128:h>>>14&127);case 6:this.view.setUint8(d+5,6!==f?h>>>7|128:h>>>7&127);case 5:this.view.setUint8(d+4,5!==f?128|h:127&h);case 4:this.view.setUint8(d+3,4!==f?g>>>21|128:g>>>21&127);case 3:this.view.setUint8(d+2,3!==f?g>>>14|128:g>>>14&127);case 2:this.view.setUint8(d+1,2!==f?g>>>7|128:g>>>7&127);case 1:this.view.setUint8(d,1!==f?128|g:127&g)}return e?(this.offset+=f,this):f},b.prototype.writeVarint64ZigZag=function(a,c){return this.writeVarint64(b.zigZagEncode64(a),c)},b.prototype.readVarint64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+1) <= "+this.buffer.byteLength)}var d=b,e=0,f=0,g=0,h=0,h=this.view.getUint8(b++),e=127&h;if(128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),f=127&h,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),g=127&h,128&h&&(h=this.view.getUint8(b++),g|=(127&h)<<7,128&h))))))))))throw Error("Data must be corrupt: Buffer overrun");return e=a.from28Bits(e,f,g,!1),c?(this.offset=b,e):{value:e,length:b-d}},b.prototype.readVarint64ZigZag=function(c){return(c=this.readVarint64(c))&&c.value instanceof a?c.value=b.zigZagDecode64(c.value):c=b.zigZagDecode64(c),c}),b.prototype.writeCString=function(a,b){var c="undefined"==typeof b;c&&(b=this.offset);var d,f=a.length;if(!this.noAssert){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");for(d=0;f>d;++d)if(0===a.charCodeAt(d))throw new RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}d=b,f=e.b(e.a(a))[1],b+=f+1;var g=this.buffer.byteLength;return b>g&&this.resize((g*=2)>b?g:b),b-=f+1,e.e(e.a(a),function(a){this.view.setUint8(b++,a)}.bind(this)),this.view.setUint8(b++,0),c?(this.offset=b-d,this):f},b.prototype.readCString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d=a,f=-1;return e.d(function(){if(0===f)return null;if(a>=this.limit)throw RangeError("Illegal range: Truncated data, "+a+" < "+this.limit);return 0===(f=this.view.getUint8(a++))?null:f}.bind(this),c=e.c(),!0),b?(this.offset=a,c()):{string:c(),length:a-d}},b.prototype.writeIString=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,f=b;d=e.b(e.a(a),this.noAssert)[1],b+=4+d;var g=this.buffer.byteLength;if(b>g&&this.resize((g*=2)>b?g:b),b-=4+d,this.view.setUint32(b,d,this.littleEndian),b+=4,e.e(e.a(a),function(a){this.view.setUint8(b++,a)}.bind(this)),b!==f+4+d)throw new RangeError("Illegal range: Truncated data, "+b+" == "+(b+4+d));return c?(this.offset=b,this):b-f},b.prototype.readIString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=0,d=a,c=this.view.getUint32(a,this.littleEndian);a+=4;var f=a+c;return e.d(function(){return f>a?this.view.getUint8(a++):null}.bind(this),c=e.c(),this.noAssert),c=c(),b?(this.offset=a,c):{string:c,length:a-d}},b.METRICS_CHARS="c",b.METRICS_BYTES="b",b.prototype.writeUTF8String=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,f=b;d=e.b(e.a(a))[1],b+=d;var g=this.buffer.byteLength;return b>g&&this.resize((g*=2)>b?g:b),b-=d,e.e(e.a(a),function(a){this.view.setUint8(b++,a)}.bind(this)),c?(this.offset=b,this):b-f},b.prototype.writeString=b.prototype.writeUTF8String,b.calculateUTF8Chars=function(a){return e.b(e.a(a))[0]},b.calculateUTF8Bytes=function(a){return e.b(e.a(a))[1]},b.prototype.readUTF8String=function(a,c,d){"number"==typeof c&&(d=c,c=void 0);var f="undefined"==typeof d;if(f&&(d=this.offset),"undefined"==typeof c&&(c=b.METRICS_CHARS),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal length: "+a+" (not an integer)");if(a|=0,"number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}var g,h=0,i=d;if(c===b.METRICS_CHARS){if(g=e.c(),e.i(function(){return a>h&&d<this.limit?this.view.getUint8(d++):null}.bind(this),function(a){++h,e.g(a,g)}.bind(this)),h!==a)throw new RangeError("Illegal range: Truncated data, "+h+" == "+a);return f?(this.offset=d,g()):{string:g(),length:d-i}}if(c===b.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+a>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+"+a+") <= "+this.buffer.byteLength)}var j=d+a;if(e.d(function(){return j>d?this.view.getUint8(d++):null}.bind(this),g=e.c(),this.noAssert),d!==j)throw new RangeError("Illegal range: Truncated data, "+d+" == "+j);return f?(this.offset=d,g()):{string:g(),length:d-i}}throw new TypeError("Unsupported metrics: "+c)},b.prototype.readString=b.prototype.readUTF8String,b.prototype.writeVString=function(a,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if("number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var f,g,h=c;f=e.b(e.a(a),this.noAssert)[1],g=b.calculateVarint32(f),c+=g+f;var i=this.buffer.byteLength;if(c>i&&this.resize((i*=2)>c?i:c),c-=g+f,c+=this.writeVarint32(f,c),e.e(e.a(a),function(a){this.view.setUint8(c++,a)}.bind(this)),c!==h+f+g)throw new RangeError("Illegal range: Truncated data, "+c+" == "+(c+f+g));return d?(this.offset=c,this):c-h},b.prototype.readVString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.readVarint32(a),d=a;a+=c.length;var c=c.value,f=a+c,c=e.c();return e.d(function(){return f>a?this.view.getUint8(a++):null}.bind(this),c,this.noAssert),c=c(),b?(this.offset=a,c):{string:c,length:a-d}},b.prototype.append=function(a,c,d){("number"==typeof c||"string"!=typeof c)&&(d=c,c=void 0);var e="undefined"==typeof d;if(e&&(d=this.offset),!this.noAssert){if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}if(a instanceof b||(a=b.wrap(a,c)),c=a.limit-a.offset,0>=c)return this;d+=c;var f=this.buffer.byteLength;return d>f&&this.resize((f*=2)>d?f:d),new Uint8Array(this.buffer,d-c).set(new Uint8Array(a.buffer).subarray(a.offset,a.limit)),a.offset+=c,e&&(this.offset+=c),this},b.prototype.appendTo=function(a,b){return a.append(this,b),this},b.prototype.assert=function(a){return this.noAssert=!a,this},b.prototype.capacity=function(){return this.buffer.byteLength},b.prototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},b.prototype.clone=function(a){var c=new b(0,this.littleEndian,this.noAssert);return a?(a=new ArrayBuffer(this.buffer.byteLength),new Uint8Array(a).set(this.buffer),c.buffer=a,c.view=new DataView(a)):(c.buffer=this.buffer,c.view=this.view),c.offset=this.offset,c.markedOffset=this.markedOffset,c.limit=this.limit,c},b.prototype.compact=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(0===a&&b===this.buffer.byteLength)return this;var d=b-a;if(0===d)return this.buffer=c,this.view=null,0<=this.markedOffset&&(this.markedOffset-=a),this.limit=this.offset=0,this;var e=new ArrayBuffer(d);return new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(a,b)),this.buffer=e,this.view=new DataView(e),0<=this.markedOffset&&(this.markedOffset-=a),this.offset=0,this.limit=d,this},b.prototype.copy=function(a,c){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof c||0!==c%1)throw new TypeError("Illegal end: Not an integer");if(c>>>=0,0>a||a>c||c>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+c+" <= "+this.buffer.byteLength)}if(a===c)return new b(0,this.littleEndian,this.noAssert);var d=c-a,e=new b(d,this.littleEndian,this.noAssert);return e.offset=0,e.limit=d,0<=e.markedOffset&&(e.markedOffset-=a),this.copyTo(e,0,a,c),e},b.prototype.copyTo=function(a,c,d,e){var f,g;if(!this.noAssert&&!b.isByteBuffer(a))throw new TypeError("Illegal target: Not a ByteBuffer");if(c=(g="undefined"==typeof c)?a.offset:0|c,d=(f="undefined"==typeof d)?this.offset:0|d,e="undefined"==typeof e?this.limit:0|e,0>c||c>a.buffer.byteLength)throw new RangeError("Illegal target range: 0 <= "+c+" <= "+a.buffer.byteLength);if(0>d||e>this.buffer.byteLength)throw new RangeError("Illegal source range: 0 <= "+d+" <= "+this.buffer.byteLength);var h=e-d;return 0===h?a:(a.ensureCapacity(c+h),new Uint8Array(a.buffer).set(new Uint8Array(this.buffer).subarray(d,e),c),f&&(this.offset+=h),g&&(a.offset+=h),this)},b.prototype.ensureCapacity=function(a){var b=this.buffer.byteLength;return a>b?this.resize((b*=2)>a?b:a):this},b.prototype.fill=function(a,b,c){var d="undefined"==typeof b;if(d&&(b=this.offset),"string"==typeof a&&0<a.length&&(a=a.charCodeAt(0)),"undefined"==typeof b&&(b=this.offset),"undefined"==typeof c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal begin: Not an integer");if(b>>>=0,"number"!=typeof c||0!==c%1)throw new TypeError("Illegal end: Not an integer");if(c>>>=0,0>b||b>c||c>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(b>=c)return this;for(;c>b;)this.view.setUint8(b++,a);return d&&(this.offset=b),this},b.prototype.flip=function(){return this.limit=this.offset,this.offset=0,this},b.prototype.mark=function(a){if(a="undefined"==typeof a?this.offset:a,!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=a,this},b.prototype.order=function(a){if(!this.noAssert&&"boolean"!=typeof a)throw new TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!a,this},b.prototype.LE=function(a){return this.littleEndian="undefined"!=typeof a?!!a:!0,this},b.prototype.BE=function(a){return this.littleEndian="undefined"!=typeof a?!a:!1,this},b.prototype.prepend=function(a,c,d){("number"==typeof c||"string"!=typeof c)&&(d=c,c=void 0);var e="undefined"==typeof d;if(e&&(d=this.offset),!this.noAssert){if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}if(a instanceof b||(a=b.wrap(a,c)),c=a.limit-a.offset,0>=c)return this;var f,g=c-d;if(g>0){var h=new ArrayBuffer(this.buffer.byteLength+g);f=new Uint8Array(h),f.set(new Uint8Array(this.buffer).subarray(d,this.buffer.byteLength),c),this.buffer=h,this.view=new DataView(h),this.offset+=g,0<=this.markedOffset&&(this.markedOffset+=g),this.limit+=g,d+=g}else f=new Uint8Array(this.buffer);return f.set(new Uint8Array(a.buffer).subarray(a.offset,a.limit),d-c),a.offset=a.limit,e&&(this.offset-=c),this},b.prototype.prependTo=function(a,b){return a.prepend(this,b),this},b.prototype.printDebug=function(a){"function"!=typeof a&&(a=console.log.bind(console)),a(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},b.prototype.remaining=function(){return this.limit-this.offset},b.prototype.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},b.prototype.resize=function(a){if(!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal capacity: "+a+" (not an integer)");if(a|=0,0>a)throw new RangeError("Illegal capacity: 0 <= "+a)}return this.buffer.byteLength<a&&(a=new ArrayBuffer(a),new Uint8Array(a).set(new Uint8Array(this.buffer)),this.buffer=a,this.view=new DataView(a)),this},b.prototype.reverse=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}return a===b?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(a,b)),this.view=new DataView(this.buffer),this)},b.prototype.skip=function(a){if(!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal length: "+a+" (not an integer)");a|=0}var b=this.offset+a;if(!this.noAssert&&(0>b||b>this.buffer.byteLength))throw new RangeError("Illegal length: 0 <= "+this.offset+" + "+a+" <= "+this.buffer.byteLength);return this.offset=b,this},b.prototype.slice=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c=this.clone();return c.offset=a,c.limit=b,c},b.prototype.toBuffer=function(a){var b=this.offset,d=this.limit;if(b>d)var e=b,b=d,d=e;if(!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: Not an integer");if(b>>>=0,"number"!=typeof d||0!==d%1)throw new TypeError("Illegal limit: Not an integer");if(d>>>=0,0>b||b>d||d>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+b+" <= "+d+" <= "+this.buffer.byteLength)}return a||0!==b||d!==this.buffer.byteLength?b===d?c:(a=new ArrayBuffer(d-b),new Uint8Array(a).set(new Uint8Array(this.buffer).subarray(b,d),0),a):this.buffer},b.prototype.toArrayBuffer=b.prototype.toBuffer,b.prototype.toString=function(a){if("undefined"==typeof a)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch(a){case"utf8":return this.toUTF8();case"base64":return this.toBase64();case"hex":return this.toHex();case"binary":return this.toBinary();case"debug":return this.toDebug();case"columns":return this.o();default:throw Error("Unsupported encoding: "+a)}};var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=d+"";b.prototype.toBase64=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return"";for(var c,e,f,g,h,i,j="";b>a;)c=this.view.getUint8(a++),e=(g=b>a)?this.view.getUint8(a++):0,f=(h=b>a)?this.view.getUint8(a++):0,i=c>>2,c=(3&c)<<4|e>>4,e=(15&e)<<2|f>>6,f&=63,h||(f=64,g||(e=64)),j+=d.charAt(i)+d.charAt(c)+d.charAt(e)+d.charAt(f);return j},b.fromBase64=function(a,c,e){if(!e){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if(0!==a.length%4)throw new TypeError("Illegal str: Length not a multiple of 4")}var f,g=a.length,h=0;for(f=a.length-1;f>=0&&"="===a.charAt(f);--f)h++;if(h>2)throw new TypeError("Illegal str: Suffix is too large");if(0===g)return new b(0,c,e);var i,j,k,l=new b(g/4*3-h,c,e);for(c=f=0;g>f;){if(h=d.indexOf(a.charAt(f++)),i=g>f?d.indexOf(a.charAt(f++)):0,j=g>f?d.indexOf(a.charAt(f++)):0,k=g>f?d.indexOf(a.charAt(f++)):0,!e&&(0>h||0>i||0>j||0>k))throw new TypeError("Illegal str: Contains non-base64 characters");l.view.setUint8(c++,h<<2|i>>4),64!==j&&(l.view.setUint8(c++,i<<4&240|j>>2,c),64!==k&&l.view.setUint8(c++,j<<6&192|k))}return l.limit=c,l},b.btoa=function(a){return b.fromBinary(a).toBase64()},b.atob=function(a){return b.fromBase64(a).toBinary()},b.prototype.toBinary=function(a,b){if(a="undefined"==typeof a?this.offset:a,b="undefined"==typeof b?this.limit:b,!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return"";for(var c=[];b>a;)c.push(this.view.getUint8(a++));return String.fromCharCode.apply(String,c)},b.fromBinary=function(a,c,d){if(!d&&"string"!=typeof a)throw new TypeError("Illegal str: Not a string");for(var e=0,f=a.length,g=new b(f,c,d);f>e;){if(c=a.charCodeAt(e),!d&&c>255)throw new TypeError("Illegal charCode at "+e+": 0 <= "+c+" <= 255");g.view.setUint8(e++,c)}return g.limit=f,g},b.prototype.toDebug=function(a){for(var b,c=-1,d=this.buffer.byteLength,e="",f="",g="";d>c;){if(-1!==c&&(b=this.view.getUint8(c),e=16>b?e+("0"+b.toString(16).toUpperCase()):e+b.toString(16).toUpperCase(),a&&(f+=b>32&&127>b?String.fromCharCode(b):".")),++c,a&&c>0&&0===c%16&&c!==d){for(;51>e.length;)e+=" ";g+=e+f+"\n",e=f=""}e=c===this.offset&&c===this.limit?e+(c===this.markedOffset?"!":"|"):c===this.offset?e+(c===this.markedOffset?"[":"<"):c===this.limit?e+(c===this.markedOffset?"]":">"):e+(c===this.markedOffset?"'":a||0!==c&&c!==d?" ":"")}if(a&&" "!==e){for(;51>e.length;)e+=" ";g+=e+f+"\n"}return a?g:e},b.fromDebug=function(a,c,d){var e=a.length;c=new b((e+1)/3|0,c,d);for(var f,g=0,h=0,i=!1,j=!1,k=!1,l=!1,m=!1;e>g;){switch(f=a.charAt(g++)){case"!":if(!d){if(j||k||l){m=!0;break}j=k=l=!0}c.offset=c.markedOffset=c.limit=h,i=!1;break;case"|":if(!d){if(j||l){m=!0;break}j=l=!0}c.offset=c.limit=h,i=!1;break;case"[":if(!d){if(j||k){m=!0;break}j=k=!0}c.offset=c.markedOffset=h,i=!1;break;case"<":if(!d){if(j){m=!0;break}j=!0}c.offset=h,i=!1;break;case"]":if(!d){if(l||k){m=!0;break}l=k=!0}c.limit=c.markedOffset=h,i=!1;break;case">":if(!d){if(l){m=!0;break}l=!0}c.limit=h,i=!1;break;case"'":if(!d){if(k){m=!0;break}k=!0}c.markedOffset=h,i=!1;break;case" ":i=!1;break;default:if(!d&&i){m=!0;break}if(f=parseInt(f+a.charAt(g++),16),!d&&(isNaN(f)||0>f||f>255))throw new TypeError("Illegal str: Not a debug encoded string");c.view.setUint8(h++,f),i=!0}if(m)throw new TypeError("Illegal str: Invalid symbol at "+g)}if(!d){if(!j||!l)throw new TypeError("Illegal str: Missing offset or limit");if(h<c.buffer.byteLength)throw new TypeError("Illegal str: Not a debug encoded string (is it hex?) "+h+" < "+e)}return c},b.prototype.toHex=function(a,b){if(a="undefined"==typeof a?this.offset:a,b="undefined"==typeof b?this.limit:b,!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}for(var c,d=Array(b-a);b>a;)c=this.view.getUint8(a++),16>c?d.push("0",c.toString(16)):d.push(c.toString(16));
return d.join("")},b.fromHex=function(a,c,d){if(!d){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if(0!==a.length%2)throw new TypeError("Illegal str: Length not a multiple of 2")}var e=a.length;c=new b(e/2|0,c);for(var f,g=0,h=0;e>g;g+=2){if(f=parseInt(a.substring(g,g+2),16),!d&&(!isFinite(f)||0>f||f>255))throw new TypeError("Illegal str: Contains non-hex characters");c.view.setUint8(h++,f)}return c.limit=h,c};var e=function(){var a={j:function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)128>c?b(127&c):(2048>c?b(c>>6&31|192):(65536>c?b(c>>12&15|224):(b(c>>18&7|240),b(c>>12&63|128)),b(c>>6&63|128)),b(63&c|128)),c=null},i:function(a,b){function c(a){a=a.slice(0,a.indexOf(null));var b=Error(a.toString());throw b.name="TruncatedError",b.bytes=a,b}for(var d,e,f,g;null!==(d=a());)if(0===(128&d))b(d);else if(192===(224&d))null===(e=a())&&c([d,e]),b((31&d)<<6|63&e);else if(224===(240&d))null!==(e=a())&&null!==(f=a())||c([d,e,f]),b((15&d)<<12|(63&e)<<6|63&f);else{if(240!==(248&d))throw RangeError("Illegal starting byte: "+d);null!==(e=a())&&null!==(f=a())&&null!==(g=a())||c([d,e,f,g]),b((7&d)<<18|(63&e)<<12|(63&f)<<6|63&g)}},f:function(a,b){for(var c,d=null;null!==(c=null!==d?d:a());)c>=55296&&57343>=c&&null!==(d=a())&&d>=56320&&57343>=d?(b(1024*(c-55296)+d-56320+65536),d=null):b(c);null!==d&&b(d)},g:function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)65535>=c?b(c):(c-=65536,b((c>>10)+55296),b(c%1024+56320)),c=null},e:function(b,c){a.f(b,function(b){a.j(b,c)})},d:function(b,c){a.i(b,function(b){a.g(b,c)})},k:function(a){if("number"!=typeof a||a!==a)throw TypeError("Illegal byte: "+typeof a);if(-128>a||a>255)throw RangeError("Illegal byte: "+a);return a},l:function(a){if("number"!=typeof a||a!==a)throw TypeError("Illegal char code: "+typeof a);if(0>a||a>65535)throw RangeError("Illegal char code: "+a);return a},m:function(a){if("number"!=typeof a||a!==a)throw TypeError("Illegal code point: "+typeof a);if(0>a||a>1114111)throw RangeError("Illegal code point: "+a);return a},h:function(a){return 128>a?1:2048>a?2:65536>a?3:4},n:function(b){for(var c,d=0;null!==(c=b());)d+=a.h(c);return d},b:function(b){var c=0,d=0;return a.f(b,function(b){++c,d+=a.h(b)}),[c,d]}};return a}(),f=String.fromCharCode;return e.a=function(a){var b=0;return function(){return b<a.length?a.charCodeAt(b++):null}},e.c=function(){var a=[],b=[];return function(){return 0===arguments.length?b.join("")+f.apply(String,a):(1024<a.length+arguments.length&&(b.push(f.apply(String,a)),a.length=0),void Array.prototype.push.apply(a,arguments))}},b.prototype.toUTF8=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c,d=this;try{e.d(function(){return b>a?d.view.getUint8(a++):null},c=e.c())}catch(f){if(a!==b)throw new RangeError("Illegal range: Truncated data, "+a+" != "+b)}return c()},b.fromUTF8=function(a,c,d){if(!d&&"string"!=typeof a)throw new TypeError("Illegal str: Not a string");var f=new b(e.b(e.a(a),!0)[1],c,d),g=0;return e.e(e.a(a),function(a){f.view.setUint8(g++,a)}),f.limit=g,f},b}CL.configs.ua.indexOf("msie 9.0")>-1||CL.configs.ua.indexOf("msie 8.0")>-1||CL.configs.ua.indexOf("msie 7.0")>-1||("undefined"!=typeof module&&module.exports?module.exports=b(require("long")):"undefined"!=typeof define&&define.amd?define("ByteBuffer",["Math/Long"],function(a){return b(a)}):(a.dcodeIO||(a.dcodeIO={}),a.dcodeIO.ByteBuffer=b(a.dcodeIO.Long)))}(this),function(a){function b(a){if(!a||!a.VERSION||3>a.VERSION.split(".")[0])throw Error("ProtoBuf.js requires ByteBuffer.js >=3");var b={VERSION:"3.1.0",WIRE_TYPES:{}};return b.WIRE_TYPES.VARINT=0,b.WIRE_TYPES.BITS64=1,b.WIRE_TYPES.LDELIM=2,b.WIRE_TYPES.STARTGROUP=3,b.WIRE_TYPES.ENDGROUP=4,b.WIRE_TYPES.BITS32=5,b.PACKABLE_WIRE_TYPES=[b.WIRE_TYPES.VARINT,b.WIRE_TYPES.BITS64,b.WIRE_TYPES.BITS32],b.TYPES={int32:{name:"int32",wireType:b.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:b.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:b.WIRE_TYPES.VARINT},int64:{name:"int64",wireType:b.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:b.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:b.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:b.WIRE_TYPES.VARINT},"double":{name:"double",wireType:b.WIRE_TYPES.BITS64},string:{name:"string",wireType:b.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:b.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:b.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:b.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:b.WIRE_TYPES.BITS64},sfixed64:{name:"sfixed64",wireType:b.WIRE_TYPES.BITS64},"float":{name:"float",wireType:b.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:b.WIRE_TYPES.VARINT},message:{name:"message",wireType:b.WIRE_TYPES.LDELIM},group:{name:"group",wireType:b.WIRE_TYPES.STARTGROUP}},b.ID_MIN=1,b.ID_MAX=536870911,b.ByteBuffer=a,b.Long=a.Long||null,b.convertFieldsToCamelCase=!1,b.Util=function(){Object.create||(Object.create=function(a){function b(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");return b.prototype=a,new b});var a={IS_NODE:!1};try{a.IS_NODE="function"==typeof require&&"function"==typeof require("fs").readFileSync&&"function"==typeof require("path").resolve}catch(b){}return a.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=null,c=0;c<a.length;c++){try{b=a[c]()}catch(d){continue}break}if(!b)throw Error("XMLHttpRequest is not supported");return b},a.fetch=function(b,c){if(c&&"function"!=typeof c&&(c=null),a.IS_NODE)if(c)require("fs").readFile(b,function(a,b){c(a?null:""+b)});else try{return require("fs").readFileSync(b)}catch(d){return null}else{var e=a.XHR();if(e.open("GET",b,c?!0:!1),e.setRequestHeader("Accept","text/plain"),"function"==typeof e.overrideMimeType&&e.overrideMimeType("text/plain"),!c)return e.send(null),200==e.status||0==e.status&&"string"==typeof e.responseText?e.responseText:null;e.onreadystatechange=function(){4==e.readyState&&c(200==e.status||0==e.status&&"string"==typeof e.responseText?e.responseText:null)},4!=e.readyState&&e.send(null)}},a.isArray=function(a){return a?a instanceof Array?!0:Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a):!1},a}(),b.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"=",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i},b.DotProto=function(a,b){var c={},d=function(a){this.source=""+a,this.index=0,this.line=1,this.stack=[],this.readingString=!1,this.stringEndsWith=b.STRINGCLOSE};d.prototype._readString=function(){b.STRING.lastIndex=this.index-1;var a;if(null!==(a=b.STRING.exec(this.source)))return a=a[1],this.index=b.STRING.lastIndex,this.stack.push(this.stringEndsWith),a;throw Error("Illegal string value at line "+this.line+", index "+this.index)},d.prototype.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var a,c;do{for(a=!1;b.WHITESPACE.test(c=this.source.charAt(this.index));)if(this.index++,"\n"===c&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++,this.line++,a=!0}else{if("*"!==this.source.charAt(this.index))throw Error("Invalid comment at line "+this.line+": /"+this.source.charAt(this.index)+" ('/' or '*' expected)");for(c="";"*/"!==c+(c=this.source.charAt(this.index));)if(this.index++,"\n"===c&&this.line++,this.index===this.source.length)return null;this.index++,a=!0}}while(a);if(this.index===this.source.length)return null;if(a=this.index,b.DELIM.lastIndex=0,b.DELIM.test(this.source.charAt(a)))a++;else for(a++;a<this.source.length&&!b.DELIM.test(this.source.charAt(a));)a++;return a=this.source.substring(this.index,this.index=a),a===b.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=b.STRINGCLOSE):a===b.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=b.STRINGCLOSE_SQ),a},d.prototype.peek=function(){if(0===this.stack.length){var a=this.next();if(null===a)return null;this.stack.push(a)}return this.stack[0]},d.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"},c.Tokenizer=d;var e=function(a){this.tn=new d(a)};return e.prototype.parse=function(){for(var a,b={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},c=!0;a=this.tn.next();)switch(a){case"package":if(!c)throw Error("Illegal package definition at line "+this.tn.line+": Must be declared before the first message or enum");if(null!==b["package"])throw Error("Illegal package definition at line "+this.tn.line+": Package already declared");b["package"]=this._parsePackage(a);break;case"import":if(!c)throw Error("Illegal import definition at line "+this.tn.line+": Must be declared before the first message or enum");b.imports.push(this._parseImport(a));break;case"message":this._parseMessage(b,null,a),c=!1;break;case"enum":this._parseEnum(b,a),c=!1;break;case"option":if(!c)throw Error("Illegal option definition at line "+this.tn.line+": Must be declared before the first message or enum");this._parseOption(b,a);break;case"service":this._parseService(b,a);break;case"extend":this._parseExtend(b,a);break;case"syntax":this._parseIgnoredStatement(b,a);break;default:throw Error("Illegal top level declaration at line "+this.tn.line+": "+a)}return delete b.name,b},e.prototype._parseNumber=function(a){var c=1;if("-"==a.charAt(0)&&(c=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))return c*parseInt(a,10);if(b.NUMBER_HEX.test(a))return c*parseInt(a.substring(2),16);if(b.NUMBER_OCT.test(a))return c*parseInt(a.substring(1),8);if(b.NUMBER_FLT.test(a))return c*parseFloat(a);throw Error("Illegal number value at line "+this.tn.line+": "+(0>c?"-":"")+a)},e.prototype._parseId=function(a,c){var d=-1,e=1;if("-"==a.charAt(0)&&(e=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))d=parseInt(a);else if(b.NUMBER_HEX.test(a))d=parseInt(a.substring(2),16);else{if(!b.NUMBER_OCT.test(a))throw Error("Illegal ID value at line "+this.tn.line+": "+(0>e?"-":"")+a);d=parseInt(a.substring(1),8)}if(d=e*d|0,!c&&0>d)throw Error("Illegal ID range at line "+this.tn.line+": "+(0>e?"-":"")+a);return d},e.prototype._parsePackage=function(a){if(a=this.tn.next(),!b.TYPEREF.test(a))throw Error("Illegal package name at line "+this.tn.line+": "+a);var c=a;if(a=this.tn.next(),a!=b.END)throw Error("Illegal end of package definition at line "+this.tn.line+": "+a+" ('"+b.END+"' expected)");return c},e.prototype._parseImport=function(a){if(a=this.tn.next(),"public"===a&&(a=this.tn.next()),a!==b.STRINGOPEN&&a!==b.STRINGOPEN_SQ)throw Error("Illegal begin of import value at line "+this.tn.line+": "+a+" ('"+b.STRINGOPEN+"' or '"+b.STRINGOPEN_SQ+"' expected)");var c=this.tn.next();if(a=this.tn.next(),a!==this.tn.stringEndsWith)throw Error("Illegal end of import value at line "+this.tn.line+": "+a+" ('"+this.tn.stringEndsWith+"' expected)");if(a=this.tn.next(),a!==b.END)throw Error("Illegal end of import definition at line "+this.tn.line+": "+a+" ('"+b.END+"' expected)");return c},e.prototype._parseOption=function(a,c){c=this.tn.next();var d=!1;if(c==b.COPTOPEN&&(d=!0,c=this.tn.next()),!b.TYPEREF.test(c)&&!/google\.protobuf\./.test(c))throw Error("Illegal option name in message "+a.name+" at line "+this.tn.line+": "+c);var e=c;if(c=this.tn.next(),d){if(c!==b.COPTCLOSE)throw Error("Illegal custom option name delimiter in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTCLOSE+"' expected)");e="("+e+")",c=this.tn.next(),b.FQTYPEREF.test(c)&&(e+=c,c=this.tn.next())}if(c!==b.EQUAL)throw Error("Illegal option operator in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+b.EQUAL+"' expected)");if(c=this.tn.next(),c===b.STRINGOPEN||c===b.STRINGOPEN_SQ){if(d=this.tn.next(),c=this.tn.next(),c!==this.tn.stringEndsWith)throw Error("Illegal end of option value in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+this.tn.stringEndsWith+"' expected)")}else if(b.NUMBER.test(c))d=this._parseNumber(c,!0);else{if(!b.TYPEREF.test(c))throw Error("Illegal option value in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c);d=c}if(c=this.tn.next(),c!==b.END)throw Error("Illegal end of option in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+b.END+"' expected)");a.options[e]=d},e.prototype._parseIgnoredStatement=function(a,c){for(var d;;){if(d=this.tn.next(),null===d)throw Error("Unexpected EOF in "+a.name+", "+c+" (ignored) at line "+this.tn.line);if(d===b.END)break}},e.prototype._parseService=function(a){var c=this.tn.next();if(!b.NAME.test(c))throw Error("Illegal service name at line "+this.tn.line+": "+c);var d=c,e={name:d,rpc:{},options:{}},c=this.tn.next();if(c!==b.OPEN)throw Error("Illegal OPEN after service "+d+" at line "+this.tn.line+": "+c+" ('"+b.OPEN+"' expected)");do if(c=this.tn.next(),"option"===c)this._parseOption(e,c);else if("rpc"===c)this._parseServiceRPC(e,c);else if(c!==b.CLOSE)throw Error("Illegal type for service "+d+" at line "+this.tn.line+": "+c);while(c!==b.CLOSE);a.services.push(e)},e.prototype._parseServiceRPC=function(a,c){var d=c;if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal RPC method name in service "+a.name+" at line "+this.tn.line+": "+c);var e=c,f={request:null,response:null,options:{}};if(c=this.tn.next(),c!==b.COPTOPEN)throw Error("Illegal start of request type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTOPEN+"' expected)");if(c=this.tn.next(),!b.TYPEREF.test(c))throw Error("Illegal request type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(f.request=c,c=this.tn.next(),c!=b.COPTCLOSE)throw Error("Illegal end of request type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTCLOSE+"' expected)");if(c=this.tn.next(),"returns"!==c.toLowerCase())throw Error("Illegal request/response delimiter in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('returns' expected)");if(c=this.tn.next(),c!=b.COPTOPEN)throw Error("Illegal start of response type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTOPEN+"' expected)");if(c=this.tn.next(),f.response=c,c=this.tn.next(),c!==b.COPTCLOSE)throw Error("Illegal end of response type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTCLOSE+"' expected)");if(c=this.tn.next(),c===b.OPEN){do if(c=this.tn.next(),"option"===c)this._parseOption(f,c);else if(c!==b.CLOSE)throw Error("Illegal start of option in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('option' expected)");while(c!==b.CLOSE);this.tn.peek()===b.END&&this.tn.next()}else if(c!==b.END)throw Error("Illegal method delimiter in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.END+"' or '"+b.OPEN+"' expected)");"undefined"==typeof a[d]&&(a[d]={}),a[d][e]=f},e.prototype._parseMessage=function(a,c,d){var e={},f="group"===d;if(d=this.tn.next(),!b.NAME.test(d))throw Error("Illegal "+(f?"group":"message")+" name"+(a?" in message "+a.name:"")+" at line "+this.tn.line+": "+d);if(e.name=d,f){if(d=this.tn.next(),d!==b.EQUAL)throw Error("Illegal id assignment after group "+e.name+" at line "+this.tn.line+": "+d+" ('"+b.EQUAL+"' expected)");d=this.tn.next();try{c.id=this._parseId(d)}catch(g){throw Error("Illegal field id value for group "+e.name+"#"+c.name+" at line "+this.tn.line+": "+d)}e.isGroup=!0}if(e.fields=[],e.enums=[],e.messages=[],e.options={},d=this.tn.next(),d===b.OPTOPEN&&c&&(this._parseFieldOptions(e,c,d),d=this.tn.next()),d!==b.OPEN)throw Error("Illegal OPEN after "+(f?"group":"message")+" "+e.name+" at line "+this.tn.line+": "+d+" ('"+b.OPEN+"' expected)");for(;;){if(d=this.tn.next(),d===b.CLOSE){d=this.tn.peek(),d===b.END&&this.tn.next();break}if(b.RULE.test(d))this._parseMessageField(e,d);else if("enum"===d)this._parseEnum(e,d);else if("message"===d)this._parseMessage(e,null,d);else if("option"===d)this._parseOption(e,d);else if("extensions"===d)e.extensions=this._parseExtensions(e,d);else{if("extend"!==d)throw Error("Illegal token in message "+e.name+" at line "+this.tn.line+": "+d+" (type or '"+b.CLOSE+"' expected)");this._parseExtend(e,d)}}return a.messages.push(e),e},e.prototype._parseMessageField=function(a,c){var d={},e=null;if(d.rule=c,d.options={},c=this.tn.next(),"group"===c){if(e=this._parseMessage(a,d,c),!/^[A-Z]/.test(e.name))throw Error("Group names must start with a capital letter");d.type=e.name,d.name=e.name.toLowerCase(),c=this.tn.peek(),c===b.END&&this.tn.next()}else{if(!b.TYPE.test(c)&&!b.TYPEREF.test(c))throw Error("Illegal field type in message "+a.name+" at line "+this.tn.line+": "+c);if(d.type=c,c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal field name in message "+a.name+" at line "+this.tn.line+": "+c);if(d.name=c,c=this.tn.next(),c!==b.EQUAL)throw Error("Illegal field id assignment in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c+" ('"+b.EQUAL+"' expected)");c=this.tn.next();try{d.id=this._parseId(c)}catch(f){throw Error("Illegal field id value in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c)}if(c=this.tn.next(),c===b.OPTOPEN&&(this._parseFieldOptions(a,d,c),c=this.tn.next()),c!==b.END)throw Error("Illegal field delimiter in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c+" ('"+b.END+"' expected)")}a.fields.push(d)},e.prototype._parseFieldOptions=function(a,c,d){for(var e=!0;d=this.tn.next(),d!==b.OPTCLOSE;){if(d===b.OPTEND){if(e)throw Error("Illegal start of message field options in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);d=this.tn.next()}this._parseFieldOption(a,c,d),e=!1}},e.prototype._parseFieldOption=function(a,c,d){var e=!1;if(d===b.COPTOPEN&&(d=this.tn.next(),e=!0),!b.TYPEREF.test(d))throw Error("Illegal field option in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);var f=d;if(d=this.tn.next(),e){if(d!==b.COPTCLOSE)throw Error("Illegal custom field option name delimiter in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d+" (')' expected)");f="("+f+")",d=this.tn.next(),b.FQTYPEREF.test(d)&&(f+=d,d=this.tn.next())}if(d!==b.EQUAL)throw Error("Illegal field option operation in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d+" ('=' expected)");if(d=this.tn.next(),d===b.STRINGOPEN||d===b.STRINGOPEN_SQ){if(e=this.tn.next(),d=this.tn.next(),d!=this.tn.stringEndsWith)throw Error("Illegal end of field value in message "+a.name+"#"+c.name+", option "+f+" at line "+this.tn.line+": "+d+" ('"+this.tn.stringEndsWith+"' expected)")}else if(b.NUMBER.test(d,!0))e=this._parseNumber(d,!0);else if(b.BOOL.test(d))e="true"===d.toLowerCase();else{if(!b.TYPEREF.test(d))throw Error("Illegal field option value in message "+a.name+"#"+c.name+", option "+f+" at line "+this.tn.line+": "+d);e=d}c.options[f]=e},e.prototype._parseEnum=function(a,c){var d={};if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal enum name in message "+a.name+" at line "+this.tn.line+": "+c);if(d.name=c,c=this.tn.next(),c!==b.OPEN)throw Error("Illegal OPEN after enum "+d.name+" at line "+this.tn.line+": "+c);for(d.values=[],d.options={};;){if(c=this.tn.next(),c===b.CLOSE){c=this.tn.peek(),c===b.END&&this.tn.next();break}if("option"==c)this._parseOption(d,c);else{if(!b.NAME.test(c))throw Error("Illegal enum value name in enum "+d.name+" at line "+this.tn.line+": "+c);this._parseEnumValue(d,c)}}a.enums.push(d)},e.prototype._parseEnumValue=function(a,c){var d={};if(d.name=c,c=this.tn.next(),c!==b.EQUAL)throw Error("Illegal enum value operator in enum "+a.name+" at line "+this.tn.line+": "+c+" ('"+b.EQUAL+"' expected)");c=this.tn.next();try{d.id=this._parseId(c,!0)}catch(e){throw Error("Illegal enum value id in enum "+a.name+" at line "+this.tn.line+": "+c)}if(a.values.push(d),c=this.tn.next(),c===b.OPTOPEN&&(this._parseFieldOptions(a,{options:{}},c),c=this.tn.next()),c!==b.END)throw Error("Illegal enum value delimiter in enum "+a.name+" at line "+this.tn.line+": "+c+" ('"+b.END+"' expected)")},e.prototype._parseExtensions=function(c,d){var e=[];if(d=this.tn.next(),e.push("min"===d?a.ID_MIN:"max"===d?a.ID_MAX:this._parseNumber(d)),d=this.tn.next(),"to"!==d)throw"Illegal extensions delimiter in message "+c.name+" at line "+this.tn.line+" ('to' expected)";if(d=this.tn.next(),e.push("min"===d?a.ID_MIN:"max"===d?a.ID_MAX:this._parseNumber(d)),d=this.tn.next(),d!==b.END)throw Error("Illegal extension delimiter in message "+c.name+" at line "+this.tn.line+": "+d+" ('"+b.END+"' expected)");return e},e.prototype._parseExtend=function(a,c){if(c=this.tn.next(),!b.TYPEREF.test(c))throw Error("Illegal extended message name at line "+this.tn.line+": "+c);var d={};if(d.ref=c,d.fields=[],c=this.tn.next(),c!==b.OPEN)throw Error("Illegal OPEN in extend "+d.name+" at line "+this.tn.line+": "+c+" ('"+b.OPEN+"' expected)");for(;;){if(c=this.tn.next(),c===b.CLOSE){c=this.tn.peek(),c==b.END&&this.tn.next();break}if(!b.RULE.test(c))throw Error("Illegal token in extend "+d.name+" at line "+this.tn.line+": "+c+" (rule or '"+b.CLOSE+"' expected)");this._parseMessageField(d,c)}return a.messages.push(d),d},e.prototype.toString=function(){return"Parser"},c.Parser=e,c}(b,b.Lang),b.Reflect=function(b){function c(a,d){var e=d.readVarint32(),f=7&e,e=e>>3;switch(f){case b.WIRE_TYPES.VARINT:do e=d.readUint8();while(128===(128&e));break;case b.WIRE_TYPES.BITS64:d.offset+=8;break;case b.WIRE_TYPES.LDELIM:e=d.readVarint32(),d.offset+=e;break;case b.WIRE_TYPES.STARTGROUP:c(e,d);break;case b.WIRE_TYPES.ENDGROUP:if(e===a)return!1;throw Error("Illegal GROUPEND after unknown group: "+e+" ("+a+" expected)");case b.WIRE_TYPES.BITS32:d.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+a+": "+f)}return!0}function d(a,c){if(a&&"number"==typeof a.low&&"number"==typeof a.high&&"boolean"==typeof a.unsigned&&a.low===a.low&&a.high===a.high)return new b.Long(a.low,a.high,"undefined"==typeof c?a.unsigned:c);if("string"==typeof a)return b.Long.fromString(a,c||!1,10);if("number"==typeof a)return b.Long.fromNumber(a,c||!1);throw Error("not convertible to Long")}var e={},f=function(a,b){this.parent=a,this.name=b};f.prototype.fqn=function(){for(var a=this.name,b=this;b=b.parent,null!=b;)a=b.name+"."+a;return a},f.prototype.toString=function(a){return(a?this.className+" ":"")+this.fqn()},f.prototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},e.T=f;var g=function(a,b,c){f.call(this,a,b),this.className="Namespace",this.children=[],this.options=c||{}};g.prototype=Object.create(f.prototype),g.prototype.getChildren=function(a){if(a=a||null,null==a)return this.children.slice();for(var b=[],c=0;c<this.children.length;c++)this.children[c]instanceof a&&b.push(this.children[c]);return b},g.prototype.addChild=function(a){var b;if(b=this.getChild(a.name))if(b instanceof h.Field&&b.name!==b.originalName&&!this.hasChild(b.originalName))b.name=b.originalName;else{if(!(a instanceof h.Field&&a.name!==a.originalName)||this.hasChild(a.originalName))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+a.name);a.name=a.originalName}this.children.push(a)},g.prototype.hasChild=function(a){return-1<this._indexOf(a)},g.prototype.getChild=function(a){return a=this._indexOf(a),a>-1?this.children[a]:null},g.prototype._indexOf=function(a){for(var b="number"==typeof a?"id":"name",c=0;c<this.children.length;c++)if("undefined"!=typeof this.children[c][b]&&this.children[c][b]==a)return c;return-1},g.prototype.resolve=function(a,b){var c=a.split("."),d=this,f=0;if(""==c[f]){for(;null!=d.parent;)d=d.parent;f++}do{do{if(d=d.getChild(c[f]),!(d&&d instanceof e.T)||b&&d instanceof e.Message.Field){d=null;break}f++}while(f<c.length);if(null!=d)break;if(null!==this.parent)return this.parent.resolve(a,b)}while(null!=d);return d},g.prototype.build=function(){for(var a,b={},c=this.getChildren(),d=0;d<c.length;d++)a=c[d],a instanceof g&&(b[a.name]=a.build());return Object.defineProperty&&Object.defineProperty(b,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),b},g.prototype.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0;c<b.length;c++)a[b[c]]=this.options[b[c]];return a},g.prototype.getOption=function(a){return"undefined"==typeof a?this.options:"undefined"!=typeof this.options[a]?this.options[a]:null},e.Namespace=g;var h=function(a,c,d,e){g.call(this,a,c,d),this.className="Message",this.extensions=[b.ID_MIN,b.ID_MAX],this.clazz=null,this.isGroup=!!e};h.prototype=Object.create(g.prototype),h.prototype.build=function(c){if(this.clazz&&!c)return this.clazz;c=function(b,c){function d(b,c){var e,f={};for(e in b)b.hasOwnProperty(e)&&(null===b[e]||"object"!=typeof b[e]?f[e]=b[e]:b[e]instanceof a?c&&(f[e]=b.toBuffer()):f[e]=d(b[e],c));return f}var e=c.getChildren(b.Reflect.Message.Field),f=function(c){b.Builder.Message.call(this);var d,f;for(d=0;d<e.length;d++)f=e[d],this[f.name]=f.repeated?[]:null;for(d=0;d<e.length;d++)if(f=e[d],"undefined"!=typeof f.options["default"])try{this.$set(f.name,f.options["default"])}catch(g){throw Error("[INTERNAL] "+g)}if(1!=arguments.length||"object"!=typeof c||"function"==typeof c.encode||b.Util.isArray(c)||c instanceof a||c instanceof ArrayBuffer||b.Long&&c instanceof b.Long)for(d=0;d<arguments.length;d++)d<e.length&&this.$set(e[d].name,arguments[d]);else for(f=Object.keys(c),d=0;d<f.length;d++)this.$set(f[d],c[f[d]])};f.prototype=Object.create(b.Builder.Message.prototype),f.prototype.add=function(a,d,e){var f=c.getChild(a);if(!f)throw Error(this+"#"+a+" is undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));if(!f.repeated)throw Error(this+"#"+a+" is not a repeated field");null===this[f.name]&&(this[f.name]=[]),this[f.name].push(e?d:f.verifyValue(d,!0))},f.prototype.$add=f.prototype.add,f.prototype.set=function(a,d,e){var f=c.getChild(a);if(!f)throw Error(this+"#"+a+" is not a field: undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));this[f.name]=e?d:f.verifyValue(d)},f.prototype.$set=f.prototype.set,f.prototype.get=function(a){var d=c.getChild(a);if(!(d&&d instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: undefined");if(!(d instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+d.toString(!0));return this[d.name]},f.prototype.$get=f.prototype.get;for(var g=0;g<e.length;g++)(function(a){var b=a.originalName.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")}),b=b.substring(0,1).toUpperCase()+b.substring(1),d=a.originalName.replace(/([A-Z])/g,function(a){return"_"+a});c.hasChild("set"+b)||(f.prototype["set"+b]=function(b){this.$set(a.name,b)}),c.hasChild("set_"+d)||(f.prototype["set_"+d]=function(b){this.$set(a.name,b)}),c.hasChild("get"+b)||(f.prototype["get"+b]=function(){return this.$get(a.name)}),c.hasChild("get_"+d)||(f.prototype["get_"+d]=function(){return this.$get(a.name)})})(e[g]);return f.prototype.encode=function(b){var d=!1;b||(b=new a,d=!0);var e=b.littleEndian;try{return c.encode(this,b.LE()),(d?b.flip():b).LE(e)}catch(f){throw b.LE(e),f}},f.prototype.encodeDelimited=function(b){var d=!1;b||(b=new a,d=!0);try{var e=(new a).LE();return c.encode(this,e).flip(),b.writeVarint32(e.remaining()),b.append(e),d?b.flip():b}catch(f){throw f}},f.prototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toArrayBuffer()),a}},f.prototype.toArrayBuffer=f.prototype.encodeAB,f.prototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBuffer()),a}},f.prototype.toBuffer=f.prototype.encodeNB,f.prototype.encode64=function(){try{return this.encode().toBase64()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBase64()),a}},f.prototype.toBase64=f.prototype.encode64,f.prototype.encodeHex=function(){try{return this.encode().toHex()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toHex()),a}},f.prototype.toHex=f.prototype.encodeHex,f.prototype.toRaw=function(a){return d(this,!!a)},f.decode=function(b,d){if(null===b)throw Error("buffer must not be null");"string"==typeof b&&(b=a.wrap(b,d?d:"base64")),b=b instanceof a?b:a.wrap(b);var e=b.littleEndian;try{var f=c.decode(b.LE());return b.LE(e),f}catch(g){throw b.LE(e),g}},f.decodeDelimited=function(b,d){if(null===b)throw Error("buffer must not be null");"string"==typeof b&&(b=a.wrap(b,d?d:"base64")),b=b instanceof a?b:a.wrap(b);var e=b.readVarint32(),f=c.decode(b.slice(b.offset,b.offset+e).LE());return b.offset+=e,f},f.decode64=function(a){return f.decode(a,"base64")},f.decodeHex=function(a){return f.decode(a,"hex")},f.prototype.toString=function(){return c.toString()},Object.defineProperty&&Object.defineProperty(f,"$options",{value:c.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),f}(b,this);for(var d=this.getChildren(),e=0;e<d.length;e++)if(d[e]instanceof j)c[d[e].name]=d[e].build();else if(d[e]instanceof h)c[d[e].name]=d[e].build();else if(!(d[e]instanceof h.Field))throw Error("Illegal reflect child of "+this.toString(!0)+": "+d[e].toString(!0));return this.clazz=c},h.prototype.encode=function(a,b){for(var c=this.getChildren(h.Field),d=null,e=0;e<c.length;e++){var f=a.$get(c[e].name);c[e].required&&null===f?null===d&&(d=c[e]):c[e].encode(f,b)}if(null!==d)throw c=Error("Missing at least one required field for "+this.toString(!0)+": "+d),c.encoded=b,c;return b},h.prototype.decode=function(a,d,e){d="number"==typeof d?d:-1;for(var f,g,h=a.offset,i=new this.clazz;a.offset<h+d||-1==d&&0<a.remaining();){if(f=a.readVarint32(),g=7&f,f>>=3,g===b.WIRE_TYPES.ENDGROUP){if(f!==e)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+f+" ("+(e?e+" expected":"not a group")+")");break}var j=this.getChild(f);if(j)j.repeated&&!j.options.packed?i.$add(j.name,j.decode(g,a),!0):i.$set(j.name,j.decode(g,a),!0);else switch(g){case b.WIRE_TYPES.VARINT:a.readVarint32();break;case b.WIRE_TYPES.BITS32:a.offset+=4;break;case b.WIRE_TYPES.BITS64:a.offset+=8;break;case b.WIRE_TYPES.LDELIM:g=a.readVarint32(),a.offset+=g;break;case b.WIRE_TYPES.STARTGROUP:for(;c(f,a););break;default:throw Error("Illegal wire type for unknown field "+f+" in "+this.toString(!0)+"#decode: "+g)}}for(a=this.getChildren(b.Reflect.Field),d=0;d<a.length;d++)if(a[d].required&&null===i[a[d].name])throw a=Error("Missing at least one required field for "+this.toString(!0)+": "+a[d].name),a.decoded=i,a;return i},e.Message=h;
var i=function(a,c,d,e,g,h){f.call(this,a,e),this.className="Message.Field",this.required="required"==c,this.repeated="repeated"==c,this.type=d,this.resolvedType=null,this.id=g,this.options=h||{},this.originalName=this.name,b.convertFieldsToCamelCase&&(this.name=this.name.replace(/_([a-zA-Z])/g,function(a,b){return b.toUpperCase()}))};i.prototype=Object.create(f.prototype),i.prototype.verifyValue=function(c,e){e=e||!1;var f=function(a,b){throw Error("Illegal value for "+this.toString(!0)+": "+a+" ("+b+")")}.bind(this);if(null===c)return this.required&&f(typeof c,"required"),null;var g;if(this.repeated&&!e){for(b.Util.isArray(c)||(c=[c]),f=[],g=0;g<c.length;g++)f.push(this.verifyValue(c[g],!0));return f}switch(!this.repeated&&b.Util.isArray(c)&&f(typeof c,"no array expected"),this.type){case b.TYPES.int32:case b.TYPES.sint32:case b.TYPES.sfixed32:return("number"!=typeof c||c===c&&0!==c%1)&&f(typeof c,"not an integer"),c>4294967295?0|c:c;case b.TYPES.uint32:case b.TYPES.fixed32:return("number"!=typeof c||c===c&&0!==c%1)&&f(typeof c,"not an integer"),0>c?c>>>0:c;case b.TYPES.int64:case b.TYPES.sint64:case b.TYPES.sfixed64:if(b.Long)try{return d(c,!1)}catch(h){f(typeof c,h.message)}case b.TYPES.uint64:case b.TYPES.fixed64:if(b.Long)try{return d(c,!0)}catch(i){f(typeof c,i.message)}case b.TYPES.bool:return"boolean"!=typeof c&&f(typeof c,"not a boolean"),c;case b.TYPES["float"]:case b.TYPES["double"]:return"number"!=typeof c&&f(typeof c,"not a number"),c;case b.TYPES.string:return"string"==typeof c||c&&c instanceof String||f(typeof c,"not a string"),""+c;case b.TYPES.bytes:return c&&c instanceof a?c:a.wrap(c);case b.TYPES["enum"]:var k=this.resolvedType.getChildren(j.Value);for(g=0;g<k.length;g++)if(k[g].name==c||k[g].id==c)return k[g].id;f(c,"not a valid enum value");case b.TYPES.group:case b.TYPES.message:return c&&"object"==typeof c||f(typeof c,"object expected"),c instanceof this.resolvedType.clazz?c:new this.resolvedType.clazz(c)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+c+" (undefined type "+this.type+")")},i.prototype.encode=function(c,d){if(c=this.verifyValue(c),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return d;try{if(this.repeated){var e;if(this.options.packed&&0<=b.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){d.writeVarint32(this.id<<3|b.WIRE_TYPES.LDELIM),d.ensureCapacity(d.offset+=1);var f=d.offset;for(e=0;e<c.length;e++)this.encodeValue(c[e],d);var g=d.offset-f,h=a.calculateVarint32(g);if(h>1){var i=d.slice(f,d.offset),f=f+(h-1);d.offset=f,d.append(i)}d.writeVarint32(g,f-h)}else for(e=0;e<c.length;e++)d.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(c[e],d)}else d.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(c,d)}catch(j){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+j+")")}return d},i.prototype.encodeValue=function(c,d){if(null!==c){switch(this.type){case b.TYPES.int32:0>c?d.writeVarint64(c):d.writeVarint32(c);break;case b.TYPES.uint32:d.writeVarint32(c);break;case b.TYPES.sint32:d.writeVarint32ZigZag(c);break;case b.TYPES.fixed32:d.writeUint32(c);break;case b.TYPES.sfixed32:d.writeInt32(c);break;case b.TYPES.int64:case b.TYPES.uint64:d.writeVarint64(c);break;case b.TYPES.sint64:d.writeVarint64ZigZag(c);break;case b.TYPES.fixed64:d.writeUint64(c);break;case b.TYPES.sfixed64:d.writeInt64(c);break;case b.TYPES.bool:d.writeVarint32("string"==typeof c?"false"===c.toLowerCase()?0:!!c:c?1:0);break;case b.TYPES["enum"]:d.writeVarint32(c);break;case b.TYPES["float"]:d.writeFloat32(c);break;case b.TYPES["double"]:d.writeFloat64(c);break;case b.TYPES.string:d.writeVString(c);break;case b.TYPES.bytes:c.offset>c.length&&(d=d.clone().flip());var e=c.offset;d.writeVarint32(c.remaining()),d.append(c),c.offset=e;break;case b.TYPES.message:e=(new a).LE(),this.resolvedType.encode(c,e),d.writeVarint32(e.offset),d.append(e.flip());break;case b.TYPES.group:this.resolvedType.encode(c,d),d.writeVarint32(this.id<<3|b.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+c+" (unknown type)")}return d}},i.prototype.decode=function(a,c,d){if(a!=this.type.wireType&&(d||a!=b.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+a+" ("+this.type.wireType+" expected)");if(a==b.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&!d){for(a=c.readVarint32(),a=c.offset+a,d=[];c.offset<a;)d.push(this.decode(this.type.wireType,c,!0));return d}switch(this.type){case b.TYPES.int32:return 0|c.readVarint32();case b.TYPES.uint32:return c.readVarint32()>>>0;case b.TYPES.sint32:return 0|c.readVarint32ZigZag();case b.TYPES.fixed32:return c.readUint32()>>>0;case b.TYPES.sfixed32:return 0|c.readInt32();case b.TYPES.int64:return c.readVarint64();case b.TYPES.uint64:return c.readVarint64().toUnsigned();case b.TYPES.sint64:return c.readVarint64ZigZag();case b.TYPES.fixed64:return c.readUint64();case b.TYPES.sfixed64:return c.readInt64();case b.TYPES.bool:return!!c.readVarint32();case b.TYPES["enum"]:return c.readVarint32();case b.TYPES["float"]:return c.readFloat();case b.TYPES["double"]:return c.readDouble();case b.TYPES.string:return c.readVString();case b.TYPES.bytes:if(a=c.readVarint32(),c.remaining()<a)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+a+" required but got only "+c.remaining());return d=c.clone(),d.limit=d.offset+a,c.offset+=a,d;case b.TYPES.message:return a=c.readVarint32(),this.resolvedType.decode(c,a);case b.TYPES.group:return this.resolvedType.decode(c,-1,this.id)}throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+a)},e.Message.Field=i;var j=function(a,b,c){g.call(this,a,b,c),this.className="Enum",this.object=null};j.prototype=Object.create(g.prototype),j.prototype.build=function(){for(var a={},b=this.getChildren(j.Value),c=0;c<b.length;c++)a[b[c].name]=b[c].id;return Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),this.object=a},e.Enum=j,i=function(a,b,c){f.call(this,a,b),this.className="Enum.Value",this.id=c},i.prototype=Object.create(f.prototype),e.Enum.Value=i,i=function(a,b,c){g.call(this,a,b,c),this.className="Service",this.clazz=null},i.prototype=Object.create(g.prototype),i.prototype.build=function(a){return this.clazz&&!a?this.clazz:this.clazz=function(a,b){var c=function(b){a.Builder.Service.call(this),this.rpcImpl=b||function(a,b,c){setTimeout(c.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}};c.prototype=Object.create(a.Builder.Service.prototype),Object.defineProperty&&(Object.defineProperty(c,"$options",{value:b.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(c.prototype,"$options",{value:c.$options,enumerable:!1,configurable:!1,writable:!1}));for(var d=b.getChildren(a.Reflect.Service.RPCMethod),e=0;e<d.length;e++)(function(a){c.prototype[a.name]=function(c,d){try{c&&c instanceof a.resolvedRequestType.clazz||setTimeout(d.bind(this,Error("Illegal request type provided to service method "+b.name+"#"+a.name)),0),this.rpcImpl(a.fqn(),c,function(c,e){if(c)d(c);else{try{e=a.resolvedResponseType.clazz.decode(e)}catch(f){}e&&e instanceof a.resolvedResponseType.clazz?d(null,e):d(Error("Illegal response type received in service method "+b.name+"#"+a.name))}})}catch(e){setTimeout(d.bind(this,e),0)}},c[a.name]=function(b,d,e){new c(b)[a.name](d,e)},Object.defineProperty&&(Object.defineProperty(c[a.name],"$options",{value:a.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(c.prototype[a.name],"$options",{value:c[a.name].$options,enumerable:!1,configurable:!1,writable:!1}))})(d[e]);return c}(b,this)},e.Service=i;var k=function(a,b,c){f.call(this,a,b),this.className="Service.Method",this.options=c||{}};return k.prototype=Object.create(f.prototype),k.prototype.buildOpt=g.prototype.buildOpt,e.Service.Method=k,i=function(a,b,c,d,e){k.call(this,a,b,e),this.className="Service.RPCMethod",this.requestName=c,this.responseName=d,this.resolvedResponseType=this.resolvedRequestType=null},i.prototype=Object.create(k.prototype),e.Service.RPCMethod=i,e}(b),b.Builder=function(a,b,c){var d=function(){this.ptr=this.ns=new c.Namespace(null,""),this.resolved=!1,this.result=null,this.files={},this.importRoot=null};return d.prototype.reset=function(){this.ptr=this.ns},d.prototype.define=function(a,d){if("string"!=typeof a||!b.TYPEREF.test(a))throw Error("Illegal package name: "+a);var e,f=a.split(".");for(e=0;e<f.length;e++)if(!b.NAME.test(f[e]))throw Error("Illegal package name: "+f[e]);for(e=0;e<f.length;e++)this.ptr.hasChild(f[e])||this.ptr.addChild(new c.Namespace(this.ptr,f[e],d)),this.ptr=this.ptr.getChild(f[e]);return this},d.isValidMessage=function(c){if("string"!=typeof c.name||!b.NAME.test(c.name)||"undefined"!=typeof c.values||"undefined"!=typeof c.rpc)return!1;var e;if("undefined"!=typeof c.fields){if(!a.Util.isArray(c.fields))return!1;var f,g=[];for(e=0;e<c.fields.length;e++){if(!d.isValidMessageField(c.fields[e]))return!1;if(f=parseInt(c.fields[e].id,10),0<=g.indexOf(f))return!1;g.push(f)}}if("undefined"!=typeof c.enums){if(!a.Util.isArray(c.enums))return!1;for(e=0;e<c.enums.length;e++)if(!d.isValidEnum(c.enums[e]))return!1}if("undefined"!=typeof c.messages){if(!a.Util.isArray(c.messages))return!1;for(e=0;e<c.messages.length;e++)if(!d.isValidMessage(c.messages[e])&&!d.isValidExtend(c.messages[e]))return!1}return"undefined"==typeof c.extensions||a.Util.isArray(c.extensions)&&2===c.extensions.length&&"number"==typeof c.extensions[0]&&"number"==typeof c.extensions[1]?!0:!1},d.isValidMessageField=function(a){if("string"!=typeof a.rule||"string"!=typeof a.name||"string"!=typeof a.type||"undefined"==typeof a.id||!(b.RULE.test(a.rule)&&b.NAME.test(a.name)&&b.TYPEREF.test(a.type)&&b.ID.test(""+a.id)))return!1;if("undefined"!=typeof a.options){if("object"!=typeof a.options)return!1;for(var c,d=Object.keys(a.options),e=0;e<d.length;e++)if("string"!=typeof(c=d[e])||"string"!=typeof a.options[c]&&"number"!=typeof a.options[c]&&"boolean"!=typeof a.options[c])return!1}return!0},d.isValidEnum=function(c){if("string"!=typeof c.name||!b.NAME.test(c.name)||"undefined"==typeof c.values||!a.Util.isArray(c.values)||0==c.values.length)return!1;for(var d=0;d<c.values.length;d++)if("object"!=typeof c.values[d]||"string"!=typeof c.values[d].name||"undefined"==typeof c.values[d].id||!b.NAME.test(c.values[d].name)||!b.NEGID.test(""+c.values[d].id))return!1;return!0},d.prototype.create=function(b){if(b&&(a.Util.isArray(b)||(b=[b]),0!=b.length)){var e,f,g,h,i,j=[];for(j.push(b);0<j.length;){if(b=j.pop(),!a.Util.isArray(b))throw Error("Not a valid namespace definition: "+JSON.stringify(b));for(;0<b.length;)if(e=b.shift(),d.isValidMessage(e)){if(f=new c.Message(this.ptr,e.name,e.options,e.isGroup),e.fields&&0<e.fields.length)for(h=0;h<e.fields.length;h++){if(f.hasChild(e.fields[h].id))throw Error("Duplicate field id in message "+f.name+": "+e.fields[h].id);if(e.fields[h].options)for(g=Object.keys(e.fields[h].options),i=0;i<g.length;i++){if("string"!=typeof g[i])throw Error("Illegal field option name in message "+f.name+"#"+e.fields[h].name+": "+g[i]);if("string"!=typeof e.fields[h].options[g[i]]&&"number"!=typeof e.fields[h].options[g[i]]&&"boolean"!=typeof e.fields[h].options[g[i]])throw Error("Illegal field option value in message "+f.name+"#"+e.fields[h].name+"#"+g[i]+": "+e.fields[h].options[g[i]])}f.addChild(new c.Message.Field(f,e.fields[h].rule,e.fields[h].type,e.fields[h].name,e.fields[h].id,e.fields[h].options))}if(g=[],"undefined"!=typeof e.enums&&0<e.enums.length)for(h=0;h<e.enums.length;h++)g.push(e.enums[h]);if(e.messages&&0<e.messages.length)for(h=0;h<e.messages.length;h++)g.push(e.messages[h]);e.extensions&&(f.extensions=e.extensions,f.extensions[0]<a.ID_MIN&&(f.extensions[0]=a.ID_MIN),f.extensions[1]>a.ID_MAX&&(f.extensions[1]=a.ID_MAX)),this.ptr.addChild(f),0<g.length&&(j.push(b),b=g,this.ptr=f)}else if(d.isValidEnum(e)){for(f=new c.Enum(this.ptr,e.name,e.options),h=0;h<e.values.length;h++)f.addChild(new c.Enum.Value(f,e.values[h].name,e.values[h].id));this.ptr.addChild(f)}else if(d.isValidService(e)){f=new c.Service(this.ptr,e.name,e.options);for(h in e.rpc)e.rpc.hasOwnProperty(h)&&f.addChild(new c.Service.RPCMethod(f,h,e.rpc[h].request,e.rpc[h].response,e.rpc[h].options));this.ptr.addChild(f)}else{if(!d.isValidExtend(e))throw Error("Not a valid message, enum, service or extend definition: "+JSON.stringify(e));if(f=this.ptr.resolve(e.ref))for(h=0;h<e.fields.length;h++){if(f.hasChild(e.fields[h].id))throw Error("Duplicate extended field id in message "+f.name+": "+e.fields[h].id);if(e.fields[h].id<f.extensions[0]||e.fields[h].id>f.extensions[1])throw Error("Illegal extended field id in message "+f.name+": "+e.fields[h].id+" ("+f.extensions.join(" to ")+" expected)");f.addChild(new c.Message.Field(f,e.fields[h].rule,e.fields[h].type,e.fields[h].name,e.fields[h].id,e.fields[h].options))}else if(!/\.?google\.protobuf\./.test(e.ref))throw Error("Extended message "+e.ref+" is not defined")}this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this}},d.isValidImport=function(a){return!/google\/protobuf\//.test(a)},d.prototype["import"]=function(b,c){if("string"==typeof c){if(a.Util.IS_NODE&&(c=require("path").resolve(c)),this.files[c])return this.reset(),this;this.files[c]=!0}if(b.imports&&0<b.imports.length){var e,f="/",g=!1;"object"==typeof c?(this.importRoot=c.root,g=!0,e=this.importRoot,c=c.file,(0<=e.indexOf("\\")||0<=c.indexOf("\\"))&&(f="\\")):"string"==typeof c?this.importRoot?e=this.importRoot:0<=c.indexOf("/")?(e=c.replace(/\/[^\/]*$/,""),""===e&&(e="/")):0<=c.indexOf("\\")?(e=c.replace(/\\[^\\]*$/,""),f="\\"):e=".":e=null;for(var h=0;h<b.imports.length;h++)if("string"==typeof b.imports[h]){if(!e)throw Error("Cannot determine import root: File name is unknown");var i=e+f+b.imports[h];if(d.isValidImport(i)){/\.proto$/i.test(i)&&!a.DotProto&&(i=i.replace(/\.proto$/,".json"));var j=a.Util.fetch(i);if(null===j)throw Error("Failed to import '"+i+"' in '"+c+"': File not found");/\.json$/i.test(i)?this["import"](JSON.parse(j+""),i):this["import"](new a.DotProto.Parser(j+"").parse(),i)}}else c?/\.(\w+)$/.test(c)?this["import"](b.imports[h],c.replace(/^(.+)\.(\w+)$/,function(a,b,c){return b+"_import"+h+"."+c})):this["import"](b.imports[h],c+"_import"+h):this["import"](b.imports[h]);g&&(this.importRoot=null)}return b.messages&&(b["package"]&&this.define(b["package"],b.options),this.create(b.messages),this.reset()),b.enums&&(b["package"]&&this.define(b["package"],b.options),this.create(b.enums),this.reset()),b.services&&(b["package"]&&this.define(b["package"],b.options),this.create(b.services),this.reset()),b["extends"]&&(b["package"]&&this.define(b["package"],b.options),this.create(b["extends"]),this.reset()),this},d.isValidService=function(a){return!("string"!=typeof a.name||!b.NAME.test(a.name)||"object"!=typeof a.rpc)},d.isValidExtend=function(c){if("string"!=typeof c.ref||!b.TYPEREF.test(c.name))return!1;var e;if("undefined"!=typeof c.fields){if(!a.Util.isArray(c.fields))return!1;var f,g=[];for(e=0;e<c.fields.length;e++){if(!d.isValidMessageField(c.fields[e]))return!1;if(f=parseInt(c.id,10),0<=g.indexOf(f))return!1;g.push(f)}}return!0},d.prototype.resolveAll=function(){var d;if(null!=this.ptr&&"object"!=typeof this.ptr.type){if(this.ptr instanceof c.Namespace){d=this.ptr.getChildren();for(var e=0;e<d.length;e++)this.ptr=d[e],this.resolveAll()}else if(this.ptr instanceof c.Message.Field)if(b.TYPE.test(this.ptr.type))this.ptr.type=a.TYPES[this.ptr.type];else{if(!b.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(d=this.ptr.parent.resolve(this.ptr.type,!0),!d)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=d,d instanceof c.Enum)this.ptr.type=a.TYPES["enum"];else{if(!(d instanceof c.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=d.isGroup?a.TYPES.group:a.TYPES.message}}else if(!(this.ptr instanceof a.Reflect.Enum.Value)){if(!(this.ptr instanceof a.Reflect.Service.Method))throw Error("Illegal object type in namespace: "+typeof this.ptr+":"+this.ptr);if(!(this.ptr instanceof a.Reflect.Service.RPCMethod))throw Error("Illegal service method type in "+this.ptr.toString(!0));if(d=this.ptr.parent.resolve(this.ptr.requestName),!(d&&d instanceof a.Reflect.Message))throw Error("Illegal request type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=d,d=this.ptr.parent.resolve(this.ptr.responseName),!(d&&d instanceof a.Reflect.Message))throw Error("Illegal response type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=d}this.reset()}},d.prototype.build=function(a){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null==this.result&&(this.result=this.ns.build()),a){a=a.split(".");for(var b=this.result,c=0;c<a.length;c++){if(!b[a[c]]){b=null;break}b=b[a[c]]}return b}return this.result},d.prototype.lookup=function(a){return a?this.ns.resolve(a):this.ns},d.prototype.toString=function(){return"Builder"},d.Message=function(){},d.Service=function(){},d}(b,b.Lang,b.Reflect),b.loadProto=function(a,c,d){return("string"==typeof c||c&&"string"==typeof c.file&&"string"==typeof c.root)&&(d=c,c=null),b.loadJson(new b.DotProto.Parser(a+"").parse(),c,d)},b.protoFromString=b.loadProto,b.loadProtoFile=function(a,c,d){if(c&&"object"==typeof c?(d=c,c=null):c&&"function"==typeof c||(c=null),!c){var e=b.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null!==e?b.protoFromString(e,d,a):null}b.Util.fetch("object"==typeof a?a.root+"/"+a.file:a,function(e){c(b.loadProto(e,d,a))})},b.protoFromFile=b.loadProtoFile,b.newBuilder=function(a,c){var d=new b.Builder;return"undefined"!=typeof a&&null!==a&&d.define(a,c),d},b.loadJson=function(a,c,d){return("string"==typeof c||c&&"string"==typeof c.file&&"string"==typeof c.root)&&(d=c,c=null),c&&"object"==typeof c||(c=b.newBuilder()),"string"==typeof a&&(a=JSON.parse(a)),c["import"](a,d),c.resolveAll(),c.build(),c},b.loadJsonFile=function(a,c,d){if(c&&"object"==typeof c?(d=c,c=null):c&&"function"==typeof c||(c=null),!c){var e=b.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null!==e?b.loadJson(JSON.parse(e),d,a):null}b.Util.fetch("object"==typeof a?a.root+"/"+a.file:a,function(e){try{c(b.loadJson(JSON.parse(e),d,a))}catch(f){c(f)}})},b}CL.configs.ua.indexOf("msie 9.0")>-1||CL.configs.ua.indexOf("msie 8.0")>-1||CL.configs.ua.indexOf("msie 7.0")>-1||("undefined"!=typeof module&&module.exports?module.exports=b(require("bytebuffer")):"function"==typeof define&&define.amd?define("ProtoBuf",["ByteBuffer"],b):(a.dcodeIO||(a.dcodeIO={}),a.dcodeIO.ProtoBuf=b(a.dcodeIO.ByteBuffer)))}(this);var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var f=CryptoJS,g=f.lib,h=g.WordArray,i=g.Hasher,g=f.algo,j=[],k=0;64>k;k++)j[k]=4294967296*a.abs(a.sin(k+1))|0;g=g.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),f.MD5=i._createHelper(g),f.HmacMD5=i._createHmacHelper(g)}(Math),function(){var a=CryptoJS,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),f=d.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&e.update(i);var i=e.update(a).finalize(b);e.reset();for(var j=1;c>j;j++)i=e.finalize(i),e.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return e.create(c).compute(a,b)}}(),CryptoJS.lib.Cipher||function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc.Base64,h=b.algo.EvpKDF,i=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?o:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?o:n).decrypt(a,b,c,d)}}}});c.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var j=b.mode={},k=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]},l=(c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();l.Encryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;k.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),l.Decryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),k.call(this,a,b,d),this._prevBlock=e}}),j=j.CBC=l,l=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;c>g;g+=4)f.push(d);c=e.create(f,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},c.BlockCipher=i.extend({cfg:i.cfg.extend({mode:j,padding:l}),reset:function(){i.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var m=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),j=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?e.create([1398893684,1701076831]).concat(a).concat(b):b).toString(g)},parse:function(a){a=g.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return m.create({ciphertext:a,salt:c})}},n=c.SerializableCipher=d.extend({cfg:d.extend({format:j}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,m.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=e.random(8)),a=h.create({keySize:b+c}).compute(a,d),c=e.create(a.words.slice(b),4*c),a.sigBytes=4*b,m.create({key:a,iv:c,salt:d})}},o=c.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=n.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,n.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=CryptoJS,b=a.lib.BlockCipher,c=a.algo,d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=0;256>o;o++)n[o]=128>o?o<<1:o<<1^283;for(var p=0,q=0,o=0;256>o;o++){var r=q^q<<1^q<<2^q<<3^q<<4,r=r>>>8^255&r^99;d[p]=r,e[r]=p;var s=n[p],t=n[s],u=n[t],v=257*n[r]^16843008*r;f[p]=v<<24|v>>>8,g[p]=v<<16|v>>>16,h[p]=v<<8|v>>>24,i[p]=v,v=16843009*u^65537*t^257*s^16843008*p,j[r]=v<<24|v>>>8,k[r]=v<<16|v>>>16,l[r]=v<<8|v>>>24,m[r]=v,p?(p=s^n[n[n[u^s]]],q^=n[n[q]]):p=q=1}var w=[0,1,2,4,8,16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),e=this._keySchedule=[],f=0;a>f;f++)if(c>f)e[f]=b[f];else{var g=e[f-1];f%c?c>6&&4==f%c&&(g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g]):(g=g<<8|g>>>24,g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g],g^=w[f/c|0]<<24),e[f]=e[f-c]^g}for(b=this._invKeySchedule=[],c=0;a>c;c++)f=a-c,g=c%4?e[f]:e[f-4],b[c]=4>c||4>=f?g:j[d[g>>>24]]^k[d[g>>>16&255]]^l[d[g>>>8&255]]^m[d[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,f,g,h,i,d)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,j,k,l,m,e),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m
},keySize:8});a.AES=b._createHelper(c)}();var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===f?62:b===g?63:h>b?-1:h+10>b?b-h+26+26:j+26>b?b-j:i+26>b?b-i+26:void 0}function c(a){function c(a){j[l++]=a}var d,f,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new e(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,f=0;g>d;d+=4,f+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function d(a){function b(a){return lookup.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var d,e,f,g=a.length%3,h="";for(d=0,f=a.length-g;f>d;d+=3)e=(a[d]<<16)+(a[d+1]<<8)+a[d+2],h+=c(e);switch(g){case 1:e=a[a.length-1],h+=b(e>>2),h+=b(e<<4&63),h+="==";break;case 2:e=(a[a.length-2]<<8)+a[a.length-1],h+=b(e>>10),h+=b(e>>4&63),h+=b(e<<2&63),h+="="}return h}var e="undefined"!=typeof Uint8Array?Uint8Array:Array,f="+".charCodeAt(0),g="/".charCodeAt(0),h="0".charCodeAt(0),i="a".charCodeAt(0),j="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=d}("undefined"==typeof exports?this.base64js={}:exports),!function(a){var b=this;"object"==typeof exports?module.exports=a(b):"function"==typeof define&&define.amd?define([],function(){return a(b)}):b.jDataView=a(b)}(function(a){"use strict";function b(a,b){return!b&&a instanceof Array?a:Array.prototype.slice.call(a)}function c(a,b){return void 0!==a?a:b}function d(a,b,e,f){if(a instanceof d){var g=a.slice(b,b+e);return g._littleEndian=c(f,g._littleEndian),g}if(!(this instanceof d))return new d(a,b,e,f);if(this.buffer=a=d.wrapBuffer(a),this._isArrayBuffer=i.ArrayBuffer&&a instanceof ArrayBuffer,this._isPixelData=!0&&i.PixelData&&a instanceof CanvasPixelArray,this._isDataView=i.DataView&&this._isArrayBuffer,this._isNodeBuffer=!1,!(this._isArrayBuffer||this._isPixelData||a instanceof Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!f;var h="byteLength"in a?a.byteLength:a.length;this.byteOffset=b=c(b,0),this.byteLength=e=c(e,h-b),this._offset=this._bitOffset=0,this._isDataView?this._view=new DataView(a,b,e):this._checkBounds(b,e,h),this._engineAction=this._isDataView?this._dataViewAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function e(a){for(var b=i.ArrayBuffer?Uint8Array:Array,c=new b(a.length),d=0,e=a.length;e>d;d++)c[d]=255&a.charCodeAt(d);return c}function f(a){return a>=0&&31>a?1<<a:f[a]||(f[a]=Math.pow(2,a))}function g(a,b){this.lo=a,this.hi=b}function h(){g.apply(this,arguments)}var i={NodeBuffer:!1,DataView:"DataView"in a,ArrayBuffer:"ArrayBuffer"in a,PixelData:!0&&"CanvasPixelArray"in a&&"ImageData"in a&&"document"in a},j=a.TextEncoder,k=a.TextDecoder;if(i.PixelData){var l=function(a,b){var c=l.context2d.createImageData((a+3)/4,1).data;if(c.byteLength=a,void 0!==b)for(var d=0;a>d;d++)c[d]=b[d];return c};l.context2d=document.createElement("canvas").getContext("2d")}var m={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8};d.wrapBuffer=function(a){switch(typeof a){case"number":if(i.ArrayBuffer)a=new Uint8Array(a).buffer;else if(i.PixelData)a=l(a);else{a=new Array(a);for(var c=0;c<a.length;c++)a[c]=0}return a;case"string":a=e(a);default:return"length"in a&&!(i.ArrayBuffer&&a instanceof ArrayBuffer||i.PixelData&&a instanceof CanvasPixelArray)&&(i.ArrayBuffer?a instanceof ArrayBuffer||(a=new Uint8Array(a).buffer,a instanceof ArrayBuffer||(a=new Uint8Array(b(a,!0)).buffer)):a=i.PixelData?l(a.length,a):b(a)),a}},d.createBuffer=function(){return d.wrapBuffer(arguments)},d.Uint64=g,g.prototype={valueOf:function(){return this.lo+f(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},g.fromNumber=function(a){var b=Math.floor(a/f(32)),c=a-b*f(32);return new g(c,b)},d.Int64=h,h.prototype="create"in Object?Object.create(g.prototype):new g,h.prototype.valueOf=function(){return this.hi<f(31)?g.prototype.valueOf.apply(this,arguments):-(f(32)-this.lo+f(32)*(f(32)-1-this.hi))},h.fromNumber=function(a){var b,c;if(a>=0){var d=g.fromNumber(a);b=d.lo,c=d.hi}else c=Math.floor(a/f(32)),b=a-c*f(32),c+=f(32);return new h(b,c)};var n=d.prototype={compatibility:i,_checkBounds:function(a,b,d){if("number"!=typeof a)throw new TypeError("Offset is not a number.");if("number"!=typeof b)throw new TypeError("Size is not a number.");if(0>b)throw new RangeError("Length is negative.");if(0>a||a+b>c(d,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(a,b,d,e,f){return this._engineAction(a,b,c(d,this._offset),c(e,this._littleEndian),f)},_dataViewAction:function(a,b,c,d,e){return this._offset=c+m[a],b?this._view["get"+a](c,d):this._view["set"+a](c,e,d)},_arrayBufferAction:function(b,d,e,f,g){var h,i=m[b],j=a[b+"Array"];if(f=c(f,this._littleEndian),1===i||(this.byteOffset+e)%i===0&&f)return h=new j(this.buffer,this.byteOffset+e,1),this._offset=e+i,d?h[0]:h[0]=g;var k=new Uint8Array(d?this.getBytes(i,e,f,!0):i);return h=new j(k.buffer,0,1),d?h[0]:(h[0]=g,void this._setBytes(e,k,f))},_arrayAction:function(a,b,c,d,e){return b?this["_get"+a](c,d):this["_set"+a](c,e,d)},_getBytes:function(a,d,e){e=c(e,this._littleEndian),d=c(d,this._offset),a=c(a,this.byteLength-d),this._checkBounds(d,a),d+=this.byteOffset,this._offset=d-this.byteOffset+a;var f=this._isArrayBuffer?new Uint8Array(this.buffer,d,a):(this.buffer.slice||Array.prototype.slice).call(this.buffer,d,d+a);return e||1>=a?f:b(f).reverse()},getBytes:function(a,d,e,f){var g=this._getBytes(a,d,c(e,!0));return f?b(g):g},_setBytes:function(a,d,e){var f=d.length;if(0!==f){if(e=c(e,this._littleEndian),a=c(a,this._offset),this._checkBounds(a,f),!e&&f>1&&(d=b(d,!0).reverse()),a+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,a,f).set(d);else for(var g=0;f>g;g++)this.buffer[a+g]=d[g];this._offset=a-this.byteOffset+f}},setBytes:function(a,b,d){this._setBytes(a,b,c(d,!0))},getString:function(a,b,c){var d=this._getBytes(a,b,!0);if(c="utf8"===c?"utf-8":c||"binary",k&&"binary"!==c)return new k(c).decode(this._isArrayBuffer?d:new Uint8Array(d));var e="";a=d.length;for(var f=0;a>f;f++)e+=String.fromCharCode(d[f]);return"utf-8"===c&&(e=decodeURIComponent(escape(e))),e},setString:function(a,b,c){c="utf8"===c?"utf-8":c||"binary";var d;j&&"binary"!==c?d=new j(c).encode(b):("utf-8"===c&&(b=unescape(encodeURIComponent(b))),d=e(b)),this._setBytes(a,d,!0)},getChar:function(a){return this.getString(1,a)},setChar:function(a,b){this.setString(a,b)},tell:function(){return this._offset},seek:function(a){return this._checkBounds(a,0),this._offset=a},skip:function(a){return this.seek(this._offset+a)},slice:function(a,b,e){function f(a,b){return 0>a?a+b:a}return a=f(a,this.byteLength),b=f(c(b,this.byteLength),this.byteLength),e?new d(this.getBytes(b-a,a,!0,!0),void 0,void 0,this._littleEndian):new d(this.buffer,this.byteOffset+a,b-a,this._littleEndian)},alignBy:function(a){return this._bitOffset=0,1!==c(a,1)?this.skip(a-(this._offset%a||a)):this._offset},_getFloat64:function(a,b){var c=this._getBytes(8,a,b),d=1-2*(c[7]>>7),e=((c[7]<<1&255)<<3|c[6]>>4)-1023,g=(15&c[6])*f(48)+c[5]*f(40)+c[4]*f(32)+c[3]*f(24)+c[2]*f(16)+c[1]*f(8)+c[0];return 1024===e?0!==g?0/0:1/0*d:-1023===e?d*g*f(-1074):d*(1+g*f(-52))*f(e)},_getFloat32:function(a,b){var c=this._getBytes(4,a,b),d=1-2*(c[3]>>7),e=(c[3]<<1&255|c[2]>>7)-127,g=(127&c[2])<<16|c[1]<<8|c[0];return 128===e?0!==g?0/0:1/0*d:-127===e?d*g*f(-149):d*(1+g*f(-23))*f(e)},_get64:function(a,b,d){d=c(d,this._littleEndian),b=c(b,this._offset);for(var e=d?[0,4]:[4,0],f=0;2>f;f++)e[f]=this.getUint32(b+e[f],d);return this._offset=b+8,new a(e[0],e[1])},getInt64:function(a,b){return this._get64(h,a,b)},getUint64:function(a,b){return this._get64(g,a,b)},_getInt32:function(a,b){var c=this._getBytes(4,a,b);return c[3]<<24|c[2]<<16|c[1]<<8|c[0]},_getUint32:function(a,b){return this._getInt32(a,b)>>>0},_getInt16:function(a,b){return this._getUint16(a,b)<<16>>16},_getUint16:function(a,b){var c=this._getBytes(2,a,b);return c[1]<<8|c[0]},_getInt8:function(a){return this._getUint8(a)<<24>>24},_getUint8:function(a){return this._getBytes(1,a)[0]},_getBitRangeData:function(a,b){var d=(c(b,this._offset)<<3)+this._bitOffset,e=d+a,f=d>>>3,g=e+7>>>3,h=this._getBytes(g-f,f,!0),i=0;(this._bitOffset=7&e)&&(this._bitOffset-=8);for(var j=0,k=h.length;k>j;j++)i=i<<8|h[j];return{start:f,bytes:h,wideValue:i}},getSigned:function(a,b){var c=32-a;return this.getUnsigned(a,b)<<c>>c},getUnsigned:function(a,b){var c=this._getBitRangeData(a,b).wideValue>>>-this._bitOffset;return 32>a?c&~(-1<<a):c},_setBinaryFloat:function(a,b,c,d,e){var g,h,i=0>b?1:0,j=~(-1<<d-1),k=1-j;0>b&&(b=-b),0===b?(g=0,h=0):isNaN(b)?(g=2*j+1,h=1):1/0===b?(g=2*j+1,h=0):(g=Math.floor(Math.log(b)/Math.LN2),g>=k&&j>=g?(h=Math.floor((b*f(-g)-1)*f(c)),g+=j):(h=Math.floor(b/f(k-c)),g=0));for(var l=[];c>=8;)l.push(h%256),h=Math.floor(h/256),c-=8;for(g=g<<c|h,d+=c;d>=8;)l.push(255&g),g>>>=8,d-=8;l.push(i<<d|g),this._setBytes(a,l,e)},_setFloat32:function(a,b,c){this._setBinaryFloat(a,b,23,8,c)},_setFloat64:function(a,b,c){this._setBinaryFloat(a,b,52,11,c)},_set64:function(a,b,d,e){d instanceof a||(d=a.fromNumber(d)),e=c(e,this._littleEndian),b=c(b,this._offset);var f=e?{lo:0,hi:4}:{lo:4,hi:0};for(var g in f)this.setUint32(b+f[g],d[g],e);this._offset=b+8},setInt64:function(a,b,c){this._set64(h,a,b,c)},setUint64:function(a,b,c){this._set64(g,a,b,c)},_setUint32:function(a,b,c){this._setBytes(a,[255&b,b>>>8&255,b>>>16&255,b>>>24],c)},_setUint16:function(a,b,c){this._setBytes(a,[255&b,b>>>8&255],c)},_setUint8:function(a,b){this._setBytes(a,[255&b])},setUnsigned:function(a,b,c){var d=this._getBitRangeData(c,a),e=d.wideValue,f=d.bytes;e&=~(~(-1<<c)<<-this._bitOffset),e|=(32>c?b&~(-1<<c):b)<<-this._bitOffset;for(var g=f.length-1;g>=0;g--)f[g]=255&e,e>>>=8;this._setBytes(d.start,f,!0)}};for(var o in m)!function(a){n["get"+a]=function(b,c){return this._action(a,!0,b,c)},n["set"+a]=function(b,c,d){this._action(a,!1,b,d,c)}}(o);n._setInt32=n._setUint32,n._setInt16=n._setUint16,n._setInt8=n._setUint8,n.setSigned=n.setUnsigned;for(var p in n)"set"===p.slice(0,3)&&!function(a){n["write"+a]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+a].apply(this,arguments)}}(p.slice(3));return d}),videojs.Html5){var onPlaybackrateChanged=function(a){try{var b=!0;if(this.player()&&null!==this.player().mediaPlayer)try{var c=this.player().mediaPlayer.getVideoModel().getElement();c&&null!==c&&(b=c.paused)}catch(d){}a.srcElement&&this.player()&&null!==this.player()&&b===!1&&(0===a.srcElement.playbackRate?this.player().loadingSpinner.show():this.player().loadingSpinner.hide())}catch(e){}},onVideoWaiting=function(){},onLoadedMetadata=function(){},onVideoPause=function(){this.player().loadingSpinner.hide()},onVideoPlay=function(){this.forcedEnd=!1,this.player().loadingSpinner.show()},onVideoPlaying=function(){this.initialPlaybackHasStarted===!1&&(this.initialPlaybackHasStarted=!0),this.player().loadingSpinner.hide()},onVideoEnded=function(){},onVideoTime=function(){try{if(CL.configs.isLive===!1&&null!==this.player().mediaPlayer&&this.player().mediaPlayer.duration()-this.player().mediaPlayer.time()<=2&&this.player().mediaPlayer.duration()==this.el().duration&&(void 0===this.forcedEnd||this.forcedEnd!==!0)){this.forcedEnd=!0;var a=this.player().mediaPlayer.time(),b=this.player().mediaPlayer.duration(),c=this.player().src(),d=this;setTimeout(function(){d.player()&&d.player().paused()===!1&&c===d.player().src()&&d.ended()===!1&&d.player().mediaPlayer.time()>=a&&d.player().mediaPlayer.duration()===b&&d.el().dispatchEvent(new Event("ended"))},2e3)}}catch(e){}},onVideoSeeking=function(){this.initialPlaybackHasStarted===!0,this.player().paused()===!1&&this.player().loadingSpinner.show()},onVideoSeeked=function(){},onDurationChange=function(){};videojs.Dashjs=videojs.Html5.extend({init:function(a,b,c){var d,e,f,g=function(b){var c;if("download"===b.error){var d,e=b.event.request;"manifest"==b.event.id?d="MANIFEST_LOAD_ERROR":"content"==b.event.id&&(d="SEGMENT_LOAD_ERROR"),a.error({code:2,subtype:d,message:"string"===e.responseType?e.responseText:"",status:e.status,statusText:e.statusText,url:e.responseURL}),a.removeClass("vjs-error")}else"key_system_selection"===b.error?(c=b.event.error,a.error({code:2,subtype:"KEY_SYSTEM_ERROR",message:c.message,status:c.status,statusText:c.statusText,url:c.responseURL}),a.removeClass("vjs-error")):"licenseError"===b.error?(c=b.event.error,a.error({code:2,subtype:"LICENSE_ACQUISITION_ERROR",message:c.message,status:c.status,statusText:c.statusText,url:c.responseURL}),a.removeClass("vjs-error")):"keyError"===b.error&&(c=b.event,"output-restricted"==c?a.error({code:3,subtype:"HDCP_OUTPUT_NOT_ALLOWED",message:"Output device is not allowed."}):"output-downscaled"==c?a.error({code:3,subtype:"HDCP_OUTPUT_DOWNSCALED",message:"Output has been downscaled."}):"expired"==c&&a.error({code:3,subtype:"LICENSE_EXPIRED",message:"License for this content has expired."}),a.removeClass("vjs-error"))},h=function(){a.trigger({type:"manifestLoaded"})};this.initialPlaybackHasStarted=!1;var i=!!a.options().autoplay;d=b.source,delete b.source,b.autoplay=!!a.options().autoplay,void 0!==a.options().context?(e=a.options().context,b.autoplay=e.config.autoplay):e=new castLabsDashJS.classes.DRMtodayContext(b),f=new MediaPlayer(e),a.usingNativeControls(CL.configs.isChromeAndroid===!0?!0:!1),a.setAudioTrack=videojs.bind(this,this.setAudioTrack),a.audioTracks=videojs.bind(this,this.audioTracks),a.setSubsTrack=videojs.bind(this,this.setSubsTrack),a.subtitleTracks=videojs.bind(this,this.subtitleTracks),a.absoluteTime=videojs.bind(this,this.absoluteTime),a.getPlaybackStatistics=videojs.bind(this,this.getPlaybackStatistics),a.enableABRSwitching=videojs.bind(this,this.enableABRSwitching),a.setQualityFor=videojs.bind(this,this.setQualityFor),a.removeEventListener=videojs.bind(this,this.removeEventListener),a.safeDispose=videojs.bind(this,this.safeDispose),a.setPlaybackRate=videojs.bind(this,this.setPlaybackRate),a.getLastAppendedSegment=videojs.bind(this,this.getLastAppendedSegment),videojs.Html5.call(this,a,b,c),CL.configs.element=this.el(),this.removeEventListener();var j=this.el();CL.configs.isChromeAndroid===!0&&(j.controls=!0,j.style.zIndex=100),j.addEventListener("durationchange",onDurationChange.bind(this)),j.addEventListener("ended",onVideoEnded.bind(this)),j.addEventListener("loadedmetadata",onLoadedMetadata.bind(this)),j.addEventListener("play",onVideoPlay.bind(this)),j.addEventListener("playing",onVideoPlaying.bind(this)),j.addEventListener("pause",onVideoPause.bind(this)),j.addEventListener("ratechange",onPlaybackrateChanged.bind(this)),j.addEventListener("seeking",onVideoSeeking.bind(this)),j.addEventListener("seeked",onVideoSeeked.bind(this)),j.addEventListener("timeupdate",onVideoTime.bind(this)),j.addEventListener("waiting",onVideoWaiting.bind(this)),a.options().children.bigPlayButton=!i,a.options().customErrorHandler=g,a.options().onManifestLoaded=h,d&&d.src&&(f.loadVideo(d.src),f.eventBus.addEventListener("error",a.options().customErrorHandler,!1),f.eventBus.addEventListener(MediaPlayer.events.MANIFEST_LOADED,a.options().onManifestLoaded,!1)),a.mediaPlayer=f;var k=function(b){var c=a.getPlaybackStatistics();if(!b.data){var d,e=c.video,f=e.bandwidth,g=void 0===e.activeTrack?[]:e.activeTrack.representations,h=0;for(d=0;d<g.length;d++)if(g[d].bandwidth===f){h=d;break}b.data={mediaType:"video",oldQuality:h,newQuality:h}}var i,j,k=b.data;if("video"===k.mediaType&&"normal"!==CL.manifest.pictureSize){j=c.video.activeTrack.representations[k.oldQuality],i=c.video.activeTrack.representations[k.newQuality];var l,m=a.el();l=m.childNodes[0];var n,o,p,q,r,s,t,u,v,w,x,y,z;switch(q=m.clientWidth,r=m.clientHeight,t=j.height,s=j.width,o=t/s,v=i.height,u=i.width,p=v/u,n=r/q,m.style.overflow="",l.style.width=q+"px",l.style.height=r+"px",l.style.transform="",CL.manifest.pictureSize){case"crop":m.style.overflow="hidden",y=(l.clientWidth-u)/2+"px",z=(l.clientHeight-v)/2+"px",l.style.width=u+"px",l.style.height=v+"px",l.style.transform="translateX("+y+") translateY("+z+")";break;case"stretch":n>p?(w=1,x=n/p,y="0px"):(w=p/n,x=1,y="0px"),l.style.transform="scaleX("+w+") scaleY("+x+") translateX("+y+")"}}};a.on("loadedmetadata",function(){a.mediaPlayer.getABRController().subscribe("qualityChanged",this,k,!1)}),a.on("firstplay",k),a.on("adstart",function(){a.mediaPlayer.pause(),a.removeEventListener(),a.mediaPlayer.reset()}),a.context=e}}),videojs.Dashjs.prototype.removeEventListener=function(){var a=this.el(),b=this.player();a.removeEventListener("durationchange",onDurationChange),a.removeEventListener("ended",onVideoEnded),a.removeEventListener("loadedmetadata",onLoadedMetadata),a.removeEventListener("play",onVideoPlay),a.removeEventListener("playing",onVideoPlaying),a.removeEventListener("pause",onVideoPause),a.removeEventListener("ratechange",onPlaybackrateChanged),a.removeEventListener("seeking",onVideoSeeking),a.removeEventListener("seeked",onVideoSeeked),a.removeEventListener("timeupdate",onVideoTime),a.removeEventListener("waiting",onVideoWaiting),b&&b.mediaPlayer&&b.mediaPlayer.removeEventListener&&(b.mediaPlayer.removeEventListener(),b.mediaPlayer.reset())},videojs.Dashjs.prototype.buffered=function(){var a,b,c=videojs.Html5.prototype.buffered.call(this);if(c.length>1){for(var d=this.currentTime(),e=0;e<c.length;e++)if(a=c.start(e),b=c.end(e),a-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,b-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,d>=a&&b>=d)return videojs.createTimeRange(a,b);return videojs.createTimeRange(0,0)}return 1===c.length?(a=c.start(0),b=c.end(0),a-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,b-=CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,videojs.createTimeRange(a,b)):videojs.createTimeRange(0,0)},videojs.Dashjs.prototype.currentTime=function(){if(this.player()&&null!==this.player().mediaPlayer)try{var a=this.player().mediaPlayer.time();return a}catch(b){}return videojs.Html5.prototype.currentTime.call(this)},videojs.Dashjs.prototype.absoluteTime=function(){if(this.player()&&null!==this.player().mediaPlayer)try{return this.player().mediaPlayer.absoluteTime()}catch(a){}return videojs.Html5.prototype.currentTime.call(this)},videojs.Dashjs.prototype.setAudioTrack=function(a){this.player().mediaPlayer.setActiveTrack("audio",a)},videojs.Dashjs.prototype.setSubsTrack=function(a){CL.configs.activeTrack.text=a,console.log("setting text track to "+a),this.player().setTextTrack(a)},videojs.Dashjs.prototype.audioTracks=function(){return this.toLangs(this.tracks("audio"))},videojs.Dashjs.prototype.subtitleTracks=function(){return this.tracks("text")},videojs.Dashjs.prototype.tracks=function(a){return this.player().mediaPlayer.getAvailableTracks(a)},videojs.Dashjs.prototype.toLangs=function(a){var b,c=[];for(b=0;b<a.length;b++)c.push(a[b].lang);return c},videojs.Dashjs.prototype.toTrackId=function(a,b){var c;for(c=0;c<b.length;c++)if(b[c].lang===a)return b[c].id;return null},videojs.Dashjs.prototype.setCurrentTime=function(a){this.player().mediaPlayer?this.player().mediaPlayer.seek(a):videojs.Html5.prototype.setCurrentTime.call(this,a)},videojs.Dashjs.prototype.duration=function(){var a,b=this.player().mediaPlayer;if(b&&b.isReady())try{var c=!1;return null!==b.adapter&&null!==b.adapter.manifestModel&&null!==b.adapter.manifestModel.getValue()&&(c="dynamic"===b.adapter.manifestModel.getValue().type),a=b.duration()-CL.configs.ssTimeOffset.video/CL.configs.ssTimeOffsetTimescale.video,c?-1:b.duration()}catch(d){}return videojs.Html5.prototype.duration.call(this)},videojs.Dashjs.isSupported=function(){{var a=new castLabsDashJS.classes.Utils;a.supportsMSE()}return CL.configs.isActiveVideoChrome===!0?!0:!!window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4;codecs="avc1.42c00c')},videojs.Dashjs.canPlaySource=function(a){return"application/dash+xml"===a.type?"maybe":""},videojs.Dashjs.prototype.play=function(){var a=this.player().mediaPlayer.getVideoModel();a.play()},videojs.Dashjs.prototype.getPlaybackStatistics=function(){var a,b,c={};a=this.player().mediaPlayer,b=a.getMetricsExt();var d=function(c){var d,e,f,g,h;return h={},d=a.getMetricsFor(c),e=b.getCurrentRepresentationSwitch(d),f=b.getCurrentBufferLevel(d),g=b.getCurrentDroppedFrames(d),null!==e&&(h.bandwidth=b.getBandwidthForRepresentation(e.to)),null!==f&&(h.bufferLength=parseFloat(f.level.toPrecision(5)),h.bufferLevel=parseFloat(Math.min(h.bufferLength/MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY,1).toPrecision(2))),null!==g&&(h.droppedFrames=g.droppedFrames),null!==e&&(h.bandwidth=b.getBandwidthForRepresentation(e.to)),h.activeTrack=CL.configs.activeTrack[c],h};return activeTextTrack=this.player().activeSubtitleTrack,c={audio:d("audio"),video:d("video"),text:{activeTrack:void 0===activeTextTrack?null:activeTextTrack}}},videojs.Dashjs.prototype.enableABRSwitching=function(a){var b;void 0===a&&(a=!0),b=this.player().mediaPlayer,this.player().mediaPlayer.setAutoSwitchQuality(a)},videojs.Dashjs.prototype.setQualityFor=function(a,b){var c;if(void 0===a||"video"!==a&&"audio"!==a)throw new Error("You must specify a valid type (video or audio) when setting the quality");if(void 0===b)throw new Error("You must specify a quality index when setting the quality");c=this.player().mediaPlayer,c.setQualityFor(a,b)},videojs.Dashjs.prototype.error=function(){try{return(new Date).getTime()-CL.configs.sourceCleaningInProgress<5e3?!0:videojs.Html5.prototype.error.call(this)}catch(a){}},videojs.Dashjs.prototype.safeDispose=function(){var a=this.player();try{a.pause(),a.mediaPlayer&&a.mediaPlayer.removeEventListener&&(a.mediaPlayer.removeEventListener(),a.mediaPlayer.reset());for(var b=document.getElementsByTagName("video"),c=0;c<b.length;c++){var d=b[c];d.pause()}a.dispose()}catch(e){}try{var f=document.querySelector("video");null!==f&&f.parentElement.removeChild(f)}catch(e){}},videojs.Player.prototype.setInterval=function(a,b){a=videojs.bind(this,a);var c=setInterval(a,b),d=function(){clearInterval(c)};return d.guid="vjs-interval-"+c,this.on("dispose",d),c},videojs.Player.prototype.clearInterval=function(a){window.clearInterval(a);var b=function(){};return b.guid="vjs-interval-"+a,this.off("dispose",b),a},videojs.MediaTechController.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=setInterval(videojs.bind(this,function(){null!==this.player().el()?this.player().trigger("timeupdate"):clearInterval(this.currentTimeInterval)}),250)},videojs.Dashjs.prototype.setPlaybackRate=function(a){try{var b=this.player().mediaPlayer.getVideoModel().getElement();void 0===a&&(a=1),a=Math.min(a,4),a=Math.max(a,.5),b&&null!==b&&(b.playbackRate=a)}catch(c){}},videojs.Dashjs.prototype.getLastAppendedSegment=function(){var a={};try{var b=this.player().mediaPlayer;void 0!==b&&b.isReady()&&(a={audio:CL.configs.lastAppendedSegment.audio,video:CL.configs.lastAppendedSegment.video})}catch(c){}return a}}videojs.Dashas=videojs.Flash.extend({init:function(a,b,c){var d,e;a.isReady=!1;var f=!!a.options().autoplay;a.options().children.bigPlayButton=!f,a.on("playerready",function(){a.isReady=!0}),b.assetId&&(d=encodeURIComponent(videojs.Dashas.buildMetadataUrl(b)),e=encodeURIComponent(videojs.Dashas.buildOptData(b))),this.cache_={buffered:{timestamp:0,value:null},currentTime:{timestmap:0,value:null},playing:!1},this.initialized_=!1,this.playPressed_=!1,b.swf=b.flashFile,maxBufferLength=15,void 0!==b.ABRParameters&&null!==b.ABRParameters&&""!==b.ABRParameters&&b.ABRParameters.maxBufferLength&&void 0!==b.ABRParameters.maxBufferLength&&(maxBufferLength=b.ABRParameters.maxBufferLength),b.flashVars=videojs.util.mergeOptions({metadataUrl:d,authenticationToken:e,spinner:!1,watermark:!1,debug:b.debug&&b.debug===!0?!0:!1,quality:"autolow",errorEventProxyFunction:"videojs.Dashas.onError",maxBufferLength:maxBufferLength},b.flashVars),b.source&&b.source.src&&(b.flashVars.src=encodeURIComponent(b.source.src)),videojs.Flash.call(this,a,b,c),a.setAudioTrack=videojs.bind(this,this.setAudioTrack),a.audioTracks=videojs.bind(this,this.audioTracks),a.subtitleTracks=videojs.bind(this,this.textTracks),a.absoluteTime=videojs.bind(this,this.currentTime),a.setSubsTrack=videojs.bind(this,this.setSubsTrack),a.getBuffered=videojs.bind(this,this.getBuffered),a.getBufferLevel=videojs.bind(this,this.getBufferLevel),a.getDroppedFrames=videojs.bind(this,this.getDroppedFrames),a.getCurrentAudioBandwidth=videojs.bind(this,this.getCurrentAudioBandwidth),a.getCurrentVideoBandwidth=videojs.bind(this,this.getCurrentVideoBandwidth),a.getPlaybackStatistics=videojs.bind(this,this.getPlaybackStatistics),a.videoClass=videojs.bind(this,this.videoClass),a.debug_maxRepresentationHeight=videojs.bind(this,this.maxRepresentationHeight),a.debug_minRepresentationHeight=videojs.bind(this,this.minRepresentationHeight),a.loadSrc=videojs.bind(this,this.loadSrc),a.on(["play","playing","seeking","pause","waiting","ended"],videojs.bind(this,this.resetCache)),a.on(["play"],videojs.bind(this,this.markPlay)),a.on(["playing"],videojs.bind(this,this.markPlaying)),a.on(["seeking","pause","waiting","ended"],videojs.bind(this,this.unmarkPlaying)),a.on(["loadedmetadata"],videojs.bind(this,this.markInitializedAndPlayIfNeeded))}}),videojs.Dashas.prototype.maxRepresentationHeight=function(a){return a?void this.el().vjs_setProperty("maxRepresentationHeight",a):this.el().vjs_getProperty("maxRepresentationHeight")},videojs.Dashas.prototype.minRepresentationHeight=function(a){return a?void this.el().vjs_setProperty("minRepresentationHeight",a):this.el().vjs_getProperty("minRepresentationHeight")},videojs.Dashas.buildMetadataUrl=function(a){var b,c,d,e,f="";return b=videojs.Dashas.buildOptData(a),e=a.authenticationToken,c=a.assetId,d=a.variantId,f+=a.accessLicenseServerURL+"?optData="+b,void 0!==c&&null!==c&&""!==c&&(f+="&assetId="+c),void 0!==d&&null!==d&&""!==d&&(f+="&variantId="+d),(void 0===e||null===e||""===e)&&(e=null),f+=null===e?"":"&authToken="+e},videojs.Dashas.buildOptData=function(a){return(new castLabsDashJS.classes.Utils).B64Tools.encode(JSON.stringify(a.customData))},videojs.Dashas.prototype.limitToXEntries=function(a,b){for(;a.length>b;)a.shift()},videojs.Dashas.prototype.getDroppedFrames=function(){return this.el().vjs_getProperty("droppedFrames")},videojs.Dashas.prototype.videoClass=function(){return this.el().vjs_videoClass()},videojs.Dashas.prototype.getBuffered=function(){return this.el().vjs_getProperty("buffered")},videojs.Dashas.prototype.getBufferLevel=function(){return this.el().vjs_getProperty("bufferLevel")},videojs.Dashas.prototype.getCurrentAudioBandwidth=function(){return this.el().vjs_getProperty("currentAudioBandwidth")},videojs.Dashas.prototype.getCurrentVideoBandwidth=function(){return this.el().vjs_getProperty("currentVideoBandwidth")},videojs.Dashas.prototype.getPlaybackStatistics=function(){var a=this.getBuffered(),b=(this.getBufferLevel(),this.getDroppedFrames()),c=this.getCurrentVideoBandwidth(),d=this.getCurrentAudioBandwidth(),e={bandwidth:c,bufferLength:a,droppedFrames:b},f={bandwidth:d,bufferLength:a};return{video:e,audio:f}},videojs.Dashas.onError=function(a,b){var c=videojs(a);"string"==typeof b&&-1!=b.indexOf("MANIFEST_LOAD_ERROR")?c.error({code:2,subtype:"MANIFEST_LOAD_ERROR"}):"string"==typeof b&&-1!=b.indexOf("SEGMENT_LOAD_ERROR")?c.error({code:2,subtype:"SEGMENT_LOAD_ERROR"}):"string"==typeof b&&-1!=b.indexOf("LICENSE_ACQUISITION_ERROR")?c.error({code:2,subtype:"LICENSE_ACQUISITION_ERROR"}):videojs.Flash.onError(a,b)},videojs.Dashas.prototype.loadSrc=function(a,b){var c,d,e,f=this,g=function(){c=!1,"boolean"==typeof b.autoplay&&(c=b.autoplay),b.assetId&&(d=videojs.Dashas.buildMetadataUrl(b),e=videojs.Dashas.buildOptData(b)),f.el().vjs_source(a,c,d,e)};this.player().isReady===!1?this.player().one("playerready",function(){setTimeout(function(){g()},0)}):setTimeout(function(){g()},0)},videojs.Dashas.now=function(){return(new Date).getTime()/1e3},videojs.Dashas.isSupported=function(){var a=videojs.Flash.version();return a[0]>11||11==a[0]&&a[1]>=5},videojs.Dashas.canPlaySource=function(a){return"application/dash+xml"===a.type?"maybe":""},videojs.Dashas.prototype.setSubsTrack=function(a){this.player().setTextTrack(a)},videojs.Dashas.prototype.setAudioTrack=function(a){this.el().vjs_setProperty("forcedAudioLang",a)},videojs.Dashas.prototype.setCurrentTime=function(a){this.el().vjs_setProperty("currentTime",a),this.play()},videojs.Dashas.prototype.currentTime=function(){if(!this.el().vjs_getProperty)return 0;if(null===this.cache_.currentTime.value&&this.updateCurrentTime(),this.cache_.playing){var a=videojs.Dashas.now()-this.cache_.currentTime.timestamp;return a>5&&(this.updateCurrentTime(),a=videojs.Dashas.now()-this.cache_.currentTime.timestamp),this.cache_.currentTime.value+a}return this.cache_.currentTime.value},videojs.Dashas.prototype.buffered=function(){if(!this.el().vjs_getProperty)return 0;var a=videojs.Dashas.now()-this.cache_.buffered.timestamp;return a>5&&(this.cache_.buffered.value=videojs.createTimeRange(0,this.el().vjs_getProperty("buffered")),this.cache_.buffered.timestamp=videojs.Dashas.now()),this.cache_.buffered.value},videojs.Dashas.prototype.play=function(){this.initialized_===!1?(this.player().addClass("vjs-waiting"),this.player().removeChild("bigPlayButton"),this.playPressed_=!0):videojs.Flash.prototype.play.call(this)},videojs.Dashas.prototype.resetCache=function(){this.cache_.currentTime.value=null,this.cache_.currentTime.timestamp=0,this.cache_.buffered.value=null,this.cache_.buffered.timestamp=0},videojs.Dashas.prototype.updateCurrentTime=function(){this.cache_.currentTime.value=this.el().vjs_getProperty("currentTime"),this.cache_.currentTime.timestamp=videojs.Dashas.now()},videojs.Dashas.prototype.unmarkPlaying=function(){this.cache_.playing=!1},videojs.Dashas.prototype.markPlay=function(){this.cache_.playing=!0},videojs.Dashas.prototype.markPlaying=function(){this.player().paused()||(this.cache_.playing=!0)},videojs.Dashas.prototype.markInitializedAndPlayIfNeeded=function(){this.initialized_=!0,this.playPressed_===!0&&(this.playPressed_=!1,this.play())},videojs.Dashas.prototype.duration=function(){var a=this.el().vjs_getProperty("duration");return 0>a?a:a+1},window.Silverlight||(window.Silverlight={}),Silverlight._silverlightCount=0,Silverlight.__onSilverlightInstalledCalled=!1,Silverlight.fwlinkRoot="http://go2.microsoft.com/fwlink/?LinkID=",Silverlight.__installationEventFired=!1,Silverlight.onGetSilverlight=null,Silverlight.onSilverlightInstalled=function(){window.location.reload(!1)},Silverlight.isInstalled=function(a){void 0==a&&(a=null);var b=!1;try{var c=null,d=!1;if(window.ActiveXObject)try{c=new ActiveXObject("AgControl.AgControl"),null===a?b=!0:c.IsVersionSupported(a)&&(b=!0),c=null}catch(e){d=!0}else d=!0;if(d){var f=navigator.plugins["Silverlight Plug-In"];if(f)if(null===a)b=!0;else{var g=f.description;"1.0.30226.2"===g&&(g="2.0.30226.2");for(var h=g.split(".");h.length>3;)h.pop();for(;h.length<4;)h.push(0);for(var i=a.split(".");i.length>4;)i.pop();var j,k,l=0;do j=parseInt(i[l]),k=parseInt(h[l]),l++;while(l<i.length&&j===k);k>=j&&!isNaN(j)&&(b=!0)}}}catch(e){b=!1}return b},Silverlight.WaitForInstallCompletion=function(){if(!Silverlight.isBrowserRestartRequired&&Silverlight.onSilverlightInstalled){try{navigator.plugins.refresh()}catch(a){}Silverlight.isInstalled(null)&&!Silverlight.__onSilverlightInstalledCalled?(Silverlight.onSilverlightInstalled(),Silverlight.__onSilverlightInstalledCalled=!0):setTimeout(Silverlight.WaitForInstallCompletion,3e3)
}},Silverlight.__startup=function(){if(navigator.plugins.refresh(),Silverlight.isBrowserRestartRequired=Silverlight.isInstalled(null),Silverlight.isBrowserRestartRequired){if(window.navigator.mimeTypes){var a=navigator.mimeTypes["application/x-silverlight-2"],b=navigator.mimeTypes["application/x-silverlight-2-b2"],c=navigator.mimeTypes["application/x-silverlight-2-b1"],d=c;b&&(d=b),a||!c&&!b?a&&d&&a.enabledPlugin&&d.enabledPlugin&&a.enabledPlugin.description!=d.enabledPlugin.description&&(Silverlight.__installationEventFired||(Silverlight.onRestartRequired(),Silverlight.__installationEventFired=!0)):Silverlight.__installationEventFired||(Silverlight.onUpgradeRequired(),Silverlight.__installationEventFired=!0)}}else Silverlight.WaitForInstallCompletion(),Silverlight.__installationEventFired||(Silverlight.onInstallRequired(),Silverlight.__installationEventFired=!0);Silverlight.disableAutoStartup||(window.removeEventListener?window.removeEventListener("load",Silverlight.__startup,!1):window.detachEvent("onload",Silverlight.__startup))},Silverlight.disableAutoStartup||(window.addEventListener?window.addEventListener("load",Silverlight.__startup,!1):window.attachEvent("onload",Silverlight.__startup)),Silverlight.createObject=function(a,b,c,d,e,f,g){var h={},i=d,j=e;if(h.version=i.version,i.source=a,h.alt=i.alt,f&&(i.initParams=f),i.isWindowless&&!i.windowless&&(i.windowless=i.isWindowless),i.framerate&&!i.maxFramerate&&(i.maxFramerate=i.framerate),c&&!i.id&&(i.id=c),delete i.ignoreBrowserVer,delete i.inplaceInstallPrompt,delete i.version,delete i.isWindowless,delete i.framerate,delete i.data,delete i.src,delete i.alt,Silverlight.isInstalled(h.version)){for(var k in j)if(j[k]){if("onLoad"==k&&"function"==typeof j[k]&&1!=j[k].length){var l=j[k];j[k]=function(a){return l(document.getElementById(c),g,a)}}var m=Silverlight.__getHandlerName(j[k]);if(null==m)throw"typeof events."+k+" must be 'function' or 'string'";i[k]=m,j[k]=null}slPluginHTML=Silverlight.buildHTML(i)}else slPluginHTML=Silverlight.buildPromptHTML(h);return b?void(b.innerHTML=slPluginHTML):slPluginHTML},Silverlight.buildHTML=function(a){var b=[];b.push('<object type="application/x-silverlight" data="data:application/x-silverlight,"'),null!=a.id&&b.push(' id="'+Silverlight.HtmlAttributeEncode(a.id)+'"'),null!=a.width&&b.push(' width="'+a.width+'"'),null!=a.height&&b.push(' height="'+a.height+'"'),b.push(" >"),delete a.id,delete a.width,delete a.height;for(var c in a)a[c]&&b.push('<param name="'+Silverlight.HtmlAttributeEncode(c)+'" value="'+Silverlight.HtmlAttributeEncode(a[c])+'" />');return b.push("</object>"),b.join("")},Silverlight.createObjectEx=function(a){var b=a,c=Silverlight.createObject(b.source,b.parentElement,b.id,b.properties,b.events,b.initParams,b.context);return null==b.parentElement?c:void 0},Silverlight.buildPromptHTML=function(a){var b="",c=Silverlight.fwlinkRoot,d=a.version;return a.alt?b=a.alt:(d||(d=""),b="<a href='javascript:Silverlight.getSilverlight(\"{1}\");' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>",b=b.replace("{1}",d),b=b.replace("{2}",c+"108181")),b},Silverlight.getSilverlight=function(a){Silverlight.onGetSilverlight&&Silverlight.onGetSilverlight();var b="",c=String(a).split(".");if(c.length>1){var d=parseInt(c[0]);b=isNaN(d)||2>d?"1.0":c[0]+"."+c[1]}var e="";b.match(/^\d+\056\d+$/)&&(e="&v="+b),Silverlight.followFWLink("149156"+e)},Silverlight.followFWLink=function(a){top.location=Silverlight.fwlinkRoot+String(a)},Silverlight.HtmlAttributeEncode=function(a){var b,c="";if(null==a)return null;for(var d=0;d<a.length;d++)b=a.charCodeAt(d),b>96&&123>b||b>64&&91>b||b>43&&58>b&&47!=b||95==b?c+=String.fromCharCode(b):c=c+"&#"+b+";";return c},Silverlight.default_error_handler=function(a,b){var c,d=b.ErrorType;c=b.ErrorCode;var e="\nSilverlight error message     \n";e+="ErrorCode: "+c+"\n",e+="ErrorType: "+d+"       \n",e+="Message: "+b.ErrorMessage+"     \n","ParserError"==d?(e+="XamlFile: "+b.xamlFile+"     \n",e+="Line: "+b.lineNumber+"     \n",e+="Position: "+b.charPosition+"     \n"):"RuntimeError"==d&&(0!=b.lineNumber&&(e+="Line: "+b.lineNumber+"     \n",e+="Position: "+b.charPosition+"     \n"),e+="MethodName: "+b.methodName+"     \n"),alert(e)},Silverlight.__cleanup=function(){for(var a=Silverlight._silverlightCount-1;a>=0;a--)window["__slEvent"+a]=null;Silverlight._silverlightCount=0,window.removeEventListener?window.removeEventListener("unload",Silverlight.__cleanup,!1):window.detachEvent("onunload",Silverlight.__cleanup)},Silverlight.__getHandlerName=function(a){var b="";if("string"==typeof a)b=a;else if("function"==typeof a){0==Silverlight._silverlightCount&&(window.addEventListener?window.addEventListener("onunload",Silverlight.__cleanup,!1):window.attachEvent("onunload",Silverlight.__cleanup));var c=Silverlight._silverlightCount++;b="__slEvent"+c,window[b]=a}else b=null;return b},Silverlight.onRequiredVersionAvailable=function(){},Silverlight.onRestartRequired=function(){},Silverlight.onUpgradeRequired=function(){},Silverlight.onInstallRequired=function(){},Silverlight.IsVersionAvailableOnError=function(a,b){var c=!1;try{8001!=b.ErrorCode||Silverlight.__installationEventFired?8002!=b.ErrorCode||Silverlight.__installationEventFired?5014==b.ErrorCode||2106==b.ErrorCode?Silverlight.__verifySilverlight2UpgradeSuccess(b.getHost())&&(c=!0):c=!0:(Silverlight.onRestartRequired(),Silverlight.__installationEventFired=!0):(Silverlight.onUpgradeRequired(),Silverlight.__installationEventFired=!0)}catch(d){}return c},Silverlight.IsVersionAvailableOnLoad=function(a){var b=!1;try{Silverlight.__verifySilverlight2UpgradeSuccess(a.getHost())&&(b=!0)}catch(c){}return b},Silverlight.__verifySilverlight2UpgradeSuccess=function(a){var b=!1,c="2.0.31005",d=null;try{a.IsVersionSupported(c+".99")?(d=Silverlight.onRequiredVersionAvailable,b=!0):d=a.IsVersionSupported(c+".0")?Silverlight.onRestartRequired:Silverlight.onUpgradeRequired,d&&!Silverlight.__installationEventFired&&(d(),Silverlight.__installationEventFired=!0)}catch(e){}return b};var fPlayer=null;videojs.Silverlight=videojs.MediaTechController.extend({init:function(a,b,c){var d,e;videojs.MediaTechController.call(this,a,b,c),d=new castLabsDashJS.classes.Utils,null!==b.authenticationToken&&""!==b.authenticationToken&&void 0!==b.customData&&(b.customData.authToken=b.authenticationToken),e=b.customData?d.B64Tools.encode(JSON.stringify(b.customData)):"",b.autoplay=!!a.options().autoplay,a.options().children.bigPlayButton=!b.autoplay;var f=this;this.player().one(["play"],function(){f.player().loadingSpinner.hide()}),window.isIE10&&window.isIE10===!0&&(videojs.Player.prototype.requestFullscreen=function(){this.isFullscreen(!0),this.enterFullWindow(),this.trigger("fullscreenchange")},videojs.Player.prototype.exitFullscreen=function(){this.isFullscreen(!1),this.exitFullWindow(),this.trigger("fullscreenchange")}),f.cache={playerState:videojs.Silverlight.PlayerStates.IDLE,currentTime:0,duration:0,volume:1,muted:!1},f.initialized=!1,f.playPressed=!1,null!==fPlayer&&a.el_.parentElement.parentElement.removeChild(a.el_.parentElement),a.on(["adsready","adstarted"],function(){f.player().el().childNodes[0].style.height="0%",null===fPlayer?a.one("ready",function(){setTimeout(function(){},0)}):setTimeout(function(){},0)}),a.on(["adend","adserror","adscancelled"],function(){f.player().el().childNodes[0].style.height="100%"});var g=b.parentEl,h=this.el_=this.createEl("div",{id:"_temp_silverlight"}),i=(a.id()+"_silverlight_api",b.source?b.source.src:"");""===i&&(a.options().children.bigPlayButton=!1),f.url=i,CL.manifest.url=i,laUrl=b.playReadyLicenseServerURL?b.playReadyLicenseServerURL:"",g.insertBefore(h,g.firstChild),onSilverlightLoad=function(){},onSilverlightError=function(){},onPlayerReady=function(a){fPlayer=a;var c="SilverlightPlayer",d=document.getElementById(c),e=(d.content,function(){f.cache.playerState=videojs.Silverlight.PlayerStates.STOPPED,f.cache.currentTime=f.cache.duration,f.player().trigger("ended")}),g=function(a){f.initialized=!0,f.cache.duration=a.EndPositionSeconds,f.setVolume(f.cache.volume),f.player().trigger("loadstart"),f.player().trigger("loadedmetadata"),f.player().trigger("loadeddata"),f.player().trigger("durationchange"),b.autoplay===!0?f.play():f.playPressed===!0&&(f.playPressed=!1,f.play())},h=function(a){f.cache.currentTime=a.PlaybackPositionSeconds},i=function(a){switch(a.PlayState){case 0:break;case 1:f.cache.playerState=videojs.Silverlight.PlayerStates.BUFFERING,f.initialized===!0&&f.player().trigger("waiting");break;case 2:f.cache.playerState=videojs.Silverlight.PlayerStates.BUFFERING,f.player().trigger("waiting");break;case 3:f.cache.playerState=videojs.Silverlight.PlayerStates.PLAYING,f.player().trigger("play");break;case 4:f.cache.playerState=videojs.Silverlight.PlayerStates.PAUSED;break;case 5:f.cache.playerState=videojs.Silverlight.PlayerStates.STOPPED,f.player().trigger("pause")}},j=function(){f.player().trigger("seeked"),f.player().trigger("timeupdate")};f.onPlayStateChanged=i,f.onProgressChanged=h,f.onMediaOpened=g,f.onMediaEnded=e,f.onSeekCompleted=j,fPlayer.addEventListener("MediaEnded",e),fPlayer.addEventListener("PlayStateChanged",i),fPlayer.addEventListener("PlaybackPositionChanged",h),fPlayer.addEventListener("MediaOpened",g),fPlayer.addEventListener("SeekCompleted",j),f.triggerReady()};var j=!0,k=!0,l="InteractiveActivationMode=None,";b.useNativeSilverlightControls===!0&&(j=!1,k=!1,a.controls(!1));var m=l+"CollapsedControlBar="+j+",scriptableName=fPlayer,mediaurl="+i+",PlayerGraphVisibility=hidden,drmCustomData="+e+",LicenseServerUriOverride="+laUrl+",AutoPlay=false,AutoLoad=true";""===e&&(m=m.replace(/,drmCustomData=/gi,"")),""===laUrl&&(m=m.replace(/,LicenseServerUriOverride=/gi,"")),""===i&&(m=m.replace(/,mediaurl=/gi,""));{var n='<div style="height:100%;width:100%;border:0px"><object id="SilverlightPlayer"  data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%"><param name="source" value="'+b.silverlightFile+'"/><param name="onError" value="onSilverlightError" /><param name="onLoad" value="onSilverlightLoad" /><param name="minRuntimeVersion" value="4.0.50826.0" /><param name="autoUpgrade" value="false" /><param name="enableGPUAcceleration" value="true" /><param name="windowless" value="'+k+'" /><param name="background" value="#000000" /><param name="maxframerate" value="25" /><param name="InteractiveActivationMode" value="None" /><param name="enableHtmlAccess" value="true" /><param name="InitParams" value="'+m+'"/></object><iframe style="visibility:hidden;height:0;width:0;border:0px"></iframe></div>',o=n,p=this.createEl("div",{innerHTML:o}).childNodes[0];h.parentNode}h.parentNode.replaceChild(p,h);var q=function(){};a.enableABRSwitching=videojs.bind(this,q),a.safeDispose=a.dispose,a.loadSrc=function(b,c){var d=function(){var d,e=fPlayer.CreatePlaylistItem(b,"","Title","Description");e.DeliveryMethod="AdaptiveStreaming",d=fPlayer.CreatePlaylist(),d.AddPlaylistItem(e),fPlayer.SetPlaylist(d),c.enableIma===!0&&f.setVolume(.01),a.ads&&a.ads.contentSrc&&a.trigger({type:"contentupdate",oldValue:a.ads.contentSrc,newValue:b}),CL.manifest.url=b};null===fPlayer?a.one("ready",function(){setTimeout(function(){d()},0)}):setTimeout(function(){d()},0)},this.el_=p}}),videojs.Silverlight.PlayerStates={IDLE:0,STOPPED:1,PLAYING:2,PAUSED:3,BUFFERING:4,SEEKING:5},videojs.Silverlight.canPlaySource=function(a){return"application/dash+xml"===a.type?"maybe":""},videojs.Silverlight.prototype.play=function(){this.initialized===!1?(this.player().removeChild("bigPlayButton"),this.playPressed=!0):this.stopped()?(this.cache.currentTime=0,fPlayer.GoToPlaylistItem(0)):setTimeout(function(){fPlayer.Play()},0)},videojs.Silverlight.prototype.pause=function(){var a=this;setTimeout(function(){try{fPlayer.Pause()}catch(b){}a.player().trigger("pause")},0)},videojs.Silverlight.prototype.seeking=function(){return this.cache.playerState===videojs.Silverlight.PlayerStates.SEEKING},videojs.Silverlight.prototype.paused=function(){return this.cache.playerState===videojs.Silverlight.PlayerStates.PAUSED||this.stopped()},videojs.Silverlight.prototype.stopped=function(){return this.cache.playerState===videojs.Silverlight.PlayerStates.STOPPED},videojs.Silverlight.prototype.ended=function(){return this.cache.playerState===videojs.Silverlight.PlayerStates.STOPPED&&this.cache.currentTime==this.cache.duration},videojs.Silverlight.prototype.currentTime=function(){return Math.min(this.cache.currentTime,this.cache.duration)},videojs.Silverlight.prototype.setCurrentTime=function(a){this.cache.playerState=videojs.Silverlight.PlayerStates.SEEKING,this.player().trigger("seeking"),this.cache.currentTime=a,fPlayer.SeekToPosition(a)},videojs.Silverlight.prototype.duration=function(){return this.cache.duration},videojs.Silverlight.prototype.buffered=function(){},videojs.Silverlight.prototype.muted=function(){return this.cache.muted},videojs.Silverlight.prototype.setMuted=function(a){this.setVolume(a?0:this.cache.volume)},videojs.Silverlight.prototype.volume=function(){return this.cache.muted?0:this.cache.volume},videojs.Silverlight.prototype.setVolume=function(a){this.cache.muted=0===a,a>0&&(this.cache.volume=a),fPlayer.SetVolume(a),this.player().trigger("volumechange",a)},videojs.Silverlight.prototype.buffered=function(){return null},videojs.Silverlight.prototype.supportsFullScreen=function(){return!1},videojs.Silverlight.prototype.enterFullScreen=function(){return!1},videojs.Silverlight.isSupported=function(){return Silverlight.isInstalled("2.0")},videojs.Silverlight.prototype.dispose=function(){fPlayer=null,videojs.MediaTechController.prototype.dispose.call(this)},videojs.Silverlight.prototype.src=function(a){return a?void(CL.manifest.url="string"==typeof a?a:a.url):CL.manifest.url},videojs.Silverlight.prototype.currentSrc=function(){return CL.manifest.url||""},"undefined"==typeof XMLHttpRequest&&(XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}throw new Error("This browser does not support XMLHttpRequest.")});var XHTML_NS="http://www.w3.org/1999/xhtml",DFXP_NS="http://www.w3.org/ns/ttml",DFXP_NS_Parameter="http://www.w3.org/ns/ttml#parameter",DFXP_NS_Style="http://www.w3.org/ns/ttml#styling",DFXP_NS_Style_Extensions="http://www.w3.org/ns/ttml#style-extension",DFXP_NS_Metadata="http://www.w3.org/ns/ttml#metadata",DFXP_NS_Metadata_Extensions="http://www.w3.org/ns/ttml#metadata-extension",DFXP_NS_SMPTE="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",DFXP_TIME_CONTAINER_PAR=1,DFXP_TIME_CONTAINER_SEQ=2,HTML5Caption_debug=!1;HTML5Caption_toSeconds=function(a){var b=0;if(a){var c=a.split(":");switch(c.length){case 0:case 1:case 2:break;case 3:for(var d=0;3>d;d++)b=60*b+parseFloat(c[d].replace(",","."));break;case 4:for(var d=0;3>d;d++)b=60*b+parseFloat(c[d].replace(",","."));b+=.04*parseFloat(c[d].replace(",","."))}}return b},HTML5Caption_toPixels=function(a){if(a){var b=a.indexOf("px");if(b>0)return 1*a.substring(0,b)}return 0},HTML5Caption_strip=function(a){return a.replace(/^\s+|\s+$/g,"")},HTML5Caption_convertDFXP2HTMLAttributes=function(a,b,c,d,e){var f;a.hasAttributeNS(XHTML_NS,"style")&&(b.style.cssText=a.getAttributeNS(XHTML_NS,"style"));var g=a.getElementsByTagNameNS(DFXP_NS_SMPTE,"image");if(g&&g.length>0,f=a.getAttribute("smpte:backgroundImage"),a.hasAttribute("smpte:backgroundImage")){var h=a.ownerDocument.getElementById(f);if(null==h&&a.ownerDocument.getElementsByTagNameNS)for(var g=a.ownerDocument.getElementsByTagNameNS(DFXP_NS_SMPTE,"image"),i=0;i<g.length;i++){var j=g.item(i),k=j.getAttribute("xml:id");if(f.indexOf(k)>-1){h=j;break}}if(null!=h){var l=h.getAttribute("imagetype").toLowerCase(),m=h.getAttribute("encoding").toLowerCase(),n=h.innerHTML?h.innerHTML:h.textContent;n=n.trim(),b.style.setProperty("background-image","url(data:image/"+l+";"+m+","+n+")",""),b.style.setProperty("position","absolute",""),b.style.setProperty("left","0em",""),b.style.setProperty("right","0em",""),b.style.setProperty("bottom","0em",""),b.style.setProperty("background-repeat","no-repeat",""),b.style.setProperty("background-size","contain",""),b.style.setProperty("background-position","center bottom",""),b.style.setProperty("width","100%",""),b.style.setProperty("height","100%",""),b.style.setProperty("display","block",""),b.df_displayValue="block",HTML5Caption_convertDFXP2HTMLAttributes(h,b,c,d,e)}else HTML5Caption_debug&&alert("can't find image "+f)}if(f=a.getAttribute("region"),a.hasAttribute("region")){var h=a.ownerDocument.getElementById(f);if(null==h&&a.ownerDocument.getElementsByTagNameNS)for(var o=a.ownerDocument.getElementsByTagNameNS(DFXP_NS,"region"),i=0;i<o.length;i++){var j=o.item(i),k=j.getAttribute("xml:id");if(k==f){h=j;break}}if(null!=h){if(b.style.setProperty("overflow","hidden",""),HTML5Caption_convertDFXP2HTMLAttributes(h,b,c,d,e),h.getElementsByTagNameNS)for(var p=h.getElementsByTagNameNS(DFXP_NS,"style"),i=0;i<p.length;i++){var q=p.item(i);HTML5Caption_convertDFXP2HTMLAttributes(q,b,c,d,e)}}else HTML5Caption_debug&&alert("can't find region "+f)}var r,s;if(a.hasAttributeNS(DFXP_NS,"style")?(r=a.getAttributeNS(DFXP_NS,"style"),s=!0):a.hasAttribute("style")?(r=a.getAttribute("style"),s=!1):r=null,null!==r){f=r;var t=f.split(" ");switch(t.length){case 1:var h=a.ownerDocument.getElementById(f);if(null==h&&a.ownerDocument.getElementsByTagNameNS)for(var p=s===!0?a.ownerDocument.getElementsByTagNameNS(DFXP_NS,"style"):a.ownerDocument.getElementsByTagName("style"),i=0;i<p.length;i++){var q=p.item(i),k=q.getAttribute("xml:id");if(k==f){h=q;break}}break;default:HTML5Caption_debug&&alert("@@TODO IDREFS")}null!=h?HTML5Caption_convertDFXP2HTMLAttributes(h,b,c,d,e):HTML5Caption_debug&&alert("can't find "+f)}if(a.hasAttributeNS(DFXP_NS_SMPTE,"backgroundImageHorizontal")||a.hasAttributeNS(DFXP_NS_SMPTE,"backgroundImageVertical")){var u="",v="";u=a.getAttributeNS(DFXP_NS_SMPTE,"backgroundImageHorizontal"),v=a.getAttributeNS(DFXP_NS_SMPTE,"backgroundImageVertical"),b.style.setProperty("background-position",u+" "+v,"")}if(a.hasAttributeNS(DFXP_NS_Style,"backgroundColor")&&b.style.setProperty("background-color",a.getAttributeNS(DFXP_NS_Style,"backgroundColor"),""),a.hasAttributeNS(DFXP_NS_Style,"color")&&b.style.setProperty("color",a.getAttributeNS(DFXP_NS_Style,"color"),""),a.hasAttributeNS(DFXP_NS_Style,"direction")&&b.style.setProperty("direction",a.getAttributeNS(DFXP_NS_Style,"direction"),""),f=a.getAttributeNS(DFXP_NS_Style,"display"),"none"==f)b.style.setProperty("display","none",""),b.df_displayValue="none";else{var w;w="span"==b.localName?"inline":"block",(a.hasAttributeNS(DFXP_NS_Style,"display")||!b.df_displayValue)&&(b.style.setProperty("display",w,""),b.df_displayValue=w)}if(a.hasAttributeNS(DFXP_NS_Style,"fontFamily")&&b.style.setProperty("font-family",a.getAttributeNS(DFXP_NS_Style,"fontFamily"),""),a.hasAttributeNS(DFXP_NS_Style,"fontSize")&&b.style.setProperty("font-size",a.getAttributeNS(DFXP_NS_Style,"fontSize"),""),a.hasAttributeNS(DFXP_NS_Style,"fontStyle")&&b.style.setProperty("font-style",a.getAttributeNS(DFXP_NS_Style,"fontStyle"),""),a.hasAttributeNS(DFXP_NS_Style,"fontWeight")&&b.style.setProperty("font-weight",a.getAttributeNS(DFXP_NS_Style,"fontWeight"),""),f=a.getAttributeNS(DFXP_NS_Style,"lineHeight"),a.hasAttributeNS(DFXP_NS_Style,"lineHeight")&&("normal"==f&&(f="100%"),b.style.setProperty("line-height",f,"")),f=a.getAttributeNS(DFXP_NS_Style,"opacity"),a.hasAttributeNS(DFXP_NS_Style,"opacity")&&b.style.setProperty("opacity",f,""),f=a.getAttributeNS(DFXP_NS_Style,"overflow"),a.hasAttributeNS(DFXP_NS_Style,"overflow")&&("dynamic"==f?b.style.setProperty("overflow","scroll",""):b.style.setProperty("overflow",f,"")),f=a.getAttributeNS(DFXP_NS_Style,"extent"),a.hasAttributeNS(DFXP_NS_Style,"extent")&&"auto"!=f){var t=f.split(" ");t.length>0&&b.style.setProperty("width",t[0],""),t.length>1&&b.style.setProperty("height",t[1],""),t.length>0&&(b.dfxp_width=t[0]),t.length>1&&(b.dfxp_height=t[1])}if(f=a.getAttributeNS(DFXP_NS_Style,"origin"),a.hasAttributeNS(DFXP_NS_Style,"origin")&&"auto"!=f&&"inherit"!=f){for(var t=f.split(" "),x=b;null!=x;){if(x.hasOrigin){c=!0;break}x=x.parentNode}c||(b.style.setProperty("position","absolute",""),t.length>0&&b.style.setProperty("left",t[0].indexOf("%")>-1?t[0]:e+HTML5Caption_toPixels(t[0])+"px",""),t.length>1&&b.style.setProperty("top",t[1].indexOf("%")>-1?t[1]:e+HTML5Caption_toPixels(t[1])+"px","")),b.hasOrigin=!0}f=a.getAttributeNS(DFXP_NS_Style,"padding"),a.hasAttributeNS(DFXP_NS_Style,"padding")&&b.style.setProperty("padding",f,""),f=a.getAttributeNS(DFXP_NS_Style,"textAlign"),a.hasAttributeNS(DFXP_NS_Style,"textAlign")&&("start"==f||"left"==f?b.style.setProperty("text-align","left",""):"end"==f||"right"==f?b.style.setProperty("text-align","right",""):"center"==f?b.style.setProperty("text-align","center",""):b.style.setProperty("text-align",f,"")),f=a.getAttributeNS(DFXP_NS_Style,"textDecoration"),a.hasAttributeNS(DFXP_NS_Style,"textDecoration")&&("noUnderline"==f||"noOverline"==f||"noLineThrough"==f?f="none":"lineThrough"==f&&(f="line-through"),b.style.setProperty("text-decoration",f,"")),f=a.getAttributeNS(DFXP_NS_Style,"unicodeBidi"),a.hasAttributeNS(DFXP_NS_Style,"unicodeBidi")&&("bidiOverride"==f&&(f="bidi-override"),b.style.setProperty("unicode-bidi",f,"")),f=a.getAttributeNS(DFXP_NS_Style,"visibility"),a.hasAttributeNS(DFXP_NS_Style,"visibility")&&b.style.setProperty("visibility",f,""),f=a.getAttribute("xml:space"),a.hasAttribute("xml:space")&&(f="preserve"==f?"pre":"normal",b.style.setProperty("white-space",f,"")),f=a.getAttributeNS(DFXP_NS_Style,"wrapOption"),a.hasAttributeNS(DFXP_NS_Style,"wrapOption")&&"noWrap"==f&&b.style.setProperty("white-space","nowrap","")},HTML5Caption_convertDFXP2HTML=function(a,b,c,d){var e=null;if(0==a.aDur)return null;if(3==a.nodeType||4==a.nodeType){if("p"!=a.parentNode.localName&&"span"!=a.parentNode.localName)return null;if(a.parentNode.tContainer==DFXP_TIME_CONTAINER_SEQ)return null;e=document.createTextNode(a.data)}else if(1==a.nodeType){if(a.namespaceURI==DFXP_NS_Metadata_Extensions||a.namespaceURI==DFXP_NS_Metadata)return null;if(a.namespaceURI==DFXP_NS){if("head"==a.localName)return null;if(a.aDur<=0)return null;if("span"==a.localName)e=document.createElementNS(XHTML_NS,"span");else if("p"==a.localName)e=document.createElementNS(XHTML_NS,"p");else if("div"==a.localName)e=document.createElementNS(XHTML_NS,"div");else if("br"==a.localName)e=document.createElementNS(XHTML_NS,"br");else{if("body"!=a.localName)return null;e=document.createElementNS(XHTML_NS,"div"),e.className="dfxp"}}else if(a.namespaceURI==XHTML_NS)try{e=document.importNode(a,!0)}catch(f){return null}}if(e.aBegin=a.aBegin,e.aEnd=a.aEnd,HTML5Caption_debug&&1==e.nodeType){e.setAttribute("relative_begin",a.rBegin),e.setAttribute("relative_end",a.rEnd),e.setAttribute("relative_dur",a.rDur),e.setAttribute("active_begin",a.aBegin),e.setAttribute("active_end",a.aEnd),e.setAttribute("active_dur",a.aDur);var g=null;a.tContainer==DFXP_TIME_CONTAINER_PAR?g="par":a.tContainer==DFXP_TIME_CONTAINER_SEQ&&(g="seq"),null!=g&&e.setAttribute("timeContainer",g)}if(a.tContainer){e.hasOrigin=!1,HTML5Caption_convertDFXP2HTMLAttributes(a,e,b,c,d),HTML5Caption_debug&&("p"==e.localName||"div"==e.localName||"span"==e.localName)&&e.appendChild(document.createTextNode("["+e.aBegin+"-"+e.aEnd+"]"));for(var h=a.childNodes,i=0;i<h.length;i++){var j=HTML5Caption_convertDFXP2HTML(h.item(i),e.hasOrigin,c,d);null!=j&&e.appendChild(j)}}return e};var TIME_INDEFINITE=-1,TIME_INFINITY_AND_BEYOND=1/0;HTML5Caption_convertDFXPDuration=function(a){var b=0;if(null==a||""==a)return TIME_INDEFINITE;if(-1!=a.indexOf(":"))return HTML5Caption_toSeconds(a);if(-1!=(b=a.indexOf("h")))return 3600*parseFloat(a.substring(0,b));if(-1!=(b=a.indexOf("m")))return 60*parseFloat(a.substring(0,b));if(-1!=(b=a.indexOf("s")))return parseFloat(a.substring(0,b));if(-1!=(b=a.indexOf("ms")))return parseFloat(a.substring(0,b))/1e3;if(-1!=(b=a.indexOf("t")))throw new Error("tick duration is not supported");if(-1!=(b=a.indexOf("f")))throw new Error("frame duration is not supported")},HTML5Caption_computeRelativeTimeIntervals=function(a){if(a.namespaceURI!=DFXP_NS||"body"!=a.localName&&"div"!=a.localName&&"p"!=a.localName&&"span"!=a.localName)return void("p"!=a.parentNode.localName&&"span"!=a.parentNode.localName?(a.rBegin=0,a.rEnd=0,a.rDur=0):a.parentNode.tContainer==DFXP_TIME_CONTAINER_SEQ?(a.rBegin=0,a.rEnd=0,a.rDur=0):a.parentNode.tContainer==DFXP_TIME_CONTAINER_PAR&&(a.rBegin=0,a.rEnd=TIME_INFINITY_AND_BEYOND,a.rDur=TIME_INFINITY_AND_BEYOND));var b=null;a.hasAttribute("timeContainer")?b=a.getAttribute("timeContainer"):a.hasAttributeNS(DFXP_NS,"timeContainer")&&(b=a.getAttributeNS(DFXP_NS,"timeContainer")),a.tContainer="seq"==b?DFXP_TIME_CONTAINER_SEQ:DFXP_TIME_CONTAINER_PAR;var c=null,d=null,e=null;a.hasAttribute("begin")?(c=a.getAttribute("begin"),d=a.getAttribute("end"),e=a.getAttribute("begin")):a.hasAttributeNS(DFXP_NS,"begin")&&(c=a.getAttributeNS(DFXP_NS,"begin"),d=a.getAttributeNS(DFXP_NS,"end"),e=a.getAttributeNS(DFXP_NS,"dur"));var f=HTML5Caption_convertDFXPDuration(c),g=HTML5Caption_convertDFXPDuration(d),h=HTML5Caption_convertDFXPDuration(e);f!=TIME_INDEFINITE?g!=TIME_INDEFINITE?h=g-f:h!=TIME_INDEFINITE&&(g=f+h):(f=0,g!=TIME_INDEFINITE?h=g:h!=TIME_INDEFINITE&&(g=h)),0>=h&&(g=TIME_INDEFINITE,h=TIME_INDEFINITE),h==TIME_INDEFINITE&&a.parentNode.tContainer==DFXP_TIME_CONTAINER_SEQ&&(f=0,g=0,h=0),a.rBegin=f,a.rEnd=g,a.rDur=h;for(var i=a.childNodes,j=0;j<i.length;j++){var k=i.item(j);HTML5Caption_computeRelativeTimeIntervals(k)}if(a.rEnd==TIME_INDEFINITE){if(a.tContainer==DFXP_TIME_CONTAINER_PAR)for(var i=a.childNodes,j=0;j<i.length;j++){var k=i.item(j);k.rEnd>a.rEnd&&(a.rEnd=k.rEnd)}else{for(var l=!1,m=0,i=a.childNodes,j=0;!l&&j<i.length;j++){var k=i.item(j);k.rEnd==TIME_INDEFINITE&&(l=!0),m+=k.rDur+k.rBegin}l||(a.rEnd=m)}a.rEnd!=TIME_INDEFINITE&&(a.rDur=a.rEnd-a.rBegin)}},HTML5Caption_computeActiveTimeIntervals=function(a){1==a.nodeType&&a.namespaceURI==DFXP_NS&&"body"==a.localName&&HTML5Caption_computeRelativeTimeIntervals(a),a.aBegin=TIME_INDEFINITE,a.aEnd=TIME_INDEFINITE,a.aDur=TIME_INDEFINITE;var b=a.parentNode;if("body"==a.localName)a.aBegin=a.rBegin,a.aEnd=a.rEnd;else if(b.tContainer==DFXP_TIME_CONTAINER_PAR)a.rDur!=TIME_INDEFINITE&&(a.aBegin=a.rBegin+a.parentNode.aBegin,a.aEnd=a.rEnd+a.parentNode.aBegin);else if(a.rDur!=TIME_INDEFINITE){for(var c=a.previousSibling;null!=c&&!c.tContainer;)c=c.previousSibling;null!=c?c.aDur!=TIME_INDEFINITE&&(a.aBegin=a.rBegin+c.aEnd,a.aEnd=a.rEnd+c.aEnd):a.rDur!=TIME_INDEFINITE&&(a.aBegin=a.rBegin+a.parentNode.aBegin,a.aEnd=a.rEnd+a.parentNode.aBegin)}if(a.aEnd!=TIME_INDEFINITE&&(a.aEnd>a.parentNode.aEnd&&(a.aEnd=a.parentNode.aEnd),a.aBegin>a.aEnd?(a.aBegin=TIME_INDEFINITE,a.aEnd=TIME_INDEFINITE):a.aDur=a.aEnd-a.aBegin),a.aDur!=TIME_INDEFINITE&&a.tContainer)for(var d=a.childNodes,e=0;e<d.length;e++)HTML5Caption_computeActiveTimeIntervals(d.item(e))},HTML5Caption_getSubtitleSetRef=function(a,b){if(a.aBegin>=0){null!=a.parentNode&&a.parentNode.aBegin>=0&&a.parentNode.aBegin==a.aBegin&&a.parentNode.aEnd==a.aEnd||(b[b.length]=a,HTML5Caption_debug||(a.style.display="none"),a.df_isInTime=!1);for(var c=a.childNodes,d=c.length,e=0;d>e;e++){var f=c.item(e);1==f.nodeType&&HTML5Caption_getSubtitleSetRef(f,b)}}},HTML5Caption_getSubtitleSet=function(a){var b=new Array;return HTML5Caption_getSubtitleSetRef(a,b),b},function(){"use strict";castLabs.parseUrl=function(a){var b,c,d,e,f;e=["protocol","hostname","port","pathname","search","hash","host"],c=videojs.Component.prototype.createEl("a",{href:a}),d=""===c.host&&"file:"!==c.protocol,d&&(b=videojs.Component.prototype.createEl("div"),b.innerHTML='<a href="'+a+'"></a>',c=b.firstChild,b.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(b)),f={};for(var g=0;g<e.length;g++)f[e[g]]=c[e[g]];return d&&document.body.removeChild(b),f},castLabs.xhr=function(a,b,c){var d,e,f,g,h,i,j,k,l;"string"==typeof a&&(a={uri:a}),videojs.util.mergeOptions({method:"GET",timeout:45e3},a),b=b||function(){},k=function(){window.clearTimeout(j),b(null,e,e.response||e.responseText,c)},l=function(a){window.clearTimeout(j),a&&"string"!=typeof a||(a=new Error(a)),b(a,e)},d=window.XMLHttpRequest,"undefined"==typeof d&&(d=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(c){}throw new Error("This browser does not support XMLHttpRequest.")}),e=new d,e.uri=a.uri,f=castLabs.parseUrl(a.uri),g=window.location,i=f.protocol+f.host!==g.protocol+g.host,!i||!window.XDomainRequest||"withCredentials"in e?(h="file:"===f.protocol||"file:"===g.protocol,e.onreadystatechange=function(){if(4===e.readyState){if(e.timedout)return l("timeout");200===e.status||h&&0===e.status?k():l()}},a.timeout&&(j=window.setTimeout(function(){4!==e.readyState&&(e.timedout=!0,e.abort())},a.timeout))):(e=new window.XDomainRequest,e.onload=k,e.onerror=l,e.onprogress=function(){},e.ontimeout=function(){});try{e.open(a.method||"GET",a.uri,!0),void 0!==a.responseType&&(e.responseType=a.responseType)}catch(m){return l(m)}a.withCredentials&&(e.withCredentials=!0),a.responseType&&(e.responseType=a.responseType);try{a.method&&"POST"===a.method&&a.params?(e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(a.params)):e.send()}catch(m){return l(m)}return e},castLabs.TextTrack=videojs.Component.extend({init:function(a,b){videojs.Component.call(this,a,b);var c=function(a,b){var e=a.length;if(2>e)return a;var f=Math.ceil(e/2);return d(c(a.slice(0,f),b),c(a.slice(f),b),b)},d=function(a,b,c){for(var d=[];a.length>0&&b.length>0;)d.push(a[0][c]<b[0][c]?a.shift():b.shift());return d=d.concat(a,b)};if(this.fastSort=c,isNaN(videojs.guid)&&(videojs.guid=0),this.id_=b.id||"vjs_"+b.kind+"_"+b.language+"_"+videojs.guid++,this.sourceStartTimeArray=[],this.sourcesSourceObject={},this.lastAppendedTextFragmentTime=0,b.sources)for(var e=0;e<b.sources.length;e++)this.sourceStartTimeArray.push(b.sources[e].startTime),this.sourcesSourceObject[b.sources[e].startTime]=b.sources[e].src;b.src&&(this.sourceStartTimeArray.push(0),this.sourcesSourceObject[0]=b.src),this.timescale_=b.timescale||1,this.playerId_=b.playerId,this.adaptionIndex_=b.adaptionIndex,this.dflt_=b.default||b.dflt,this.title_=b.title,this.language_=b.srclang,this.label_=b.label,this.cues_=[],this.currentCueKey=null,this.activeCues_=[],this.callbackIndex_=void 0,this.wasSeeking=!1,this.readyState_=0,this.mode_=0,this.kind_="subtitles",this.player_=a,this.el_=this.el(),this.el_.classList.add("vjs-subtitles"),this.el_.classList.add("vjs-text-track"),this.el_.innerHTML='<div id="captions"></div>',a.on("dispose",videojs.bind(this,this.deactivate,this.id_)),a.on("loadedmetadata",videojs.bind(this,this.deactivate,this.id_));var f=this.player_.getChild("textTrackDisplay"),g=this,h=function(a){var b=a.match(/(\d*(\.\d*)?)px/),c=0;return null!==b&&b.length>0&&(c=Number(b[1])),c},i=function(){var a,b,c=(g.player_.el(),getComputedStyle(f.el(),"")),d=getComputedStyle(g.player_.el(),"");a=h(d.height),b=a-h(c.top)-h(c.bottom),f.el().style.height=b+"px"};i(),a.on(["resize","fullscreenchange","useractive","userinactive"],function(){i()}),this.isLive=1/0===this.player().duration()?!0:!1}}),castLabs.TextTrack.prototype.kind=function(){return this.kind_},castLabs.TextTrack.prototype.src=function(){return this.src_},castLabs.TextTrack.prototype.dflt=function(){return this.dflt_},castLabs.TextTrack.prototype.title=function(){return this.title_},castLabs.TextTrack.prototype.language=function(){return this.language_},castLabs.TextTrack.prototype.label=function(){return this.label_
},castLabs.TextTrack.prototype.cues=function(){return this.cues_},castLabs.TextTrack.prototype.activeCues=function(){return this.activeCues_},castLabs.TextTrack.prototype.readyState=function(){return this.readyState_},castLabs.TextTrack.prototype.mode=function(){return this.mode_},castLabs.TextTrack.prototype.show=function(){this.activate(),this.mode_=2,videojs.Component.prototype.show.call(this)},castLabs.TextTrack.prototype.hide=function(){this.mode_=1,videojs.Component.prototype.hide.call(this)},castLabs.TextTrack.prototype.disable=function(){void 0!==this.callbackIndex_&&(clearTimeout(this.callbackIndex_),this.callbackIndex_=void 0),2===this.mode_&&this.hide(),this.deactivate(),this.mode_=0},castLabs.TextTrack.prototype.activate=function(){var a=this;CL.configs.activeTrack.text={id:this.playerId_,adaptionIndex:this.adaptionIndex_};var b=!1,c=a.player_.options().trackTimeOffset||0,d=a.isLive===!0?a.player_.absoluteTime():a.player_.currentTime()+c;this.isLive===!0&&a.sourceStartTimeArray.length>0&&d>a.sourceStartTimeArray[a.sourceStartTimeArray.length-1]/1e7&&(b=!0,CL.configs.needManifestUpdate=!0,this.player_.one("manifestLoaded",function(){a.lastAppendedTextFragmentTime=0,a.load()})),this.isLiveTimerRun=!0,b!==!1||0!==this.readyState_&&!Object.keys(this.sourcesSourceObject).length||this.load(),0===this.mode_&&(this.player_.on("timeupdate",videojs.bind(this,this.update,this.id_)),this.player_.on("ended",videojs.bind(this,this.reset,this.id_)),("captions"===this.kind_||"subtitles"===this.kind_)&&this.player_.getChild("textTrackDisplay").addChild(this))},castLabs.TextTrack.prototype.deactivate=function(){this.isLiveTimerRun=!1,this.player_.off("timeupdate",videojs.bind(this,this.update,this.id_)),this.player_.off("ended",videojs.bind(this,this.reset,this.id_)),this.reset(),this.player_.getChild("textTrackDisplay").removeChild(this)},castLabs.TextTrack.prototype.load=function(){var a,b,c,d={},e=this,f=!1,g=function(b){if(e.abort_!==!0){if(!b||b>=e.sourceStartTimeArray.length){if(e.isLive===!0)return void(f=!1);b=0}if(a=b,e.sourcesSourceObject[e.sourceStartTimeArray[a]]){d.src=e.sourcesSourceObject[e.sourceStartTimeArray[a]],d.startTime=e.sourceStartTimeArray[a];var c={startTime:d.startTime},i={uri:d.src,responseType:"arraybuffer"};castLabs.xhr(i,videojs.bind(e,h),c)}else a+1>=e.sourceStartTimeArray.length?e.isLive===!0||g(0):g(a+=1)}},h=function(c,d,f,h){if(c)return this.onError(c);if(this.trigger("cueloaded"),e.lastAppendedTextFragmentTime=h.startTime,this.parseCues(f,!0,h.startTime),delete this.sourcesSourceObject[this.sourceStartTimeArray[a]],Object.keys(this.sourcesSourceObject).length>0||this.isLive===!0){if(this.player().activeSubtitleTrack===this.playerId_&&!b){var i=e.player_.options().trackTimeOffset||0,j=e.isLive===!0?e.player_.absoluteTime():e.player_.currentTime()+i;h.startTime/1e7-j>10?void 0===e.callbackIndex_?e.callbackIndex_=setTimeout(function(){e.callbackIndex_=void 0,g(a+=1)},1e3):(clearTimeout(e.callbackIndex_),e.callbackIndex_=void 0):g(a+=1)}}else this.player().trigger("texttracksready"),this.reset(),this.readyState_=2,this.trigger("loaded"),this.isLive&&(this.sourceStartTimeArray=[],a=0),window.activeTextTrack_=this,window.cues_=this.cues_},i=function(){var a=e.player_.options().trackTimeOffset||0,b=e.isLive===!0?e.player_.absoluteTime():e.player_.currentTime()+a,d=1e7*b;for(c=0;c<e.sourceStartTimeArray.length;c++){var f=Number(e.sourceStartTimeArray[c]);if(f>=d)return c-1}return e.sourceStartTimeArray.length-1},j=function(a){if("dfxp"===a.className)for(a.style.display="none",e.dfxp=null,c=0;c<a.childNodes.length;c++)j(a.childNodes[c]);else for(c=0;c<a.childNodes.length;c++)"p"===a.childNodes[c].localName&&(a.childNodes[c].style.display="none")};this.isLive&&(CL.configs.isLiveTimeInterval||(CL.configs.isLiveTimeInterval=2e3),this.isLiveTimerHandler=function(){if(CL.configs.subtitlesOff!==!0&&e.isLiveTimerRun){{var a=e.player_.options().trackTimeOffset||0,b=e.isLive===!0?e.player_.absoluteTime():e.player_.currentTime()+a;e.lastAppendedTextFragmentTime/1e7-b}if(f===!0)return;for(var c=e.player_.subtitleTracks(),d=!1,h=0;h<c.length;h++)if(c[h].id===e.playerId_)for(var j=c[h].sources,k=0,l=j.length-1;l>0;l--){var m=j[l].startTime;if(-1!=e.sourceStartTimeArray.indexOf(m))break;d=!0,delete e.sourcesSourceObject[e.sourceStartTimeArray[0]],e.sourceStartTimeArray.shift(),e.sourceStartTimeArray.splice(e.sourceStartTimeArray.length-k,0,m),e.sourcesSourceObject[m]=j[l].src,k++}d===!0&&(f=!0,g(i()))}else window.clearInterval(e.isLiveTimer);void 0!==this.isLiveTimer&&clearInterval(this.isLiveTimer)},this.isLiveTimer=setInterval(this.isLiveTimerHandler,CL.configs.isLiveTimeInterval)),(0===this.readyState_||Object.keys(this.sourcesSourceObject).length)&&(this.startTime=(new Date).getTime(),0===this.readyState_&&(this.readyState_=1,this.player_.on("seeking",function(){e.dfxp&&j(e.dfxp),2!==e.readyState_&&(b=!0)}),this.player_.on("seeked",function(){e.wasSeeking=!0,2!==e.readyState_?(b=!1,g(i())):(e.prevChange=void 0,e.nextChange=void 0,e.firstActiveIndex=0,e.lastActiveIndex=0)}),g(i())),Object.keys(this.sourcesSourceObject).length>1)},castLabs.TextTrack.prototype.onError=function(a){this.error=a,this.readyState_=3,this.trigger("error")},castLabs.TextTrack.prototype.parseCues=function(a,b,c){var d,e,f,g=0;if(b){var h=new castLabsDashJS.classes.Utils,i=new Uint8Array(a);if(CL.configs.isSmoothStreaming===!1)a=h.utf8ArrayToStr(i);else{var j=h.getSubBox(i,"moof"),k=h.getSubBox(i,"mdat");CL.manifest.useLookAheadFragments===!0&&(j=h.parseSmoothStreamingFragment(null,i,"text",0)),a=h.utf8ArrayToStr(k)}a=a.substring(a.indexOf("<tt"),a.length),a=a.replace(/http:\/\/www.w3.org\/2006\/10\/ttaf1/gi,"http://www.w3.org/ns/ttml");for(var l,m,n=/xmlns:(.+?)=/gi;l=n.exec(a);)m=l[1],-1===m.indexOf("tt")&&-1===m.indexOf("xhtm")&&-1===m.indexOf("smpt")}if(CL.configs.debug&&console.log("startTime is "+c/this.timescale_),"<tt "===a.toLowerCase().substr(0,4)||"<?xml"===a.toLowerCase().substr(0,5)){var o=this.player(),p=new DOMParser,q=p.parseFromString(a,"text/xml");this.isTTML=!0;var r=o.currentTime();if(g=c/this.timescale_,"undefined"==typeof r)throw new Error("currentTime is not supported by the Video element");q.bodyElement="undefined"==typeof q.getElementsByTagNameNS?q.documentElement.childNodes.item(1):q.getElementsByTagNameNS(DFXP_NS,"body").item(0);var s=!1;for(e=0;e<q.bodyElement.childNodes.length;e++)if("div"===q.bodyElement.childNodes[e].nodeName&&q.bodyElement.childNodes[e].attributes.length)for(f=0;f<q.bodyElement.childNodes[e].attributes.length;f++)"begin"===q.bodyElement.childNodes[e].attributes[f].name&&(s=!0);if(s){var t=a.split("<body>")[0];t+="<body>\n<div>\n";var u,v=1;for(e=0;e<q.bodyElement.childNodes.length;e++){var w,x,y,z=[];if("div"===q.bodyElement.childNodes[e].nodeName){for(f=0;f<q.bodyElement.childNodes[e].attributes.length;f++)"begin"===q.bodyElement.childNodes[e].attributes[f].name&&(w=q.bodyElement.childNodes[e].attributes[f].value),"end"===q.bodyElement.childNodes[e].attributes[f].name&&(x=q.bodyElement.childNodes[e].attributes[f].value);for(f=0;f<q.bodyElement.childNodes[e].childNodes.length;f++)if("p"===q.bodyElement.childNodes[e].childNodes[f].nodeName){for(var A=0;A<q.bodyElement.childNodes[e].childNodes[f].attributes.length;A++)"region"===q.bodyElement.childNodes[e].childNodes[f].attributes[A].name&&(y=q.bodyElement.childNodes[e].childNodes[f].attributes[A].value,u=y);z.push(q.bodyElement.childNodes[e].childNodes[f].childNodes[0].nodeValue)}t+='<p region="'+y+'" begin="'+w+'" id="p'+v+'" end="'+x+'" >'+z.join("<br/>")+"</p>\n",v+=1}}t+="</div>\n</body>\n</tt>",q=p.parseFromString(t,"text/xml"),q.bodyElement="undefined"==typeof q.getElementsByTagNameNS?q.documentElement.childNodes.item(1):q.getElementsByTagNameNS(DFXP_NS,"body").item(0)}new HTML5Caption_computeActiveTimeIntervals(q.bodyElement);var B=0,C=0;o.offsetTop&&(B=o.offsetTop),o.offsetLeft&&(C=o.offsetLeft);var D=HTML5Caption_convertDFXP2HTML(q.bodyElement,!1,B,C);if(null===D)return;new HTML5Caption_convertDFXP2HTMLAttributes(q.documentElement,D,!1,0,0);var E=HTML5Caption_getSubtitleSet(D);1/0===E[0].aEnd&&(E[0].aEnd=this.player_.duration());var F;this.captionsElement_?F=this.captionsElement_:(F=document.getElementById("captions"),null===F&&(this.el_.innerHTML='<div id="captions"></div>',F=this.el_.children[0]),this.captionsElement_=F,this.orgParent=F.parentNode);try{F.appendChild(D)}catch(G){CL.configs.debug&&console.log(G)}null===F.parentNode&&(CL.configs.debug&&console.log("captionsElement has no parent node, attaching..."),this.orgParent.appendChild(F));var H,I=E.length;for(e=0;I>e;e++)if(H=E[e],L={id:e,index:this.cues_.length},L.startTime=H.aBegin+g,L.endTime=H.aEnd+g,1/0!==L.endTime&&1/0!==L.startTime){if(CL.configs.debug&&console.log("adding cue from/to "+L.startTime+"/"+L.endTime),L.endTime-L.startTime<.1&&(CL.configs.debug&&console.log("WARNING: Cue is short: "),CL.configs.debug&&console.log(L)),L.node=H,void 0!==this.player().options().customCueParser){var J;J=this.player().options().customCueParser(L),void 0!==J&&null!==J&&(L=J)}this.cues_.push(L),this.cues_=this.fastSort(this.cues_,"startTime"),void 0===this.lastForcedCueUpdate&&(this.lastForcedCueUpdate=(new Date).getTime());var K=(new Date).getTime();K-this.lastForcedCueUpdate>1e3,this.lastForcedCueUpdate=K}this.wasSeeking===!0&&(this.reset(),this.wasSeeking=!1)}else if("webvtt"===a.trim().toLowerCase().substr(0,6)){var L,M,N,O,P=a.split("\n"),Q="";for(e=1,O=P.length;O>e;e++)if(Q=videojs.trim(P[e])){for(-1===Q.indexOf("-->")?(d=Q,Q=videojs.trim(P[++e])):d=this.cues_.length,L={id:d,index:this.cues_.length},M=Q.split(/[\t ]+/),L.startTime=this.parseCueTime(M[0]),L.endTime=this.parseCueTime(M[2]),N=[];P[++e]&&(Q=videojs.trim(P[e]));)N.push(Q);L.text=N.join("<br/>"),this.cues_.push(L)}}else CL.configs.debug&&CL.configs.debug&&console.log("Unknown subtitle format, skipping file.")},castLabs.TextTrack.prototype.parseCueTime=function(a){var b,c,d,e,f,g=a.split(":"),h=0;return 3===g.length?(b=g[0],c=g[1],d=g[2]):(b=0,c=g[0],d=g[1]),d=d.split(/\s+/),e=d.splice(0,1)[0],e=e.split(/\.|,/),f=parseFloat(e[1]),e=e[0],h+=3600*parseFloat(b),h+=60*parseFloat(c),h+=parseFloat(e),f&&(h+=f/1e3),h};castLabs.TextTrack.prototype.update=function(){var a,b,c,d,e,f=this.activeCues_;if(this.cues_.length>0&&(d=this.player_.options().trackTimeOffset||0,e=this.isLive===!0?this.player_.absoluteTime():this.player_.currentTime()+d,void 0===this.prevChange||e<this.prevChange||this.nextChange<=e||this.isLive)){var g,h,i,j=this.cues_,k=this.player_.duration(),l=0,m=!1,n=[];for(c=void 0!==this.firstActiveIndex?this.firstActiveIndex:0,CL.configs.debug&&console.log("cue starting at index: "+c+" "+this.firstActiveIndex+"/"+j.length);;){if(i=j[c],this.isLive===!0,CL.configs.debug,i.endTime<=e)l=Math.max(l,i.endTime),i.active&&(i.active=!1);else if(e<i.startTime){if(k=Math.min(k,i.startTime),i.active&&(i.active=!1),!m)break}else m?(n.splice(0,0,i),void 0===h&&c>0&&(h=c),g=c):(n.push(i),void 0===g&&(g=c),h=c),k=Math.min(k,i.endTime),l=Math.max(l,i.startTime),i.active=!0;if(m){if(0===c)break;c--}else{if(c===j.length-1)break;c++}}this.activeCues_=n,this.nextChange=k,this.prevChange=l,this.firstActiveIndex=g?g:this.firstActiveIndex,this.lastActiveIndex=h?h:this.lastActiveIndex,this.updateDisplay(),this.trigger("cuechange")}for(a=this.activeCues_,c=0;c<f.length;c++)if(b=f[c],void 0!==b.node){for(var o=!1,p=0;p<a.length;p++)if(a[p]===b){o=!0;break}if(!o){var q=b.node;q.style.display="none"}}},castLabs.TextTrack.prototype.updateDisplay=function(){for(var a=this.activeCues_,b="",c=0,d=a.length,e=!1;d>c;c++)if(void 0!==a[c].node){0===c&&null===this.captionsElement_.parentNode&&(this.orgParent.appendChild(this.captionsElement_),CL.configs.debug&&console.log("Warning: Reattaching missing captions element")),e=!0;var f=a[c].node;f.style.display=null===f.df_displayValue?"block":f.df_displayValue,"p"!==f.localName||f.hasOrigin!==!1||f.style.position||(f.style.position="absolute",f.style.left="0em",f.style.right="0em",f.style.bottom="0em",f.style.removeProperty("width"),f.style.removeProperty("height"),f.style.removeProperty("font-size"))}else b+='<span class="vjs-tt-cue" style="background-color:rgba(0,0,0,.5);position:absolute;left:0em;right:0em;bottom:0em">'+a[c].text+"</span>";e||(this.el_.innerHTML=""+b)},castLabs.TextTrack.prototype.reset=function(){this.nextChange=0,this.prevChange=this.player_.duration(),this.firstActiveIndex=0,this.lastActiveIndex=0},castLabs.SubtitlesTrack=castLabs.TextTrack.extend(),castLabs.SubtitlesTrack.prototype.kind_="subtitles"}(),videojs.plugin("texttracks",function(a){var b=this;hideTextTrack=function(a){for(var c,d=b.textTracks_,e=0,f=d.length;f>e;e++)c=d[e],c.id()===a&&c.disable();return this},showTextTrack=function(a,c){for(var d,e,f,g=b.textTracks_,h=0,i=g.length;i>h;h++)d=g[h],d.id()===a?(d.show(),e=d):c&&d.kind()==c&&d.mode()>0&&d.disable();return f=e?e.kind():c?c:!1,f&&this.trigger(f+"trackchange"),this},addTextTrack=function(a,c,d,e){var f=b.textTracks_=b.textTracks_||[];e=e||{},e.kind=a,e.label=c,e.language=d;var g=new castLabs.TextTrack(b,e);return f.push(g),g};var c=videojs.MenuItem.extend({init:function(a,b){var c={label:b.label_};videojs.MenuItem.call(this,a,c),this.track=b,this.on("click",this.onClick)}});c.prototype.onClick=function(){this.trigger({type:"selected",track:this.track})};var d=videojs.MenuButton.extend({init:function(a,b,c){a.textTracks_=[];var d,e=new castLabs.utils.Internationalization;if(d=void 0!==a.subtitleTracks?a.subtitleTracks():[],!(d.length<=0)){for(var f=0;f<d.length;f++){var g,h,i;h=d[f],g={src:h.src,sources:h.sources,timescale:h.timescale,playerId:h.id,adaptionIndex:h.adaptionIndex},i=e.translateLanguageCode(h.lang,"en"),addTextTrack("subtitles",i,h.lang,g)}videojs.MenuButton.call(this,a,b,c),d.length<=0?this.hide():this.show(),this.el().setAttribute("aria-label","Subtitles Menu");var j=this;setTextTrack=function(a){j.selectItem({playerId:a})},a.setTextTrack=setTextTrack}}});d.prototype.buttonText="Subtitles",d.prototype.className="vjs-subtitles-button",d.prototype.createItems=function(){var a,c=this;this.items=[];var d=new videojs.MenuItem(b,{label:"Off"});for(d.selected_=!1,d.on("click",function(){c.selectItem({}),this.selected(!1),CL.configs.subtitlesOff=!0}),this.items.push(d),a=0;a<b.textTracks_.length;a++)this.items.push(this.createItem(b.textTracks_[a]));return this.items},d.prototype.createItem=function(a){var b;return b=new c(this.player(),a),b.selected_=!1,b.on("selected",videojs.bind(this,this.selectItem)),b},d.prototype.selectItem=function(a){this.player().activeSubtitleTrack=null;for(var b=1;b<this.items.length;b++)void 0!==a.track&&this.items[b].track.id()===a.track.id()||void 0!==a.playerId&&this.items[b].track.playerId_===a.playerId?(this.items[b].selected_===!0?(this.items[b].track.disable(),this.items[b].selected(!1),this.items[b].selected_=!1):(this.items[b].track.show(),this.items[b].selected(!0),this.items[b].selected_=!0,this.player().activeSubtitleTrack=this.items[b].track.playerId_,CL.configs.subtitlesOff=!1),this.player().trigger({type:"trackchanged",trackType:"text",trackId:this.items[b].track.playerId_,trackEnabled:this.items[b].selected_})):(this.items[b].selected_===!0&&this.player().trigger({type:"trackchanged",trackType:"text",trackId:this.items[b].track.playerId_,trackEnabled:!1}),this.items[b].track.disable(),this.items[b].selected(!1),this.items[b].selected_=!1)};var e=null;b.on("loadedmetadata",function(){null!==e&&e.dispose&&e.el()&&e.dispose(),e=new d(b,a),b.controlBar.addChild(e)}),d.prototype.dispose=function(){try{videojs.Component.prototype.dispose.call(this)}catch(a){}}}),castLabs.utils||(castLabs.utils={}),castLabs.utils.Internationalization=function(){var a={ab:"Abkhazian",aa:"Afar",af:"Afrikaans",ak:"Akan",sq:"Albanian",am:"Amharic",ar:"Arabic",an:"Aragonese",hy:"Armenian",as:"Assamese",av:"Avaric",ae:"Avestan",ay:"Aymara",az:"Azerbaijani",bm:"Bambara",ba:"Bashkir",eu:"Basque",be:"Belarusian",bn:"Bengali",bh:"Bihari languages",bi:"Bislama",nb:"Bokml, Norwegian; Norwegian Bokml",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",es:"Spanish; Castilian",ca:"Catalan; Valencian",km:"Central Khmer",ch:"Chamorro",ce:"Chechen",ny:"Chichewa; Chewa; Nyanja",ny:"Chichewa; Chewa; Nyanja",zh:"Chinese",za:"Zhuang; Chuang",cu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",cu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",cv:"Chuvash",kw:"Cornish",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",dv:"Divehi; Dhivehi; Maldivian",dv:"Divehi; Dhivehi; Maldivian",nl:"Dutch; Flemish",dz:"Dzongkha",en:"English",eo:"Esperanto",et:"Estonian",ee:"Ewe",fo:"Faroese",fj:"Fijian",fi:"Finnish",nl:"Dutch; Flemish",fr:"French",ff:"Fulah",gd:"Gaelic; Scottish Gaelic",gl:"Galician",lg:"Ganda",ka:"Georgian",de:"German",ki:"Kikuyu; Gikuyu",el:"Greek, Modern (1453-)  ",kl:"Kalaallisut; Greenlandic",gn:"Guarani",gu:"Gujarati",ht:"Haitian; Haitian Creole",ht:"Haitian; Haitian Creole",ha:"Hausa",he:"Hebrew",hz:"Herero",hi:"Hindi",ho:"Hiri Motu",hu:"Hungarian",is:"Icelandic",io:"Ido",ig:"Igbo",id:"Indonesian",ia:"Interlingua (International Auxiliary Language Association) ",ie:"Interlingue; Occidental",iu:"Inuktitut",ik:"Inupiaq",ga:"Irish",it:"Italian",ja:"Japanese",jv:"Javanese",kl:"Kalaallisut; Greenlandic",kn:"Kannada",kr:"Kanuri",ks:"Kashmiri",kk:"Kazakh",ki:"Kikuyu; Gikuyu",rw:"Kinyarwanda",ky:"Kirghiz; Kyrgyz",kv:"Komi",kg:"Kongo",ko:"Korean",kj:"Kuanyama; Kwanyama",ku:"Kurdish",kj:"Kuanyama; Kwanyama",ky:"Kirghiz; Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lb:"Luxembourgish; Letzeburgesch",li:"Limburgan; Limburger; Limburgish",li:"Limburgan; Limburger; Limburgish",li:"Limburgan; Limburger; Limburgish",ln:"Lingala",lt:"Lithuanian",lu:"Luba-Katanga",lb:"Luxembourgish; Letzeburgesch",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",dv:"Divehi; Dhivehi; Maldivian",mt:"Maltese",gv:"Manx",mi:"Maori",mr:"Marathi",mh:"Marshallese",ro:"Romanian; Moldavian; Moldovan",ro:"Romanian; Moldavian; Moldovan",mn:"Mongolian",na:"Nauru",nv:"Navajo; Navaho",nv:"Navajo; Navaho",nd:"Ndebele, North; North Ndebele",nr:"Ndebele, South; South Ndebele",ng:"Ndonga",ne:"Nepali",nd:"Ndebele, North; North Ndebele",se:"Northern Sami",no:"Norwegian",nb:"Bokml, Norwegian; Norwegian Bokml",nn:"Norwegian Nynorsk; Nynorsk, Norwegian",ii:"Sichuan Yi; Nuosu",ny:"Chichewa; Chewa; Nyanja",nn:"Norwegian Nynorsk; Nynorsk, Norwegian",ie:"Interlingue; Occidental",oc:"Occitan (post 1500)  ",oj:"Ojibwa",cu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",cu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",cu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",or:"Oriya",om:"Oromo",os:"Ossetian; Ossetic",os:"Ossetian; Ossetic",pi:"Pali",pa:"Panjabi; Punjabi",ps:"Pushto; Pashto",fa:"Persian",pl:"Polish",pt:"Portuguese",pa:"Panjabi; Punjabi",ps:"Pushto; Pashto",qu:"Quechua",ro:"Romanian; Moldavian; Moldovan",rm:"Romansh",rn:"Rundi",ru:"Russian",sm:"Samoan",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",gd:"Gaelic; Scottish Gaelic",sr:"Serbian",sn:"Shona",ii:"Sichuan Yi; Nuosu",sd:"Sindhi",si:"Sinhala; Sinhalese",si:"Sinhala; Sinhalese",sk:"Slovak",sl:"Slovenian",so:"Somali",st:"Sotho, Southern",nr:"Ndebele, South; South Ndebele",es:"Spanish; Castilian",su:"Sundanese",sw:"Swahili",ss:"Swati",sv:"Swedish",tl:"Tagalog",ty:"Tahitian",tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Telugu",th:"Thai",bo:"Tibetan",ti:"Tigrinya",to:"Tonga (Tonga Islands)  ",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",tw:"Twi",ug:"Uighur; Uyghur",uk:"Ukrainian",ur:"Urdu",ug:"Uighur; Uyghur",uz:"Uzbek",ca:"Catalan; Valencian",ve:"Venda",vi:"Vietnamese",vo:"Volapk",wa:"Walloon",cy:"Welsh",fy:"Western Frisian",wo:"Wolof",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",za:"Zhuang; Chuang",zu:"Zulu"},b={abk:"Abkhazian",ace:"Achinese",ach:"Acoli",ada:"Adangme",ady:"Adyghe; Adygei",ady:"Adyghe; Adygei",aar:"Afar",afh:"Afrihili",afr:"Afrikaans",afa:"Afro-Asiatic languages",ain:"Ainu",aka:"Akan",akk:"Akkadian",alb:"Albanian",sqi:"Albanian",gsw:"Swiss German; Alemannic; Alsatian",ale:"Aleut",alg:"Algonquian languages",gsw:"Swiss German; Alemannic; Alsatian",tut:"Altaic languages",amh:"Amharic",anp:"Angika",apa:"Apache languages",ara:"Arabic",arg:"Aragonese",arp:"Arapaho",arw:"Arawak",arm:"Armenian",hye:"Armenian",rup:"Aromanian; Arumanian; Macedo-Romanian",art:"Artificial languages",rup:"Aromanian; Arumanian; Macedo-Romanian",asm:"Assamese",ast:"Asturian; Bable; Leonese; Asturleonese",ast:"Asturian; Bable; Leonese; Asturleonese",ath:"Athapascan languages",aus:"Australian languages",map:"Austronesian languages",ava:"Avaric",ave:"Avestan",awa:"Awadhi",aym:"Aymara",aze:"Azerbaijani",ast:"Asturian; Bable; Leonese; Asturleonese",ban:"Balinese",bat:"Baltic languages",bal:"Baluchi",bam:"Bambara",bai:"Bamileke languages",bad:"Banda languages",bnt:"Bantu languages",bas:"Basa",bak:"Bashkir",baq:"Basque",eus:"Basque",btk:"Batak languages",bej:"Beja; Bedawiyet",bej:"Beja; Bedawiyet",bel:"Belarusian",bem:"Bemba",ben:"Bengali",ber:"Berber languages",bho:"Bhojpuri",bih:"Bihari languages",bik:"Bikol",byn:"Blin; Bilin",bin:"Bini; Edo",bis:"Bislama",byn:"Blin; Bilin",zbl:"Blissymbols; Blissymbolics; Bliss",zbl:"Blissymbols; Blissymbolics; Bliss",zbl:"Blissymbols; Blissymbolics; Bliss",nob:"Bokml, Norwegian; Norwegian Bokml",bos:"Bosnian",bra:"Braj",bre:"Breton",bug:"Buginese",bul:"Bulgarian",bua:"Buriat",bur:"Burmese",mya:"Burmese",cad:"Caddo",spa:"Spanish; Castilian",cat:"Catalan; Valencian",cau:"Caucasian languages",ceb:"Cebuano",cel:"Celtic languages",cai:"Central American Indian languages",khm:"Central Khmer",chg:"Chagatai",cmc:"Chamic languages",cha:"Chamorro",che:"Chechen",chr:"Cherokee",nya:"Chichewa; Chewa; Nyanja",chy:"Cheyenne",chb:"Chibcha",nya:"Chichewa; Chewa; Nyanja",chi:"Chinese",zho:"Chinese",chn:"Chinook jargon",chp:"Chipewyan; Dene Suline",cho:"Choctaw",zha:"Zhuang; Chuang",chu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",chu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",chk:"Chuukese",chv:"Chuvash",nwc:"Classical Newari; Old Newari; Classical Nepal Bhasa",nwc:"Classical Newari; Old Newari; Classical Nepal Bhasa",syc:"Classical Syriac",rar:"Rarotongan; Cook Islands Maori",cop:"Coptic",cor:"Cornish",cos:"Corsican",cre:"Cree",mus:"Creek",crp:"Creoles and pidgins",cpe:"Creoles and pidgins, English based",cpf:"Creoles and pidgins, French-based",cpp:"Creoles and pidgins, Portuguese-based",crh:"Crimean Tatar; Crimean Turkish",crh:"Crimean Tatar; Crimean Turkish",hrv:"Croatian",cus:"Cushitic languages",cze:"Czech",ces:"Czech",dak:"Dakota",dan:"Danish",dar:"Dargwa",del:"Delaware",chp:"Chipewyan; Dene Suline",div:"Divehi; Dhivehi; Maldivian",zza:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki",din:"Dinka",div:"Divehi; Dhivehi; Maldivian",doi:"Dogri",dgr:"Dogrib",dra:"Dravidian languages",dua:"Duala",dut:"Dutch; Flemish",nld:"Dutch; Flemish",dum:"Dutch, Middle (ca.1050-1350)",dyu:"Dyula",dzo:"Dzongkha",frs:"Eastern Frisian",bin:"Bini; Edo",efi:"Efik",egy:"Egyptian (Ancient)",eka:"Ekajuk",elx:"Elamite",eng:"English",enm:"English, Middle (1100-1500)",ang:"English, Old (ca.450-1100)",myv:"Erzya",epo:"Esperanto",est:"Estonian",ewe:"Ewe",ewo:"Ewondo",fan:"Fang",fat:"Fanti",fao:"Faroese",fij:"Fijian",fil:"Filipino; Pilipino",fin:"Finnish",fiu:"Finno-Ugrian languages",dut:"Dutch; Flemish",nld:"Dutch; Flemish",fon:"Fon",fre:"French",fra:"French",frm:"French, Middle (ca.1400-1600)",fro:"French, Old (842-ca.1400)",fur:"Friulian",ful:"Fulah",gaa:"Ga",gla:"Gaelic; Scottish Gaelic",car:"Galibi Carib",glg:"Galician",lug:"Ganda",gay:"Gayo",gba:"Gbaya",gez:"Geez",geo:"Georgian",kat:"Georgian",ger:"German",deu:"German",nds:"Low German; Low Saxon; German, Low; Saxon, Low",gmh:"German, Middle High (ca.1050-1500)",goh:"German, Old High (ca.750-1050)",gem:"Germanic languages",kik:"Kikuyu; Gikuyu",gil:"Gilbertese",gon:"Gondi",gor:"Gorontalo",got:"Gothic",grb:"Grebo",grc:"Greek, Ancient (to 1453)",gre:"Greek, Modern (1453-)",ell:"Greek, Modern (1453-)",kal:"Kalaallisut; Greenlandic",grn:"Guarani",guj:"Gujarati",gwi:"Gwich'in",hai:"Haida",hat:"Haitian; Haitian Creole",hat:"Haitian; Haitian Creole",hau:"Hausa",haw:"Hawaiian",heb:"Hebrew",her:"Herero",hil:"Hiligaynon",him:"Himachali languages; Western Pahari languages",hin:"Hindi",hmo:"Hiri Motu",hit:"Hittite",hmn:"Hmong; Mong",hun:"Hungarian",hup:"Hupa",iba:"Iban",ice:"Icelandic",isl:"Icelandic",ido:"Ido",ibo:"Igbo",ijo:"Ijo languages",ilo:"Iloko",arc:"Official Aramaic (700-300 BCE); Imperial Aramaic (700-300 BCE)",smn:"Inari Sami",inc:"Indic languages",ine:"Indo-European languages",ind:"Indonesian",inh:"Ingush",ina:"Interlingua (International Auxiliary Language Association)",ile:"Interlingue; Occidental",iku:"Inuktitut",ipk:"Inupiaq",ira:"Iranian languages",gle:"Irish",mga:"Irish, Middle (900-1200)",sga:"Irish, Old (to 900)",iro:"Iroquoian languages",ita:"Italian",jpn:"Japanese",jav:"Javanese",kac:"Kachin; Jingpho",jrb:"Judeo-Arabic",jpr:"Judeo-Persian",kbd:"Kabardian",kab:"Kabyle",kac:"Kachin; Jingpho",kal:"Kalaallisut; Greenlandic",xal:"Kalmyk; Oirat",kam:"Kamba",kan:"Kannada",kau:"Kanuri",pam:"Pampanga; Kapampangan",kaa:"Kara-Kalpak",krc:"Karachay-Balkar",krl:"Karelian",kar:"Karen languages",kas:"Kashmiri",csb:"Kashubian",kaw:"Kawi",kaz:"Kazakh",kha:"Khasi",khi:"Khoisan languages",kho:"Khotanese; Sakan",kik:"Kikuyu; Gikuyu",kmb:"Kimbundu",kin:"Kinyarwanda",zza:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki",kir:"Kirghiz; Kyrgyz",zza:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki",tlh:"Klingon; tlhIngan-Hol",kom:"Komi",kon:"Kongo",kok:"Konkani",kor:"Korean",kos:"Kosraean",kpe:"Kpelle",kro:"Kru languages",kua:"Kuanyama; Kwanyama",kum:"Kumyk",kur:"Kurdish",kru:"Kurukh",kut:"Kutenai",kua:"Kuanyama; Kwanyama",kir:"Kirghiz; Kyrgyz",lad:"Ladino",lah:"Lahnda",lam:"Lamba",day:"Land Dayak languages",lao:"Lao",lat:"Latin",lav:"Latvian",ast:"Asturian; Bable; Leonese; Asturleonese",ltz:"Luxembourgish; Letzeburgesch",lez:"Lezghian",lim:"Limburgan; Limburger; Limburgish",lim:"Limburgan; Limburger; Limburgish",lim:"Limburgan; Limburger; Limburgish",lin:"Lingala",lit:"Lithuanian",jbo:"Lojban",nds:"Low German; Low Saxon; German, Low; Saxon, Low",nds:"Low German; Low Saxon; German, Low; Saxon, Low",dsb:"Lower Sorbian",loz:"Lozi",lub:"Luba-Katanga",lua:"Luba-Lulua",lui:"Luiseno",smj:"Lule Sami",lun:"Lunda",luo:"Luo (Kenya and Tanzania)",lus:"Lushai",ltz:"Luxembourgish; Letzeburgesch",rup:"Aromanian; Arumanian; Macedo-Romanian",mac:"Macedonian",mkd:"Macedonian",mad:"Madurese",mag:"Magahi",mai:"Maithili",mak:"Makasar",mlg:"Malagasy",may:"Malay",msa:"Malay",mal:"Malayalam",div:"Divehi; Dhivehi; Maldivian",mlt:"Maltese",mnc:"Manchu",mdr:"Mandar",man:"Mandingo",mni:"Manipuri",mno:"Manobo languages",glv:"Manx",mao:"Maori",mri:"Maori",arn:"Mapudungun; Mapuche",arn:"Mapudungun; Mapuche",mar:"Marathi",chm:"Mari",mah:"Marshallese",mwr:"Marwari",mas:"Masai",myn:"Mayan languages",men:"Mende",mic:"Mi'kmaq; Micmac",mic:"Mi'kmaq; Micmac",min:"Minangkabau",mwl:"Mirandese",moh:"Mohawk",mdf:"Moksha",rum:"Romanian; Moldavian; Moldovan",ron:"Romanian; Moldavian; Moldovan",mkh:"Mon-Khmer languages",hmn:"Hmong; Mong",lol:"Mongo",mon:"Mongolian",mos:"Mossi",mul:"Multiple languages",mun:"Munda languages",nqo:"N'Ko",nah:"Nahuatl languages",nau:"Nauru",nav:"Navajo; Navaho",nav:"Navajo; Navaho",nde:"Ndebele, North; North Ndebele",nbl:"Ndebele, South; South Ndebele",ndo:"Ndonga",nap:"Neapolitan","new":"Nepal Bhasa; Newari",nep:"Nepali","new":"Nepal Bhasa; Newari",nia:"Nias",nic:"Niger-Kordofanian languages",ssa:"Nilo-Saharan languages",niu:"Niuean",zxx:"No linguistic content; Not applicable",nog:"Nogai",non:"Norse, Old",nai:"North American Indian languages",nde:"Ndebele, North; North Ndebele",frr:"Northern Frisian",sme:"Northern Sami",nso:"Pedi; Sepedi; Northern Sotho",nor:"Norwegian",nob:"Bokml, Norwegian; Norwegian Bokml",nno:"Norwegian Nynorsk; Nynorsk, Norwegian",zxx:"No linguistic content; Not applicable",nub:"Nubian languages",iii:"Sichuan Yi; Nuosu",nym:"Nyamwezi",nya:"Chichewa; Chewa; Nyanja",nyn:"Nyankole",nno:"Norwegian Nynorsk; Nynorsk, Norwegian",nyo:"Nyoro",nzi:"Nzima",ile:"Interlingue; Occidental",oci:"Occitan (post 1500)",pro:"Provenal, Old (to 1500);Occitan, Old (to 1500)",arc:"Official Aramaic (700-300 BCE); Imperial Aramaic (700-300 BCE)",xal:"Kalmyk; Oirat",oji:"Ojibwa",chu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",chu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",nwc:"Classical Newari; Old Newari; Classical Nepal Bhasa",chu:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic",ori:"Oriya",orm:"Oromo",osa:"Osage",oss:"Ossetian; Ossetic",oss:"Ossetian; Ossetic",oto:"Otomian languages",pal:"Pahlavi",pau:"Palauan",pli:"Pali",pam:"Pampanga; Kapampangan",pag:"Pangasinan",pan:"Panjabi; Punjabi",pap:"Papiamento",paa:"Papuan languages",pus:"Pushto; Pashto",nso:"Pedi; Sepedi; Northern Sotho",per:"Persian",fas:"Persian",peo:"Persian, Old (ca.600-400 B.C.)",phi:"Philippine languages",phn:"Phoenician",fil:"Filipino; Pilipino",pon:"Pohnpeian",pol:"Polish",por:"Portuguese",pra:"Prakrit languages",pro:"Provenal, Old (to 1500);Occitan, Old (to 1500)",pan:"Panjabi; Punjabi",pus:"Pushto; Pashto",que:"Quechua",raj:"Rajasthani",rap:"Rapanui",rar:"Rarotongan; Cook Islands Maori","qaa-qtz":"Reserved for local use",roa:"Romance languages",rum:"Romanian; Moldavian; Moldovan",ron:"Romanian; Moldavian; Moldovan",roh:"Romansh",rom:"Romany",run:"Rundi",rus:"Russian",kho:"Khotanese; Sakan",sal:"Salishan languages",sam:"Samaritan Aramaic",smi:"Sami languages",smo:"Samoan",sad:"Sandawe",sag:"Sango",san:"Sanskrit",sat:"Santali",srd:"Sardinian",sas:"Sasak",nds:"Low German; Low Saxon; German, Low; Saxon, Low",sco:"Scots",gla:"Gaelic; Scottish Gaelic",sel:"Selkup",sem:"Semitic languages",nso:"Pedi; Sepedi; Northern Sotho",srp:"Serbian",srr:"Serer",shn:"Shan",sna:"Shona",iii:"Sichuan Yi; Nuosu",scn:"Sicilian",sid:"Sidamo",sgn:"Sign Languages",bla:"Siksika",snd:"Sindhi",sin:"Sinhala; Sinhalese",sin:"Sinhala; Sinhalese",sit:"Sino-Tibetan languages",sio:"Siouan languages",sms:"Skolt Sami",den:"Slave (Athapascan)",sla:"Slavic languages",slo:"Slovak",slk:"Slovak",slv:"Slovenian",sog:"Sogdian",som:"Somali",son:"Songhai languages",snk:"Soninke",wen:"Sorbian languages",nso:"Pedi; Sepedi; Northern Sotho",sot:"Sotho, Southern",sai:"South American Indian languages",nbl:"Ndebele, South; South Ndebele",alt:"Southern Altai",sma:"Southern Sami",spa:"Spanish; Castilian",srn:"Sranan Tongo",zgh:"Standard Moroccan Tamazight",suk:"Sukuma",sux:"Sumerian",sun:"Sundanese",sus:"Susu",swa:"Swahili",ssw:"Swati",swe:"Swedish",gsw:"Swiss German; Alemannic; Alsatian",syr:"Syriac",tgl:"Tagalog",tah:"Tahitian",tai:"Tai languages",tgk:"Tajik",tmh:"Tamashek",tam:"Tamil",tat:"Tatar",tel:"Telugu",ter:"Tereno",tet:"Tetum",tha:"Thai",tib:"Tibetan",bod:"Tibetan",tig:"Tigre",tir:"Tigrinya",tem:"Timne",tiv:"Tiv",tlh:"Klingon; tlhIngan-Hol",tli:"Tlingit",tpi:"Tok Pisin",tkl:"Tokelau",tog:"Tonga (Nyasa)",ton:"Tonga (Tonga Islands)",tsi:"Tsimshian",tso:"Tsonga",tsn:"Tswana",tum:"Tumbuka",tup:"Tupi languages",tur:"Turkish",ota:"Turkish, Ottoman (1500-1928)",tuk:"Turkmen",tvl:"Tuvalu",tyv:"Tuvinian",twi:"Twi",udm:"Udmurt",uga:"Ugaritic",uig:"Uighur; Uyghur",ukr:"Ukrainian",umb:"Umbundu",mis:"Uncoded languages",und:"Undetermined",hsb:"Upper Sorbian",urd:"Urdu",uig:"Uighur; Uyghur",uzb:"Uzbek",vai:"Vai",cat:"Catalan; Valencian",ven:"Venda",vie:"Vietnamese",vol:"Volapk",vot:"Votic",wak:"Wakashan languages",wln:"Walloon",war:"Waray",was:"Washo",wel:"Welsh",cym:"Welsh",fry:"Western Frisian",him:"Himachali languages; Western Pahari languages",wal:"Wolaitta; Wolaytta",wal:"Wolaitta; Wolaytta",wol:"Wolof",xho:"Xhosa",sah:"Yakut",yao:"Yao",yap:"Yapese",yid:"Yiddish",yor:"Yoruba",ypk:"Yupik languages",znd:"Zande languages",zap:"Zapotec",zza:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki",zza:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki",zen:"Zenaga",zha:"Zhuang; Chuang",zul:"Zulu",zun:"Zuni"},c={},d=function(a,b){if(c[b])return void 0!=c[b][a]?c[b][a]:"Undefined";
throw"Cannot find language mapping for target language "+b},e=function(a,b){var d;if(c[a])for(d in b)c[a][d]=b[d];else c[a]=b};return e("en",a),e("en",b),{translateLanguageCode:d,addLanguageMap:e}},function(){"use strict";function a(a,b){var c=Object.create(a.prototype);return a.apply(c,b)||c}var b,c="dashjs",d="dashas",e="dashcs",f="dashhls";videojs.Dasheverywhere=function(g,h){h.techs&&h.techs.length>0&&(videojs.Dasheverywhere.TECHS=h.techs),CL.manifest=videojs.util.mergeOptions(CL.defaultManifest,h);var i=new castLabsDashJS.classes.Utils,j=!1,k=!1,l=!1;j=!!h.widevineLicenseServerURL&&null!==h.widevineLicenseServerURL&&-1===h.widevineLicenseServerURL.toLowerCase().indexOf("drmtoday.com"),k=!!h.accessLicenseServerURL&&null!==h.accessLicenseServerURL&&-1===h.accessLicenseServerURL.toLowerCase().indexOf("drmtoday.com"),l=!!h.playReadyLicenseServerURL&&null!==h.playReadyLicenseServerURL&&-1===h.playReadyLicenseServerURL.toLowerCase().indexOf("drmtoday.com"),(void 0!==h.sendCustomData&&h.sendCustomData!==!0||j||k||l)&&i.sdfglksdfgkl(CL.manifest);var m=videojs.Dasheverywhere.supportedTech();CL.configs=JSON.parse(JSON.stringify(CL.defaultConfigs)),CL.manifest=JSON.parse(JSON.stringify(CL.defaultManifest)),h.debug&&m&&console.log("Active tech: "+m);var n=function(){return m},o=function(a,b){if(void 0===a||null===a||"audio"!==a&&"text"!==a)throw"Cannot set active track: Parameter 'type' must be 'audio' or 'text'.";if(void 0===b||null===b||""===b)throw"Cannot set active track: Parameter 'id' must not be empty.";"audio"===a?g.setAudioTrack(b):"text"===a&&g.setSubsTrack(b)},p=function(a,h){var j,k=g.options();g.orgVolume=g.volume();var l=function(){try{g.ads&&"ad-playback"===g.ads.state&&(g.ads.state="content-resuming",g.ima.pauseAd(),g.ima.onAdComplete_(),g.ads.endLinearAdMode(),g.ima.onContentResumeRequested_(),g.removeClass("vjs-ad-playing"))}catch(d){}if(h.enableIma===!0){if(g.el().childNodes[0].style.width="1px",g.orgVolume=g.volume(),g.volume(0),b)g.volume(g.orgVolume),g.controlBar.hide(),g.one("loadedmetadata",function(){g.ima.setContent(a,null,!0),g.ima.requestAds()});else if(h.imaOptions&&h.imaOptions.adTagUrl){h.imaOptions.id=g.id(),g.ima(h.imaOptions),b=new videojs.Dasheverywhere.Ads,g.one("dispose",function(){b=!1});var e="loadedmetadata";g.one(e,function(){g.controlBar.hide(),g.pause(),g.on(["adend","adserror","adscancelled"],function(a){if(g.el().childNodes[0].style.width="100%",g.controlBar.show(),g.volume(g.orgVolume),j===c&&CL.configs.isLive===!0&&"adserror"!=a.type&&(g.loadVideo(CL.manifest.url,{}),g.volume(0),g.volume(g.orgVolume)),g.removeClass("vjs-ad-playing"),"adserror"===a.type){var b=document.getElementById("ima-ad-container");null!==b&&(b.style.display="none");try{g.play()}catch(d){}}}),g.on("adstarted",function(){g.addClass("vjs-ad-playing");var a=document.getElementById("ima-play-pause-div");null!==a&&(a.className="ima-playing"),g.volume(g.orgVolume)}),g.ima.initializeAdDisplayContainer(),g.ima.requestAds()})}}else g.volume(g.orgVolume)};CL.configs=JSON.parse(JSON.stringify(CL.defaultConfigs)),CL.manifest=JSON.parse(JSON.stringify(CL.defaultManifest)),i=new castLabsDashJS.classes.Utils,i.supportsMSE(),h.autoplay=k.autoplay,k.dasheverywhere=videojs.util.mergeOptions(k.dasheverywhere,h),CL.manifest=videojs.util.mergeOptions(CL.manifest,k.dasheverywhere);var m=!1,n=!1,o=!1;m=!!h.widevineLicenseServerURL&&null!==h.widevineLicenseServerURL&&-1===h.widevineLicenseServerURL.toLowerCase().indexOf("drmtoday.com"),n=!!h.accessLicenseServerURL&&null!==h.accessLicenseServerURL&&-1===h.accessLicenseServerURL.toLowerCase().indexOf("drmtoday.com"),o=!!h.playReadyLicenseServerURL&&null!==h.playReadyLicenseServerURL&&-1===h.playReadyLicenseServerURL.toLowerCase().indexOf("drmtoday.com"),(void 0!==h.sendCustomData&&h.sendCustomData!==!0||m||n||o)&&i.sdfglksdfgkl(CL.manifest),j=videojs.Dasheverywhere.supportedTech();try{j===c&&(g.pause(),g.removeEventListener())}catch(p){}if(l(),void 0===k.dasheverywhere.initialSeekTime||null===k.dasheverywhere.initialSeekTime||isNaN(k.dasheverywhere.initialSeekTime)||g.one("loadedmetadata",function(){j===c?CL.configs.initialStartTime=k.dasheverywhere.initialSeekTime:g.currentTime(k.dasheverywhere.initialSeekTime)}),j===c){var q;try{this.options().autoplay===!0&&(this.player().addClass("vjs-waiting"),this.player().loadingSpinner.show()),q=g.el().childNodes[0],q.hidden=!0,g.one("loadstart",function(){q.hidden=!1})}catch(p){}void 0!==g.mediaPlayer.eventBus&&(g.mediaPlayer.eventBus.removeEventListener("error",g.options().customErrorHandler,!1),g.mediaPlayer.eventBus.removeEventListener(MediaPlayer.events.MANIFEST_LOADED,g.options().onManifestLoaded,!1)),g.mediaPlayer.setConfig(k.dasheverywhere);try{var r=function(){g.manifestUrl=a,g.mediaPlayer.loadVideo(a),g.mediaPlayer.eventBus.addEventListener("error",g.options().customErrorHandler,!1),g.mediaPlayer.eventBus.addEventListener(MediaPlayer.events.MANIFEST_LOADED,g.options().onManifestLoaded,!1)};""!==q.src?(CL.configs.sourceCleaningInProgress=(new Date).getTime(),q.src="",q.setMediaKeys?q.setMediaKeys(null).then(function(){r()},function(){r()}):r()):r()}catch(p){}}else if(j===d)g.loadSrc(a,k.dasheverywhere);else if(j===e)k.autoplay===!0?(this.player().addClass("vjs-waiting"),this.player().loadingSpinner.show()):this.player().addChild("BigPlayButton"),this.player().one("play",function(){this.player().loadingSpinner.hide()}),g.loadSrc(a,k.dasheverywhere);else if(j===f){try{g.pause(),this.player().loadingSpinner.show(),g.one("loadeddata",function(){this.player().loadingSpinner.hide(),this.options().autoplay===!0&&this.player().play()})}catch(p){}g.src(a)}},q=function(){var a=g.getActiveTech();switch(a){case c:break;case e:break;case d:}};switch(g.getActiveTech=n,g.setActiveTrack=o,g.loadVideo=p,g.restoreAfterSnapshot=q,m){case c:return a(videojs.Dashjs,arguments);case d:return a(videojs.Dashas,arguments);case e:return a(videojs.Silverlight,arguments);case f:return videojs.Hls.supportsNativeHls?a(videojs.Html5,arguments):a(videojs.Hls,arguments);default:throw new Error("NO_SUPPORTED_PLAYBACK_TECHNOLOGY")}},videojs.Dasheverywhere.Ads=function(){this.initialized=!0},videojs.Dasheverywhere.isSupported=function(){return!!this.supportedTech()},videojs.Dasheverywhere.canPlaySource=function(a){return"application/dash+xml"===a.type||"application/vnd.ms-sstr+xml"===a.type||"application/x-mpegURL"===a.type?"maybe":""},videojs.Dasheverywhere.supportedTech=function(){var a=CL.configs.isWindows,b=CL.configs.isIE11,g=CL.configs.isFirefox,h=this.canUseTech.bind(this);return a&&g===!0&&CL.manifest.enableHTML5OnFirefox!==!0&&h(e)&&videojs.Silverlight.isSupported()?e:!h(c)||!videojs.Dashjs.isSupported()||CL.configs.isOpera!==!1||g!==!1&&CL.manifest.enableHTML5OnFirefox!==!0||CL.configs.isSafari!==!1&&(CL.configs.isSafari9!==!0||CL.manifest.enableHTML5OnSafari!==!0)||b&&(!b||CL.manifest.disableDASHJSOnIE11)?h(d)&&videojs.Dashas.isSupported()?d:h(e)&&videojs.Silverlight.isSupported()?e:h(f)&&videojs.Hls.isSupported()?f:void 0:c},videojs.Dasheverywhere.canUseTech=function(a){var b,c;for(b=0,c=this.TECHS.length;c>b;b++)if(a===this.TECHS[b])return!0;return!1},videojs.Dasheverywhere.TECHS=[c,d,e,f]}();