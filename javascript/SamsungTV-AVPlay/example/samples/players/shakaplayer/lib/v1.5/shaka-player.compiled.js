(function(){var g={};
(function(window){var l,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Qb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ob=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ca(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function da(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}da.prototype.clone=function(){var a=new da;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function ea(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function fa(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",fa);function ga(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ga("error");ga("warn");ga("info");ga("log");ga("debug");function ha(a){ia[a]={oa:ja(),end:NaN}}function ka(a){if(a=ia[a])a.end=ja()}function la(a){return(a=ia[a])&&a.end?a.end-a.oa:NaN}var ja=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ia={};function ma(){};function r(){this.fontSize="100%";this.fontColor=na;this.fontOpacity=oa;this.backgroundColor=pa;this.backgroundOpacity=oa;this.fontEdge=qa}n("shaka.player.TextStyle",r);r.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};r.prototype.load=r.prototype.a;r.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
r.prototype.store=r.prototype.b;function ra(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+sa(a.fontColor,a.fontOpacity));b.push("background-color: "+sa(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(sa(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function sa(a,b){return"rgba("+a.concat(b).join(",")+")"}var na=[255,255,255],pa=[0,0,0];
r.StandardColors={WHITE:na,BLACK:pa,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var oa=1;r.StandardOpacities={OPAQUE:oa,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var qa=[];
r.EdgeStyles={NONE:qa,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function ua(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
va);document.addEventListener("webkitfullscreenerror",va);document.addEventListener("mozfullscreenchange",va);document.addEventListener("mozfullscreenerror",va);document.addEventListener("MSFullscreenChange",va);document.addEventListener("MSFullscreenError",va)}n("shaka.polyfill.Fullscreen.install",ua);function va(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function wa(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=xa)}n("shaka.polyfill.VideoPlaybackQuality.install",wa);function xa(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function ya(){return Promise.reject(Error("The key system specified is not supported."))}function za(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Aa(){throw new TypeError("Illegal constructor.");}Aa.prototype.createSession=function(){};Aa.prototype.setServerCertificate=function(){};function Ba(){throw new TypeError("Illegal constructor.");}Ba.prototype.getConfiguration=function(){};Ba.prototype.createMediaKeys=function(){};function Ca(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=Da)}n("shaka.polyfill.CustomEvent.install",Ca);function Da(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function Ea(a){this.b=a;this.a=new Fa(a);Ga||(Ga=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Ga;
function w(a){var b;b=Ha(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=Ha(a);a:{for(d=0;d<Ga.length;d++)if(Ia(c,Ga[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c);x(a.a,c);return new Ka(b,d)}function Ha(a){var b=La(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=La(a.a);return d}function Ka(a,b){this.id=a;this.a=b}
function Ma(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};function Na(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};function Oa(a,b,c){Pa(b);Pa(c);return c==b||a>=Qa&&c==b.split("-")[0]||a>=Ra&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Qa=1,Ra=2;function Pa(a){a=a.toLowerCase().split("-");var b=Sa[a[0]];b&&(a[0]=b);return a.join("-")}
var Sa={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function z(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function A(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Ta(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Ta.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Ua(a){return a.b/(1-Math.pow(a.c,a.a))};function Va(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function Wa(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",Wa);function Xa(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",Xa);function Ya(a,b){var c=void 0==b?!0:b,d=window.btoa(Wa(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}n("shaka.util.Uint8ArrayUtils.toBase64",Ya);function Za(a){return Xa(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
n("shaka.util.Uint8ArrayUtils.fromBase64",Za);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function $a(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",$a);function Ia(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function ab(){this.j=this.a="";this.l=!1;this.i=this.h=null;this.o=this.g=!1;this.v=this.f="";this.c=null;this.b=[]}
function bb(a){var b=new ab;if(!a)return b;var c=cb(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=cb(a,"licenseServerUrl");if(null!=d)b.j=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=db(a,"withCredentials","boolean");null!=c&&(b.l=c);c=eb(a,"licensePostProcessor",Function);null!=c&&(b.h=c);c=eb(a,"licensePreProcessor",Function);null!=c&&(b.i=c);c=db(a,"distinctiveIdentifierRequired","boolean");null!=
c&&(b.g=c);c=db(a,"persistentStateRequired","boolean");null!=c&&(b.o=c);c=cb(a,"audioRobustness");null!=c&&(b.f=c);c=cb(a,"videoRobustness");null!=c&&(b.v=c);c=eb(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=eb(a,"initData",Object)){a=eb(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=cb(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function fb(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=Na(c,function(a){return Array.prototype.join.apply(a.initData)+","+a.initDataType})};function gb(a,b,c,d,e,f,g,h,k,m,p){this.g=a;this.j=b;this.o=c;this.a=[];this.h=e||null;this.i=f||null;this.f=g==hb;this.v=h==ib;this.c=k||"";this.l=m||"";this.b=p||null;d&&this.a.push(d)}n("shaka.player.DrmSchemeInfo",gb);var hb=1;gb.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:hb};var ib=1;gb.PersistentState={OPTIONAL:0,REQUIRED:ib};gb.createUnencrypted=function(){return new gb("","",!1,null)};function jb(a){return Object.keys(a).map(function(b){return a[b]})}function kb(a,b){var c=db(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function cb(a,b){return db(a,b,"string")}function db(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function eb(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function lb(){return Date.now()+mb}var mb=0;function B(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=B.prototype.destroy;return c}B.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function nb(){this.g=new B;this.f=!1;this.a=null;this.b=[];this.c=null}function ob(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}nb.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});pb(this,void 0)};nb.prototype.end=function(){this.b.splice(1)};
function pb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(C(a,function(a){this.a?(this.b=[],this.c=null,qb(this)):(this.b.shift(),this.b.length?pb(this,a):(this.g.resolve(a),this.c=null))})).catch(C(a,function(a){this.b=[];this.c=null;this.a?qb(this):this.g.reject(a)}))}function qb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function D(){this.a={}}D.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};D.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function rb(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function sb(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function tb(a){var b=[],c;for(c in a.a)b.push(c);return b};function E(a){this.ya=new D;this.v=a}n("shaka.util.FakeEventTarget",E);E.prototype.addEventListener=function(a,b,c){c||this.ya.push(a,b)};E.prototype.removeEventListener=function(a,b,c){c||sb(this.ya,a,b)};E.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return ub(this,a)};
function ub(a,b){b.currentTarget=a;for(var c=a.ya.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.v&&b.bubbles&&ub(a.v,b);return b.defaultPrevented};function vb(){E.call(this,null);this.a=new Ta(3);this.c=new Ta(10);this.b=0}q(vb,E);n("shaka.util.EWMABandwidthEstimator",vb);vb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(z({type:"bandwidth"}));this.b=Date.now()}};vb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Ua(this.a),Ua(this.c))};vb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
vb.prototype.supportsCaching=function(){return!1};function Fa(a){var b=wb;this.b=a;this.c=b==xb;this.a=0}var wb=0,xb=1;function yb(a){return a.a<a.b.byteLength}function La(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function F(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function zb(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ab(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function x(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Bb(a){this.systemIds=[];this.cencKeyIds=[];a=new Fa(new DataView(a.buffer));try{for(;yb(a);){var b=a.a,c=F(a),d=F(a);1==c?c=zb(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)x(a,c-(a.a-b));else{var e=La(a);if(1<e)x(a,c-(a.a-b));else{x(a,3);var f=$a(Ab(a)),g=[];if(0<e)for(var h=F(a),k=0;k<h;++k){var m=$a(Ab(a));g.push(m)}var p=F(a);x(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a!=b+c&&x(a,c-(a.a-b))}}}}catch(t){}};function Cb(){this.a=new D}Cb.prototype.destroy=function(){Db(this);this.a=null};function G(a,b,c,d){b=new Eb(b,c,d);a.a.push(c,b)}Cb.prototype.ta=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.ta(),sb(this.a,b,e))}};function Db(a){for(var b=rb(a.a),c=0;c<b.length;++c)b[c].ta();a.a.a={}}function Eb(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Eb.prototype.ta=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function Fb(a,b){try{var c=new Gb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function Ib(a){var b=this.mediaKeys;b&&b!=a&&Jb(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Jb(a,this);return Promise.resolve()}
function Gb(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},k=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var p=g.audioCapabilities[m];
p.contentType&&(k=!0,e.canPlayType(p.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(p),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)p=g.videoCapabilities[m],p.contentType&&(k=!0,e.canPlayType(p.contentType,this.a)&&(h.videoCapabilities.push(p),d=!0));k||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}throw Error("None of the requested configurations were supported.");
}Gb.prototype.createMediaKeys=function(){var a=new Kb(this.a);return Promise.resolve(a)};Gb.prototype.getConfiguration=function(){return this.b};function Kb(a){this.g=a;this.b=null;this.a=new Cb;this.c=[];this.f={}}function Jb(a,b){a.b=b;Db(a.a);b&&(G(a.a,b,"webkitneedkey",a.Db.bind(a)),G(a.a,b,"webkitkeymessage",a.Cb.bind(a)),G(a.a,b,"webkitkeyadded",a.Ab.bind(a)),G(a.a,b,"webkitkeyerror",a.Bb.bind(a)))}l=Kb.prototype;
l.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new Lb(a,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};l.Db=function(a){a=z({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};
l.Cb=function(a){var b=Mb(this,a.sessionId);b&&(a=z({type:"message",messageType:void 0==b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};l.Ab=function(a){if(a=Mb(this,a.sessionId))Nb(a,"usable"),a.a&&a.a.resolve(),a.a=null};
l.Bb=function(a){var b=Mb(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Nb(b,"output-restricted"):1==c?Nb(b,"expired"):Nb(b,"internal-error"))}};
function Mb(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function Lb(a,b,c){E.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new B;this.keyStatuses=new Ob}q(Lb,E);
function Pb(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=Xa("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=Xa("PERSISTENT|"+Wa(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new B;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}l=Lb.prototype;l.Ja=function(a,b){if(this.a)this.a.then(this.Ja.bind(this,a,b)).catch(this.Ja.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=Wa(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=Za(d.keys[0].k),d=Za(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function Nb(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;c=z({type:"keystatuseschange"});a.dispatchEvent(c)}l.generateRequest=function(a,b){return Pb(this,b,null)};l.load=function(a){return"persistent-license"==this.g?Pb(this,null,a):Promise.reject(Error("Not a persistent session."))};l.update=function(a){var b=new B;this.Ja(b,a);return b};
l.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};l.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function Qb(a){this.b=a;this.a=0}
Qb.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function Ob(){this.size=0;this.a=void 0}var Rb;l=Ob.prototype;l.entries=function(){var a=Rb,b=[];this.a&&b.push([a,this.a]);return new Qb(b)};l.forEach=function(a){this.a&&a(this.a)};l.get=function(a){if(this.has(a))return this.a};l.has=function(a){var b=Rb;return this.a&&Ia(new Uint8Array(a),b)?!0:!1};l.keys=function(){var a=Rb,b=[];this.a&&b.push(a);return new Qb(b)};
l.values=function(){var a=[];this.a&&a.push(this.a);return new Qb(a)};function Sb(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(Rb=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=Fb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ib,window.MediaKeys=Kb,window.MediaKeySystemAccess=Gb):(Navigator.prototype.requestMediaKeySystemAccess=ya,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=za,window.MediaKeys=Aa,window.MediaKeySystemAccess=Ba))}n("shaka.polyfill.MediaKeys.install",Sb);n("shaka.polyfill.installAll",function(){Ca();ua();Sb();wa()});var Tb={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function C(a,b){return b.bind(a)};function Ub(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.j=a;this.c=b;this.v=c;this.h=new Cb;this.b=[];this.o=0;this.f=this.a=null;this.l=0;G(this.h,this.c,"updateend",this.w.bind(this))}var Vb=1/60;Ub.prototype.destroy=function(){Wb(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.h.destroy();this.j=this.c=this.h=null};
function Xb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Vb,f=c.end(d)+Vb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function Yb(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new nb;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);d&&ob(a.a,function(){return[Zb(this,d),this.g.bind(this)]}.bind(a));ob(a.a,function(){var a=b.a?b.a-b.b:1,c=new $b;c.a=3;c.h=1E3*a;c.c=1E3*this.l;return[ac(b.url,c,this.v),H.prototype.g.bind(b.url)]}.bind(a));ob(a.a,C(a,function(a){this.v.getBandwidth();return[Zb(this,a),this.g.bind(this)]}));var e=0==a.c.buffered.length&&
0==a.b.length,f=null;ob(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.i+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=bc(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return cc(a).then(function(){return Promise.resolve(f)}.bind(a))}
function dc(a){if(a.a)return a=Error("Cannot clear ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new nb;ob(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new B}return[a,this.g.bind(this)]}.bind(a));return cc(a)}
function ec(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.i+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new nb;ob(a.a,function(){return[fc(this,b),this.g.bind(this)]}.bind(a));return cc(a)}function Wb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new B,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function cc(a){a.a.start();return a.a.g.then(C(a,function(){this.a=null})).catch(C(a,function(a){this.a=null;return Promise.reject(a)}))}
function Zb(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new B;return a.f}function fc(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=bc(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new B;return a.f}Ub.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()};Ub.prototype.w=function(){this.f.resolve();this.f=null};function gc(a,b){E.call(this,b);this.a=null;this.h=a}q(gc,E);
function hc(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new B,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=C(a,function(a){this.a=a.target.result;ic(this,"group_store",{keyPath:"group_id"});ic(this,"stream_index_store",{keyPath:"stream_id"});a=ic(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=C(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function I(a){a.a&&(a.a.close(),a.a=null)}function ic(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function jc(a){return kc(a,"content_store")}function lc(a){return kc(a,"stream_index_store")}function mc(a){return kc(a,"group_store")}
function kc(a,b){return a.a.transaction([b],a.h).objectStore(b)}function nc(a,b){var c=new B,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function oc(){gc.call(this,"readonly",null)}q(oc,gc);function pc(a){var b=new B,c=[],d=mc(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function qc(a,b){return nc(mc(a),b).then(C(a,function(a){a.session_ids=Na(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):rc(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function rc(a,b){return nc(lc(a),b)}function sc(a,b,c){return nc(jc(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};var tc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function J(a){var b;a instanceof J?(uc(this,a.R),this.aa=a.aa,this.P=a.P,vc(this,a.ga),this.O=a.O,wc(this,a.a.clone()),this.$=a.$):a&&(b=String(a).match(tc))?(uc(this,b[1]||"",!0),this.aa=xc(b[2]||""),this.P=xc(b[3]||"",!0),vc(this,b[4]),this.O=xc(b[5]||"",!0),wc(this,b[6]||"",!0),this.$=xc(b[7]||"")):this.a=new yc(null)}l=J.prototype;l.R="";l.aa="";l.P="";l.ga=null;l.O="";l.$="";
l.toString=function(){var a=[],b=this.R;b&&a.push(zc(b,Ac,!0),":");if(b=this.P){a.push("//");var c=this.aa;c&&a.push(zc(c,Ac,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ga;null!=b&&a.push(":",String(b))}if(b=this.O)this.P&&"/"!=b.charAt(0)&&a.push("/"),a.push(zc(b,"/"==b.charAt(0)?Bc:Cc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.$)&&a.push("#",zc(b,Dc));return a.join("")};
l.resolve=function(a){var b=this.clone();"data"===b.R&&(b=new J);var c=!!a.R;c?uc(b,a.R):c=!!a.aa;c?b.aa=a.aa:c=!!a.P;c?b.P=a.P:c=null!=a.ga;var d=a.O;if(c)vc(b,a.ga);else if(c=!!a.O){if("/"!=d.charAt(0))if(this.P&&!this.O)d="/"+d;else{var e=b.O.lastIndexOf("/");-1!=e&&(d=b.O.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.O=d:c=""!==a.a.toString();c?wc(b,a.a.clone()):c=!!a.$;c&&(b.$=a.$);return b};l.clone=function(){return new J(this)};function uc(a,b,c){a.R=c?xc(b,!0):b;a.R&&(a.R=a.R.replace(/:$/,""))}function vc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ga=b}else a.ga=null}function wc(a,b,c){b instanceof yc?a.a=b:(c||(b=zc(b,Ec)),a.a=new yc(b))}
function xc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function zc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Fc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Fc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ac=/[#\/\?@]/g,Cc=/[\#\?:]/g,Bc=/[\#\?]/g,Ec=/[\#\?@]/g,Dc=/#/g;function yc(a){this.b=a||null}yc.prototype.a=null;yc.prototype.c=null;
function Gc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Gc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
yc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};yc.prototype.clone=function(){var a=new yc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Ic(){this.id=this.url=null;this.type="static";this.c=this.j=this.s=null;this.h=5;this.f=this.b=this.g=null;this.i=1;this.a=[]}function Jc(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null;this.b=[]}function Kc(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.s=null;this.j=[];this.a=[]}function Lc(){this.value=null}function Mc(){this.contentType=this.lang=this.id=null}
function Nc(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function Oc(){this.value=this.schemeIdUri=this.b=null;this.children=[];this.a=this.pssh=null}function Pc(){this.parsedPssh=this.psshBox=null}function Qc(){this.url=null}function Rc(){this.url=null}function Sc(){this.s=null;this.g=1;this.c=this.b=this.a=this.f=null}
Sc.prototype.clone=function(){var a=new Sc;a.s=Tc(this.s);a.g=this.g;a.f=this.f;a.a=K(this.a);a.b=K(this.b);a.c=K(this.c);return a};function Uc(){this.a=this.url=null}Uc.prototype.clone=function(){var a=new Uc;a.url=Tc(this.url);a.a=K(this.a);return a};function Vc(){this.a=this.url=null}Vc.prototype.clone=function(){var a=new Vc;a.url=Tc(this.url);a.a=K(this.a);return a};function Wc(){this.s=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}
Wc.prototype.clone=function(){var a=new Wc;a.s=Tc(this.s);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=K(this.h);a.a=Tc(this.a)||[];a.c=K(this.c);return a};function Xc(){this.a=this.b=null}Xc.prototype.clone=function(){var a=new Xc;a.b=Tc(this.b);a.a=K(this.a);return a};function Yc(){this.b=1;this.a=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}Yc.prototype.clone=function(){var a=new Yc;a.b=this.b;a.i=this.i;a.a=this.a;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=K(this.c);return a};
function Zc(){this.a=[]}Zc.prototype.clone=function(){var a=new Zc;a.a=Tc(this.a)||[];return a};function $c(){this.c=this.a=this.b=null}$c.prototype.clone=function(){var a=new $c;a.b=this.b;a.a=this.a;a.c=this.c;return a};function ad(a,b){this.oa=a;this.end=b}ad.prototype.clone=function(){return new ad(this.oa,this.end)};Ic.TAG_NAME="MPD";Jc.TAG_NAME="Period";Kc.TAG_NAME="AdaptationSet";Lc.TAG_NAME="Role";Mc.TAG_NAME="ContentComponent";Nc.TAG_NAME="Representation";Oc.TAG_NAME="ContentProtection";
Pc.TAG_NAME="cenc:pssh";Qc.TAG_NAME="BaseURL";Rc.TAG_NAME="Location";Sc.TAG_NAME="SegmentBase";Uc.TAG_NAME="RepresentationIndex";Vc.TAG_NAME="Initialization";Wc.TAG_NAME="SegmentList";Xc.TAG_NAME="SegmentURL";Yc.TAG_NAME="SegmentTemplate";Zc.TAG_NAME="SegmentTimeline";$c.TAG_NAME="S";
Ic.prototype.parse=function(a,b){this.url=a.s;this.id=L(b,"id",M);this.type=L(b,"type",M)||"static";this.c=L(b,"mediaPresentationDuration",bd);this.h=L(b,"minBufferTime",bd,this.h);this.g=L(b,"minimumUpdatePeriod",bd,this.g);this.b=L(b,"availabilityStartTime",cd,this.b);this.f=L(b,"timeShiftBufferDepth",bd,this.f);this.i=L(b,"suggestedPresentationDelay",bd,this.i);var c=a.s,d=N(this,b,Qc);this.s=dd(c,d);if(d=O(this,b,Rc))this.j=ed(c,d.url);this.a=N(this,b,Jc)};
Jc.prototype.parse=function(a,b){this.id=L(b,"id",M);this.start=L(b,"start",bd);this.a=L(b,"duration",bd);var c=N(this,b,Qc);this.s=dd(a.s,c);this.c=O(this,b,Sc);this.f=O(this,b,Wc);this.g=O(this,b,Yc);this.b=N(this,b,Kc);fd(this)};function fd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
Kc.prototype.parse=function(a,b){var c=O(this,b,Mc)||{},d=O(this,b,Lc);this.id=L(b,"id",M);this.group=L(b,"group",P);this.lang=L(b,"lang",M,c.lang);this.contentType=L(b,"contentType",M,c.contentType);this.width=L(b,"width",Q);this.height=L(b,"height",Q);this.b=L(b,"mimeType",M);this.i=L(b,"codecs",M);this.c=d&&"main"==d.value;this.lang&&(this.lang=Pa(this.lang));c=N(this,b,Qc);this.s=dd(a.s,c);this.j=N(this,b,Oc);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?gd(this,
b,a.c):O(this,b,Sc);this.g=a.f?gd(this,b,a.f):O(this,b,Wc);this.h=a.g?gd(this,b,a.g):O(this,b,Yc);this.a=N(this,b,Nc);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Lc.prototype.parse=function(a,b){this.value=L(b,"value",M)};Mc.prototype.parse=function(a,b){this.id=L(b,"id",M);this.lang=L(b,"lang",M);this.contentType=L(b,"contentType",M);this.lang&&(this.lang=Pa(this.lang))};
Nc.prototype.parse=function(a,b){this.id=L(b,"id",M);this.bandwidth=L(b,"bandwidth",Q);this.width=L(b,"width",Q,a.width);this.height=L(b,"height",Q,a.height);this.f=L(b,"mimeType",M,a.b);this.h=L(b,"codecs",M,a.i);this.lang=a.lang;var c=N(this,b,Qc);this.s=dd(a.s,c);this.c=N(this,b,Oc);this.g=a.f?gd(this,b,a.f):O(this,b,Sc);this.b=a.g?gd(this,b,a.g):O(this,b,Wc);this.a=a.h?gd(this,b,a.h):O(this,b,Yc);0==this.c.length&&(this.c=a.j)};
Oc.prototype.parse=function(a,b){this.b=b;this.schemeIdUri=L(b,"schemeIdUri",M);this.value=L(b,"value",M);var c=L(b,"cenc:default_KID",M);c&&(this.a=c.replace(/[-]/g,""));this.pssh=O(this,b,Pc);this.children=Array.prototype.slice.call(b.childNodes)};Pc.prototype.parse=function(a,b){var c=hd(b);if(c){this.psshBox=Za(c);try{this.parsedPssh=new Bb(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};Qc.prototype.parse=function(a,b){this.url=hd(b)};
Rc.prototype.parse=function(a,b){this.url=hd(b)};Sc.prototype.parse=function(a,b){this.s=a.s||this.s;this.g=L(b,"timescale",Q,this.g);this.f=L(b,"presentationTimeOffset",P,this.f);this.a=L(b,"indexRange",id,this.a);this.b=O(this,b,Uc)||this.b;this.c=O(this,b,Vc)||this.c};Uc.prototype.parse=function(a,b){var c=L(b,"sourceURL",M);this.url=ed(a.s,c);this.a=L(b,"range",id,K(a.a))};Vc.prototype.parse=function(a,b){var c=L(b,"sourceURL",M);this.url=ed(a.s,c);this.a=L(b,"range",id)};
Wc.prototype.parse=function(a,b){this.s=a.s||this.s;this.f=L(b,"timescale",Q,this.f);this.g=L(b,"presentationTimeOffset",P,this.g);this.b=L(b,"duration",Q,this.b);this.i=L(b,"startNumber",P,this.i);this.h=O(this,b,Vc)||this.h;var c=N(this,b,Xc);this.a=c&&0<c.length?c:this.a;this.c=O(this,b,Zc)||this.c};Xc.prototype.parse=function(a,b){var c=L(b,"media",M);this.b=ed(a.s,c);this.a=L(b,"mediaRange",id)};
Yc.prototype.parse=function(a,b){this.b=L(b,"timescale",Q,this.b);this.i=L(b,"presentationTimeOffset",P,this.i);this.a=L(b,"duration",Q,this.a);this.j=L(b,"startNumber",P,this.j);this.h=L(b,"media",M,this.h);this.f=L(b,"index",M,this.f);this.g=L(b,"initialization",M,this.g);this.c=O(this,b,Zc)||this.c};Zc.prototype.parse=function(a,b){this.a=N(this,b,$c)};$c.prototype.parse=function(a,b){this.b=L(b,"t",P);this.a=L(b,"d",P);this.c=L(b,"r",jd)};
function dd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new J(e)):(e=ed(a.slice(0,1),e),c.push(e[0]))}return c}function ed(a,b){if(!b)return a;var c=new J(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function gd(a,b,c){var d=K(c);(b=kd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function O(a,b,c){var d=null;if(b=kd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function kd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function N(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function hd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function Tc(a){return a?a.map(function(a){return a.clone()}):null}function K(a){return a?a.clone():null}
function L(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function cd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function bd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=P(b[1]);c&&(a+=31536E3*c);(c=P(b[2]))&&(a+=2592E3*c);(c=P(b[3]))&&(a+=86400*c);(c=P(b[4]))&&(a+=3600*c);(c=P(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function id(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=P(b[1]);if(null==a)return null;b=P(b[2]);return null==b?null:new ad(a,b)}function jd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function Q(a){a=window.parseInt(a,10);return 0<a?a:null}function P(a){a=window.parseInt(a,10);return 0<=a?a:null}function M(a){return a};function ld(a,b){this.url=a;this.b=b||new $b;this.g=this.i=this.h=0;this.a=null;this.c=new B;this.f=null}function $b(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.i=!1}function md(a){nd(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function nd(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}l=ld.prototype;
l.fb=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=Xa(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);md(this);return b}if(0==this.url.lastIndexOf("idb:",0))return od(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;if(this.f&&!this.f.supportsCaching()||this.b.g)a=new J(a),Gc(a.a,"_",Date.now()),a=a.toString();this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.i;this.a.onload=this.ob.bind(this);this.b.g&&(this.a.onreadystatechange=this.sb.bind(this));this.a.onerror=this.Jb.bind(this);this.a.ontimeout=this.xb.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function od(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new oc;return hc(e).then(function(){return sc(e,c,d)}).then(C(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);I(e);md(this);return a})).catch(C(a,function(a){I(e);md(this);return Promise.reject(a)}))}function pd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Nb=a.a;return b}
l.ob=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),md(this)):this.h<this.b.a?qd(this):(a=pd(this,"HTTP error.","net"),this.c.reject(a),md(this))};l.sb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(mb=a-Date.now())}};l.Jb=function(){var a=pd(this,"Network failure.","net");this.c.reject(a);md(this)};
l.xb=function(){if(this.h<this.b.a)qd(this);else{var a=pd(this,"Request timed out.","net");this.c.reject(a);md(this)}};function qd(a){nd(a);window.setTimeout(a.fb.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function H(a,b,c,d){this.c=b;this.f=c||0;this.h=null!=d?d:null;this.b=this.a=null;this.i=a}function rd(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function ac(a,b,c){if(a.a)return a.a;b=b||new $b;if(a.f||a.h)b.b.Range="bytes="+(a.f+"-"+(null!=a.h?a.h:""));a.a=sd(a,0,b,c);return a.a}H.prototype.g=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=pd(a,"Request aborted.","aborted");a.c.reject(b);md(a)}this.b=null}};
function sd(a,b,c,d){var e=a.c[b].toString();a.i&&(e=a.i(e,c.b)||e);a.b=new ld(e,c);d&&(a.b.f=d);e=a.b.fb().then(C(a,function(a){this.b=this.a=null;return Promise.resolve(a.response)}));return e=e.catch(C(a,function(a){if(this.a&&b+1<this.c.length)return this.a=sd(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}H.prototype.clone=function(){return new H(this.i,this.c.map(function(a){return a.clone()}),this.f,this.h)};H.prototype.toString=function(){return this.c[0].toString()};function td(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,k=(h-1)*e.a,m=k/e.b,k=(k+e.a)/e.b,h=ud(a,b,h-1+e.j,(h-1)*e.a);if(!h)return null;f.push(new vd(m,k,h))}return f}function ud(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new H(a,b.s,0,null):null;c=wd(e,b.id,c,b.bandwidth,d);if(!c)return null;b=rd(b.s,c);return new H(a,b,0,null)}
function wd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new J(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function xd(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function yd(a,b){this.a=new $b;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function zd(a){var b=a.b;return ac(b,a.a).then(function(a){var d;d=b.c;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?O({s:d},a,Ic):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function Ad(a){this.a=a}Ad.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null)};Ad.prototype.create=function(){return this.a?ac(this.a):Promise.resolve(null)};function vd(a,b,c){this.b=a;this.a=b;this.url=c}function Bd(a,b,c){return new vd(b,c,a.url)}function bc(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Cd(a,b){return a.map(function(a){return Bd(a,a.b+b,null!=a.a?a.a+b:null)})};function R(a){this.u=a;this.h=0}R.prototype.destroy=function(){this.u=null};l=R.prototype;l.length=function(){return this.u.length};function S(a){if(0==a.u.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.u[0]}function T(a){if(0==a.u.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.u[a.u.length-1]}l.get=function(a){if(0>a||a>=this.u.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.u[a]};
l.ja=function(a){a=bc(this.u,a);return 0<=a?this.u[a]:null};l.Ca=function(a){Dd(this,a);return!0};
function Dd(a,b){a.h!=b.h&&(b=new R(Cd(b.u,a.h-b.h)));if(0==a.length())a.u=b.u.slice(0);else if(0!=b.length()&&null!=T(a).a&&!(null!=T(b).a&&T(b).a<T(a).a)){if(T(a).a<=S(b).b)var c=Bd(T(a),T(a).b,S(b).b),c=a.u.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.u.length&&!(a.u[d].a>=S(b).b);++d);a.u[d].b<S(b).b?(c=Bd(a.u[d],a.u[d].b,S(b).b),c=a.u.slice(0,d).concat([c])):(S(a).b>S(b).b||S(b),c=a.u.slice(0,d))}a.u=c.concat(b.u)}}
l.ia=function(a){var b=a-this.h;if(0==b)return 0;this.u=Cd(this.u,b);this.h=a;return b};l.Ba=function(){return 0<this.length()?{start:S(this).b,end:T(this).a}:{start:0,end:0}};function U(a,b,c,d){R.call(this,a);this.g=b;this.o=c;this.f=d;this.c=this.v=this.a=null;Ed(this)}q(U,R);U.prototype.destroy=function(){this.o=this.g=null;R.prototype.destroy.call(this)};U.prototype.ja=function(a){Fd(this,lb()/1E3);return R.prototype.ja.call(this,a)};U.prototype.Ca=function(a){if(!(a instanceof U))return!1;Dd(this,a);null==this.a&&(this.f=a.f,Ed(this));return!0};
function Ed(a){if(0!=a.length()){a.length();var b=null!=T(a).a?T(a).a:T(a).b;if(a.g.b>a.f)a.a=b;else{var c=a.f-(a.g.b+a.o.start);0>c?a.a=b:c<Math.max(T(a).b,T(a).a||0)?(T(a),a.a=b):a.a=c}a.v=T(a).b;a.c=S(a).b}}U.prototype.ia=function(a){a=R.prototype.ia.call(this,a);null!=this.a&&(this.v+=a,this.c+=a,this.v>this.a&&(this.a+=a));return a};U.prototype.Ba=function(){return Gd(this,lb()/1E3)};
function Gd(a,b){Fd(a,b);if(null==a.a||null==a.v||null==a.c)return{start:0,end:0};var c=b-a.f,d=a.a+c;null!=a.g.f&&(d=d-a.c-a.g.f,0<d&&(a.c+=d));c=a.v+c;c=0<a.length()?null!=T(a).a?Math.min(c,T(a).a):c:a.c;c=Math.max(c,a.c);return{start:a.c,end:c}}function Fd(a,b){if(null!=a.g.f)if(null==a.a)a.length();else{for(var c=a.a+(b-a.f),d=0,e=0;e<a.u.length;++e){var f=null;e<a.u.length-1?f=a.u[e+1].a:(f=a.u[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.g.f)++d;else break}0<d&&a.u.splice(0,d)}};function Hd(a,b,c,d,e){var f=1,g=0,h;if(a.b>d)h=null;else{var k=a.i||0,m=a.f||0;h=c.a;h=h.a/h.b;var p=d-(a.b+b.start);0>p?h=null:(m=p-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,p-=h,0>p?h=null:(k=Math.floor(p/h)*h-k,0>k&&(k=0),k=Math.floor(k/h)*h,h={Na:m/h+1,current:(k>=m?k:m)/h+1}))}h&&(f=h.Na,g=h.current-h.Na+1);f=td(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.l=c;this.j=this.b=0<this.length()?a.b+b.start+T(this).a:null;this.i=
h?h.current+1:null;this.w=e}q(Hd,U);Hd.prototype.destroy=function(){this.w=this.l=null;U.prototype.destroy.call(this)};Hd.prototype.ja=function(a){var b=lb()/1E3;Id(this,b);Fd(this,b);return R.prototype.ja.call(this,a)};Hd.prototype.Ca=function(a){if(null!=this.b||!(a instanceof Hd)||null==a.b)return!1;this.b=a.b;this.j=a.j;this.i=a.i;this.f=a.f;Dd(this,a);Id(this,lb()/1E3);Ed(this);return!0};Hd.prototype.ia=function(a){a=U.prototype.ia.call(this,a);null!=this.b&&(this.b+=a,this.j+=a);return a};
Hd.prototype.Ba=function(){var a=lb()/1E3;Id(this,a);return Gd(this,a)};function Id(a,b){if(null!=a.b&&null!=a.j&&null!=a.i){var c=a.l.a,c=c.a/c.b,d=Math.floor((a.j+(b-a.f)-a.b)/c);if(0!=d){var e=td(a.w,a.l,a.i,d);Array.prototype.push.apply(a.u,Cd(e,a.h));a.b+=d*c;a.i+=d}}};function Jd(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}Jd.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Jd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=xd(a.c,a.b||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.b,g=b[d].end/a.b,e=ud(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.b;c.push(new vd(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new R(c);return Promise.resolve(this.a)};function Kd(a,b,c,d,e){this.f=a;this.b=b;this.c=c;this.h=d;this.a=null;this.g=e}Kd.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null)};
Kd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new Hd(this.f,this.b,this.c,this.h,this.g)}catch(a){return Promise.reject(a)}else{var b;b=this.c.a;if(b=td(this.g,this.c,1,Math.ceil(this.b.a/(b.a/b.b)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=Bd(c,c.b,this.b.a)}b=new R(b)}else b=null;this.a=b;if(!this.a)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b)}return Promise.resolve(this.a)};function Ld(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}Ld.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Ld.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=xd(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=a.b*a.i:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,k=null,m=null;a.b?(k=c+a.b,m=k/a.f):0<b.length?(k=b[f].end-(a.g||0),m=k/a.f):(m=h+this.b.a,k=m*a.f);var c=k,k=0,p=null;g.a&&(k=g.a.oa,p=g.a.end);e.push(new vd(h,m,new H(this.f,g.b,
k,p)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new R(e);return Promise.resolve(this.a)};function Md(){this.A=Nd++;this.id=this.C=this.F=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.M=!1;this.J=!0}var Nd=0;Md.prototype.destroy=function(){this.F&&(this.F.destroy(),this.F=null);this.C&&(this.C.destroy(),this.C=null)};function Od(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function Pd(){this.A=$d++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var $d=0;
Pd.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function ae(a){for(var b=[],c=0;c<a.a.length;++c){var d=new be;d.id=a.A;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?Od(a.m[0]):"";b.push(d)}return b}function ce(){this.id=null;this.start=0;this.b=null;this.a=[]}ce.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function de(){this.b=!1;this.h=this.g=this.f=null;this.c=0;this.a=[]}
de.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function be(){this.id=0;this.a=null;this.b=this.contentType=""};function ee(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function fe(a,b){var c=new ge(b);a.streamHistory.push(new he(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function ge(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function he(a){this.timestamp=lb()/1E3;this.value=a};function ie(a,b){E.call(this,a);this.b=b;this.h=!0;this.g=this.f=null;this.c=new B;this.a=null}q(ie,E);ie.prototype.H=function(){};ie.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.v=this.b=this.f=this.g=this.a=this.c=null};l=ie.prototype;l.pa=function(){return this.f};l.Pa=function(){return this.g};l.gb=function(){return this.c};l.Qa=function(){return!0};
l.sa=function(a){a.F.create().then(C(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.g=b;b=S(b).url.c[0].toString();var d=this.Aa();this.a&&(this.xa(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.xa(d);b=z({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};l.Xa=function(){};
l.Ya=function(){return!0};l.xa=function(a){this.h=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};l.Aa=function(){return this.h};l.Fa=function(){return 0};function je(a){this.b=a;this.a=null}je.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};je.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new vd(0,null,this.b);this.a=new R([a]);return Promise.resolve(this.a)};function ke(){}
ke.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new Ea(b);if(440786851!=w(g).id)f=null;else{var h=w(g);if(408125543!=h.id)f=null;else{var k=h.a.byteOffset,m;var p=new Ea(h.a);for(b=null;yb(p.a);){var t=w(p);if(357149030==t.id){b=t;break}}if(b){for(var y=new Ea(b.a),p=1E6;yb(y.a);){var u=w(y);if(2807729==u.id){p=Ma(u);break}}m=p/1E9}else m=null;f=m?{Fb:k,Kb:m}:null}}if(f){var v=w(new Ea(a));if(475249515!=v.id)e=null;else{var ta=f.Fb,Hb=f.Kb;a=[];var Qd=new Ea(v.a);for(f=v=-1;yb(Qd.a);){var Rd=
w(Qd);if(187==Rd.id){var Ja;var Sd=new Ea(Rd.a),Td=w(Sd);if(179!=Td.id)Ja=null;else{var df=Ma(Td),Ud=w(Sd);if(183!=Ud.id)Ja=null;else{for(var Vd=new Ea(Ud.a),k=0;yb(Vd.a);){var Wd=w(Vd);if(241==Wd.id){k=Ma(Wd);break}}Ja={Mb:df,Eb:k}}}if(Ja){var Xd=Hb*Ja.Mb,Yd=ta+Ja.Eb;if(0<=v){var Hc=new H(d,c,f,Yd-1);a.push(new vd(v,Xd,Hc))}v=Xd;f=Yd}}}0<=v&&(Hc=new H(d,c,f,null),a.push(new vd(v,null,Hc)));e=a}}else e=null}catch(Zd){if(!(Zd instanceof RangeError))throw Zd;}return e};function le(a,b,c,d,e){E.call(this,a);this.c=b;this.a=new Ub(c,d,e);this.B=this.D=this.b=null;this.I=!1;this.g=null;this.l=!1;this.i=null;this.o=!1;this.h=new B;this.j=this.f=!1;this.K=0;this.w=15;this.G=!1}q(le,E);le.prototype.H=function(a){null!=a.initialStreamBufferSize&&(this.K=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.w=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.l=Number(a.segmentRequestTimeout))};
le.prototype.destroy=function(){me(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.v=this.c=this.a=null};l=le.prototype;l.pa=function(){return this.b};l.Pa=function(){return this.D};l.gb=function(a){this.f||a.then(function(){this.f=!0;this.g||ne(this,0)}.bind(this)).catch(function(){});return this.h};l.Qa=function(){return this.j};
l.sa=function(a,b,c){if(a!=this.b){var d=[a.F.create(),a.C.create()];Promise.all(d).then(C(this,function(d){if(this.c){var f=this.b;this.b=a;this.D=d[0];this.B=d[1];this.I=!0;this.l||(f?b&&oe(this,!0,c):ne(this,0))}})).catch(C(this,function(a){"aborted"!=a.type&&(this.f?(a=A(a),this.dispatchEvent(a)):this.h.reject(a))}))}};l.Xa=function(){return oe(this,!1)};
function oe(a,b,c){a.b&&!a.l&&(a.l=!0,me(a),Wb(a.a).then(C(a,function(){var a=this.c.currentTime;if(!b&&0<Xb(this.a,a)&&0<=bc(this.a.b,a))return Promise.resolve();if(c)return ec(this.a,this.c.currentTime+c);this.G=!0;return dc(this.a)})).then(C(a,function(){this.l=!1;ne(this,0)})).catch(C(a,function(a){this.l=!1;this.f?(a=A(a),this.dispatchEvent(a)):this.h.reject(a)})))}l.Ya=function(a){return 0<Xb(this.a,a)&&0<=bc(this.a.b,a)};l.xa=function(){};l.Aa=function(){return!0};
l.Fa=function(){return this.o?this.w:Math.min(this.K,this.w)};
l.zb=function(){if(this.o&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)oe(this,!0);else{this.g=null;a=this.b;var b=this.D,c=this.c.currentTime;Xb(this.a,this.o?c:c+(this.i||0))>=this.Fa()?(pe(this),ne(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=qe(this,c,b))?(b=Yb(this.a,b,a.c,this.B),this.B=null,this.I&&(this.I=!1,re(this,a)),this.j=!1,b.then(C(this,function(a){null==this.i&&(this.i=a);this.G&&0<Xb(this.a,c)&&(this.G=!1,this.c.currentTime+=.001);
ne(this,0)})).catch(C(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Nb.status)&&this.b&&ne(this,5E3);a=A(a);this.dispatchEvent(a)}}))):(pe(this),this.f&&!this.j&&(this.j=!0,se(this)),ne(this,1E3))}}};function qe(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.ja(a.a):null:c.ja(b)||(c.length()?T(c):null)}function pe(a){if(!a.o&&null!=a.i){a.o=!0;var b=a.a,c=a.i,d=c-b.o;0!=d&&(b.b=Cd(b.b,d),b.o=c);a.h.resolve(a.i)}}
function re(a,b){var c;c=b.a.split("/")[0];c=z({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function se(a){var b=z({type:"ended"});a.dispatchEvent(b)}function ne(a,b){a.g=window.setTimeout(a.zb.bind(a),b)}function me(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function te(a){this.b=a;this.a=null}te.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};te.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new vd(c.start_time,c.end_time,new H(null,[new J(c.url)],c.start_byte,null)))}this.b=null;this.a=new R(a);return Promise.resolve(this.a)};function ue(){}
ue.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new Fa(a),h=F(g);if(1936286840!=F(g))e=null;else{1==h&&(h=zb(g));var k=La(g);x(g,3);x(g,4);var m=F(g);if(0==m)e=null;else{var p,t;0==k?(p=F(g),t=F(g)):(p=zb(g),t=zb(g));x(g,2);var y=g.b.getUint16(g.a,g.c);g.a+=2;a=p;b=b+h+t;for(h=0;h<y;h++){var u=F(g);t=(u&2147483648)>>>31;var k=u&2147483647,v=F(g);F(g);if(1==t){e=null;break a}var ta=new H(d,c,b,b+k-1);f.push(new vd(a/m,(a+v)/m,ta));a+=v;b+=k}e=f}}}}catch(Hb){if(!(Hb instanceof RangeError))throw Hb;
}return e};function ve(a,b,c,d,e,f,g){this.g=a;this.j=b;this.f=c;this.a=d;this.c=e;this.v=f;this.i=this.b=null;this.h=g}ve.prototype.destroy=function(){this.h=this.j=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.i&&(this.i.destroy(),this.i=null);this.b=null};
ve.prototype.create=function(){if(this.b)return this.b;var a=[ac(this.a)];"webm"==this.f&&a.push(ac(this.c));return this.b=Promise.all(a).then(C(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new ue,d=d.parse(new DataView(c),this.a.f,this.a.c,this.h)):"webm"==this.f&&(d=new ke,d=d.parse(new DataView(c),new DataView(a),this.a.c,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.j,this.v):e=new R(d);return Promise.resolve(e)}))};function we(a){this.a=a}
function xe(a,b,c){for(var d=lb()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var k=0;k<h.a.length;++k){var m=h.a[k],p=0,p=p+(m.g?1:0),p=p+(m.b?1:0),p=p+(m.a?1:0);0==p?(h.a.splice(k,1),--k):1!=p&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}ye(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){k=h=f.b[g];m=null;for(p=0;p<k.a.length;++p){var t=k.a[p].f||"";m?t!=m&&(k.a.splice(p,1),--p):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.b&&(b.b=d);e=new de;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new H(c,b.j||b.url),e.h=b.b);e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=ze(a,b,g,d,c);e.a.push(g)}return e}
function ye(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.c=null);b(a.c)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.c);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.c};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.c)||(e=a.a[a.a.length-1],d?a.c=c:b(e.start)&&b(e.a)?a.c=e.start+e.a:"dynamic"!=a.type&&
(a.c=c))}}function ze(a,b,c,d,e){var f=new ce;f.id=c.id;f.start=c.start;f.b=c.a;var g=new D;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=tb(g),k=0;k<h.length;++k){var m=new D;g.get(h[k]).forEach(function(a){m.push(a.group,a)});for(var p=tb(m),t=0;t<p.length;++t){var y=new D;m.get(p[t]).forEach(function(a){y.push(a.lang,a)});for(var u=tb(y),v=0;v<u.length;++v){var ta=y.get(u[v]),ta=Ae(a,b,c,ta,d,e);f.a.push(ta)}}}return f}
function Ae(a,b,c,d,e,f){ma(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new Pd,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},k=0;k<d.length;++k)for(var m=d[k],p=0;p<m.a.length;++p){var t=m.a[p],y=Be(a,t),u=g.a.slice(0);
Ce(y,u);0==u.length&&0<g.a.length||!(t=De(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.A]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.M=!0}),g;a=Ee(d);for(k=0;k<g.m.length;++k)t=g.m[k],m=h[t.A],m==a&&(t.M=!0);return g}function Ee(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function Ce(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.j==g.j&&f.l==g.l&&f.h==g.h&&f.i==g.i&&f.g==g.g&&f.o==g.o&&f.f==g.f&&f.v==g.v&&Ia(f.c,g.c)){d=!0;break}}d||(b.splice(c,1),--c)}}function Be(a,b){var c=[];if(0==b.c.length)c.push(new ab);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,Fe(a,b.c[d]));return c}
function Fe(a,b){var c=[];if(2==a.a.length){var d=a.a(b.schemeIdUri,b.b);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=bb(d[e]);0==f.b.length&&b.pssh&&b.pssh.psshBox&&fb(f,[{initData:b.pssh.psshBox,initDataType:"cenc"}]);c.push(f)}}else{d=a.a(b);if(!(d&&d instanceof gb))return[];e=new ab;e.a=d.g;e.j=d.j;e.l=d.o;e.h=d.h;e.i=d.i;e.g=d.f;e.o=d.v;e.f=d.c;e.v=d.l;e.c=d.b?new Uint8Array(d.b.buffer):null;fb(e,d.a);c.push(e)}return c}
function De(a,b,c,d,e){if(!c.s||0===c.s.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new Uc,h.url=c.s,h.a=g.a?g.a.clone():null),h=Ge(h,e),g=g.c?Ge(g.c,e):null,a=new ve(a,b,f,h,g,d,e),b=new Ad(g),d=new Md,d.F=a,d.C=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?Ge(f.h,e):null,a=new Ld(a,b,c,d,e),b=
new Ad(f),d=new Md,d.F=a,d.C=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.a?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.a=null):f.c&&(f.a=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?He(c,f,Vc):null,!g)){f=null;break a}f=g?Ge(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?ud(e,c,1,0)?(h=(h=c.a.f)?He(c,h,Uc):null)?(h=Ge(h,e),a=new ve(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new Jd(a,b,c,d,e):g.a?"dynamic"!=a.type&&null==b.a?null:
new Kd(a,b,c,d,e):null:null;a?(b=new Ad(f),d=new Md,d.F=a,d.C=b,f=d):f=null}else f=null;g=c.a.b;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new Md,f.F=new je(new H(e,c.s)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.a&&f.f.push(b.a);return f}function He(a,b,c){b=wd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=rd(a.s,b);return c}
function Ge(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.oa,e=a.a.end);return new H(b,c,d,e)};function Ie(a,b){gc.call(this,"readwrite",b);this.j=a;this.b=0}q(Ie,gc);
function Je(a,b,c,d,e){for(var f=[],g=[],h=0,k=0,m=[],p=b.map(function(a){return a.F.create()}),p=Promise.all(p),t=b.map(function(a){return a.C.create()}),t=Promise.all(t),p=Promise.all([p,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)p=p.then(function(a){return Ke(this,b[a],f[a],g[a],h,k)}.bind(a,t)),p=p.then(function(a,b){k+=f[a].length();m.push(b)}.bind(a,t));return p.then(C(a,function(){return Le(mc(this))})).then(C(a,function(a){var b=
new B;c=Na(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.j,with_credentials:e.l,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.v},g=mc(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function Me(a,b){return nc(mc(a),b).then(C(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(Ne(this,a.stream_ids[e]));a=mc(this);d.push(a.delete(b));return Promise.all(d)}))}
function Ke(a,b,c,d,e,f){var g=[Le(lc(a)),Le(jc(a).index("stream"))],g=Promise.all(g).then(C(a,function(a){return{ra:Math.max(a[0],a[1]),ha:new ArrayBuffer(0),Da:0,u:[],za:null,Lb:e,Wa:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function Le(a){var b=new B,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
Ie.prototype.g=function(a,b,c){var d=new B;a={stream_id:c.ra,mime_type:a.a,codecs:a.b,init_segment:b,references:c.u};var e=lc(this).put(a);e.onsuccess=function(){d.resolve(c.ra)};e.onerror=function(){d.reject(e.error)};return d};Ie.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(C(this,function(a){Ne(this,b.ra);return Promise.reject(a)}))};
Ie.prototype.c=function(a,b,c,d){var e=new B;0==b.ha.byteLength&&(b.za=a);b.ha=Oe(b.ha,d);b.Wa++;var f=z({type:"progress",detail:b.Wa/b.Lb*100,bubbles:!0});if(1048576<=b.ha.byteLength||c){c={stream_id:b.ra,segment_id:b.Da,content:b.ha};var g=jc(this).put(c);b.u.push({start_time:b.za.b,start_byte:b.za.url.f,end_time:a.a,url:"idb://"+b.ra+"/"+b.Da});b.Da++;b.ha=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=C(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function Oe(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}Ie.prototype.i=function(a){var b=new $b;b.c=1E3*this.b;return ac(a.url,b,this.j)};
function Ne(a,b){var c=new B,d=lc(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=jc(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function Pe(a,b,c,d,e,f){this.b=new H(null,[new J(a)]);this.a=new $b;this.a.body=b;this.a.method=c;this.a.a=3;this.a.i=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function Qe(a){return ac(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Re(a,b,c){E.call(this,a);this.g=b;this.b=c;this.a=this.h=null;this.l=new Cb;this.j={};this.f=[];this.o=0;this.c=new B;this.i=null;this.w=0}q(Re,E);Re.prototype.destroy=function(){this.v=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.j=this.a=this.h=null;this.c.destroy();this.c=null;this.l.destroy();this.l=null;this.i&&(window.clearTimeout(this.i),this.i=null);this.g=this.b=null};
Re.prototype.initialize=function(){for(var a=new D,b=this.b.Oa(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!Se(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.o||this.b.fa()?"required":"optional",sessionTypes:[this.b.fa()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var k;"audio"==f.contentType?k=f.a.f:"video"==f.contentType&&(k=f.a.v);h[g].push({contentType:f.b,robustness:k})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Ea(a),this.c.resolve(),Promise.resolve();k=new B;c=Te(this,c,k);c=c.then(this.kb.bind(this,b,a));c=c.then(this.Gb.bind(this));k.reject(null);return c};
function Ue(a,b){null==a.i&&(a.i=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.c.reject(a)}.bind(a),b));return a.c}function Ve(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function Te(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.fa()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}l=Re.prototype;
l.kb=function(a,b,c){if(!this.g)return We();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var k=e[h+"Capabilities"];if(k&&k.length){for(var k=k[0],m=[],p={},t=0;t<a.length;++t){var y=a[t];if(y.a.a==d&&y.b==k.contentType&&!(y.id in p)){m.push(y);p[y.id]=!0;var u;if(this.a){u=this.a;var y=y.a,v=new ab;v.a=u.a;v.j=u.j;v.l=u.l;v.h=u.h;v.i=u.i;v.g=u.g;v.o=u.o;v.f=u.f;v.v=u.v;v.c=u.c?new Uint8Array(u.c.buffer):null;fb(v,u.b);fb(v,
y.b);u=v}else u=y.a;this.a=u}}b.a[h]=m}}}this.b.Ea(b);return c.createMediaKeys()};
l.Gb=function(a){if(!this.g)return We();this.h=a;return this.g.setMediaKeys(this.h).then(C(this,function(){return this.g?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():We()})).then(C(this,function(){if(!this.g)return We();if(0<this.b.wa().length)Xe(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Ra({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&G(this.l,this.g,"encrypted",this.Ra.bind(this))}}))};
function We(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}l.Ra=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.j[c]){try{var d=Ye(this)}catch(e){d=A(e);this.dispatchEvent(d);this.c.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.j[c]=!0;a.catch(C(this,function(a){if(this.j){this.j[c]=!1;var b=A(a);this.dispatchEvent(b);this.c.reject(a)}}));this.f.push(d)}};
function Xe(a){for(var b=a.b.wa(),c=0;c<b.length;++c){var d=Ye(a),e=d.load(b[c]);a.f.push(d);e.then(C(a,function(){this.o++;this.o>=this.f.length&&this.c.resolve()})).catch(C(a,function(a){a=A(a);this.dispatchEvent(a)}))}}
function Ye(a){var b=null;if(a.b.fa())try{b=a.h.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.h.createSession();G(a.l,b,"message",a.vb.bind(a));G(a.l,b,"keystatuseschange",a.nb.bind(a));return b}l.vb=function(a){Ze(this,a.target,this.a,a.message)};l.nb=function(a){a=a.target.keyStatuses;for(var b={},c=a.keys(),d=c.next();!d.done;d=c.next()){var e=$a(new Uint8Array(d.value)),d=a.get(d.value);b[e]=d}this.b.Sa(b)};
function Ze(a,b,c,d){d=$e(c,d);Qe(new Pe(d.url,d.body,d.method,c.l,d.headers,a.w)).then(C(a,function(a){c.h&&(a=c.h(a));return b.update(a)})).then(C(a,function(){var a=z({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o>=this.f.length&&this.c.resolve()})).catch(C(a,function(a){a.Pb=b;a=A(a);this.dispatchEvent(a)}))}
function $e(a,b){var c={url:a.j,body:b.slice(0),method:"POST",headers:{}};if(!a.i)return c;a.i(c);c.url=cb(c,"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=cb(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=eb(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");
return c};function V(a){E.call(this,null);this.a=a;this.b=null;this.f=new Cb;this.j=this.l=null;this.H=0;this.B=null;this.i=!1;this.g=new ee;this.c={enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new da};this.o=1;this.D=null}q(V,E);n("shaka.player.Player",V);V.version="v1.5.0-21-g9befe62";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function Se(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=Se;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+ra(a)+" }",0)};V.prototype.destroy=function(){return this.w().then(C(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.w=function(){if(!this.b)return Promise.resolve();this.i&&af(this);this.a.pause();Db(this.f);bf(this);cf(this);this.l&&(this.l.destroy(),this.l=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.i=!1;this.g=new ee;return a};V.prototype.unload=V.prototype.w;
V.prototype.ma=function(a){var b=this.w();this.a.autoplay&&(ha("load"),G(this.f,this.a,"timeupdate",this.mb.bind(this)));a.I(this.c);a.cb(this.D);this.D=null;b=b.then(C(this,function(){return a.V()}));b.catch(C(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(C(this,function(){if(!this.a)return ef();this.b=a;G(this.f,this.b,"seekrangechanged",this.tb.bind(this));this.l=new Re(this,this.a,this.b);return this.l.initialize()})).then(C(this,function(){if(!this.a)return ef();G(this.f,
this.a,"error",this.Hb.bind(this));G(this.f,this.a,"playing",this.rb.bind(this));G(this.f,this.a,"pause",this.qb.bind(this));return this.b.Ka(this,this.a)})).then(C(this,function(){if(!this.a)return ef();ff(this)})).catch(C(this,function(a){if(!this.a)return ef();if("destroy"!=a.type){var b=A(a);this.dispatchEvent(b)}return this.w().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.ma;
function ef(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}l=V.prototype;l.mb=function(){ka("load");this.g.playbackLatency=la("load")/1E3;this.f.ta(this.a,"timeupdate")};l.Hb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(gf[a]||"Unknown playback error."),a.type="playback",a=A(a),this.dispatchEvent(a))}};
l.rb=function(){ha("playing");!this.j&&0>this.o&&(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),this.o));this.i&&af(this)};l.qb=function(){ka("playing");var a=la("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}cf(this)};l.tb=function(a){this.H=a.start};
l.eb=function(){if(!this.a.paused){ka("playing");var a=la("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;ha("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.eb;V.prototype.la=function(){return this.b?this.b.ka():[]};V.prototype.getVideoTracks=V.prototype.la;V.prototype.ua=function(){return this.b?this.b.qa():[]};
V.prototype.getAudioTracks=V.prototype.ua;V.prototype.va=function(){return this.b?this.b.Ha():[]};V.prototype.getTextTracks=V.prototype.va;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.na=function(a,b){return this.b?this.b.ab(a,void 0==b?!0:b):!1};V.prototype.selectAudioTrack=V.prototype.na;V.prototype.ib=function(a){return this.b?this.b.bb(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.ib;V.prototype.U=function(a){this.b&&this.b.Ga(a)};V.prototype.enableTextTrack=V.prototype.U;V.prototype.K=function(a){this.h({enableAdaptation:a})};V.prototype.enableAdaptation=V.prototype.K;V.prototype.S=function(){return this.c.enableAdaptation};V.prototype.getAdaptationEnabled=V.prototype.S;V.prototype.da=function(a){this.h({streamBufferSize:a})};V.prototype.setStreamBufferSize=V.prototype.da;V.prototype.X=function(){return Number(this.c.streamBufferSize)};
V.prototype.getStreamBufferSize=V.prototype.X;V.prototype.jb=function(a){this.h({licenseRequestTimeout:a/1E3})};V.prototype.setLicenseRequestTimeout=V.prototype.jb;V.prototype.Z=function(a){this.h({mpdRequestTimeout:a/1E3})};V.prototype.setMpdRequestTimeout=V.prototype.Z;V.prototype.L=function(a){this.h({segmentRequestTimeout:a/1E3})};V.prototype.setRangeRequestTimeout=V.prototype.L;V.prototype.ca=function(a){this.h({preferredLanguage:a})};V.prototype.setPreferredLanguage=V.prototype.ca;
V.prototype.ba=function(a){cf(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),a));this.o=a};V.prototype.setPlaybackRate=V.prototype.ba;V.prototype.T=function(){return this.o};V.prototype.getPlaybackRate=V.prototype.T;V.prototype.N=function(a){this.h({restrictions:a})};V.prototype.setRestrictions=V.prototype.N;V.prototype.W=function(){return this.c.restrictions.clone()};V.prototype.getRestrictions=V.prototype.W;
V.prototype.hb=function(a){this.D=a};V.prototype.setPlaybackStartTime=V.prototype.hb;V.prototype.I=function(){return this.b?this.b.$a():!1};V.prototype.isLive=V.prototype.I;
V.prototype.h=function(a){if(a){var b=db(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=kb(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=kb(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=kb(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=kb(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=cb(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=b);a=eb(a,"restrictions",da);null!=a&&(this.c.restrictions=
a.clone());this.b&&this.b.I(this.c)}};V.prototype.configure=V.prototype.h;V.prototype.ea=function(){return this.c};V.prototype.getConfiguration=V.prototype.ea;function cf(a){a.j&&(window.clearTimeout(a.j),a.j=null)}function ff(a){bf(a);a.B=window.setTimeout(a.Y.bind(a),100)}function bf(a){a.B&&(window.clearTimeout(a.B),a.B=null)}
V.prototype.G=function(a,b,c){this.j=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.H+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.H,a+d),this.a.currentTime=d,this.j=window.setTimeout(this.G.bind(this,a,b,c),250))};function af(a){ka("buffering");var b=a.g;b.bufferingTime+=la("buffering")/1E3;a.i=!1;a.dispatchEvent(z({type:"bufferingEnd"}))}
V.prototype.Y=function(){ff(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0);if(this.i)b=this.b.Za(),a>b&&(af(this),this.a.play());else{var c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;!this.a.paused&&!b&&.2>a&&(this.i=!0,this.a.pause(),this.g.bufferingHistory.push(lb()/1E3),ha("buffering"),this.dispatchEvent(z({type:"bufferingStart"})))}}};
var gf={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function hf(a,b,c){E.call(this,null);this.f=a;this.c=b;this.b=bb(c);this.a=null}q(hf,E);n("shaka.player.HttpVideoSource",hf);hf.prototype.I=function(){};hf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.v=this.b=null};l=hf.prototype;l.Ka=function(a,b){this.v=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};l.V=function(){return Promise.resolve()};
l.ka=function(){return[]};l.qa=function(){return[]};l.Ha=function(){return[]};l.Za=function(){return 5};l.Oa=function(){var a=new be;a.a=this.b;return[a]};l.Ea=function(){};hf.prototype.selectVideoTrack=function(){return!1};l=hf.prototype;l.ab=function(){return!1};l.bb=function(){return!1};l.Ga=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};l.cb=function(){};l.wa=function(){return[]};l.fa=function(){return!1};l.$a=function(){return!1};
l.Sa=function(a){for(var b in a){var c=a[b],d=Tb[c]||null;if(d){var e=Va(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=A(d);this.dispatchEvent(c)}}};function jf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)Se(Od(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function kf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(lf)}function lf(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function mf(a){this.a=a}mf.prototype.destroy=function(){this.a.destroy();this.a=null};function nf(a,b){var c=of(b),d=of(a.a);return Promise.all([c,d]).then(C(a,function(a){var c=a[0];a=a[1];var d=this.a.a;jf(d);kf(d);b.f=this.a.f;b.g=this.a.g?this.a.g.clone():null;b.c=this.a.c;d=[];pf(b,this.a,c,a,d);c=b.a;jf(c);kf(c);return Promise.resolve(d)}))}
function of(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.F.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].A]=a[f];return Promise.resolve(b)})}
function pf(a,b,c,d,e){var f=new D;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=tb(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(qf(k[0],h[0],c,d,e),k[0].b=h[0].b)}}
function qf(a,b,c,d,e){var f=new D;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=tb(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&rf(k[0],h[0],c,d,e)}}
function rf(a,b,c,d,e){var f=new D;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=tb(f),k=0;k<h.length;++k){var m=h[k];b[m]=m;var p=f.get(m);1<p.length||((m=g.get(m))&&0!=m.length?1==m.length&&(sf(p[0],m[0],c,d),p[0].C=m[0].C,m[0].C=null,p[0].c=m[0].c):(e.push(p[0]),a.m.splice(a.m.indexOf(p[0]),1)))}h=tb(g);for(k=0;k<h.length;++k)m=h[k],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function sf(a,b,c,d){a=c[a.A];b=d[b.A];a.length();a.Ca(b)&&a.length()};function W(){this.a=this.b=null;this.f=new Cb;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}n("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,G(this.f,this.b,"bandwidth",this.v.bind(this)),G(this.f,this.a,"adaptation",this.j.bind(this)),G(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=tf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.v=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=tf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function tf(a){var b=a.a.ka();if(0==b.length)return null;b.sort(fa);var c;a:{c=a.a.qa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function X(a,b,c){E.call(this,null);this.a=a;this.Y=b;this.i=new Cb;this.g=new MediaSource;this.f=null;this.ba=0;this.b=new D;this.G=c;this.G.initialize(b,this);this.D=!1;this.H="en";this.da=!1;this.K=null;this.w=new B;this.h=new da;this.B=null;this.va=1;this.c={};this.ca=new B;this.W=0;this.ua=!1;this.o={};this.Z=this.X=this.S=null;this.T={}}q(X,E);n("shaka.player.StreamVideoSource",X);
X.prototype.I=function(a){null!=a.streamBufferSize&&(this.T.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.T.segmentRequestTimeout=a.segmentRequestTimeout);uf(this);null!=a.enableAdaptation&&this.G.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ba=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.H=Pa(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.D&&vf(this))};
X.prototype.destroy=function(){this.w.destroy();this.ca.destroy();this.ca=this.w=null;this.X&&(window.clearTimeout(this.X),this.X=null);this.S&&(window.clearTimeout(this.S),this.S=null);this.o=null;this.i.destroy();this.i=null;jb(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.G.destroy();this.v=this.h=this.K=this.f=this.g=this.Y=this.G=null};l=X.prototype;
l.Ka=function(a,b){if(!this.D){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.v=a;this.f=b;this.K=a.eb();G(this.i,this.g,"sourceopen",this.pb.bind(this));G(this.i,this.Y,"bandwidth",this.Ib.bind(this));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.w,c])};
l.V=function(){if(this.D){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;jf(a);kf(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.D=!0;this.T.initialStreamBufferSize=this.a.c;uf(this);vf(this);
return Promise.resolve()};l.Va=function(a){var b=Date.now(),c=this.S=null,d=this.a.g;(a?this.Ta():this.Ua(d)).then(C(this,function(a){c=new mf(a);return nf(c,this.a)})).then(C(this,function(a){c.destroy();c=null;for(var d=0;d<a.length;++d)wf(this,a[d]);this.T.initialStreamBufferSize=this.a.c;uf(this);vf(this);0==Object.keys(this.c).length?xf(this):yf(this,(Date.now()-b)/1E3)})).catch(C(this,function(a){c&&(c.destroy(),c=null);"aborted"!=a.type&&(a=A(a),this.dispatchEvent(a),this.a&&yf(this,0))}))};
l.Ua=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};l.Ta=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function yf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.S=window.setTimeout(a.Va.bind(a,!1),1E3*c)}}
function wf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.pa()==b){var e=a.b.get(b.a.split("/")[0]),f=e.map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.M&&a.J});if(0==f.length){e.push(b);return}a.o[c].Ia==b&&delete a.o[c];d.sa(f[0],!0);b.destroy()}b.destroy()}
l.ka=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.pa():null)?a.A:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.M&&g.J){var h=g.A,g=new ea(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ka;
X.prototype.qa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.pa():null)?a.A:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.M&&h.J){var k=h.A,h=new ba(k,h.bandwidth,f);k==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.qa;
X.prototype.Ha=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.pa():null,b=b?b.A:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var k=f.m[h].A,m=new ca(k,g);k==b&&(m.active=!0,m.enabled=a.Aa());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Ha;X.prototype.Za=function(){var a=null,b;for(b in this.c){var c=this.c[b].Fa();0<c&&(a=null!=a?Math.min(a,c):c)}return a||0};
X.prototype.Oa=function(){var a;if(this.D){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,ae(a.a[c]));a=b}else a=[];return a};
X.prototype.Ea=function(a){if(this.D){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.A]=e}this.b.a={};c=tb(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var k=f[h];k.b.split(";")[0]==g&&this.b.push(e,b[k.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.da=!0;if(a=this.b.get("audio"))zf(this,a),this.b.a.audio=a,a=a[0].lang||this.H,Oa(2,this.H,
a)&&(this.da=!1);if(a=this.b.get("text"))zf(this,a),this.b.a.text=a,a=a[0].lang||this.H,Oa(2,this.H,a)||(this.da=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return Af(this,"video",a,b,c)};l=X.prototype;l.ab=function(a,b){return Af(this,"audio",a,b)};l.bb=function(a,b){return Af(this,"text",a,b)};l.Ga=function(a){var b=this.c.text;b&&b.xa(a)};l.cb=function(a){this.Z=a};
function vf(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],k=h.J;h.J=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.J=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.J=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.J=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.J=!1);k!=h.J&&(b=!0)}}0!=rb(a.b).length&&b&&(Bf(a),0<a.ka().length||(b=Error("The application has restricted all video tracks!"),
b.type="app",b=A(b),a.dispatchEvent(b)))}}l.wa=function(){return[]};l.fa=function(){return!1};l.$a=function(){return this.a?this.a.b:!1};
l.Sa=function(a){for(var b,c=!1,d=new D,e=rb(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var k=g.m[h];k.f.forEach(function(a){d.push(a,k)})}for(b in a)if(e=Tb[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)k=g[f],h=k.M,k.M=!e,h!=k.M&&(c=!0);else Va(b);c&&(Bf(this),b=this.qa(),a=this.ka(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="drm",a=A(a),this.dispatchEvent(a))};function Bf(a){var b=z({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function Af(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],k=0;k<h.m.length;++k){var m=h.m[k];if(m.A==c){if(!m.M||!m.J)return!1;if("text"!=b&&!a.ua)return c=a.o[b],a.o[b]={Ia:m,La:null!=c&&c.La||d,Ma:null!=c&&c.Ma||e},!0;fe(a.K,m);a.c[b].sa(m,d,e);return!0}}return!1}
function zf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Oa(c,a.H,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}l.pb=function(){this.i.ta(this.g,"sourceopen");xf(this).then(C(this,function(){this.w&&this.w.resolve()})).catch(C(this,function(a){this.w&&this.w.reject(a)}))};
function xf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Cf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=jb(f).map(function(a){return a.F.create()});return Promise.all(b).then(C(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Df(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Ef(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.G.start();Ff(this,f,a);return Promise.resolve()})).catch(C(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(a=Math.max(this.a.h-Date.now()/1E3,3),this.S=window.setTimeout(this.Va.bind(this,!0),1E3*
a),Promise.resolve()):Promise.reject(a)}))}function Cf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.G.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.A==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.M&&a.J});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function Ef(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new ie(a,a.f):Gf(a,e);if(!e)return jb(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Gf(a,b){var c=new le(a,a.f,a.g,Od(b),a.Y);c.H(a.T);return c}
function Ff(a,b,c){a.va=a.f.playbackRate;a.f.playbackRate=0;Hf(a,c);var d;d=a.a.b?c.end:a.Z&&a.Z<=c.end&&a.Z>=c.start?a.Z:c.start;G(a.i,a.f,"seeking",a.ub.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.B=d);If(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.gb(a.ca));G(a.i,d,"ended",a.wb.bind(a));var f=b[e];fe(a.K,f);d.sa(f,!1)}Promise.all(c).then(a.lb.bind(a)).catch(C(a,function(a){"destroy"!=a.type&&(a=A(a),this.dispatchEvent(a))}));a.Ga(a.da)}
l.lb=function(a){ma(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=Jf(this);for(d=0;d<a.length;++d)a[d].ia(c);Kf(this,a,c);d=rb(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.F.create()];a.C&&b.push(a.C.create());return Promise.all(b)});Promise.all(d).then(C(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ia(c);this.ua=
!0;for(var d in this.o)a=this.o[d],b=this.c[d],fe(this.K,a.Ia),b.sa(a.Ia,a.La,a.Ma);this.o={}})).catch(C(this,function(a){"aborted"!=a.type&&(a=A(a),this.dispatchEvent(a))}))};function Kf(a,b,c){if(b=Df(a,b))Hf(a,b),If(a,b.start,b.end);0!=c?(c=a.f.currentTime+c,a.f.currentTime=c,a.B=c):c=a.f.currentTime;a.a.b&&b&&(a.W=b.end-c,a.W=Math.max(a.W,0));a.f.playbackRate=a.va;a.a.b&&null!=a.a.f&&yf(a,a.W);Lf(a);a.ca.resolve()}
function Hf(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}l.yb=function(){this.X=null;Lf(this);var a=Df(this,Jf(this));a&&(If(this,a.start,a.end),this.f.paused||Mf(this,this.f.currentTime,a.start,a.end))};function If(a,b,c){b=z({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}
l.ub=function(){var a=this.f.currentTime;if(null!=this.B){if(a>=this.B-.01&&a<=this.B+.01){this.B=null;return}this.B=null}var b=Df(this,Jf(this));if(b){var c=b.end;(b=Mf(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].Xa()}};function Mf(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.b){b=.5;for(var e in a.c)if(!a.c[e].Ya(c+b)){b=a.a.c;break}}a.f.currentTime=Math.min(c+b,d);return!0}
l.wb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Qa())return;this.g.endOfStream()}};l.Ib=function(){var a=this.K,b=this.Y.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new he(b))};function Jf(a){return jb(a.c).map(function(a){return a.Pa()}).filter(function(a){return null!=a})}
function Df(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e<b.length;++e){var f=b[e].Ba(),c=Math.max(c,f.start);null!=f.end&&(d=Math.min(d,f.end))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-(a.a.c+a.W),c));return c>d?null:{start:c,end:d}}function Lf(a){a.a.b&&(a.X=window.setTimeout(a.yb.bind(a),1E3))}function uf(a){for(var b in a.c)a.c[b].H(a.T)};function Y(a,b,c){b||(b=new vb);c||(c=new W);X.call(this,null,b,c);this.U=a;this.L=[];this.timeoutMs=3E4;this.l={};this.j=this.N=null}q(Y,X);n("shaka.player.OfflineVideoSource",Y);Y.prototype.I=function(a){null!=a.licenseRequestTimeout&&(this.l.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.l.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.I.call(this,a)};
n("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new oc,b=hc(a).then(function(){return pc(a)});b.then(function(){I(a)}).catch(function(){I(a)});return b});
Y.prototype.na=function(a,b,c,d){var e,f=null,g={},h=[];a=new H(this.N,[new J(a)]);return zd(new yd(a,this.ba)).then(C(this,function(a){this.a=xe(new we(c),a,this.N);if(this.a.b)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.I({preferredLanguage:b});return X.prototype.V.call(this)})).then(C(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new Re(null,a,this);null!=this.l.licenseRequestTimeout&&(e.w=Number(this.l.licenseRequestTimeout));
G(this.i,e,"sessionReady",this.ea.bind(this));G(this.i,e,"error",function(a){f=a});return e.initialize()})).then(C(this,function(){for(var a=rb(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var f=c.m[e];g[f.A]=f}return d()})).then(C(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=h.map(function(a){return a.C.create()});
return Promise.all(a)})).then(C(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(Od(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(C(this,function(){return Ue(e,this.timeoutMs)})).then(C(this,function(){return f?Promise.reject(f):Nf(this,h,e.a,this.a.a[0].b)})).then(C(this,function(a){this.U=a;return f?
(Of(this),Promise.reject(f)):Promise.resolve(a)}))};n("shaka.player.OfflineVideoSource.prototype.store",Y.prototype.na);Y.prototype.ma=function(a){this.N=a};Y.prototype.setNetworkCallback=Y.prototype.ma;Y.prototype.ea=function(a){this.L.push(a.detail.sessionId)};
function Nf(a,b,c,d){var e=new Ie(a.Y,a);null!=a.l.segmentRequestTimeout&&(e.b=Number(a.l.segmentRequestTimeout));return hc(e).then(C(a,function(){return Je(e,b,this.L,d,c)})).then(function(a){I(e);return Promise.resolve(a)}).catch(function(a){I(e);return Promise.reject(a)})}
Y.prototype.V=function(){var a=new oc,b,c;return hc(a).then(C(this,function(){return qc(a,this.U)})).then(C(this,function(d){var e=[];this.L=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(rc(a,d.stream_ids[f]));return Promise.all(e)})).then(C(this,
function(a){var e=b,f=c,g=new de;g.c=5;for(var h=new ce,k=0;k<a.length;++k){var m=a[k],p=new Md,t=new te(m.references),y=new Uint8Array(m.init_segment),y=new J("data:application/octet-stream;base64,"+Ya(y)),y=new Ad(new H(this.N,[y],0,null));p.F=t;p.C=y;p.a=m.mime_type;p.b=m.codecs;p.M=!0;this.j&&(null!=this.j.licenseServerUrl&&(f.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(f.withCredentials=this.j.withCredentials),f.licensePostProcessor=this.j.licensePostProcessor,f.licensePreProcessor=
this.j.licensePreProcessor,f.serverCertificate=this.j.serverCertificate);m=bb(f);t=new Pd;t.m.push(p);t.a.push(m);t.contentType=p.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.V.call(this)})).then(function(){I(a);return Promise.resolve()}).catch(function(b){I(a);return Promise.reject(b)})};
Y.prototype.la=function(a,b){a&&(this.j={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return Pf(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(C(this,function(){return Of(this)})).then(function(){return Promise.resolve(c)})};Y.prototype.deleteGroup=Y.prototype.la;Y.prototype.wa=function(){return this.L};
Y.prototype.fa=function(){return!0};function Of(a){var b=new Ie(null,null);return hc(b).then(C(a,function(){return Me(b,this.U)})).then(function(){I(b);return Promise.resolve()}).catch(function(a){I(b);return Promise.reject(a)})}
function Pf(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.g);var c=new Re(null,b,a);null!=a.l.licenseRequestTimeout&&(c.w=Number(a.l.licenseRequestTimeout));return a.V().then(function(){return c.initialize()}).then(C(a,function(){return Ue(c,this.timeoutMs)})).then(function(){return Ve(c)}).then(C(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(C(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};function Z(a,b,c,d){c||(c=new vb);d||(d=new W);X.call(this,null,c,d);this.la=a;this.l=null;this.L=b;this.N=[];this.U=[];this.ea=[];this.j=null}q(Z,X);n("shaka.player.DashVideoSource",Z);Z.prototype.ma=function(a,b,c){this.N.push(a);this.U.push(b||"");this.ea.push(c||"")};Z.prototype.addExternalCaptions=Z.prototype.ma;Z.prototype.na=function(a){this.j=a};Z.prototype.setNetworkCallback=Z.prototype.na;Z.prototype.destroy=function(){this.l=this.j=this.L=null;X.prototype.destroy.call(this)};
Z.prototype.V=function(){var a=new H(this.j,[new J(this.la)]);return zd(new yd(a,this.ba)).then(C(this,function(a){this.l=a;for(var c=0;c<this.N.length;c++){var d=a,e=this.N[c],f=this.U[c],g=this.ea[c];if(0!==d.a.length){var h=new Kc;h.contentType="text";h.lang=f||"en";h.c=!0;f=new Nc;f.bandwidth=0;f.f=g||"text/vtt";f.s=[new J(e)];h.a.push(f);d.a[0].b.push(h);fd(d.a[0])}}this.a=xe(new we(this.L),a,this.j);return X.prototype.V.call(this)}))};
Z.prototype.Ua=function(a){return zd(new yd(a,this.ba)).then(C(this,function(a){this.l=a;a=xe(new we(this.L),a,this.j);return Promise.resolve(a)}))};Z.prototype.Ta=function(){var a=xe(new we(this.L),this.l,this.j);return Promise.resolve(a)};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

