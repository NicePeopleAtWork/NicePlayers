<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>TurtleTube - Basic Test</title>
    <!-- Load the Shaka Player library. -->
    <script src="lib/v1.6.5/shaka-player.compiled.js"></script>
    <!---->
    <!-- YouboraLib -->
    <script src="/src/v5/plugins/shakaplayer/last-build/sp.min.js"></script>
    <!---->
</head>

<body>
    <video id="video1" width="640" height="480" crossorigin="anonymous" controls>
        Your browser does not support HTML5 video.
    </video>
    <script>
    function initPlayer() {
        // Install polyfills.
        shaka.polyfill.installAll();

        // Find the video element.
        var video = document.getElementById('video1');

        // Construct a Player to wrap around it.
        var player = new shaka.player.Player(video);

        // Autoplay
        //player.a.autoplay = true;

        // Attach the player to the window so that it can be easily debugged.
        window.player = player;

        //video error
        player.addEventListener("error", function(e) {
            console.log(e);
        });

        /* Dash */
        var mpdUrl = 'https://turtle-tube.appspot.com/t/t2/dash.mpd';
        var estimator = new shaka.util.EWMABandwidthEstimator();
        var source = new shaka.player.DashVideoSource(mpdUrl, null, estimator);

        /* http * /
        var source = new shaka.player.HttpVideoSource("assets/bear-av-enc.webm", "", {
            'keySystem': 'org.w3.clearkey',
            'licenseServerUrl': 'assets/test_license.json'
        });
        /**/

        // Load the source into the Player.
        player.load(source);

        // init youbora
        window.youbora = new $YB.plugins.Shaka(player, {
            // options
            enableAnalytics: true,
            parseHLS: false,
            parseCDNNodeHost: false,
            hashTitle: true,
            httpSecure: undefined,
            trackAdvertisement: false,
            trackSeekEvent: false,

            // Main properties
            accountCode: "qamini",
            service: "nqs.nice264.com",
            username: "default",
            transactionCode: "",
            isBalanced: 0,

            // params defined
            network: {
                ip: "",
                isp: "",
            },

            // Media Info
            media: {
                cdn: "",
                isLive: undefined,
                resource: ""
            },

            // properties
            properties: {
                filename: "",
                content_id: "",
                content_metadata: {
                    title: "",
                    genre: "",
                    language: "",
                    year: "",
                    cast: "",
                    director: "",
                    owner: "",
                    duration: "",
                    parental: "",
                    price: "",
                    rating: "",
                    audioType: "",
                    audioChannels: ""
                },
                transaction_type: "",
                quality: "",
                content_type: "",
                device: {
                    manufacturer: "",
                    type: "",
                    year: "",
                    firmware: ""
                }
            },

            // concurrency
            concurrencyConfig: {
                enabled: false,
                sessionId: Math.random(),
                service: "pc.youbora.com/cping",
                code: "",
                maxConcurrents: 1,
                redirect: "http://www.google.com",
                ipMode: false,
            },

            //resume
            resumeConfig: {
                enabled: false,
                contentId: undefined,
                service: "pc.youbora.com/resume",
                playTimeService: "pc.youbora.com/playTime",
                callback: function(time) {
                    console.log("ResumeService Callback: Seek to second " + time);
                }
            },

            //balancer
            smartswitchConfig: {
                enabled: false,
                type: "balance",
                service: "smartswitch.youbora.com",
                zoneCode: "",
                originCode: "",
                niceNVA: "",
                niceNVB: "",
                token: ""
            },

            //extraparams
            extraParams: {
                param1: undefined,
                param2: undefined,
                param3: undefined,
                param4: undefined,
                param5: undefined,
                param6: undefined,
                param7: undefined,
                param8: undefined,
                param9: undefined,
                param10: undefined
            }
        });
    }
    document.addEventListener('DOMContentLoaded', initPlayer);
    </script>
    <script src="/src/v5/util/inspector/inspector.js"></script>
</body>

</html>
